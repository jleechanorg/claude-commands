# Review Command - Enhanced Code Review
description = "Comprehensive code analysis with multi-pass security review"

prompt = """
## Enhanced Code Review Analysis

Perform comprehensive code review for:

{{input}}

## Multi-Pass Analysis

### Pass 1: Security Vulnerabilities
- Authentication flaws
- Input validation issues
- Injection vulnerabilities (SQL, command, XSS)
- Secrets exposure
- `shell=True` usage (must use `shell=False, timeout=30`)

### Pass 2: Runtime Errors
- Null pointers and undefined references
- Resource leaks
- Edge cases
- Error handling gaps

### Pass 3: Performance Issues
- Inefficient algorithms
- N+1 queries
- Memory leaks
- Optimization opportunities

### Pass 4: Code Quality
- Maintainability
- Documentation
- Best practices
- DRY violations

## Issue Categorization

- **ğŸ”´ Critical**: Security vulnerabilities, runtime errors, data corruption risks
- **ğŸŸ¡ Important**: Performance issues, maintainability problems, architectural concerns
- **ğŸ”µ Suggestion**: Style improvements, refactoring opportunities
- **ğŸŸ¢ Nitpick**: Minor style issues, documentation improvements

## Critical Patterns to Flag

**Security Issues**:
- `shell=True` â†’ Must use list args with `shell=False, timeout=30`
- Missing input validation â†’ Whitelist patterns required
- SQL injection risks â†’ Parameterized queries only
- Command injection â†’ Never construct commands from user input

**Test Issues**:
- `@unittest.skipIf` or `pytest.skip()` â†’ Use mocks instead
- Environment-dependent tests â†’ Must behave identically everywhere
- Missing cleanup â†’ Use context managers and `finally` blocks

## Output Format

```
ğŸ” ENHANCED CODE REVIEW ANALYSIS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ Summary: [Brief assessment]
ğŸ”´ Critical Issues: [Count and key items]
ğŸŸ¡ Important Issues: [Count and key items]
ğŸ”µ Suggestions: [Count and key items]

[Detailed analysis with specific recommendations]
```
"""
