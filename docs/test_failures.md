2025-08-10T01:10:36.1789707Z ##[group]Run # Activate the virtual environment
2025-08-10T01:10:36.1790100Z [36;1m# Activate the virtual environment[0m
2025-08-10T01:10:36.1790379Z [36;1msource venv/bin/activate[0m
2025-08-10T01:10:36.1790616Z [36;1m[0m
2025-08-10T01:10:36.1790813Z [36;1m# Verify environment is correct[0m
2025-08-10T01:10:36.1791109Z [36;1mecho "Current Python: $(which python3)"[0m
2025-08-10T01:10:36.1791415Z [36;1mecho "Virtual env: $VIRTUAL_ENV"[0m
2025-08-10T01:10:36.1791851Z [36;1mpython3 -c "import pydantic; print(f'‚úÖ Pydantic {pydantic.__version__} available')"[0m
2025-08-10T01:10:36.1792252Z [36;1m[0m
2025-08-10T01:10:36.1792649Z [36;1m# Navigate to mvp_site and run tests directly[0m
2025-08-10T01:10:36.1792938Z [36;1mcd mvp_site[0m
2025-08-10T01:10:36.1793130Z [36;1m[0m
2025-08-10T01:10:36.1793320Z [36;1m# Set test environment variables[0m
2025-08-10T01:10:36.1793584Z [36;1mexport TESTING=true[0m
2025-08-10T01:10:36.1793816Z [36;1mexport MOCK_SERVICES_MODE=true[0m
2025-08-10T01:10:36.1794092Z [36;1m[0m
2025-08-10T01:10:36.1794377Z [36;1mecho "Running tests directly with activated virtual environment..."[0m
2025-08-10T01:10:36.1794730Z [36;1m[0m
2025-08-10T01:10:36.1794984Z [36;1m# Run tests using Python discovery (same pattern as run_tests.sh)[0m
2025-08-10T01:10:36.1795321Z [36;1mtest_count=0[0m
2025-08-10T01:10:36.1795527Z [36;1mfailed_count=0[0m
2025-08-10T01:10:36.1795730Z [36;1m[0m
2025-08-10T01:10:36.1795904Z [36;1m# Find and run all test files[0m
2025-08-10T01:10:36.1796247Z [36;1mfor test_file in $(find tests/ -name "test_*.py" -type f | sort); do[0m
2025-08-10T01:10:36.1796650Z [36;1m  if [[ "$test_file" == *"test_integration"* ]]; then[0m
2025-08-10T01:10:36.1796974Z [36;1m    echo "Skipping integration test: $test_file"[0m
2025-08-10T01:10:36.1797255Z [36;1m    continue[0m
2025-08-10T01:10:36.1797446Z [36;1m  fi[0m
2025-08-10T01:10:36.1797616Z [36;1m[0m
2025-08-10T01:10:36.1798099Z [36;1m  test_count=$((test_count + 1))[0m
2025-08-10T01:10:36.1798451Z [36;1m  echo "Running: $test_file"[0m
2025-08-10T01:10:36.1798687Z [36;1m[0m
2025-08-10T01:10:36.1798884Z [36;1m  if TESTING=true python3 "$test_file"; then[0m
2025-08-10T01:10:36.1799168Z [36;1m    echo "‚úÖ PASS: $test_file"[0m
2025-08-10T01:10:36.1799409Z [36;1m  else[0m
2025-08-10T01:10:36.1799598Z [36;1m    echo "‚ùå FAIL: $test_file"[0m
2025-08-10T01:10:36.1799859Z [36;1m    failed_count=$((failed_count + 1))[0m
2025-08-10T01:10:36.1800109Z [36;1m  fi[0m
2025-08-10T01:10:36.1800319Z [36;1m  echo "----------------------------------------"[0m
2025-08-10T01:10:36.1800589Z [36;1mdone[0m
2025-08-10T01:10:36.1800769Z [36;1m[0m
2025-08-10T01:10:36.1800934Z [36;1mecho ""[0m
2025-08-10T01:10:36.1801144Z [36;1mecho "========================================"[0m
2025-08-10T01:10:36.1801429Z [36;1mif [ $failed_count -eq 0 ]; then[0m
2025-08-10T01:10:36.1801707Z [36;1m  echo "‚úÖ ALL $test_count TESTS PASSED"[0m
2025-08-10T01:10:36.1801961Z [36;1melse[0m
2025-08-10T01:10:36.1802181Z [36;1m  echo "‚ùå $failed_count/$test_count TESTS FAILED"[0m
2025-08-10T01:10:36.1802463Z [36;1m  exit 1[0m
2025-08-10T01:10:36.1802641Z [36;1mfi[0m
2025-08-10T01:10:36.1802840Z [36;1mecho "========================================"[0m
2025-08-10T01:10:36.1842840Z shell: /usr/bin/bash -e {0}
2025-08-10T01:10:36.1843077Z env:
2025-08-10T01:10:36.1843326Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-10T01:10:36.1843743Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib/pkgconfig
2025-08-10T01:10:36.1844139Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-10T01:10:36.1844500Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-10T01:10:36.1844854Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-10T01:10:36.1845207Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib
2025-08-10T01:10:36.1845497Z   TESTING: true
2025-08-10T01:10:36.1845689Z   MOCK_SERVICES_MODE: true
2025-08-10T01:10:36.1845897Z ##[endgroup]
2025-08-10T01:10:36.1918776Z Current Python: /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/bin/python3
2025-08-10T01:10:36.1920172Z Virtual env: /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv
2025-08-10T01:10:36.2630117Z ‚úÖ Pydantic 2.11.7 available
2025-08-10T01:10:36.2740589Z Running tests directly with activated virtual environment...
2025-08-10T01:10:36.2774362Z Running: tests/auth/test_auth_resilience.py
2025-08-10T01:10:36.3471067Z test_clock_skew_auto_retry_mechanism (__main__.AuthResilienceTest.test_clock_skew_auto_retry_mechanism)
2025-08-10T01:10:36.3472879Z üî¥ RED TEST: Verify that clock skew errors trigger auto-retry ... ok
2025-08-10T01:10:36.3474804Z test_connection_status_monitoring (__main__.AuthResilienceTest.test_connection_status_monitoring)
2025-08-10T01:10:36.3483545Z üî¥ RED TEST: Verify that connection status is monitored for smart UI adaptations ... ok
2025-08-10T01:10:36.3484674Z test_integrated_resilience_workflow (__main__.AuthResilienceTest.test_integrated_resilience_workflow)
2025-08-10T01:10:36.3486030Z üü¢ GREEN TEST: Test the complete resilience workflow end-to-end ... ok
2025-08-10T01:10:36.3486876Z test_offline_campaign_caching (__main__.AuthResilienceTest.test_offline_campaign_caching)
2025-08-10T01:10:36.3490079Z üî¥ RED TEST: Verify that successful campaign data is cached for offline viewing ... ok
2025-08-10T01:10:36.3491075Z test_user_friendly_error_messages (__main__.AuthResilienceTest.test_user_friendly_error_messages)
2025-08-10T01:10:36.3495262Z üî¥ RED TEST: Verify that user gets helpful error messages instead of generic failures ... ok
2025-08-10T01:10:36.3495850Z
2025-08-10T01:10:36.3496032Z ============================================================
2025-08-10T01:10:36.3496655Z üß™ AUTHENTICATION RESILIENCE: RED/GREEN TEST SUITE
2025-08-10T01:10:36.3497159Z ============================================================
2025-08-10T01:10:36.3497950Z üî¥ RED TEST: Testing clock skew auto-retry mechanism
2025-08-10T01:10:36.3498581Z ‚úÖ Auto-retry mechanism implementation found
2025-08-10T01:10:36.3499218Z üî¥ RED TEST: Testing connection status monitoring
2025-08-10T01:10:36.3499869Z ‚úÖ Connection status monitoring implementation found
2025-08-10T01:10:36.3500539Z üü¢ GREEN TEST: Testing integrated resilience workflow
2025-08-10T01:10:36.3501191Z ‚úÖ All resilience components properly integrated
2025-08-10T01:10:36.3501800Z üî¥ RED TEST: Testing offline campaign caching
2025-08-10T01:10:36.3502401Z ‚úÖ Offline campaign caching implementation found
2025-08-10T01:10:36.3503035Z üî¥ RED TEST: Testing user-friendly error messaging
2025-08-10T01:10:36.3503679Z ‚úÖ User-friendly error messaging implementation found
2025-08-10T01:10:36.3504081Z
2025-08-10T01:10:36.3504239Z ============================================================
2025-08-10T01:10:36.3505190Z üü¢ GREEN STATE ACHIEVED: All resilience features implemented correctly!
2025-08-10T01:10:36.3505847Z ‚úÖ 5 tests passed
2025-08-10T01:10:36.3506070Z
2025-08-10T01:10:36.3506443Z
2025-08-10T01:10:36.3506945Z ----------------------------------------------------------------------
2025-08-10T01:10:36.3507641Z Ran 5 tests in 0.002s
2025-08-10T01:10:36.3508048Z
2025-08-10T01:10:36.3508173Z OK
2025-08-10T01:10:36.3509469Z üéØ RESILIENCE FEATURES VALIDATED:
2025-08-10T01:10:36.3509954Z    ‚Ä¢ JWT clock skew auto-retry ‚úÖ
2025-08-10T01:10:36.3510425Z    ‚Ä¢ User-friendly error messages ‚úÖ
2025-08-10T01:10:36.3510878Z    ‚Ä¢ Offline campaign caching ‚úÖ
2025-08-10T01:10:36.3511282Z    ‚Ä¢ Connection status monitoring ‚úÖ
2025-08-10T01:10:36.3511756Z    ‚Ä¢ Integrated workflow ‚úÖ
2025-08-10T01:10:36.3512153Z ============================================================
2025-08-10T01:10:36.3561927Z ‚úÖ PASS: tests/auth/test_auth_resilience.py
2025-08-10T01:10:36.3566056Z ----------------------------------------
2025-08-10T01:10:36.3566673Z Running: tests/frontend_v2/test_campaign_creation_v2_memory_leaks.py
2025-08-10T01:10:36.4930034Z sss
2025-08-10T01:10:36.4930368Z
2025-08-10T01:10:36.4930931Z ----------------------------------------------------------------------
2025-08-10T01:10:36.4931858Z Ran 3 tests in 0.005s
2025-08-10T01:10:36.4932083Z
2025-08-10T01:10:36.4932220Z OK (skipped=3)
2025-08-10T01:10:36.4932974Z üß™ Testing completion flow shows success message...
2025-08-10T01:10:36.4935275Z
2025-08-10T01:10:36.4944436Z üß™ Testing component unmount clears all timers...
2025-08-10T01:10:36.4945157Z
2025-08-10T01:10:36.4945624Z üß™ Testing error handling clears timers...
2025-08-10T01:10:36.5122331Z ‚úÖ PASS: tests/frontend_v2/test_campaign_creation_v2_memory_leaks.py
2025-08-10T01:10:36.5123903Z ----------------------------------------
2025-08-10T01:10:36.5124559Z Running: tests/integration/test_real_browser_settings_game_integration.py
2025-08-10T01:10:36.6673579Z üåê Real Browser Settings Game Integration Test
2025-08-10T01:10:36.6683628Z üì° Server: http://localhost:8081
2025-08-10T01:10:36.6684138Z üë§ Test User: real-browser-test-user
2025-08-10T01:10:36.6684696Z üìù Log File: /tmp/worldarchitect.ai/integration-test.log
2025-08-10T01:10:36.6685149Z ============================================================
2025-08-10T01:10:36.6685801Z üöÄ CI Environment detected - running modified integration test
2025-08-10T01:10:36.6686475Z ‚ö†Ô∏è Skipping server-dependent integration test in CI environment
2025-08-10T01:10:36.6687093Z ‚úÖ Test structure and imports validated successfully
2025-08-10T01:10:36.6687895Z üí° Integration test would run successfully with server available
2025-08-10T01:10:36.6688317Z
2025-08-10T01:10:36.6688498Z ‚úÖ TEST SUITE PASSED
2025-08-10T01:10:36.6858793Z ‚úÖ PASS: tests/integration/test_real_browser_settings_game_integration.py
2025-08-10T01:10:36.6864023Z ----------------------------------------
2025-08-10T01:10:36.6864573Z Running: tests/test_age_field_validation.py
2025-08-10T01:10:36.8730583Z .........
2025-08-10T01:10:36.8732449Z ----------------------------------------------------------------------
2025-08-10T01:10:36.8734812Z Ran 9 tests in 0.001s
2025-08-10T01:10:36.8735025Z
2025-08-10T01:10:36.8735142Z OK
2025-08-10T01:10:36.8941462Z ‚úÖ PASS: tests/test_age_field_validation.py
2025-08-10T01:10:36.8942449Z ----------------------------------------
2025-08-10T01:10:36.8943449Z Running: tests/test_ai_content_simple.py
2025-08-10T01:10:36.9425208Z ...
2025-08-10T01:10:36.9427332Z ----------------------------------------------------------------------
2025-08-10T01:10:36.9429718Z Ran 3 tests in 0.000s
2025-08-10T01:10:36.9429967Z
2025-08-10T01:10:36.9430086Z OK
2025-08-10T01:10:36.9494470Z ‚úÖ PASS: tests/test_ai_content_simple.py
2025-08-10T01:10:36.9495775Z ----------------------------------------
2025-08-10T01:10:36.9496232Z Running: tests/test_always_json_mode.py
2025-08-10T01:10:38.0951888Z .2025-08-10 01:10:38,094 - INFO - Cache MISS for master_directive.md: loaded and cached 8299 characters (~2074 tokens)
2025-08-10T01:10:38.0955508Z 2025-08-10 01:10:38,095 - INFO - Cache MISS for game_state_instruction.md: loaded and cached 56680 characters (~14170 tokens)
2025-08-10T01:10:38.0961092Z 2025-08-10 01:10:38,095 - INFO - Cache MISS for character_template.md: loaded and cached 6696 characters (~1674 tokens)
2025-08-10T01:10:38.0963692Z 2025-08-10 01:10:38,095 - INFO - Cache MISS for narrative_system_instruction.md: loaded and cached 40868 characters (~10217 tokens)
2025-08-10T01:10:38.0964870Z 2025-08-10 01:10:38,096 - INFO - Cache MISS for dnd_srd_instruction.md: loaded and cached 1216 characters (~304 tokens)
2025-08-10T01:10:38.0967874Z 2025-08-10 01:10:38,096 - INFO - Prompt scaffold is 125 chars (~31 tokens). Remaining budget for story: 2999875 chars (~749968 tokens)
2025-08-10T01:10:38.0968989Z 2025-08-10 01:10:38,096 - INFO - Initial context stats: Turns: 0, Tokens: 0
2025-08-10T01:10:38.0983926Z 2025-08-10 01:10:38,098 - INFO - Context is within token budget. No truncation needed.
2025-08-10T01:10:38.0991536Z 2025-08-10 01:10:38,099 - INFO - Generated entity manifest for session 1, turn 1
2025-08-10T01:10:38.0995219Z 2025-08-10 01:10:38,099 - INFO - Successfully used GeminiRequest for structured JSON communication
2025-08-10T01:10:38.1007173Z 2025-08-10 01:10:38,100 - INFO - Comprehensive validation: 2/2 found, confidence: 1.00, warnings: 0
2025-08-10T01:10:38.1018431Z 2025-08-10 01:10:38,100 - INFO - NarrativeSyncValidator delegated to EntityValidator: 2/2 found
2025-08-10T01:10:38.1019426Z 2025-08-10 01:10:38,100 - INFO - Comprehensive validation: 2/2 found, confidence: 1.00, warnings: 0
2025-08-10T01:10:38.1020388Z 2025-08-10 01:10:38,100 - INFO - NarrativeSyncValidator delegated to EntityValidator: 2/2 found
2025-08-10T01:10:38.1021839Z 2025-08-10 01:10:38,100 - WARNING - ‚ö†Ô∏è ‚ö†Ô∏è PLANNING_BLOCK_MISSING: Story mode response missing required planning block
2025-08-10T01:10:38.1023394Z 2025-08-10 01:10:38,100 - INFO - üîç PLANNING_BLOCK_REGENERATION: Sending prompt to API
2025-08-10T01:10:38.1024245Z 2025-08-10 01:10:38,100 - INFO - üîç PLANNING_BLOCK_PROMPT:
2025-08-10T01:10:38.1033342Z CRITICAL: Generate planning options ONLY for Test Hero in current location.
2025-08-10T01:10:38.1034254Z DO NOT reference other characters, campaigns, or unrelated narrative elements.
2025-08-10T01:10:38.1034805Z
2025-08-10T01:10:38.1035025Z Generate ONLY a planning block using the st...
2025-08-10T01:10:38.1035633Z 2025-08-10 01:10:38,100 - INFO - Initializing Gemini Client
2025-08-10T01:10:38.1037012Z 2025-08-10 01:10:38,101 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Failed to generate planning block: CRITICAL: GEMINI_API_KEY environment variable not found!
2025-08-10T01:10:38.1038590Z 2025-08-10 01:10:38,101 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Exception type: <class 'ValueError'>
2025-08-10T01:10:38.1040021Z 2025-08-10 01:10:38,101 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Exception details: ValueError('CRITICAL: GEMINI_API_KEY environment variable not found!')
2025-08-10T01:10:38.1041590Z 2025-08-10 01:10:38,102 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Traceback: Traceback (most recent call last):
2025-08-10T01:10:38.1055072Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 1908, in _validate_and_enforce_planning_block
2025-08-10T01:10:38.1056224Z     planning_response = _call_gemini_api(
2025-08-10T01:10:38.1056680Z                         ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:38.1057644Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 1251, in _call_gemini_api
2025-08-10T01:10:38.1062226Z     return _call_gemini_api_with_model_cycling(
2025-08-10T01:10:38.1062759Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:38.1063951Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 919, in _call_gemini_api_with_model_cycling
2025-08-10T01:10:38.1068063Z     client = get_client()
2025-08-10T01:10:38.1068470Z              ^^^^^^^^^^^^
2025-08-10T01:10:38.1069408Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 240, in get_client
2025-08-10T01:10:38.1070662Z     raise ValueError("CRITICAL: GEMINI_API_KEY environment variable not found!")
2025-08-10T01:10:38.1071521Z ValueError: CRITICAL: GEMINI_API_KEY environment variable not found!
2025-08-10T01:10:38.1077379Z
2025-08-10T01:10:38.1078437Z 2025-08-10 01:10:38,102 - INFO - üîç FALLBACK_USED: Updated structured_response.planning_block with fallback JSON content due to exception
2025-08-10T01:10:38.1079745Z .2025-08-10 01:10:38,103 - INFO - Cache MISS for mechanics_system_instruction.md: loaded and cached 51025 characters (~12756 tokens)
2025-08-10T01:10:38.1080884Z 2025-08-10 01:10:38,104 - INFO - Prompt scaffold is 125 chars (~31 tokens). Remaining budget for story: 2999875 chars (~749968 tokens)
2025-08-10T01:10:38.1081746Z 2025-08-10 01:10:38,104 - INFO - Initial context stats: Turns: 0, Tokens: 0
2025-08-10T01:10:38.1082449Z 2025-08-10 01:10:38,105 - INFO - Context is within token budget. No truncation needed.
2025-08-10T01:10:38.1083279Z 2025-08-10 01:10:38,106 - INFO - Successfully used GeminiRequest for structured JSON communication
2025-08-10T01:10:38.1084135Z 2025-08-10 01:10:38,107 - INFO - Comprehensive validation: 0/0 found, confidence: 1.00, warnings: 0
2025-08-10T01:10:38.1085234Z 2025-08-10 01:10:38,107 - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/1 found
2025-08-10T01:10:38.1086059Z 2025-08-10 01:10:38,107 - INFO - Comprehensive validation: 0/0 found, confidence: 1.00, warnings: 0
2025-08-10T01:10:38.1086875Z 2025-08-10 01:10:38,107 - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/1 found
2025-08-10T01:10:38.1087647Z 2025-08-10 01:10:38,107 - INFO - Planning block found in JSON structured response
2025-08-10T01:10:38.1088308Z ...
2025-08-10T01:10:38.1088647Z ----------------------------------------------------------------------
2025-08-10T01:10:38.1089270Z Ran 5 tests in 0.014s
2025-08-10T01:10:38.1089467Z
2025-08-10T01:10:38.1090085Z OK
2025-08-10T01:10:38.2599288Z ‚úÖ PASS: tests/test_always_json_mode.py
2025-08-10T01:10:38.2600784Z ----------------------------------------
2025-08-10T01:10:38.2601259Z Running: tests/test_animation_system.py
2025-08-10T01:10:38.2977600Z test_accessibility_features (__main__.TestAnimationSystem.test_accessibility_features)
2025-08-10T01:10:38.2982163Z Test that accessibility features are properly implemented ... ok
2025-08-10T01:10:38.2984509Z test_animation_css_exists_and_valid (__main__.TestAnimationSystem.test_animation_css_exists_and_valid)
2025-08-10T01:10:38.2989191Z Test that animation CSS file exists and contains expected animations ... ok
2025-08-10T01:10:38.2991870Z test_animation_css_syntax_validation (__main__.TestAnimationSystem.test_animation_css_syntax_validation)
2025-08-10T01:10:38.2992791Z Test CSS syntax is valid (basic validation) ... ok
2025-08-10T01:10:38.2993695Z test_animation_js_exists_and_valid (__main__.TestAnimationSystem.test_animation_js_exists_and_valid)
2025-08-10T01:10:38.2994629Z Test that animation JavaScript file exists and is valid ... ok
2025-08-10T01:10:38.2995656Z test_animation_performance_properties (__main__.TestAnimationSystem.test_animation_performance_properties)
2025-08-10T01:10:38.2996727Z Test that performance-enhancing CSS properties are present ... ok
2025-08-10T01:10:38.2997962Z test_index_html_includes_animation_files (__main__.TestAnimationSystem.test_index_html_includes_animation_files)
2025-08-10T01:10:38.2999557Z Test that index.html includes animation CSS and JS ... ok
2025-08-10T01:10:38.3000777Z test_javascript_error_handling (__main__.TestAnimationSystem.test_javascript_error_handling)
2025-08-10T01:10:38.3001987Z Test that JavaScript has proper error handling patterns ... ok
2025-08-10T01:10:38.3003221Z test_theme_specific_animations (__main__.TestAnimationSystem.test_theme_specific_animations)
2025-08-10T01:10:38.3004318Z Test that theme-specific animations are included ... ok
2025-08-10T01:10:38.3005430Z test_animation_system_compatibility (__main__.TestAnimationIntegration.test_animation_system_compatibility)
2025-08-10T01:10:38.3008208Z Test that animation system doesn't conflict with existing app.js ... ok
2025-08-10T01:10:38.3009118Z test_loading_order_in_html (__main__.TestAnimationIntegration.test_loading_order_in_html)
2025-08-10T01:10:38.3016025Z Test that scripts are loaded in correct order ... ok
2025-08-10T01:10:38.3019690Z test_css_file_size (__main__.TestAnimationPerformance.test_css_file_size)
2025-08-10T01:10:38.3020359Z Test that CSS file size is reasonable ... ok
2025-08-10T01:10:38.3021114Z test_css_selector_efficiency (__main__.TestAnimationPerformance.test_css_selector_efficiency)
2025-08-10T01:10:38.3021891Z Test that CSS selectors are efficient ... ok
2025-08-10T01:10:38.3022620Z test_javascript_file_size (__main__.TestAnimationPerformance.test_javascript_file_size)
2025-08-10T01:10:38.3023405Z Test that JavaScript file size is reasonable ... ok
2025-08-10T01:10:38.3024292Z test_animation_duration_variables (__main__.TestAnimationFunctionality.test_animation_duration_variables)
2025-08-10T01:10:38.3025284Z Test that animation duration variables are properly defined ... ok
2025-08-10T01:10:38.3026187Z test_javascript_api_methods (__main__.TestAnimationFunctionality.test_javascript_api_methods)
2025-08-10T01:10:38.3027305Z Test that JavaScript API provides expected methods ... ok
2025-08-10T01:10:38.3030430Z test_keyframe_animations_defined (__main__.TestAnimationFunctionality.test_keyframe_animations_defined)
2025-08-10T01:10:38.3031217Z Test that essential keyframe animations are defined ... ok
2025-08-10T01:10:38.3031621Z
2025-08-10T01:10:38.3031853Z ----------------------------------------------------------------------
2025-08-10T01:10:38.3032334Z Ran 16 tests in 0.004s
2025-08-10T01:10:38.3032540Z
2025-08-10T01:10:38.3032658Z OK
2025-08-10T01:10:38.3033180Z üß™ Running Animation System Tests...
2025-08-10T01:10:38.3033916Z ‚úÖ All animation tests passed!
2025-08-10T01:10:38.3083554Z ‚úÖ PASS: tests/test_animation_system.py
2025-08-10T01:10:38.3084932Z ----------------------------------------
2025-08-10T01:10:38.3085446Z Running: tests/test_api_backward_compatibility.py
2025-08-10T01:10:38.6507433Z 2025-08-10 01:10:38,650 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:38.6710084Z ssss
2025-08-10T01:10:38.6711244Z ----------------------------------------------------------------------
2025-08-10T01:10:38.6712501Z Ran 4 tests in 0.000s
2025-08-10T01:10:38.6712730Z
2025-08-10T01:10:38.6712845Z OK (skipped=4)
2025-08-10T01:10:38.7239908Z ‚úÖ PASS: tests/test_api_backward_compatibility.py
2025-08-10T01:10:38.7241357Z ----------------------------------------
2025-08-10T01:10:38.7241879Z Running: tests/test_api_response_format_consistency.py
2025-08-10T01:10:39.0498854Z 2025-08-10 01:10:39,049 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:39.0611684Z sssssssss
2025-08-10T01:10:39.0612898Z ----------------------------------------------------------------------
2025-08-10T01:10:39.0614236Z Ran 9 tests in 0.000s
2025-08-10T01:10:39.0614442Z
2025-08-10T01:10:39.0614568Z OK (skipped=9)
2025-08-10T01:10:39.1131912Z ‚úÖ PASS: tests/test_api_response_format_consistency.py
2025-08-10T01:10:39.1133523Z ----------------------------------------
2025-08-10T01:10:39.1133971Z Running: tests/test_api_routes.py
2025-08-10T01:10:39.4412433Z 2025-08-10 01:10:39,441 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:39.4505964Z 2025-08-10 01:10:39,450 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:39.4659401Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:39.4661877Z   setup_file_logging()
2025-08-10T01:10:39.4662576Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:39.7403353Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:10:39.7407100Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:10:39.7613162Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:10:39.7616556Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:10:40.4502970Z 2025-08-10 01:10:40,449 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:10:40.4504117Z Args: ('mcp-api-test-user', 'mcp-test-campaign')
2025-08-10T01:10:40.4506665Z Kwargs: {}
2025-08-10T01:10:40.4508713Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4516107Z Traceback:
2025-08-10T01:10:40.4516461Z Traceback (most recent call last):
2025-08-10T01:10:40.4517541Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:40.4518597Z     asyncio.get_running_loop()
2025-08-10T01:10:40.4519040Z RuntimeError: no running event loop
2025-08-10T01:10:40.4519353Z
2025-08-10T01:10:40.4519664Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:40.4520373Z
2025-08-10T01:10:40.4520534Z Traceback (most recent call last):
2025-08-10T01:10:40.4521473Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:40.4522298Z     return func(*args, **kwargs)
2025-08-10T01:10:40.4522667Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4523636Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:10:40.4524542Z     db = get_db()
2025-08-10T01:10:40.4524795Z          ^^^^^^^^
2025-08-10T01:10:40.4525518Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:40.4526391Z     return firestore.client()
2025-08-10T01:10:40.4526824Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4528128Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:40.4529478Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:40.4530179Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4531357Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:40.4532629Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:40.4533262Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4534434Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:40.4535583Z     self._services[name] = initializer(self)
2025-08-10T01:10:40.4536038Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4537143Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:40.4538573Z     credentials = app.credential.get_credential()
2025-08-10T01:10:40.4539086Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4540296Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:40.4541469Z     self._load_credential()
2025-08-10T01:10:40.4542608Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:40.4543963Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:40.4544606Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4545755Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:40.4547128Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:40.4549129Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4551042Z --- END EXCEPTION ---
2025-08-10T01:10:40.4553007Z 2025-08-10 01:10:40,450 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4556304Z .2025-08-10 01:10:40,454 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:40.4564781Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:40.4566551Z   setup_file_logging()
2025-08-10T01:10:40.4567142Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:40.4621216Z 2025-08-10 01:10:40,461 - root - INFO - üéÆ LOADING GAME PAGE: user=mcp-api-test-user, campaign=mcp-debug-campaign
2025-08-10T01:10:40.4650035Z 2025-08-10 01:10:40,464 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_by_id ---
2025-08-10T01:10:40.4650863Z Args: ('mcp-api-test-user', 'mcp-debug-campaign')
2025-08-10T01:10:40.4651366Z Kwargs: {}
2025-08-10T01:10:40.4652535Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4653786Z Traceback:
2025-08-10T01:10:40.4654147Z Traceback (most recent call last):
2025-08-10T01:10:40.4655048Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:40.4655891Z     asyncio.get_running_loop()
2025-08-10T01:10:40.4656317Z RuntimeError: no running event loop
2025-08-10T01:10:40.4656603Z
2025-08-10T01:10:40.4656895Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:40.4657340Z
2025-08-10T01:10:40.4657486Z Traceback (most recent call last):
2025-08-10T01:10:40.4658459Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:40.4659318Z     return func(*args, **kwargs)
2025-08-10T01:10:40.4659717Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4660778Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 470, in get_campaign_by_id
2025-08-10T01:10:40.4661718Z     db = get_db()
2025-08-10T01:10:40.4662039Z          ^^^^^^^^
2025-08-10T01:10:40.4662857Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:40.4663749Z     return firestore.client()
2025-08-10T01:10:40.4664137Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4665142Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:40.4666458Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:40.4667186Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4668683Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:40.4670029Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:40.4670690Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4671897Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:40.4673030Z     self._services[name] = initializer(self)
2025-08-10T01:10:40.4673544Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4674718Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:40.4676141Z     credentials = app.credential.get_credential()
2025-08-10T01:10:40.4676740Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4678165Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:40.4679434Z     self._load_credential()
2025-08-10T01:10:40.4680700Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:40.4682144Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:40.4683107Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4684310Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:40.4685743Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:40.4687639Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4689589Z --- END EXCEPTION ---
2025-08-10T01:10:40.4691491Z 2025-08-10 01:10:40,464 - root - ERROR - üî•üî¥ Failed to get campaign state: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4695914Z .2025-08-10 01:10:40,467 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:40.4701687Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:40.4703212Z   setup_file_logging()
2025-08-10T01:10:40.4703800Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:40.4777170Z 2025-08-10 01:10:40,477 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:10:40.4781778Z Args: ('mcp-api-test-user',)
2025-08-10T01:10:40.4782222Z Kwargs: {}
2025-08-10T01:10:40.4785627Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4786873Z Traceback:
2025-08-10T01:10:40.4787177Z Traceback (most recent call last):
2025-08-10T01:10:40.4788311Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:40.4789243Z     asyncio.get_running_loop()
2025-08-10T01:10:40.4789676Z RuntimeError: no running event loop
2025-08-10T01:10:40.4789973Z
2025-08-10T01:10:40.4790280Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:40.4790737Z
2025-08-10T01:10:40.4790898Z Traceback (most recent call last):
2025-08-10T01:10:40.4791790Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:40.4792659Z     return func(*args, **kwargs)
2025-08-10T01:10:40.4793059Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4794068Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:10:40.4795034Z     db = get_db()
2025-08-10T01:10:40.4795351Z          ^^^^^^^^
2025-08-10T01:10:40.4796174Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:40.4797076Z     return firestore.client()
2025-08-10T01:10:40.4797462Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4798765Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:40.4800391Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:40.4801121Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4802326Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:40.4803754Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:40.4804452Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4805897Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:40.4807034Z     self._services[name] = initializer(self)
2025-08-10T01:10:40.4807498Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4808974Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:40.4810217Z     credentials = app.credential.get_credential()
2025-08-10T01:10:40.4810740Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4812053Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:40.4813299Z     self._load_credential()
2025-08-10T01:10:40.4814564Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:40.4815989Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:40.4816732Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4818237Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:40.4819615Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:40.4821410Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4823071Z --- END EXCEPTION ---
2025-08-10T01:10:40.4824934Z 2025-08-10 01:10:40,477 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4826907Z .2025-08-10 01:10:40,480 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:40.4828917Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:40.4830383Z   setup_file_logging()
2025-08-10T01:10:40.4831004Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:40.4904709Z 2025-08-10 01:10:40,490 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:10:40.4911881Z Args: ('mcp-api-test-user',)
2025-08-10T01:10:40.4912304Z Kwargs: {}
2025-08-10T01:10:40.4913331Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4916399Z Traceback:
2025-08-10T01:10:40.4916791Z Traceback (most recent call last):
2025-08-10T01:10:40.4917671Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:40.4918649Z     asyncio.get_running_loop()
2025-08-10T01:10:40.4919283Z RuntimeError: no running event loop
2025-08-10T01:10:40.4919578Z
2025-08-10T01:10:40.4919879Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:40.4920351Z
2025-08-10T01:10:40.4920519Z Traceback (most recent call last):
2025-08-10T01:10:40.4921428Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:40.4922287Z     return func(*args, **kwargs)
2025-08-10T01:10:40.4922681Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4923640Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:10:40.4924820Z     db = get_db()
2025-08-10T01:10:40.4925139Z          ^^^^^^^^
2025-08-10T01:10:40.4925968Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:40.4926873Z     return firestore.client()
2025-08-10T01:10:40.4927267Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4928778Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:40.4930177Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:40.4930919Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4932149Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:40.4936331Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:40.4937054Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4938546Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:40.4939806Z     self._services[name] = initializer(self)
2025-08-10T01:10:40.4940322Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4941556Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:40.4942777Z     credentials = app.credential.get_credential()
2025-08-10T01:10:40.4943309Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4944610Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:40.4945881Z     self._load_credential()
2025-08-10T01:10:40.4947149Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:40.4952530Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:40.4953280Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.4954549Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:40.4955985Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:40.4958138Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4959788Z --- END EXCEPTION ---
2025-08-10T01:10:40.4961713Z 2025-08-10 01:10:40,490 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.4963688Z .2025-08-10 01:10:40,493 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:40.4965702Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:40.4967191Z   setup_file_logging()
2025-08-10T01:10:40.4968103Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:40.5028175Z .2025-08-10 01:10:40,502 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:40.5034166Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:40.5035921Z   setup_file_logging()
2025-08-10T01:10:40.5036567Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:40.5126963Z 2025-08-10 01:10:40,512 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:10:40.5128608Z Args: ('mcp-api-test-user',)
2025-08-10T01:10:40.5130656Z Kwargs: {}
2025-08-10T01:10:40.5132363Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.5136029Z Traceback:
2025-08-10T01:10:40.5136402Z Traceback (most recent call last):
2025-08-10T01:10:40.5137389Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:40.5138426Z     asyncio.get_running_loop()
2025-08-10T01:10:40.5138877Z RuntimeError: no running event loop
2025-08-10T01:10:40.5139185Z
2025-08-10T01:10:40.5139487Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:40.5139947Z
2025-08-10T01:10:40.5140109Z Traceback (most recent call last):
2025-08-10T01:10:40.5140993Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:40.5141840Z     return func(*args, **kwargs)
2025-08-10T01:10:40.5142228Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5143225Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:10:40.5144213Z     db = get_db()
2025-08-10T01:10:40.5144523Z          ^^^^^^^^
2025-08-10T01:10:40.5145353Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:40.5146244Z     return firestore.client()
2025-08-10T01:10:40.5146651Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5148041Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:40.5149416Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:40.5150113Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5151344Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:40.5152660Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:40.5153364Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5154592Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:40.5158059Z     self._services[name] = initializer(self)
2025-08-10T01:10:40.5158584Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5159823Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:40.5161084Z     credentials = app.credential.get_credential()
2025-08-10T01:10:40.5161872Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5163193Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:40.5164381Z     self._load_credential()
2025-08-10T01:10:40.5165627Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:40.5167105Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:40.5168298Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5169549Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:40.5170956Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:40.5172841Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.5174485Z --- END EXCEPTION ---
2025-08-10T01:10:40.5176348Z 2025-08-10 01:10:40,512 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.5178481Z .2025-08-10 01:10:40,515 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:40.5180285Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:40.5181770Z   setup_file_logging()
2025-08-10T01:10:40.5182397Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:40.5256255Z 2025-08-10 01:10:40,525 - root - ERROR - üî•üî¥ Failed to get user settings for user_713441: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.5275754Z .2025-08-10 01:10:40,527 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:40.5282127Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:40.5283640Z   setup_file_logging()
2025-08-10T01:10:40.5284267Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:40.5342679Z 2025-08-10 01:10:40,534 - root - INFO - üéÆ LOADING GAME PAGE: user=mcp-api-test-user, campaign=mcp-test-campaign
2025-08-10T01:10:40.5369120Z 2025-08-10 01:10:40,536 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_by_id ---
2025-08-10T01:10:40.5369985Z Args: ('mcp-api-test-user', 'mcp-test-campaign')
2025-08-10T01:10:40.5370506Z Kwargs: {}
2025-08-10T01:10:40.5371690Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.5372965Z Traceback:
2025-08-10T01:10:40.5373326Z Traceback (most recent call last):
2025-08-10T01:10:40.5374729Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:40.5375656Z     asyncio.get_running_loop()
2025-08-10T01:10:40.5376089Z RuntimeError: no running event loop
2025-08-10T01:10:40.5376387Z
2025-08-10T01:10:40.5376684Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:40.5377121Z
2025-08-10T01:10:40.5377268Z Traceback (most recent call last):
2025-08-10T01:10:40.5378576Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:40.5379546Z     return func(*args, **kwargs)
2025-08-10T01:10:40.5379945Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5380919Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 470, in get_campaign_by_id
2025-08-10T01:10:40.5381867Z     db = get_db()
2025-08-10T01:10:40.5382176Z          ^^^^^^^^
2025-08-10T01:10:40.5382974Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:40.5384064Z     return firestore.client()
2025-08-10T01:10:40.5384445Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5385536Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:40.5386895Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:40.5387631Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5389131Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:40.5390471Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:40.5391118Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5392298Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:40.5393540Z     self._services[name] = initializer(self)
2025-08-10T01:10:40.5394025Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5395658Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:40.5396963Z     credentials = app.credential.get_credential()
2025-08-10T01:10:40.5397504Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5398968Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:40.5400214Z     self._load_credential()
2025-08-10T01:10:40.5401450Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:40.5402896Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:40.5408731Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5410032Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:40.5411488Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:40.5413374Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.5415065Z --- END EXCEPTION ---
2025-08-10T01:10:40.5416983Z 2025-08-10 01:10:40,536 - root - ERROR - üî•üî¥ Failed to get campaign state: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.5419149Z .2025-08-10 01:10:40,539 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:40.5420979Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:40.5422718Z   setup_file_logging()
2025-08-10T01:10:40.5423328Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:40.5496800Z 2025-08-10 01:10:40,548 - root - ERROR - üî•üî¥ Failed to update user settings for mcp-api-test-user: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.5498545Z Traceback (most recent call last):
2025-08-10T01:10:40.5499410Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:40.5500128Z     asyncio.get_running_loop()
2025-08-10T01:10:40.5500382Z RuntimeError: no running event loop
2025-08-10T01:10:40.5500560Z
2025-08-10T01:10:40.5500732Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:40.5500995Z
2025-08-10T01:10:40.5501085Z Traceback (most recent call last):
2025-08-10T01:10:40.5501689Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 1082, in update_user_settings
2025-08-10T01:10:40.5502250Z     db = get_db()
2025-08-10T01:10:40.5502430Z          ^^^^^^^^
2025-08-10T01:10:40.5502899Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:40.5503400Z     return firestore.client()
2025-08-10T01:10:40.5503624Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5504223Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:40.5505150Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:40.5505566Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5506244Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:40.5506995Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:40.5507366Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5508151Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:40.5508796Z     self._services[name] = initializer(self)
2025-08-10T01:10:40.5509058Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5509673Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:40.5510708Z     credentials = app.credential.get_credential()
2025-08-10T01:10:40.5511251Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5512622Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:40.5513987Z     self._load_credential()
2025-08-10T01:10:40.5515272Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:40.5516750Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:40.5517468Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:40.5519153Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:40.5520578Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:40.5522307Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.5524225Z 2025-08-10 01:10:40,549 - root - INFO - Updated user settings for mcp-api-test-user: {'debug_mode': True}
2025-08-10T01:10:40.5527551Z 2025-08-10 01:10:40,551 - root - ERROR - üî•üî¥ Failed to get user settings for user_713441: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:40.5529924Z .
2025-08-10T01:10:40.5530281Z ----------------------------------------------------------------------
2025-08-10T01:10:40.5530743Z Ran 9 tests in 1.103s
2025-08-10T01:10:40.5531161Z
2025-08-10T01:10:40.5531284Z OK
2025-08-10T01:10:40.7667276Z ‚úÖ PASS: tests/test_api_routes.py
2025-08-10T01:10:40.7668980Z ----------------------------------------
2025-08-10T01:10:40.7669575Z Running: tests/test_architectural_boundary_validation.py
2025-08-10T01:10:41.0949367Z 2025-08-10 01:10:41,094 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:41.9951855Z test_cross_boundary_field_consistency (__main__.TestArchitecturalBoundaryValidation.test_cross_boundary_field_consistency)
2025-08-10T01:10:41.9954823Z RED-GREEN: Validate that error/success fields are consistent across ALL boundaries. ... ok
2025-08-10T01:10:41.9956842Z test_frontend_to_main_field_constants (__main__.TestArchitecturalBoundaryValidation.test_frontend_to_main_field_constants)
2025-08-10T01:10:41.9958539Z RED-GREEN: Validate frontend ‚Üí main.py field translation constants. ... ok
2025-08-10T01:10:41.9959627Z test_green_phase_complete_flow_validation (__main__.TestArchitecturalBoundaryValidation.test_green_phase_complete_flow_validation)
2025-08-10T01:10:41.9960678Z GREEN PHASE: End-to-end field format validation. ... ok
2025-08-10T01:10:41.9961538Z test_main_to_mcp_field_constants (__main__.TestArchitecturalBoundaryValidation.test_main_to_mcp_field_constants)
2025-08-10T01:10:41.9962604Z RED-GREEN: Validate main.py ‚Üí MCP protocol field translation constants. ... ok
2025-08-10T01:10:41.9963531Z test_mcp_api_field_constants (__main__.TestArchitecturalBoundaryValidation.test_mcp_api_field_constants)
2025-08-10T01:10:41.9964351Z RED-GREEN: Validate MCP API layer field consistency. ... ok
2025-08-10T01:10:41.9965301Z test_red_phase_field_mismatch_detection (__main__.TestArchitecturalBoundaryValidation.test_red_phase_field_mismatch_detection)
2025-08-10T01:10:41.9966301Z RED PHASE: Test what happens with WRONG field access patterns. ... ok
2025-08-10T01:10:41.9967242Z test_story_field_format_validation (__main__.TestArchitecturalBoundaryValidation.test_story_field_format_validation)
2025-08-10T01:10:41.9968437Z RED-GREEN: Validate story entry field format for UI compatibility. ... ok
2025-08-10T01:10:41.9969491Z test_translation_layer_field_conversion (__main__.TestArchitecturalBoundaryValidation.test_translation_layer_field_conversion)
2025-08-10T01:10:41.9970776Z RED-GREEN: Validate the intentional field translation between layers. ... ok
2025-08-10T01:10:41.9971576Z üèóÔ∏è Architectural Boundary Field Format Validation
2025-08-10T01:10:41.9972419Z
2025-08-10T01:10:41.9972692Z Testing field format consistency across all system boundaries
2025-08-10T01:10:41.9974373Z ----------------------------------------------------------------------
2025-08-10T01:10:41.9974854Z ================================================================================
2025-08-10T01:10:41.9975480Z Ran 8 tests in 0.001s
2025-08-10T01:10:41.9975691Z
2025-08-10T01:10:41.9975852Z
2025-08-10T01:10:41.9976116Z üîç Testing Cross-Boundary Field Consistency
2025-08-10T01:10:41.9976659Z OK
2025-08-10T01:10:42.0046671Z ‚úÖ Cross-boundary field consistency: VALIDATED
2025-08-10T01:10:42.0097443Z
2025-08-10T01:10:42.0098724Z üîç Testing Frontend ‚Üí main.py Field Constants
2025-08-10T01:10:42.0099601Z ‚úÖ Frontend ‚Üí main.py field constants: VALIDATED
2025-08-10T01:10:42.0100164Z
2025-08-10T01:10:42.0100592Z üü¢ GREEN PHASE: Complete Flow Validation
2025-08-10T01:10:42.0101296Z üü¢ GREEN TESTS CONFIRM: Complete flow works correctly
2025-08-10T01:10:42.0103314Z    Frontend 'input' ‚Üí MCP 'user_input' ‚Üí Story 'text' ‚úÖ
2025-08-10T01:10:42.0103823Z
2025-08-10T01:10:42.0104228Z üîç Testing main.py ‚Üí MCP Protocol Field Constants
2025-08-10T01:10:42.0104953Z ‚úÖ main.py ‚Üí MCP field constants: VALIDATED
2025-08-10T01:10:42.0105398Z
2025-08-10T01:10:42.0105753Z üîç Testing MCP API Layer Field Constants
2025-08-10T01:10:42.0106414Z ‚úÖ MCP API field constants: VALIDATED
2025-08-10T01:10:42.0106839Z
2025-08-10T01:10:42.0107197Z üî¥ RED PHASE: Field Mismatch Detection
2025-08-10T01:10:42.0108157Z üî¥ RED TESTS CONFIRM: Wrong field names cause None extraction
2025-08-10T01:10:42.0108946Z
2025-08-10T01:10:42.0109360Z üîç Testing Story Field Format Validation
2025-08-10T01:10:42.0110036Z ‚úÖ Story field format: VALIDATED
2025-08-10T01:10:42.0110687Z    Story entries must use 'text' field (not 'story') ‚úÖ
2025-08-10T01:10:42.0111202Z
2025-08-10T01:10:42.0111605Z üîç Testing Translation Layer Field Conversion
2025-08-10T01:10:42.0112277Z ‚úÖ Translation layer conversion: VALIDATED
2025-08-10T01:10:42.0113548Z    Frontend field: 'input' ‚Üí MCP field: 'user_input' ‚úÖ
2025-08-10T01:10:42.1930057Z ‚úÖ PASS: tests/test_architectural_boundary_validation.py
2025-08-10T01:10:42.1933546Z ----------------------------------------
2025-08-10T01:10:42.1934016Z Running: tests/test_architectural_decisions.py
2025-08-10T01:10:42.4171834Z ....sssssss.../home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:10:42.4176669Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:10:42.4404321Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:10:42.4407054Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:10:42.4464541Z ....WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp'. Using default: 1
2025-08-10T01:10:42.4467045Z ..
2025-08-10T01:10:42.4467451Z ----------------------------------------------------------------------
2025-08-10T01:10:42.4468137Z Ran 20 tests in 0.132s
2025-08-10T01:10:42.4468371Z
2025-08-10T01:10:42.4468486Z OK (skipped=7)
2025-08-10T01:10:42.4770879Z ‚úÖ PASS: tests/test_architectural_decisions.py
2025-08-10T01:10:42.4772376Z ----------------------------------------
2025-08-10T01:10:42.4772900Z Running: tests/test_auth_mock_separation_redgreen.py
2025-08-10T01:10:42.8407386Z ..
2025-08-10T01:10:42.8409424Z ----------------------------------------------------------------------
2025-08-10T01:10:42.8411729Z Ran 2 tests in 0.104s
2025-08-10T01:10:42.8411948Z
2025-08-10T01:10:42.8412053Z OK
2025-08-10T01:10:42.8788078Z ‚úÖ PASS: tests/test_auth_mock_separation_redgreen.py
2025-08-10T01:10:42.8788828Z ----------------------------------------
2025-08-10T01:10:42.8790634Z Running: tests/test_backstory_cutoff_red_green.py
2025-08-10T01:10:42.9274435Z test_backstory_completion_GREEN_phase (__main__.TestBackstoryCutoffBug.test_backstory_completion_GREEN_phase)
2025-08-10T01:10:42.9283270Z GREEN PHASE: Test with a complete, untruncated response. ... ok
2025-08-10T01:10:42.9284789Z test_backstory_extraction_RED_phase (__main__.TestBackstoryCutoffBug.test_backstory_extraction_RED_phase)
2025-08-10T01:10:42.9291296Z RED PHASE: Demonstrate that the current narrative extraction ... ok
2025-08-10T01:10:42.9292540Z test_backstory_length_analysis (__main__.TestBackstoryCutoffBug.test_backstory_length_analysis)
2025-08-10T01:10:42.9300227Z Analyze where exactly the backstory gets cut off. ... ok
2025-08-10T01:10:42.9301970Z test_character_creation_response_parsing (__main__.TestBackstoryCutoffBug.test_character_creation_response_parsing)
2025-08-10T01:10:42.9303328Z Test that we can properly parse the character creation response. ... ok
2025-08-10T01:10:42.9304453Z test_identify_root_cause (__main__.TestBackstoryCutoffBug.test_identify_root_cause)
2025-08-10T01:10:42.9312343Z Identify where the truncation might be happening. ... ok
2025-08-10T01:10:42.9312740Z
2025-08-10T01:10:42.9312948Z ----------------------------------------------------------------------
2025-08-10T01:10:42.9313452Z Ran 5 tests in 0.004s
2025-08-10T01:10:42.9313915Z
2025-08-10T01:10:42.9314044Z OK
2025-08-10T01:10:42.9314193Z
2025-08-10T01:10:42.9314617Z üü¢ GREEN PHASE: Complete backstory test
2025-08-10T01:10:42.9315076Z Found 4/4 expected phrases
2025-08-10T01:10:42.9315467Z Complete narrative length: 2231
2025-08-10T01:10:42.9315727Z
2025-08-10T01:10:42.9315999Z üî¥ RED PHASE: Confirmed backstory truncation
2025-08-10T01:10:42.9316494Z Narrative length: 1657 characters
2025-08-10T01:10:42.9317357Z Backstory ends with: ...ess, earning him the title of prodigy. His formative years were steeped in the Empress's doctrine of
2025-08-10T01:10:42.9318289Z
2025-08-10T01:10:42.9318509Z üìä BACKSTORY ANALYSIS:
2025-08-10T01:10:42.9318883Z Full narrative length: 1657
2025-08-10T01:10:42.9319282Z Backstory section length: 286
2025-08-10T01:10:42.9319862Z Backstory ends with: 've years were steeped in the Empress's doctrine of'
2025-08-10T01:10:42.9320495Z Truncation detected: True
2025-08-10T01:10:42.9320738Z
2025-08-10T01:10:42.9321015Z ‚úÖ JSON PARSING: Successfully parsed response
2025-08-10T01:10:42.9321516Z Narrative field length: 1657
2025-08-10T01:10:42.9321775Z
2025-08-10T01:10:42.9321976Z üîç ROOT CAUSE ANALYSIS:
2025-08-10T01:10:42.9322344Z Raw JSON narrative length: 1657
2025-08-10T01:10:42.9322764Z Extracted narrative length: 1657
2025-08-10T01:10:42.9323269Z ‚úÖ JSON extraction is working correctly
2025-08-10T01:10:42.9323877Z ‚ùå Issue is in the original AI response generation
2025-08-10T01:10:42.9385050Z ‚úÖ PASS: tests/test_backstory_cutoff_red_green.py
2025-08-10T01:10:42.9390765Z ----------------------------------------
2025-08-10T01:10:42.9391299Z Running: tests/test_banned_name_prevention_v2.py
2025-08-10T01:10:42.9770766Z ....
2025-08-10T01:10:42.9773010Z ----------------------------------------------------------------------
2025-08-10T01:10:42.9773564Z Ran 4 tests in 0.002s
2025-08-10T01:10:42.9774927Z
2025-08-10T01:10:42.9779461Z OK
2025-08-10T01:10:42.9826729Z ‚úÖ PASS: tests/test_banned_name_prevention_v2.py
2025-08-10T01:10:42.9828269Z ----------------------------------------
2025-08-10T01:10:42.9828765Z Running: tests/test_banned_names_loading.py
2025-08-10T01:10:43.0296162Z ........
2025-08-10T01:10:43.0297205Z ----------------------------------------------------------------------
2025-08-10T01:10:43.0298022Z Ran 8 tests in 0.001s
2025-08-10T01:10:43.0298259Z
2025-08-10T01:10:43.0298393Z OK
2025-08-10T01:10:43.0371170Z ‚úÖ PASS: tests/test_banned_names_loading.py
2025-08-10T01:10:43.0371950Z ----------------------------------------
2025-08-10T01:10:43.0372692Z Running: tests/test_banned_names_visibility_v2.py
2025-08-10T01:10:43.0844330Z ...
2025-08-10T01:10:43.0845133Z ----------------------------------------------------------------------
2025-08-10T01:10:43.0845910Z Ran 3 tests in 0.002s
2025-08-10T01:10:43.0846399Z
2025-08-10T01:10:43.0848101Z OK
2025-08-10T01:10:43.0916945Z ‚úÖ PASS: tests/test_banned_names_visibility_v2.py
2025-08-10T01:10:43.0918454Z ----------------------------------------
2025-08-10T01:10:43.0918955Z Running: tests/test_build_campaign_prompt.py
2025-08-10T01:10:44.2095352Z 2025-08-10 01:10:44,209 - INFO - Skipping Firebase initialization in testing mode
2025-08-10T01:10:44.2113891Z 2025-08-10 01:10:44,211 - INFO - Generated random campaign: character='A nature-loving druid who can shapeshift and command beasts', setting='The mystical Feywild, a realm where magic runs wild and reality bends to emotion'
2025-08-10T01:10:44.2122166Z ...............2025-08-10 01:10:44,211 - INFO - Generated random campaign: character='A charismatic bard who weaves magic through music and stories', setting='The war-torn kingdom of Cyre, struggling to rebuild after magical devastation'
2025-08-10T01:10:44.2123475Z .
2025-08-10T01:10:44.2123824Z ----------------------------------------------------------------------
2025-08-10T01:10:44.2124297Z Ran 16 tests in 0.001s
2025-08-10T01:10:44.2124504Z
2025-08-10T01:10:44.2124613Z OK
2025-08-10T01:10:44.3975476Z ‚úÖ PASS: tests/test_build_campaign_prompt.py
2025-08-10T01:10:44.3976943Z ----------------------------------------
2025-08-10T01:10:44.3978026Z Running: tests/test_campaign_clicks.py
2025-08-10T01:10:44.4353791Z ....
2025-08-10T01:10:44.4355670Z ----------------------------------------------------------------------
2025-08-10T01:10:44.4356183Z Ran 4 tests in 0.001s
2025-08-10T01:10:44.4356404Z
2025-08-10T01:10:44.4356524Z OK
2025-08-10T01:10:44.4412301Z ‚úÖ PASS: tests/test_campaign_clicks.py
2025-08-10T01:10:44.4413171Z ----------------------------------------
2025-08-10T01:10:44.4414560Z Running: tests/test_character_extraction_regex_bug.py
2025-08-10T01:10:45.4392369Z .....
2025-08-10T01:10:45.4393268Z ----------------------------------------------------------------------
2025-08-10T01:10:45.4394954Z Ran 5 tests in 0.001s
2025-08-10T01:10:45.4395173Z
2025-08-10T01:10:45.4395295Z OK
2025-08-10T01:10:45.5748179Z ‚úÖ PASS: tests/test_character_extraction_regex_bug.py
2025-08-10T01:10:45.5749245Z ----------------------------------------
2025-08-10T01:10:45.5749977Z Running: tests/test_combat_bug_green.py
2025-08-10T01:10:45.6208436Z test_cleanup_defeated_enemies_handles_list_combatants (__main__.TestCombatBugGreen.test_cleanup_defeated_enemies_handles_list_combatants)
2025-08-10T01:10:45.6212527Z GREEN TEST: This should PASS without errors ... ok
2025-08-10T01:10:45.6213052Z ======================================================================
2025-08-10T01:10:45.6214009Z üü¢ RUNNING GREEN TEST - THIS SHOULD PASS!
2025-08-10T01:10:45.6216337Z test_cleanup_defeated_enemies_preserves_dict_combatants (__main__.TestCombatBugGreen.test_cleanup_defeated_enemies_preserves_dict_combatants)
2025-08-10T01:10:45.6217439Z If this test PASSES, the bug is fixed.
2025-08-10T01:10:45.6218642Z Verify that dict format still works correctly (regression test) ... ok
2025-08-10T01:10:45.6219887Z test_cleanup_with_complex_list_structure (__main__.TestCombatBugGreen.test_cleanup_with_complex_list_structure)
2025-08-10T01:10:45.6221129Z Test with more complex list structure that AI might generate ... ok
2025-08-10T01:10:45.6221729Z
2025-08-10T01:10:45.6222164Z ----------------------------------------------------------------------
2025-08-10T01:10:45.6222705Z ======================================================================
2025-08-10T01:10:45.6223600Z Ran 3 tests in 0.000s
2025-08-10T01:10:45.6224011Z
2025-08-10T01:10:45.6224021Z
2025-08-10T01:10:45.6224756Z ‚úÖ GREEN TEST: Attempting to call cleanup_defeated_enemies()...
2025-08-10T01:10:45.6225526Z OK
2025-08-10T01:10:45.6226127Z Expected: No errors, returns list of defeated enemies
2025-08-10T01:10:45.6227083Z ‚úÖ Successfully cleaned up defeated enemies: ['Dragon']
2025-08-10T01:10:45.6228032Z ‚úÖ Combatants normalized to dict format and Dragon removed
2025-08-10T01:10:45.6228502Z
2025-08-10T01:10:45.6230604Z ‚úÖ Dict format still works correctly (no regression)
2025-08-10T01:10:45.6230988Z
2025-08-10T01:10:45.6231254Z ‚úÖ Complex list structure handled correctly
2025-08-10T01:10:45.6287700Z ‚úÖ PASS: tests/test_combat_bug_green.py
2025-08-10T01:10:45.6289220Z ----------------------------------------
2025-08-10T01:10:45.6289768Z Running: tests/test_combat_cleanup_comprehensive.py
2025-08-10T01:10:46.7582478Z 2025-08-10 01:10:46,757 - INFO - Skipping Firebase initialization in testing mode
2025-08-10T01:10:46.7598656Z test_automatic_cleanup_via_state_updates_hp_defeat (__main__.TestCombatCleanupComprehensive.test_automatic_cleanup_via_state_updates_hp_defeat)
2025-08-10T01:10:46.7601282Z Test: Enemy defeated via AI HP update should be automatically cleaned up. ... 2025-08-10 01:10:46,759 - INFO - COMBAT STARTED - Participants: ['Hero', 'Orc Warrior', 'Goblin']
2025-08-10T01:10:46.7603165Z 2025-08-10 01:10:46,759 - INFO - COMBAT INITIALIZED - Initiative order: ['Hero(18)', 'Orc Warrior(14)', 'Goblin(12)']
2025-08-10T01:10:46.7604577Z 2025-08-10 01:10:46,760 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7606091Z   "combat_state": {
2025-08-10T01:10:46.7606662Z     "combatants": {
2025-08-10T01:10:46.7611583Z       "Orc Warrior": {
2025-08-10T01:10:46.7612300Z         "hp_current": 0,
2025-08-10T01:10:46.7612699Z         "status": [
2025-08-10T01:10:46.7613050Z           "bloodied",
2025-08-10T01:10:46.7613406Z           "unconscious"
2025-08-10T01:10:46.7613756Z         ]
2025-08-10T01:10:46.7614060Z       }
2025-08-10T01:10:46.7614345Z     }
2025-08-10T01:10:46.7614628Z   }
2025-08-10T01:10:46.7614915Z }
2025-08-10T01:10:46.7615434Z 2025-08-10 01:10:46,760 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7616082Z   "combatants": {
2025-08-10T01:10:46.7616443Z     "Orc Warrior": {
2025-08-10T01:10:46.7616805Z       "hp_current": 0,
2025-08-10T01:10:46.7617167Z       "status": [
2025-08-10T01:10:46.7617499Z         "bloodied",
2025-08-10T01:10:46.7643588Z         "unconscious"
2025-08-10T01:10:46.7643933Z       ]
2025-08-10T01:10:46.7644191Z     }
2025-08-10T01:10:46.7644434Z   }
2025-08-10T01:10:46.7644689Z }
2025-08-10T01:10:46.7645136Z 2025-08-10 01:10:46,760 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7645730Z   "Orc Warrior": {
2025-08-10T01:10:46.7646020Z     "hp_current": 0,
2025-08-10T01:10:46.7646310Z     "status": [
2025-08-10T01:10:46.7646590Z       "bloodied",
2025-08-10T01:10:46.7646883Z       "unconscious"
2025-08-10T01:10:46.7647154Z     ]
2025-08-10T01:10:46.7647383Z   }
2025-08-10T01:10:46.7647622Z }
2025-08-10T01:10:46.7648217Z 2025-08-10 01:10:46,760 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7648768Z   "hp_current": 0,
2025-08-10T01:10:46.7649050Z   "status": [
2025-08-10T01:10:46.7649305Z     "bloodied",
2025-08-10T01:10:46.7649563Z     "unconscious"
2025-08-10T01:10:46.7649850Z   ]
2025-08-10T01:10:46.7650093Z }
2025-08-10T01:10:46.7650471Z 2025-08-10 01:10:46,760 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7651112Z 2025-08-10 01:10:46,760 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7651737Z 2025-08-10 01:10:46,760 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7652420Z 2025-08-10 01:10:46,760 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7653180Z 2025-08-10 01:10:46,760 - INFO - COMBAT CLEANUP CHECK: Found 3 combatants, scanning for defeated enemies...
2025-08-10T01:10:46.7653982Z 2025-08-10 01:10:46,760 - INFO - COMBAT CLEANUP: Marking Orc Warrior (enemy) as defeated
2025-08-10T01:10:46.7654765Z 2025-08-10 01:10:46,760 - INFO - COMBAT CLEANUP: Removed Orc Warrior from combat_state.combatants
2025-08-10T01:10:46.7655524Z 2025-08-10 01:10:46,760 - INFO - COMBAT CLEANUP: Removed Orc Warrior from npc_data
2025-08-10T01:10:46.7656295Z 2025-08-10 01:10:46,761 - INFO - AUTOMATIC CLEANUP: Defeated enemies removed: ['Orc Warrior']
2025-08-10T01:10:46.7656892Z ok
2025-08-10T01:10:46.7657865Z test_cleanup_without_explicit_combat_state_changes (__main__.TestCombatCleanupComprehensive.test_cleanup_without_explicit_combat_state_changes)
2025-08-10T01:10:46.7664992Z Test: Cleanup should trigger even when combat_state isn't explicitly in proposed_changes. ... 2025-08-10 01:10:46,761 - INFO - COMBAT STARTED - Participants: ['Ranger', 'Troll']
2025-08-10T01:10:46.7666283Z 2025-08-10 01:10:46,761 - INFO - COMBAT INITIALIZED - Initiative order: ['Ranger(16)', 'Troll(8)']
2025-08-10T01:10:46.7667065Z 2025-08-10 01:10:46,761 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7667607Z   "combat_state": {
2025-08-10T01:10:46.7668544Z     "current_turn_index": 1,
2025-08-10T01:10:46.7668939Z     "current_round": 3
2025-08-10T01:10:46.7669262Z   },
2025-08-10T01:10:46.7669549Z   "world_data": {
2025-08-10T01:10:46.7669854Z     "current_weather": "stormy"
2025-08-10T01:10:46.7670168Z   }
2025-08-10T01:10:46.7670409Z }
2025-08-10T01:10:46.7670834Z 2025-08-10 01:10:46,761 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7671379Z   "current_turn_index": 1,
2025-08-10T01:10:46.7671716Z   "current_round": 3
2025-08-10T01:10:46.7671996Z }
2025-08-10T01:10:46.7672368Z 2025-08-10 01:10:46,761 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7673266Z 2025-08-10 01:10:46,761 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7673813Z   "current_weather": "stormy"
2025-08-10T01:10:46.7674133Z }
2025-08-10T01:10:46.7674517Z 2025-08-10 01:10:46,761 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7675120Z 2025-08-10 01:10:46,761 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7675884Z 2025-08-10 01:10:46,761 - INFO - COMBAT CLEANUP CHECK: Found 2 combatants, scanning for defeated enemies...
2025-08-10T01:10:46.7676687Z 2025-08-10 01:10:46,761 - INFO - COMBAT CLEANUP: Marking Troll (enemy) as defeated
2025-08-10T01:10:46.7677408Z 2025-08-10 01:10:46,761 - INFO - COMBAT CLEANUP: Removed Troll from combat_state.combatants
2025-08-10T01:10:46.7678297Z 2025-08-10 01:10:46,761 - INFO - COMBAT CLEANUP: Removed Troll from npc_data
2025-08-10T01:10:46.7678970Z 2025-08-10 01:10:46,761 - INFO - AUTOMATIC CLEANUP: Defeated enemies removed: ['Troll']
2025-08-10T01:10:46.7679506Z ok
2025-08-10T01:10:46.7680201Z test_combat_end_with_pre_defeated_enemies (__main__.TestCombatCleanupComprehensive.test_combat_end_with_pre_defeated_enemies)
2025-08-10T01:10:46.7681735Z Test: When combat ends and there are already defeated enemies, they should be cleaned up. ... 2025-08-10 01:10:46,761 - INFO - COMBAT STARTED - Participants: ['Player', 'Dead Orc', 'Living Wolf']
2025-08-10T01:10:46.7683111Z 2025-08-10 01:10:46,761 - INFO - COMBAT INITIALIZED - Initiative order: ['Player(15)', 'Dead Orc(12)', 'Living Wolf(10)']
2025-08-10T01:10:46.7683998Z 2025-08-10 01:10:46,761 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7684520Z   "combat_state": {
2025-08-10T01:10:46.7684812Z     "in_combat": false,
2025-08-10T01:10:46.7685118Z     "current_round": 0
2025-08-10T01:10:46.7685408Z   }
2025-08-10T01:10:46.7685633Z }
2025-08-10T01:10:46.7686029Z 2025-08-10 01:10:46,761 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7686586Z   "in_combat": false,
2025-08-10T01:10:46.7686877Z   "current_round": 0
2025-08-10T01:10:46.7687146Z }
2025-08-10T01:10:46.7687516Z 2025-08-10 01:10:46,762 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7689609Z 2025-08-10 01:10:46,762 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7690359Z 2025-08-10 01:10:46,762 - INFO - COMBAT CLEANUP CHECK: Found 3 combatants, scanning for defeated enemies...
2025-08-10T01:10:46.7691143Z 2025-08-10 01:10:46,762 - INFO - COMBAT CLEANUP: Marking Dead Orc (enemy) as defeated
2025-08-10T01:10:46.7691880Z 2025-08-10 01:10:46,762 - INFO - COMBAT CLEANUP: Removed Dead Orc from combat_state.combatants
2025-08-10T01:10:46.7692592Z 2025-08-10 01:10:46,762 - INFO - COMBAT CLEANUP: Removed Dead Orc from npc_data
2025-08-10T01:10:46.7693258Z 2025-08-10 01:10:46,762 - INFO - AUTOMATIC CLEANUP: Defeated enemies removed: ['Dead Orc']
2025-08-10T01:10:46.7693787Z ok
2025-08-10T01:10:46.7694488Z test_multiple_enemies_defeated_same_turn (__main__.TestCombatCleanupComprehensive.test_multiple_enemies_defeated_same_turn)
2025-08-10T01:10:46.7695950Z Test: Multiple enemies defeated in the same AI response should all be cleaned up. ... 2025-08-10 01:10:46,762 - INFO - COMBAT STARTED - Participants: ['Wizard', 'Goblin A', 'Goblin B', 'Orc Chief']
2025-08-10T01:10:46.7697308Z 2025-08-10 01:10:46,762 - INFO - COMBAT INITIALIZED - Initiative order: ['Wizard(20)', 'Goblin A(15)', 'Goblin B(14)', 'Orc Chief(13)']
2025-08-10T01:10:46.7698554Z 2025-08-10 01:10:46,762 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7699072Z   "combat_state": {
2025-08-10T01:10:46.7699353Z     "combatants": {
2025-08-10T01:10:46.7699623Z       "Goblin A": {
2025-08-10T01:10:46.7699908Z         "hp_current": 0,
2025-08-10T01:10:46.7700211Z         "status": [
2025-08-10T01:10:46.7700478Z           "dead"
2025-08-10T01:10:46.7700744Z         ]
2025-08-10T01:10:46.7700986Z       },
2025-08-10T01:10:46.7701423Z       "Goblin B": {
2025-08-10T01:10:46.7701710Z         "hp_current": 0,
2025-08-10T01:10:46.7702014Z         "status": [
2025-08-10T01:10:46.7702272Z           "dead"
2025-08-10T01:10:46.7702531Z         ]
2025-08-10T01:10:46.7702763Z       },
2025-08-10T01:10:46.7702997Z       "Orc Chief": {
2025-08-10T01:10:46.7703286Z         "hp_current": 5,
2025-08-10T01:10:46.7703590Z         "status": [
2025-08-10T01:10:46.7703882Z           "wounded"
2025-08-10T01:10:46.7704170Z ... (truncated, showing 19/24 lines)
2025-08-10T01:10:46.7704697Z 2025-08-10 01:10:46,762 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7705222Z   "combatants": {
2025-08-10T01:10:46.7705493Z     "Goblin A": {
2025-08-10T01:10:46.7705771Z       "hp_current": 0,
2025-08-10T01:10:46.7706065Z       "status": [
2025-08-10T01:10:46.7706333Z         "dead"
2025-08-10T01:10:46.7706594Z       ]
2025-08-10T01:10:46.7706837Z     },
2025-08-10T01:10:46.7707080Z     "Goblin B": {
2025-08-10T01:10:46.7707368Z       "hp_current": 0,
2025-08-10T01:10:46.7707658Z       "status": [
2025-08-10T01:10:46.7708055Z         "dead"
2025-08-10T01:10:46.7708309Z       ]
2025-08-10T01:10:46.7708538Z     },
2025-08-10T01:10:46.7708770Z     "Orc Chief": {
2025-08-10T01:10:46.7709049Z       "hp_current": 5,
2025-08-10T01:10:46.7709330Z       "status": [
2025-08-10T01:10:46.7709584Z         "wounded"
2025-08-10T01:10:46.7709860Z       ]
2025-08-10T01:10:46.7710118Z ... (truncated, showing 19/22 lines)
2025-08-10T01:10:46.7710641Z 2025-08-10 01:10:46,762 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7711169Z   "Goblin A": {
2025-08-10T01:10:46.7711448Z     "hp_current": 0,
2025-08-10T01:10:46.7711724Z     "status": [
2025-08-10T01:10:46.7711984Z       "dead"
2025-08-10T01:10:46.7712235Z     ]
2025-08-10T01:10:46.7712468Z   },
2025-08-10T01:10:46.7712700Z   "Goblin B": {
2025-08-10T01:10:46.7712978Z     "hp_current": 0,
2025-08-10T01:10:46.7713251Z     "status": [
2025-08-10T01:10:46.7713503Z       "dead"
2025-08-10T01:10:46.7713758Z     ]
2025-08-10T01:10:46.7713986Z   },
2025-08-10T01:10:46.7714215Z   "Orc Chief": {
2025-08-10T01:10:46.7714483Z     "hp_current": 5,
2025-08-10T01:10:46.7714760Z     "status": [
2025-08-10T01:10:46.7715010Z       "wounded"
2025-08-10T01:10:46.7715263Z     ]
2025-08-10T01:10:46.7715494Z   }
2025-08-10T01:10:46.7715722Z }
2025-08-10T01:10:46.7716120Z 2025-08-10 01:10:46,762 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7716638Z   "hp_current": 0,
2025-08-10T01:10:46.7716907Z   "status": [
2025-08-10T01:10:46.7717175Z     "dead"
2025-08-10T01:10:46.7717413Z   ]
2025-08-10T01:10:46.7717634Z }
2025-08-10T01:10:46.7718134Z 2025-08-10 01:10:46,762 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7718766Z 2025-08-10 01:10:46,762 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7719278Z   "hp_current": 0,
2025-08-10T01:10:46.7719540Z   "status": [
2025-08-10T01:10:46.7719787Z     "dead"
2025-08-10T01:10:46.7720033Z   ]
2025-08-10T01:10:46.7720255Z }
2025-08-10T01:10:46.7720617Z 2025-08-10 01:10:46,762 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7721256Z 2025-08-10 01:10:46,762 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:46.7721756Z   "hp_current": 5,
2025-08-10T01:10:46.7722032Z   "status": [
2025-08-10T01:10:46.7722476Z     "wounded"
2025-08-10T01:10:46.7722716Z   ]
2025-08-10T01:10:46.7722948Z }
2025-08-10T01:10:46.7723304Z 2025-08-10 01:10:46,762 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7723904Z 2025-08-10 01:10:46,763 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7724503Z 2025-08-10 01:10:46,763 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7725089Z 2025-08-10 01:10:46,763 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:10:46.7725819Z 2025-08-10 01:10:46,763 - INFO - COMBAT CLEANUP CHECK: Found 4 combatants, scanning for defeated enemies...
2025-08-10T01:10:46.7726781Z 2025-08-10 01:10:46,763 - INFO - COMBAT CLEANUP: Marking Goblin A (enemy) as defeated
2025-08-10T01:10:46.7727465Z 2025-08-10 01:10:46,763 - INFO - COMBAT CLEANUP: Marking Goblin B (enemy) as defeated
2025-08-10T01:10:46.7728340Z 2025-08-10 01:10:46,763 - INFO - COMBAT CLEANUP: Removed Goblin A from combat_state.combatants
2025-08-10T01:10:46.7729017Z 2025-08-10 01:10:46,763 - INFO - COMBAT CLEANUP: Removed Goblin A from npc_data
2025-08-10T01:10:46.7729705Z 2025-08-10 01:10:46,763 - INFO - COMBAT CLEANUP: Removed Goblin B from combat_state.combatants
2025-08-10T01:10:46.7730374Z 2025-08-10 01:10:46,763 - INFO - COMBAT CLEANUP: Removed Goblin B from npc_data
2025-08-10T01:10:46.7731109Z 2025-08-10 01:10:46,763 - INFO - AUTOMATIC CLEANUP: Defeated enemies removed: ['Goblin A', 'Goblin B']
2025-08-10T01:10:46.7731699Z ok
2025-08-10T01:10:46.7731831Z
2025-08-10T01:10:46.7732017Z ----------------------------------------------------------------------
2025-08-10T01:10:46.7732453Z Ran 4 tests in 0.004s
2025-08-10T01:10:46.7732638Z
2025-08-10T01:10:46.7732741Z OK
2025-08-10T01:10:46.7733051Z Running comprehensive combat cleanup tests
2025-08-10T01:10:46.7733543Z These tests verify the automatic cleanup system works correctly
2025-08-10T01:10:46.7734039Z ======================================================================
2025-08-10T01:10:46.7734322Z
2025-08-10T01:10:46.7734500Z Testing: Automatic cleanup via HP state updates
2025-08-10T01:10:46.7734964Z Initial combatants: ['Hero', 'Orc Warrior', 'Goblin']
2025-08-10T01:10:46.7735453Z Initial NPC data: ['Orc Warrior', 'Goblin', 'Merchant']
2025-08-10T01:10:46.7736247Z AI proposed changes: {'combat_state': {'combatants': {'Orc Warrior': {'hp_current': 0, 'status': ['bloodied', 'unconscious']}}}}
2025-08-10T01:10:46.7737030Z After automatic cleanup - Combatants: ['Hero', 'Goblin']
2025-08-10T01:10:46.7737546Z After automatic cleanup - NPCs: ['Goblin', 'Merchant']
2025-08-10T01:10:46.7738002Z
2025-08-10T01:10:46.7738204Z Testing: Cleanup without explicit combat state changes
2025-08-10T01:10:46.7738662Z Before update - Troll HP: 0
2025-08-10T01:10:46.7739051Z Before update - Combatants: ['Ranger', 'Troll']
2025-08-10T01:10:46.7739478Z After update - Combatants: ['Ranger']
2025-08-10T01:10:46.7739718Z
2025-08-10T01:10:46.7739887Z Testing: Combat end with pre-defeated enemies
2025-08-10T01:10:46.7740413Z Before combat end - Combatants: ['Player', 'Dead Orc', 'Living Wolf']
2025-08-10T01:10:46.7740893Z Dead Orc HP: 0
2025-08-10T01:10:46.7741192Z After combat end - In combat: False
2025-08-10T01:10:46.7741638Z After combat end - Combatants: ['Player', 'Living Wolf']
2025-08-10T01:10:46.7741954Z
2025-08-10T01:10:46.7742095Z Testing: Multiple simultaneous defeats
2025-08-10T01:10:46.7742622Z Before fireball - Combatants: ['Wizard', 'Goblin A', 'Goblin B', 'Orc Chief']
2025-08-10T01:10:46.7743212Z After fireball - Combatants: ['Wizard', 'Orc Chief']
2025-08-10T01:10:46.7743690Z After fireball - NPCs: ['Orc Chief', 'Village Elder']
2025-08-10T01:10:46.9553592Z ‚úÖ PASS: tests/test_combat_cleanup_comprehensive.py
2025-08-10T01:10:46.9555124Z ----------------------------------------
2025-08-10T01:10:46.9555586Z Running: tests/test_common.py
2025-08-10T01:10:46.9673774Z ‚úÖ PASS: tests/test_common.py
2025-08-10T01:10:46.9674414Z ----------------------------------------
2025-08-10T01:10:46.9675598Z Running: tests/test_complete_combined_approach.py
2025-08-10T01:10:47.1472113Z test_complete_combined_approach_integration (__main__.TestCompleteCombinedApproach.test_complete_combined_approach_integration)
2025-08-10T01:10:47.1488282Z Test complete Combined approach integration flow ... ok
2025-08-10T01:10:47.1489762Z test_failure_case_handling (__main__.TestCompleteCombinedApproach.test_failure_case_handling)
2025-08-10T01:10:47.1491780Z Test how the system handles failure cases ... WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:10:47.1501181Z ERROR:root:üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:10:47.1502695Z ok
2025-08-10T01:10:47.1504145Z test_step1_structured_generation_prompt_creation (__main__.TestCompleteCombinedApproach.test_step1_structured_generation_prompt_creation)
2025-08-10T01:10:47.1511099Z Step 1: Create structured generation prompt with entity manifest ... /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/case.py:678: DeprecationWarning: It is deprecated to return a value that is not None from a test case (<bound method TestCompleteCombinedApproach.test_step1_structured_generation_prompt_creation of <__main__.TestCompleteCombinedApproach testMethod=test_step1_structured_generation_prompt_creation>>)
2025-08-10T01:10:47.1514353Z   return self.run(*args, **kwds)
2025-08-10T01:10:47.1514900Z ok
2025-08-10T01:10:47.1515807Z test_step2_structured_response_parsing (__main__.TestCompleteCombinedApproach.test_step2_structured_response_parsing)
2025-08-10T01:10:47.1519047Z Step 2: Parse structured JSON response from LLM ... /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/case.py:678: DeprecationWarning: It is deprecated to return a value that is not None from a test case (<bound method TestCompleteCombinedApproach.test_step2_structured_response_parsing of <__main__.TestCompleteCombinedApproach testMethod=test_step2_structured_response_parsing>>)
2025-08-10T01:10:47.1521730Z üéØ Complete Combined Approach Implementation Test
2025-08-10T01:10:47.1522274Z Testing Milestone 1: Production Entity Tracking
2025-08-10T01:10:47.1523508Z   return self.run(*args, **kwds)
2025-08-10T01:10:47.1523861Z ok
2025-08-10T01:10:47.1524432Z test_step3_schema_validation (__main__.TestCompleteCombinedApproach.test_step3_schema_validation)
2025-08-10T01:10:47.1526958Z Step 3: Validate structured response against expected schema ... /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/case.py:678: DeprecationWarning: It is deprecated to return a value that is not None from a test case (<bound method TestCompleteCombinedApproach.test_step3_schema_validation of <__main__.TestCompleteCombinedApproach testMethod=test_step3_schema_validation>>)
2025-08-10T01:10:47.1529334Z   return self.run(*args, **kwds)
2025-08-10T01:10:47.1529674Z ok
2025-08-10T01:10:47.1530324Z test_step4_narrative_sync_validation (__main__.TestCompleteCombinedApproach.test_step4_narrative_sync_validation)
2025-08-10T01:10:47.1532926Z Step 4: Additional validation with NarrativeSyncValidator ... /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/case.py:678: DeprecationWarning: It is deprecated to return a value that is not None from a test case (<bound method TestCompleteCombinedApproach.test_step4_narrative_sync_validation of <__main__.TestCompleteCombinedApproach testMethod=test_step4_narrative_sync_validation>>)
2025-08-10T01:10:47.1536244Z   return self.run(*args, **kwds)
2025-08-10T01:10:47.1536571Z ok
2025-08-10T01:10:47.1536715Z
2025-08-10T01:10:47.1536910Z ----------------------------------------------------------------------
2025-08-10T01:10:47.1537360Z Ran 6 tests in 0.005s
2025-08-10T01:10:47.1537563Z
2025-08-10T01:10:47.1537669Z OK
2025-08-10T01:10:47.1541406Z ======================================================================
2025-08-10T01:10:47.1541751Z
2025-08-10T01:10:47.1542041Z üöÄ Complete Combined Approach Integration Test
2025-08-10T01:10:47.1542473Z ============================================================
2025-08-10T01:10:47.1542748Z
2025-08-10T01:10:47.1543286Z üîß Step 1: Creating structured generation prompt
2025-08-10T01:10:47.1543860Z    ‚úÖ Expected entities: ['Gideon', 'Sariel', 'Rowan']
2025-08-10T01:10:47.1544388Z    ‚úÖ Prompt injection created (836 chars)
2025-08-10T01:10:47.1544657Z
2025-08-10T01:10:47.1544882Z üîß Step 2: Parsing structured JSON response
2025-08-10T01:10:47.1545343Z    ‚úÖ JSON parsed successfully
2025-08-10T01:10:47.1545768Z    ‚úÖ Narrative extracted (380 chars)
2025-08-10T01:10:47.1546248Z    ‚úÖ Entities found: ['Gideon', 'Sariel', 'Rowan']
2025-08-10T01:10:47.1546559Z
2025-08-10T01:10:47.1546826Z üîß Step 3: Schema validation of structured response
2025-08-10T01:10:47.1547505Z    ‚úÖ Schema validation: True
2025-08-10T01:10:47.1548124Z    ‚úÖ Narrative validation: True
2025-08-10T01:10:47.1548552Z    ‚úÖ Coverage rate: 1.00
2025-08-10T01:10:47.1548758Z
2025-08-10T01:10:47.1549002Z üîß Step 4: Additional narrative sync validation
2025-08-10T01:10:47.1549474Z    ‚úÖ All entities present: True
2025-08-10T01:10:47.1549954Z    ‚úÖ Entities found: ['Gideon', 'Sariel', 'Rowan']
2025-08-10T01:10:47.1550452Z    ‚úÖ Confidence: 1.00
2025-08-10T01:10:47.1550647Z
2025-08-10T01:10:47.1550843Z üìä Combined Approach Results:
2025-08-10T01:10:47.1551306Z    üéØ Structured Generation: ‚úÖ PASS
2025-08-10T01:10:47.1551786Z    üéØ Response Parsing: ‚úÖ PASS
2025-08-10T01:10:47.1552278Z    üéØ Schema Validation: ‚úÖ PASS (100% coverage)
2025-08-10T01:10:47.1552852Z    üéØ Sync Validation: ‚úÖ PASS (100% confidence)
2025-08-10T01:10:47.1553370Z    üéØ Overall: ‚úÖ 100% SUCCESS
2025-08-10T01:10:47.1553610Z
2025-08-10T01:10:47.1553864Z üéâ Combined Approach Implementation VERIFIED!
2025-08-10T01:10:47.1554336Z    The Cassian Problem is SOLVED!
2025-08-10T01:10:47.1554602Z
2025-08-10T01:10:47.1554806Z üß™ Testing failure case handling
2025-08-10T01:10:47.1555286Z    ‚úÖ Graceful fallback for non-JSON response
2025-08-10T01:10:47.1556005Z    ‚úÖ Validation still detects missing entities: ['Gideon', 'Sariel', 'Rowan']
2025-08-10T01:10:47.1556468Z
2025-08-10T01:10:47.1556741Z üîß Step 1: Creating structured generation prompt
2025-08-10T01:10:47.1557353Z    ‚úÖ Expected entities: ['Gideon', 'Sariel', 'Rowan']
2025-08-10T01:10:47.1558056Z    ‚úÖ Prompt injection created (836 chars)
2025-08-10T01:10:47.1558355Z
2025-08-10T01:10:47.1558598Z üîß Step 2: Parsing structured JSON response
2025-08-10T01:10:47.1559108Z    ‚úÖ JSON parsed successfully
2025-08-10T01:10:47.1559566Z    ‚úÖ Narrative extracted (380 chars)
2025-08-10T01:10:47.1560088Z    ‚úÖ Entities found: ['Gideon', 'Sariel', 'Rowan']
2025-08-10T01:10:47.1560416Z
2025-08-10T01:10:47.1560684Z üîß Step 3: Schema validation of structured response
2025-08-10T01:10:47.1561230Z    ‚úÖ Schema validation: True
2025-08-10T01:10:47.1561672Z    ‚úÖ Narrative validation: True
2025-08-10T01:10:47.1562125Z    ‚úÖ Coverage rate: 1.00
2025-08-10T01:10:47.1562351Z
2025-08-10T01:10:47.1562613Z üîß Step 4: Additional narrative sync validation
2025-08-10T01:10:47.1563133Z    ‚úÖ All entities present: True
2025-08-10T01:10:47.1563642Z    ‚úÖ Entities found: ['Gideon', 'Sariel', 'Rowan']
2025-08-10T01:10:47.1564175Z    ‚úÖ Confidence: 1.00
2025-08-10T01:10:47.1756952Z ‚úÖ PASS: tests/test_complete_combined_approach.py
2025-08-10T01:10:47.1757646Z ----------------------------------------
2025-08-10T01:10:47.1758402Z Running: tests/test_constants.py
2025-08-10T01:10:47.2144321Z ...............
2025-08-10T01:10:47.2145059Z ----------------------------------------------------------------------
2025-08-10T01:10:47.2146286Z Ran 15 tests in 0.001s
2025-08-10T01:10:47.2146753Z
2025-08-10T01:10:47.2146967Z OK
2025-08-10T01:10:47.2199932Z ‚úÖ PASS: tests/test_constants.py
2025-08-10T01:10:47.2201155Z ----------------------------------------
2025-08-10T01:10:47.2201680Z Running: tests/test_context_truncation.py
2025-08-10T01:10:48.2140530Z 2025-08-10 01:10:48,213 - INFO - Initializing Gemini Client
2025-08-10T01:10:48.2142465Z 2025-08-10 01:10:48,213 - WARNING - ‚ö†Ô∏è Could not count tokens for context stats: CRITICAL: GEMINI_API_KEY environment variable not found!
2025-08-10T01:10:48.2144743Z 2025-08-10 01:10:48,214 - INFO - Initial context stats: Turns: 2, Tokens: 5 (est: 5), Core Memories: 0
2025-08-10T01:10:48.2146634Z 2025-08-10 01:10:48,214 - INFO - Context is within token budget. No truncation needed.
2025-08-10T01:10:48.2147422Z .2025-08-10 01:10:48,214 - INFO - Initializing Gemini Client
2025-08-10T01:10:48.2150302Z 2025-08-10 01:10:48,214 - WARNING - ‚ö†Ô∏è Could not count tokens for context stats: CRITICAL: GEMINI_API_KEY environment variable not found!
2025-08-10T01:10:48.2151404Z 2025-08-10 01:10:48,214 - INFO - Initial context stats: Turns: 6, Tokens: 15 (est: 15), Core Memories: 0
2025-08-10T01:10:48.2152480Z 2025-08-10 01:10:48,214 - INFO - Context is within token budget. No truncation needed.
2025-08-10T01:10:48.2153145Z .2025-08-10 01:10:48,214 - INFO - Initializing Gemini Client
2025-08-10T01:10:48.2154182Z 2025-08-10 01:10:48,214 - WARNING - ‚ö†Ô∏è Could not count tokens for context stats: CRITICAL: GEMINI_API_KEY environment variable not found!
2025-08-10T01:10:48.2155212Z 2025-08-10 01:10:48,214 - INFO - Initial context stats: Turns: 4, Tokens: 50 (est: 50), Core Memories: 0
2025-08-10T01:10:48.2156201Z 2025-08-10 01:10:48,214 - WARNING - ‚ö†Ô∏è Context (50 tokens) exceeds budget of 30 tokens. Truncating...
2025-08-10T01:10:48.2156883Z 2025-08-10 01:10:48,214 - INFO - Initializing Gemini Client
2025-08-10T01:10:48.2158049Z 2025-08-10 01:10:48,214 - WARNING - ‚ö†Ô∏è Could not count tokens for context stats: CRITICAL: GEMINI_API_KEY environment variable not found!
2025-08-10T01:10:48.2159145Z 2025-08-10 01:10:48,214 - INFO - Final context stats after truncation: Turns: 4, Tokens: 67 (est: 67), Core Memories: 0
2025-08-10T01:10:48.2159827Z .
2025-08-10T01:10:48.2160150Z ----------------------------------------------------------------------
2025-08-10T01:10:48.2160596Z Ran 3 tests in 0.001s
2025-08-10T01:10:48.2160796Z
2025-08-10T01:10:48.2160894Z OK
2025-08-10T01:10:48.2161292Z \n--- Running Test: test_does_not_truncate_if_within_all_limits ---
2025-08-10T01:10:48.2161812Z --- Test Finished Successfully ---
2025-08-10T01:10:48.2162305Z \n--- Running Test: test_no_truncation_when_under_char_limit ---
2025-08-10T01:10:48.2162791Z --- Test Finished Successfully ---
2025-08-10T01:10:48.2163287Z \n--- Running Test: test_truncates_when_few_turns_over_char_limit ---
2025-08-10T01:10:48.2163815Z --- Test Finished Successfully ---
2025-08-10T01:10:48.3529703Z ‚úÖ PASS: tests/test_context_truncation.py
2025-08-10T01:10:48.3531174Z ----------------------------------------
2025-08-10T01:10:48.3531626Z Running: tests/test_data_integrity.py
2025-08-10T01:10:48.6146720Z INFO: COMBAT STARTED - Participants: ['Player', 'Dragon Boss', 'Friendly Wolf']
2025-08-10T01:10:48.6165473Z INFO: COMBAT INITIALIZED - Initiative order: ['Player(15)', 'Dragon Boss(12)', 'Friendly Wolf(8)']
2025-08-10T01:10:48.6166309Z INFO: COMBAT CLEANUP: Marking Dragon Boss (enemy) as defeated
2025-08-10T01:10:48.6166976Z INFO: COMBAT CLEANUP: Removed Dragon Boss from combat_state.combatants
2025-08-10T01:10:48.6167590Z INFO: COMBAT CLEANUP: Removed Dragon Boss from npc_data
2025-08-10T01:10:48.6168367Z ..INFO: --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:48.6168851Z   "custom_campaign_state": {
2025-08-10T01:10:48.6169189Z     "active_missions": {
2025-08-10T01:10:48.6169514Z       "rogue_mission": {
2025-08-10T01:10:48.6169852Z         "title": "This shouldn't be here"
2025-08-10T01:10:48.6170222Z       }
2025-08-10T01:10:48.6170473Z     }
2025-08-10T01:10:48.6170715Z   }
2025-08-10T01:10:48.6170945Z }
2025-08-10T01:10:48.6171313Z INFO: --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:48.6171772Z   "active_missions": {
2025-08-10T01:10:48.6172085Z     "rogue_mission": {
2025-08-10T01:10:48.6172406Z       "title": "This shouldn't be here"
2025-08-10T01:10:48.6172776Z     }
2025-08-10T01:10:48.6173010Z   }
2025-08-10T01:10:48.6173242Z }
2025-08-10T01:10:48.6174168Z WARNING: ‚ö†Ô∏è SMART CONVERSION: AI attempted to set 'active_missions' as dict. Converting to list append.
2025-08-10T01:10:48.6174908Z INFO: Adding new mission: rogue_mission
2025-08-10T01:10:48.6175723Z INFO: --- update_state_with_changes: finished ---
2025-08-10T01:10:48.6176198Z INFO: --- update_state_with_changes: finished ---
2025-08-10T01:10:48.6176706Z ........INFO: --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:48.6177176Z   "npc_data": {
2025-08-10T01:10:48.6177467Z     "Grishnak": "defeated"
2025-08-10T01:10:48.6177916Z   }
2025-08-10T01:10:48.6178140Z }
2025-08-10T01:10:48.6178478Z INFO: --- update_state_with_changes: applying changes:\n{
2025-08-10T01:10:48.6178924Z   "Grishnak": "defeated"
2025-08-10T01:10:48.6179220Z }
2025-08-10T01:10:48.6179884Z INFO: update_state: Preserving dict structure for key 'Grishnak', adding 'status' field.
2025-08-10T01:10:48.6180541Z INFO: --- update_state_with_changes: finished ---
2025-08-10T01:10:48.6180995Z INFO: --- update_state_with_changes: finished ---
2025-08-10T01:10:48.6181390Z .
2025-08-10T01:10:48.6181718Z ----------------------------------------------------------------------
2025-08-10T01:10:48.6182190Z Ran 11 tests in 0.002s
2025-08-10T01:10:48.6182388Z
2025-08-10T01:10:48.6182489Z OK
2025-08-10T01:10:48.6543242Z ‚úÖ PASS: tests/test_data_integrity.py
2025-08-10T01:10:48.6544692Z ----------------------------------------
2025-08-10T01:10:48.6545157Z Running: tests/test_decorators.py
2025-08-10T01:10:48.7904249Z .........
2025-08-10T01:10:48.7908765Z ----------------------------------------------------------------------
2025-08-10T01:10:48.7909300Z Ran 9 tests in 0.004s
2025-08-10T01:10:48.7909518Z
2025-08-10T01:10:48.7909627Z OK
2025-08-10T01:10:48.8116638Z ‚úÖ PASS: tests/test_decorators.py
2025-08-10T01:10:48.8118231Z ----------------------------------------
2025-08-10T01:10:48.8118743Z Running: tests/test_defensive_numeric_converter.py
2025-08-10T01:10:49.0357255Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp'. Using default: 1
2025-08-10T01:10:49.0359239Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'hp_max'. Using default: 1
2025-08-10T01:10:49.0360955Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'strength'. Using default: 10
2025-08-10T01:10:49.0362471Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'dexterity'. Using default: 10
2025-08-10T01:10:49.0363653Z .WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp'. Using default: 1
2025-08-10T01:10:49.0365862Z WARNING:root:‚ö†Ô∏è Invalid value 'Unknown' for field 'hp'. Using default: 1
2025-08-10T01:10:49.0370379Z WARNING:root:‚ö†Ô∏è Invalid value 'UNKNOWN' for field 'hp'. Using default: 1
2025-08-10T01:10:49.0372627Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'hp'. Using default: 1
2025-08-10T01:10:49.0373622Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'hp'. Using default: 1
2025-08-10T01:10:49.0374679Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp_max'. Using default: 1
2025-08-10T01:10:49.0375632Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'hp_max'. Using default: 1
2025-08-10T01:10:49.0376599Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'temp_hp'. Using default: 0
2025-08-10T01:10:49.0377614Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'temp_hp'. Using default: 0
2025-08-10T01:10:49.0378753Z .WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'level'. Using default: 1
2025-08-10T01:10:49.0379737Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'level'. Using default: 1
2025-08-10T01:10:49.0380755Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'level'. Using default: 1
2025-08-10T01:10:49.0381716Z .WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'gold'. Using default: 0
2025-08-10T01:10:49.0382575Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'gold'. Using default: 0
2025-08-10T01:10:49.0383417Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'initiative'. Using default: 0
2025-08-10T01:10:49.0384248Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'initiative'. Using default: 0
2025-08-10T01:10:49.0385129Z ....WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'strength'. Using default: 10
2025-08-10T01:10:49.0385933Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'strength'. Using default: 10
2025-08-10T01:10:49.0387175Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'strength'. Using default: 10
2025-08-10T01:10:49.0388268Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'dexterity'. Using default: 10
2025-08-10T01:10:49.0389104Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'dexterity'. Using default: 10
2025-08-10T01:10:49.0390055Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'dexterity'. Using default: 10
2025-08-10T01:10:49.0390955Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'constitution'. Using default: 10
2025-08-10T01:10:49.0392037Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'constitution'. Using default: 10
2025-08-10T01:10:49.0392944Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'constitution'. Using default: 10
2025-08-10T01:10:49.0393846Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'intelligence'. Using default: 10
2025-08-10T01:10:49.0395233Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'intelligence'. Using default: 10
2025-08-10T01:10:49.0396712Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'intelligence'. Using default: 10
2025-08-10T01:10:49.0398165Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'wisdom'. Using default: 10
2025-08-10T01:10:49.0399308Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'wisdom'. Using default: 10
2025-08-10T01:10:49.0400647Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'wisdom'. Using default: 10
2025-08-10T01:10:49.0401895Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'charisma'. Using default: 10
2025-08-10T01:10:49.0403035Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'charisma'. Using default: 10
2025-08-10T01:10:49.0404356Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'charisma'. Using default: 10
2025-08-10T01:10:49.0405952Z .WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'level'. Using default: 1
2025-08-10T01:10:49.0406747Z .WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp'. Using default: 1
2025-08-10T01:10:49.0407513Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'hp_max'. Using default: 1
2025-08-10T01:10:49.0408507Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'temp_hp'. Using default: 0
2025-08-10T01:10:49.0409330Z .WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp_max'. Using default: 1
2025-08-10T01:10:49.0410090Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp'. Using default: 1
2025-08-10T01:10:49.0410856Z .WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'strength'. Using default: 10
2025-08-10T01:10:49.0411692Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'dexterity'. Using default: 10
2025-08-10T01:10:49.0412637Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'constitution'. Using default: 10
2025-08-10T01:10:49.0413200Z .
2025-08-10T01:10:49.0413514Z ----------------------------------------------------------------------
2025-08-10T01:10:49.0413952Z Ran 12 tests in 0.003s
2025-08-10T01:10:49.0414145Z
2025-08-10T01:10:49.0414265Z OK
2025-08-10T01:10:49.0703926Z ‚úÖ PASS: tests/test_defensive_numeric_converter.py
2025-08-10T01:10:49.0705412Z ----------------------------------------
2025-08-10T01:10:49.0705875Z Running: tests/test_delete_fix.py
2025-08-10T01:10:49.0808348Z === Testing __DELETE__ Token Processing ===
2025-08-10T01:10:49.0809330Z
2025-08-10T01:10:49.0809717Z Test 1: Simple deletion
2025-08-10T01:10:49.0812391Z Before: {'npc_data': {'Drake 1': {'name': 'Drake 1', 'type': 'enemy'}, 'Drake 2': {'name': 'Drake 2', 'type': 'enemy'}, 'Friendly NPC': {'name': 'Friend', 'type': 'ally'}}, 'other_data': 'should remain'}
2025-08-10T01:10:49.0813791Z Removed 'Drake 1' from state.
2025-08-10T01:10:49.0814205Z Removed 'Drake 2' from state.
2025-08-10T01:10:49.0814870Z After: {'npc_data': {'Friendly NPC': {'name': 'Friend', 'type': 'ally'}}, 'other_data': 'should remain'}
2025-08-10T01:10:49.0815691Z ‚úÖ Test 1 passed!
2025-08-10T01:10:49.0815903Z
2025-08-10T01:10:49.0816049Z Test 2: Top-level deletion
2025-08-10T01:10:49.0816765Z Before: {'defeated_enemy': {'name': 'Orc', 'hp': 0}, 'alive_ally': {'name': 'Ranger', 'hp': 50}, 'world_data': {'location': 'forest'}}
2025-08-10T01:10:49.0818116Z Removed 'defeated_enemy' from state.
2025-08-10T01:10:49.0818749Z After: {'alive_ally': {'name': 'Ranger', 'hp': 50}, 'world_data': {'location': 'forest'}}
2025-08-10T01:10:49.0819432Z ‚úÖ Test 2 passed!
2025-08-10T01:10:49.0819622Z
2025-08-10T01:10:49.0820024Z üéâ All tests passed! __DELETE__ token processing works correctly.
2025-08-10T01:10:49.0833969Z ‚úÖ PASS: tests/test_delete_fix.py
2025-08-10T01:10:49.0835249Z ----------------------------------------
2025-08-10T01:10:49.0835767Z Running: tests/test_delete_token_comprehensive.py
2025-08-10T01:10:49.1542593Z .....
2025-08-10T01:10:49.1544354Z ----------------------------------------------------------------------
2025-08-10T01:10:49.1546693Z Ran 5 tests in 0.004s
2025-08-10T01:10:49.1546911Z
2025-08-10T01:10:49.1547027Z OK
2025-08-10T01:10:49.1649236Z ‚úÖ PASS: tests/test_delete_token_comprehensive.py
2025-08-10T01:10:49.1651667Z ----------------------------------------
2025-08-10T01:10:49.1652280Z Running: tests/test_deployment_build.py
2025-08-10T01:10:49.2824979Z ...
2025-08-10T01:10:49.2825727Z ----------------------------------------------------------------------
2025-08-10T01:10:49.2828463Z Ran 3 tests in 0.003s
2025-08-10T01:10:49.2828697Z
2025-08-10T01:10:49.2828812Z OK
2025-08-10T01:10:49.2983790Z ‚úÖ PASS: tests/test_deployment_build.py
2025-08-10T01:10:49.2985151Z ----------------------------------------
2025-08-10T01:10:49.2985659Z Running: tests/test_documentation_performance.py
2025-08-10T01:10:49.3128516Z üìä Documentation Performance Test Report
2025-08-10T01:10:49.3130307Z ================================================================================
2025-08-10T01:10:49.3131406Z Project root: /home/runner/work/worldarchitect.ai/worldarchitect.ai
2025-08-10T01:10:49.3133268Z Maximum recommended size: 1500 lines
2025-08-10T01:10:49.3135069Z Warning threshold: 1000 lines
2025-08-10T01:10:49.3135679Z Optimal size: 700 lines
2025-08-10T01:10:49.3138001Z
2025-08-10T01:10:49.3138274Z üìè File Size Analysis:
2025-08-10T01:10:49.3138755Z --------------------------------------------------------------------------------
2025-08-10T01:10:49.3139381Z File                                                  Lines      Chars Status
2025-08-10T01:10:49.3139986Z --------------------------------------------------------------------------------
2025-08-10T01:10:49.3140830Z .cursor/rules/rules.mdc                                  65      2,823 ‚ú® OPTIMAL
2025-08-10T01:10:49.3141689Z .cursor/rules/lessons.mdc                              1432     85,037 ‚ö†Ô∏è  WARNING
2025-08-10T01:10:49.3142631Z .cursor/rules/project_overview.md                       192      7,132 ‚ú® OPTIMAL
2025-08-10T01:10:49.3143651Z .cursor/rules/planning_protocols.md                     211      7,242 ‚ú® OPTIMAL
2025-08-10T01:10:49.3144656Z .cursor/rules/documentation_map.md                       86      3,489 ‚ú® OPTIMAL
2025-08-10T01:10:49.3145646Z .cursor/rules/quick_reference.md                         83      2,013 ‚ú® OPTIMAL
2025-08-10T01:10:49.3146630Z .cursor/rules/progress_tracking.md                      131      3,333 ‚ú® OPTIMAL
2025-08-10T01:10:49.3147480Z CLAUDE.md                                               997     57,726 ‚úÖ OK
2025-08-10T01:10:49.3148253Z --------------------------------------------------------------------------------
2025-08-10T01:10:49.3148850Z TOTAL                                                  3197 lines
2025-08-10T01:10:49.3149192Z
2025-08-10T01:10:49.3149419Z ‚è±Ô∏è  Read Performance Test:
2025-08-10T01:10:49.3150302Z --------------------------------------------------------------------------------
2025-08-10T01:10:49.3151100Z .cursor/rules/rules.mdc                             0.000s ‚úÖ Fast
2025-08-10T01:10:49.3151886Z .cursor/rules/lessons.mdc                           0.000s ‚úÖ Fast
2025-08-10T01:10:49.3152673Z .cursor/rules/project_overview.md                   0.000s ‚úÖ Fast
2025-08-10T01:10:49.3153679Z .cursor/rules/planning_protocols.md                 0.000s ‚úÖ Fast
2025-08-10T01:10:49.3154476Z .cursor/rules/documentation_map.md                  0.000s ‚úÖ Fast
2025-08-10T01:10:49.3155262Z .cursor/rules/quick_reference.md                    0.000s ‚úÖ Fast
2025-08-10T01:10:49.3156035Z .cursor/rules/progress_tracking.md                  0.000s ‚úÖ Fast
2025-08-10T01:10:49.3156742Z CLAUDE.md                                           0.000s ‚úÖ Fast
2025-08-10T01:10:49.3157082Z
2025-08-10T01:10:49.3158936Z üîÑ API Chunking Simulation (2000 lines per chunk):
2025-08-10T01:10:49.3159575Z --------------------------------------------------------------------------------
2025-08-10T01:10:49.3160138Z .cursor/rules/rules.mdc: 1 chunks needed
2025-08-10T01:10:49.3160606Z .cursor/rules/lessons.mdc: 1 chunks needed
2025-08-10T01:10:49.3161121Z .cursor/rules/project_overview.md: 1 chunks needed
2025-08-10T01:10:49.3161669Z .cursor/rules/planning_protocols.md: 1 chunks needed
2025-08-10T01:10:49.3162241Z .cursor/rules/documentation_map.md: 1 chunks needed
2025-08-10T01:10:49.3162731Z .cursor/rules/quick_reference.md: 1 chunks needed
2025-08-10T01:10:49.3163233Z .cursor/rules/progress_tracking.md: 1 chunks needed
2025-08-10T01:10:49.3163718Z CLAUDE.md: 1 chunks needed
2025-08-10T01:10:49.3163963Z
2025-08-10T01:10:49.3164210Z üìã Summary & Recommendations:
2025-08-10T01:10:49.3164652Z ================================================================================
2025-08-10T01:10:49.3165362Z ‚úÖ All documentation files are within acceptable limits!
2025-08-10T01:10:49.3165935Z    No timeout risks detected.
2025-08-10T01:10:49.3166214Z
2025-08-10T01:10:49.3166418Z üí° Best Practices:
2025-08-10T01:10:49.3166902Z   - Keep documentation files under 1,000 lines for best performance
2025-08-10T01:10:49.3167513Z   - Archive old content to separate files
2025-08-10T01:10:49.3168282Z   - Use concise bullet points instead of verbose descriptions
2025-08-10T01:10:49.3168867Z   - Extract patterns from detailed incidents
2025-08-10T01:10:49.3171655Z ‚úÖ PASS: tests/test_documentation_performance.py
2025-08-10T01:10:49.3176057Z ----------------------------------------
2025-08-10T01:10:49.3176535Z Running: tests/test_dual_pass_generator.py
2025-08-10T01:10:49.3857305Z .....................
2025-08-10T01:10:49.3860226Z ----------------------------------------------------------------------
2025-08-10T01:10:49.3860761Z Ran 21 tests in 0.003s
2025-08-10T01:10:49.3860974Z
2025-08-10T01:10:49.3861097Z OK
2025-08-10T01:10:49.3964618Z ‚úÖ PASS: tests/test_dual_pass_generator.py
2025-08-10T01:10:49.3965909Z ----------------------------------------
2025-08-10T01:10:49.3966492Z Running: tests/test_end2end/test_continue_story_end2end.py
2025-08-10T01:10:49.7297348Z 2025-08-10 01:10:49,729 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:50.4667038Z sssss
2025-08-10T01:10:50.4669382Z ----------------------------------------------------------------------
2025-08-10T01:10:50.4671841Z Ran 5 tests in 0.000s
2025-08-10T01:10:50.4672066Z
2025-08-10T01:10:50.4672189Z OK (skipped=5)
2025-08-10T01:10:50.6177402Z ‚úÖ PASS: tests/test_end2end/test_continue_story_end2end.py
2025-08-10T01:10:50.6179146Z ----------------------------------------
2025-08-10T01:10:50.6179708Z Running: tests/test_end2end/test_create_campaign_end2end.py
2025-08-10T01:10:50.9483086Z 2025-08-10 01:10:50,948 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:50.9595706Z sssss
2025-08-10T01:10:50.9597523Z ----------------------------------------------------------------------
2025-08-10T01:10:50.9600804Z Ran 5 tests in 0.000s
2025-08-10T01:10:50.9601027Z
2025-08-10T01:10:50.9601153Z OK (skipped=5)
2025-08-10T01:10:51.0109922Z ‚úÖ PASS: tests/test_end2end/test_create_campaign_end2end.py
2025-08-10T01:10:51.0111104Z ----------------------------------------
2025-08-10T01:10:51.0112030Z Running: tests/test_end2end/test_debug_mode_end2end.py
2025-08-10T01:10:51.3468558Z 2025-08-10 01:10:51,346 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:51.3587290Z ssssssssssssss
2025-08-10T01:10:51.3588404Z ----------------------------------------------------------------------
2025-08-10T01:10:51.3589319Z Ran 14 tests in 0.000s
2025-08-10T01:10:51.3589858Z
2025-08-10T01:10:51.3590180Z OK (skipped=14)
2025-08-10T01:10:51.4154015Z ‚úÖ PASS: tests/test_end2end/test_debug_mode_end2end.py
2025-08-10T01:10:51.4154994Z ----------------------------------------
2025-08-10T01:10:51.4157224Z Running: tests/test_end2end/test_mcp_error_handling_end2end.py
2025-08-10T01:10:51.7475627Z 2025-08-10 01:10:51,747 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:51.7595406Z sssssssssssss
2025-08-10T01:10:51.7596576Z ----------------------------------------------------------------------
2025-08-10T01:10:51.7597457Z Ran 13 tests in 0.000s
2025-08-10T01:10:51.7599097Z
2025-08-10T01:10:51.7599447Z OK (skipped=13)
2025-08-10T01:10:51.8181017Z ‚úÖ PASS: tests/test_end2end/test_mcp_error_handling_end2end.py
2025-08-10T01:10:51.8182047Z ----------------------------------------
2025-08-10T01:10:51.8182731Z Running: tests/test_end2end/test_mcp_integration_comprehensive.py
2025-08-10T01:10:52.1462908Z 2025-08-10 01:10:52,146 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:52.1633127Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/bin/python3: can't open file '/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/mcp_api.py': [Errno 2] No such file or directory
2025-08-10T01:10:54.1746156Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/subprocess.py:1127: ResourceWarning: subprocess 2135 is still running
2025-08-10T01:10:54.1747615Z   _warn("subprocess %s is still running" % self.pid,
2025-08-10T01:10:54.1748647Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:54.1768943Z 2025-08-10 01:10:54,176 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:54.1772591Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:54.1774217Z   setup_file_logging()
2025-08-10T01:10:54.1774912Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:54.4413107Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:10:54.4417613Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:10:54.4633681Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:10:54.4636875Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:10:55.1482757Z 2025-08-10 01:10:55,148 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:10:55.1484429Z Args: ('mcp-comprehensive-test-user',)
2025-08-10T01:10:55.1485123Z Kwargs: {}
2025-08-10T01:10:55.1487674Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1490159Z Traceback:
2025-08-10T01:10:55.1490526Z Traceback (most recent call last):
2025-08-10T01:10:55.1491466Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:55.1492594Z     asyncio.get_running_loop()
2025-08-10T01:10:55.1493025Z RuntimeError: no running event loop
2025-08-10T01:10:55.1493319Z
2025-08-10T01:10:55.1493623Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:55.1494077Z
2025-08-10T01:10:55.1494250Z Traceback (most recent call last):
2025-08-10T01:10:55.1498321Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:55.1499208Z     return func(*args, **kwargs)
2025-08-10T01:10:55.1499543Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1500476Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:10:55.1501448Z     db = get_db()
2025-08-10T01:10:55.1501847Z          ^^^^^^^^
2025-08-10T01:10:55.1502644Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:55.1503540Z     return firestore.client()
2025-08-10T01:10:55.1503922Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1505034Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:55.1506336Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:55.1506985Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1508341Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:55.1509652Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:55.1510305Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1511441Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:55.1512587Z     self._services[name] = initializer(self)
2025-08-10T01:10:55.1513034Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1514133Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:55.1515280Z     credentials = app.credential.get_credential()
2025-08-10T01:10:55.1515762Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1516852Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:55.1521362Z     self._load_credential()
2025-08-10T01:10:55.1523652Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:55.1525062Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:55.1525750Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1526941Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:55.1529636Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:55.1531484Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1533382Z --- END EXCEPTION ---
2025-08-10T01:10:55.1535295Z 2025-08-10 01:10:55,148 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1537433Z .2025-08-10 01:10:55,152 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:55.1539592Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:55.1541093Z   setup_file_logging()
2025-08-10T01:10:55.1541699Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:55.1597010Z 2025-08-10 01:10:55,159 - main - INFO - Received campaign creation request:
2025-08-10T01:10:55.1598713Z 2025-08-10 01:10:55,159 - main - INFO -   Character: Update Test Hero
2025-08-10T01:10:55.1600008Z 2025-08-10 01:10:55,159 - main - INFO -   Setting: Update Test World
2025-08-10T01:10:55.1600936Z 2025-08-10 01:10:55,159 - main - INFO -   Description: Original description
2025-08-10T01:10:55.1601772Z 2025-08-10 01:10:55,159 - main - INFO -   Custom options: []
2025-08-10T01:10:55.1602396Z 2025-08-10 01:10:55,159 - main - INFO -   Selected prompts: []
2025-08-10T01:10:55.1623700Z 2025-08-10 01:10:55,162 - root - ERROR - üî•üî¥ Failed to get user settings for user_422246: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1626012Z 2025-08-10 01:10:55,162 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:55.1627166Z 2025-08-10 01:10:55,162 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:55.1657542Z 2025-08-10 01:10:55,165 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:10:55.1666267Z Args: ('mcp-comprehensive-test-user', 'Original Campaign Title', 'Character: Update Test Hero | Setting: Update Test World | Description: Original description', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 10, 55, 162179, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-comprehensive-test-user'}, [], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:10:55.1671288Z Kwargs: {}
2025-08-10T01:10:55.1672508Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1673840Z Traceback:
2025-08-10T01:10:55.1674199Z Traceback (most recent call last):
2025-08-10T01:10:55.1675072Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:55.1675558Z     asyncio.get_running_loop()
2025-08-10T01:10:55.1675800Z RuntimeError: no running event loop
2025-08-10T01:10:55.1676049Z
2025-08-10T01:10:55.1676223Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:55.1676494Z
2025-08-10T01:10:55.1676589Z Traceback (most recent call last):
2025-08-10T01:10:55.1677095Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:55.1677982Z     return func(*args, **kwargs)
2025-08-10T01:10:55.1678233Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1678781Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:10:55.1679308Z     db = get_db()
2025-08-10T01:10:55.1679486Z          ^^^^^^^^
2025-08-10T01:10:55.1680428Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:55.1681358Z     return firestore.client()
2025-08-10T01:10:55.1681771Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1682855Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:55.1684232Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:55.1684981Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1686240Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:55.1687635Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:55.1688600Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1689820Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:55.1691004Z     self._services[name] = initializer(self)
2025-08-10T01:10:55.1691478Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1692622Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:55.1693915Z     credentials = app.credential.get_credential()
2025-08-10T01:10:55.1694420Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1695687Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:55.1696923Z     self._load_credential()
2025-08-10T01:10:55.1698360Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:55.1699839Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:55.1700524Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1701680Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:55.1703108Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:55.1705071Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1706831Z --- END EXCEPTION ---
2025-08-10T01:10:55.1709545Z 2025-08-10 01:10:55,165 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1711803Z 2025-08-10 01:10:55,170 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_by_id ---
2025-08-10T01:10:55.1714114Z Args: ('mcp-comprehensive-test-user', 'non-existent-campaign-id')
2025-08-10T01:10:55.1714746Z Kwargs: {}
2025-08-10T01:10:55.1717982Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1719352Z Traceback:
2025-08-10T01:10:55.1719909Z Traceback (most recent call last):
2025-08-10T01:10:55.1720785Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:55.1721618Z     asyncio.get_running_loop()
2025-08-10T01:10:55.1722054Z RuntimeError: no running event loop
2025-08-10T01:10:55.1722346Z
2025-08-10T01:10:55.1722644Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:55.1723297Z
2025-08-10T01:10:55.1723459Z Traceback (most recent call last):
2025-08-10T01:10:55.1724337Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:55.1725202Z     return func(*args, **kwargs)
2025-08-10T01:10:55.1725605Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1726573Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 470, in get_campaign_by_id
2025-08-10T01:10:55.1727525Z     db = get_db()
2025-08-10T01:10:55.1728113Z          ^^^^^^^^
2025-08-10T01:10:55.1728964Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:55.1729869Z     return firestore.client()
2025-08-10T01:10:55.1730271Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1731402Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:55.1732774Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:55.1733539Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1734807Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:55.1736663Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:55.1737356Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1738838Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:55.1740088Z     self._services[name] = initializer(self)
2025-08-10T01:10:55.1740580Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1741965Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:55.1743201Z     credentials = app.credential.get_credential()
2025-08-10T01:10:55.1743736Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1745028Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:55.1746291Z     self._load_credential()
2025-08-10T01:10:55.1747559Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:55.1749315Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:55.1750015Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1751264Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:55.1752754Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:55.1754666Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1756316Z --- END EXCEPTION ---
2025-08-10T01:10:55.1795249Z 2025-08-10 01:10:55,170 - root - ERROR - üî•üî¥ Failed to update campaign: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1797470Z .2025-08-10 01:10:55,173 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:55.1799425Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:55.1801187Z   setup_file_logging()
2025-08-10T01:10:55.1801794Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:55.1830650Z 2025-08-10 01:10:55,182 - main - INFO - Received campaign creation request:
2025-08-10T01:10:55.1833734Z 2025-08-10 01:10:55,182 - main - INFO -   Character: Test Hero 0
2025-08-10T01:10:55.1834730Z 2025-08-10 01:10:55,182 - main - INFO -   Setting: Concurrent Test Realm
2025-08-10T01:10:55.1835459Z 2025-08-10 01:10:55,183 - main - INFO -   Description: Testing concurrent request 0
2025-08-10T01:10:55.1836152Z 2025-08-10 01:10:55,183 - main - INFO -   Custom options: []
2025-08-10T01:10:55.1836640Z 2025-08-10 01:10:55,183 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:55.1870988Z 2025-08-10 01:10:55,186 - root - ERROR - üî•üî¥ Failed to get user settings for user_422246: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1873937Z 2025-08-10 01:10:55,186 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:55.1874519Z 2025-08-10 01:10:55,186 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:55.1902845Z 2025-08-10 01:10:55,189 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:10:55.1913129Z Args: ('mcp-comprehensive-test-user', 'Concurrent Test Campaign 0', 'Character: Test Hero 0 | Setting: Concurrent Test Realm | Description: Testing concurrent request 0', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 10, 55, 186752, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-comprehensive-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:10:55.1917124Z Kwargs: {}
2025-08-10T01:10:55.1918453Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1919729Z Traceback:
2025-08-10T01:10:55.1920094Z Traceback (most recent call last):
2025-08-10T01:10:55.1920975Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:55.1921847Z     asyncio.get_running_loop()
2025-08-10T01:10:55.1922293Z RuntimeError: no running event loop
2025-08-10T01:10:55.1922600Z
2025-08-10T01:10:55.1922909Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:55.1923388Z
2025-08-10T01:10:55.1923569Z Traceback (most recent call last):
2025-08-10T01:10:55.1924097Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:55.1924572Z     return func(*args, **kwargs)
2025-08-10T01:10:55.1924810Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1925333Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:10:55.1926058Z     db = get_db()
2025-08-10T01:10:55.1926236Z          ^^^^^^^^
2025-08-10T01:10:55.1926696Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:55.1927196Z     return firestore.client()
2025-08-10T01:10:55.1927418Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1928362Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:55.1929465Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:55.1930340Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1931925Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:55.1933518Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:55.1934209Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1935437Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:55.1936971Z     self._services[name] = initializer(self)
2025-08-10T01:10:55.1937459Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1938946Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:55.1939935Z     credentials = app.credential.get_credential()
2025-08-10T01:10:55.1940238Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1941005Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:55.1941668Z     self._load_credential()
2025-08-10T01:10:55.1942328Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:55.1943088Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:55.1943465Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1944104Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:55.1944854Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:55.1945838Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1946690Z --- END EXCEPTION ---
2025-08-10T01:10:55.1947878Z 2025-08-10 01:10:55,189 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1948819Z 2025-08-10 01:10:55,190 - main - INFO - Received campaign creation request:
2025-08-10T01:10:55.1949206Z 2025-08-10 01:10:55,190 - main - INFO -   Character: Test Hero 1
2025-08-10T01:10:55.1949577Z 2025-08-10 01:10:55,190 - main - INFO -   Setting: Concurrent Test Realm
2025-08-10T01:10:55.1949983Z 2025-08-10 01:10:55,190 - main - INFO -   Description: Testing concurrent request 1
2025-08-10T01:10:55.1950366Z 2025-08-10 01:10:55,190 - main - INFO -   Custom options: []
2025-08-10T01:10:55.1950730Z 2025-08-10 01:10:55,191 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:55.1953141Z 2025-08-10 01:10:55,193 - root - ERROR - üî•üî¥ Failed to get user settings for user_422246: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1955804Z 2025-08-10 01:10:55,193 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:55.1956652Z 2025-08-10 01:10:55,193 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:55.1961776Z 2025-08-10 01:10:55,196 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:10:55.1968806Z Args: ('mcp-comprehensive-test-user', 'Concurrent Test Campaign 1', 'Character: Test Hero 1 | Setting: Concurrent Test Realm | Description: Testing concurrent request 1', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 10, 55, 193262, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-comprehensive-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:10:55.1974083Z Kwargs: {}
2025-08-10T01:10:55.1975465Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1976722Z Traceback:
2025-08-10T01:10:55.1977063Z Traceback (most recent call last):
2025-08-10T01:10:55.1978268Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:55.1979084Z     asyncio.get_running_loop()
2025-08-10T01:10:55.1979503Z RuntimeError: no running event loop
2025-08-10T01:10:55.1979782Z
2025-08-10T01:10:55.1980071Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:55.1980512Z
2025-08-10T01:10:55.1980627Z Traceback (most recent call last):
2025-08-10T01:10:55.1981225Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:55.1981744Z     return func(*args, **kwargs)
2025-08-10T01:10:55.1981968Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1982495Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:10:55.1983000Z     db = get_db()
2025-08-10T01:10:55.1983176Z          ^^^^^^^^
2025-08-10T01:10:55.1983608Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:55.1984098Z     return firestore.client()
2025-08-10T01:10:55.1984319Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1984920Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:55.1985656Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:55.1986057Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1986733Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:55.1987474Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:55.1988031Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1988674Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:55.1989306Z     self._services[name] = initializer(self)
2025-08-10T01:10:55.1989744Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1990364Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:55.1990994Z     credentials = app.credential.get_credential()
2025-08-10T01:10:55.1991378Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1992028Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:55.1992662Z     self._load_credential()
2025-08-10T01:10:55.1993284Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:55.1994022Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:55.1994388Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.1995010Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:55.1995954Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:55.1997983Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.1999626Z --- END EXCEPTION ---
2025-08-10T01:10:55.2001404Z 2025-08-10 01:10:55,196 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2003011Z 2025-08-10 01:10:55,197 - main - INFO - Received campaign creation request:
2025-08-10T01:10:55.2003733Z 2025-08-10 01:10:55,197 - main - INFO -   Character: Test Hero 2
2025-08-10T01:10:55.2004380Z 2025-08-10 01:10:55,197 - main - INFO -   Setting: Concurrent Test Realm
2025-08-10T01:10:55.2005080Z 2025-08-10 01:10:55,197 - main - INFO -   Description: Testing concurrent request 2
2025-08-10T01:10:55.2005731Z 2025-08-10 01:10:55,197 - main - INFO -   Custom options: []
2025-08-10T01:10:55.2006350Z 2025-08-10 01:10:55,197 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:55.2008571Z 2025-08-10 01:10:55,199 - root - ERROR - üî•üî¥ Failed to get user settings for user_422246: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2010321Z 2025-08-10 01:10:55,200 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:55.2011091Z 2025-08-10 01:10:55,200 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:55.2039327Z 2025-08-10 01:10:55,203 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:10:55.2049753Z Args: ('mcp-comprehensive-test-user', 'Concurrent Test Campaign 2', 'Character: Test Hero 2 | Setting: Concurrent Test Realm | Description: Testing concurrent request 2', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 10, 55, 200307, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-comprehensive-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:10:55.2054748Z Kwargs: {}
2025-08-10T01:10:55.2055886Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2057102Z Traceback:
2025-08-10T01:10:55.2057666Z Traceback (most recent call last):
2025-08-10T01:10:55.2058732Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:55.2059575Z     asyncio.get_running_loop()
2025-08-10T01:10:55.2060014Z RuntimeError: no running event loop
2025-08-10T01:10:55.2060311Z
2025-08-10T01:10:55.2060619Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:55.2061074Z
2025-08-10T01:10:55.2061244Z Traceback (most recent call last):
2025-08-10T01:10:55.2062124Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:55.2063003Z     return func(*args, **kwargs)
2025-08-10T01:10:55.2063394Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2064333Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:10:55.2065336Z     db = get_db()
2025-08-10T01:10:55.2065676Z          ^^^^^^^^
2025-08-10T01:10:55.2066513Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:55.2068077Z     return firestore.client()
2025-08-10T01:10:55.2068472Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2069524Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:55.2071119Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:55.2071851Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2073041Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:55.2074337Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:55.2074986Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2076215Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:55.2077437Z     self._services[name] = initializer(self)
2025-08-10T01:10:55.2078137Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2079310Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:55.2080545Z     credentials = app.credential.get_credential()
2025-08-10T01:10:55.2081047Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2082343Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:55.2083598Z     self._load_credential()
2025-08-10T01:10:55.2084838Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:55.2086314Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:55.2086991Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2088375Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:55.2089836Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:55.2091725Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2093635Z --- END EXCEPTION ---
2025-08-10T01:10:55.2095560Z 2025-08-10 01:10:55,203 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2097981Z .2025-08-10 01:10:55,206 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:55.2099773Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:55.2101272Z   setup_file_logging()
2025-08-10T01:10:55.2101882Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:55.2159864Z s2025-08-10 01:10:55,215 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:55.2169268Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:55.2170787Z   setup_file_logging()
2025-08-10T01:10:55.2171399Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:55.2236049Z 2025-08-10 01:10:55,223 - root - INFO - üéÆ LOADING GAME PAGE: user=mcp-comprehensive-test-user, campaign=invalid-mcp-campaign-id
2025-08-10T01:10:55.2513415Z 2025-08-10 01:10:55,251 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_by_id ---
2025-08-10T01:10:55.2516571Z Args: ('mcp-comprehensive-test-user', 'invalid-mcp-campaign-id')
2025-08-10T01:10:55.2517221Z Kwargs: {}
2025-08-10T01:10:55.2518617Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2519958Z Traceback:
2025-08-10T01:10:55.2520324Z Traceback (most recent call last):
2025-08-10T01:10:55.2521218Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:55.2522113Z     asyncio.get_running_loop()
2025-08-10T01:10:55.2522571Z RuntimeError: no running event loop
2025-08-10T01:10:55.2522878Z
2025-08-10T01:10:55.2523208Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:55.2524147Z
2025-08-10T01:10:55.2524341Z Traceback (most recent call last):
2025-08-10T01:10:55.2525279Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:55.2526199Z     return func(*args, **kwargs)
2025-08-10T01:10:55.2526661Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2527696Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 470, in get_campaign_by_id
2025-08-10T01:10:55.2530237Z     db = get_db()
2025-08-10T01:10:55.2530552Z          ^^^^^^^^
2025-08-10T01:10:55.2531356Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:55.2532279Z     return firestore.client()
2025-08-10T01:10:55.2532712Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2533845Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:55.2535418Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:55.2536187Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2537399Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:55.2539142Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:55.2539808Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2541088Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:55.2542476Z     self._services[name] = initializer(self)
2025-08-10T01:10:55.2542946Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2544071Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:55.2545303Z     credentials = app.credential.get_credential()
2025-08-10T01:10:55.2545804Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2547003Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:55.2548384Z     self._load_credential()
2025-08-10T01:10:55.2549570Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:55.2550947Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:55.2551625Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2552751Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:55.2554137Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:55.2555980Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2557608Z --- END EXCEPTION ---
2025-08-10T01:10:55.2559722Z 2025-08-10 01:10:55,251 - root - ERROR - üî•üî¥ Failed to get campaign state: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2561519Z 2025-08-10 01:10:55,252 - main - INFO - Received campaign creation request:
2025-08-10T01:10:55.2562206Z 2025-08-10 01:10:55,252 - main - INFO -   Character:
2025-08-10T01:10:55.2562736Z 2025-08-10 01:10:55,252 - main - INFO -   Setting:
2025-08-10T01:10:55.2563278Z 2025-08-10 01:10:55,252 - main - INFO -   Description:
2025-08-10T01:10:55.2563898Z 2025-08-10 01:10:55,252 - main - INFO -   Custom options: []
2025-08-10T01:10:55.2564557Z 2025-08-10 01:10:55,252 - main - INFO -   Selected prompts: []
2025-08-10T01:10:55.2568816Z .2025-08-10 01:10:55,255 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:55.2570599Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:55.2572097Z   setup_file_logging()
2025-08-10T01:10:55.2572699Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:55.2628817Z 2025-08-10 01:10:55,262 - main - INFO - Received campaign creation request:
2025-08-10T01:10:55.2629925Z 2025-08-10 01:10:55,262 - main - INFO -   Character: Export Test Hero
2025-08-10T01:10:55.2630546Z 2025-08-10 01:10:55,262 - main - INFO -   Setting: Export Test World
2025-08-10T01:10:55.2631010Z 2025-08-10 01:10:55,262 - main - INFO -   Description:
2025-08-10T01:10:55.2631362Z 2025-08-10 01:10:55,262 - main - INFO -   Custom options: []
2025-08-10T01:10:55.2631717Z 2025-08-10 01:10:55,262 - main - INFO -   Selected prompts: []
2025-08-10T01:10:55.2651256Z 2025-08-10 01:10:55,264 - root - ERROR - üî•üî¥ Failed to get user settings for user_422246: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2653645Z 2025-08-10 01:10:55,264 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:55.2654434Z 2025-08-10 01:10:55,265 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:55.2736207Z 2025-08-10 01:10:55,273 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:10:55.2741635Z Args: ('mcp-comprehensive-test-user', 'Export Test Campaign', 'Character: Export Test Hero | Setting: Export Test World', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 10, 55, 264940, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-comprehensive-test-user'}, [], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:10:55.2758152Z Kwargs: {}
2025-08-10T01:10:55.2759335Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2760610Z Traceback:
2025-08-10T01:10:55.2760945Z Traceback (most recent call last):
2025-08-10T01:10:55.2762358Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:55.2763882Z     asyncio.get_running_loop()
2025-08-10T01:10:55.2764327Z RuntimeError: no running event loop
2025-08-10T01:10:55.2764638Z
2025-08-10T01:10:55.2764947Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:55.2765425Z
2025-08-10T01:10:55.2765600Z Traceback (most recent call last):
2025-08-10T01:10:55.2766544Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:55.2767453Z     return func(*args, **kwargs)
2025-08-10T01:10:55.2768707Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2769757Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:10:55.2770748Z     db = get_db()
2025-08-10T01:10:55.2771052Z          ^^^^^^^^
2025-08-10T01:10:55.2771886Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:55.2772848Z     return firestore.client()
2025-08-10T01:10:55.2773262Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2774402Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:55.2775812Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:55.2776579Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2778031Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:55.2779487Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:55.2780173Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2781410Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:55.2782642Z     self._services[name] = initializer(self)
2025-08-10T01:10:55.2783353Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2784603Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:55.2785837Z     credentials = app.credential.get_credential()
2025-08-10T01:10:55.2786595Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2788170Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:55.2789404Z     self._load_credential()
2025-08-10T01:10:55.2790643Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:55.2792103Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:55.2792806Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2794012Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:55.2795457Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:55.2797359Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2799195Z --- END EXCEPTION ---
2025-08-10T01:10:55.2801138Z 2025-08-10 01:10:55,273 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2803079Z .2025-08-10 01:10:55,276 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:55.2804845Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:55.2806346Z   setup_file_logging()
2025-08-10T01:10:55.2806957Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:55.2843388Z 2025-08-10 01:10:55,284 - main - INFO - Received campaign creation request:
2025-08-10T01:10:55.2846874Z 2025-08-10 01:10:55,284 - main - INFO -   Character: Comprehensive Test Hero
2025-08-10T01:10:55.2847571Z 2025-08-10 01:10:55,284 - main - INFO -   Setting: Integration Test Realm
2025-08-10T01:10:55.2848335Z 2025-08-10 01:10:55,284 - main - INFO -   Description: Testing complete MCP architecture workflow
2025-08-10T01:10:55.2848786Z 2025-08-10 01:10:55,284 - main - INFO -   Custom options: []
2025-08-10T01:10:55.2849379Z 2025-08-10 01:10:55,284 - main - INFO -   Selected prompts: ['narrative', 'combat']
2025-08-10T01:10:55.2868682Z 2025-08-10 01:10:55,286 - root - ERROR - üî•üî¥ Failed to get user settings for user_422246: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2871172Z 2025-08-10 01:10:55,286 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:55.2872137Z 2025-08-10 01:10:55,286 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:55.2896060Z 2025-08-10 01:10:55,289 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:10:55.2902887Z Args: ('mcp-comprehensive-test-user', 'MCP Integration Test Campaign', 'Character: Comprehensive Test Hero | Setting: Integration Test Realm | Description: Testing complete MCP architecture workflow', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 10, 55, 286676, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-comprehensive-test-user'}, ['narrative', 'combat'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:10:55.2910298Z Kwargs: {}
2025-08-10T01:10:55.2911464Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2912685Z Traceback:
2025-08-10T01:10:55.2913009Z Traceback (most recent call last):
2025-08-10T01:10:55.2913867Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:55.2914703Z     asyncio.get_running_loop()
2025-08-10T01:10:55.2915141Z RuntimeError: no running event loop
2025-08-10T01:10:55.2915440Z
2025-08-10T01:10:55.2915744Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:55.2916228Z
2025-08-10T01:10:55.2916391Z Traceback (most recent call last):
2025-08-10T01:10:55.2917272Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:55.2918351Z     return func(*args, **kwargs)
2025-08-10T01:10:55.2918747Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2919692Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:10:55.2920612Z     db = get_db()
2025-08-10T01:10:55.2920927Z          ^^^^^^^^
2025-08-10T01:10:55.2922113Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:55.2923073Z     return firestore.client()
2025-08-10T01:10:55.2931044Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2932247Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:55.2933698Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:55.2934463Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2935759Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:55.2937159Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:55.2938122Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2939377Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:55.2940587Z     self._services[name] = initializer(self)
2025-08-10T01:10:55.2941075Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2942269Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:55.2943497Z     credentials = app.credential.get_credential()
2025-08-10T01:10:55.2944042Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2945325Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:55.2946559Z     self._load_credential()
2025-08-10T01:10:55.2951765Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:55.2953509Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:55.2954230Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.2955449Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:55.2957139Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:55.2959659Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2961317Z --- END EXCEPTION ---
2025-08-10T01:10:55.2963194Z 2025-08-10 01:10:55,289 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.2965175Z .2025-08-10 01:10:55,292 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:55.2966954Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:55.2968633Z   setup_file_logging()
2025-08-10T01:10:55.2969238Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:55.3002332Z 2025-08-10 01:10:55,300 - main - INFO - Received campaign creation request:
2025-08-10T01:10:55.3005608Z 2025-08-10 01:10:55,300 - main - INFO -   Character: God Mode Test Hero
2025-08-10T01:10:55.3006275Z 2025-08-10 01:10:55,300 - main - INFO -   Setting: God Mode Realm
2025-08-10T01:10:55.3006852Z 2025-08-10 01:10:55,300 - main - INFO -   Description:
2025-08-10T01:10:55.3007328Z 2025-08-10 01:10:55,300 - main - INFO -   Custom options: []
2025-08-10T01:10:55.3007938Z 2025-08-10 01:10:55,300 - main - INFO -   Selected prompts: []
2025-08-10T01:10:55.3030740Z 2025-08-10 01:10:55,302 - root - ERROR - üî•üî¥ Failed to get user settings for user_422246: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.3032837Z 2025-08-10 01:10:55,302 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:55.3033722Z 2025-08-10 01:10:55,302 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:55.3059425Z 2025-08-10 01:10:55,305 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:10:55.3064267Z Args: ('mcp-comprehensive-test-user', 'God Mode Test Campaign', 'Character: God Mode Test Hero | Setting: God Mode Realm', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 10, 55, 302832, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-comprehensive-test-user'}, [], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:10:55.3070900Z Kwargs: {}
2025-08-10T01:10:55.3072078Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.3073341Z Traceback:
2025-08-10T01:10:55.3073891Z Traceback (most recent call last):
2025-08-10T01:10:55.3074766Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:55.3075613Z     asyncio.get_running_loop()
2025-08-10T01:10:55.3076047Z RuntimeError: no running event loop
2025-08-10T01:10:55.3076348Z
2025-08-10T01:10:55.3076650Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:55.3077323Z
2025-08-10T01:10:55.3077486Z Traceback (most recent call last):
2025-08-10T01:10:55.3078589Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:55.3079518Z     return func(*args, **kwargs)
2025-08-10T01:10:55.3079909Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3080844Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:10:55.3081785Z     db = get_db()
2025-08-10T01:10:55.3082123Z          ^^^^^^^^
2025-08-10T01:10:55.3082977Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:55.3083927Z     return firestore.client()
2025-08-10T01:10:55.3084350Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3085472Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:55.3086930Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:55.3087689Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3089185Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:55.3090627Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:55.3091300Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3092535Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:55.3093783Z     self._services[name] = initializer(self)
2025-08-10T01:10:55.3094269Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3095459Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:55.3096699Z     credentials = app.credential.get_credential()
2025-08-10T01:10:55.3097201Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3098723Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:55.3099989Z     self._load_credential()
2025-08-10T01:10:55.3101209Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:55.3102683Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:55.3103355Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3104561Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:55.3106049Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:55.3113684Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.3115383Z --- END EXCEPTION ---
2025-08-10T01:10:55.3117280Z 2025-08-10 01:10:55,305 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.3119696Z .2025-08-10 01:10:55,308 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:55.3121520Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:55.3123235Z   setup_file_logging()
2025-08-10T01:10:55.3123849Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:55.3161426Z 2025-08-10 01:10:55,315 - main - INFO - Received campaign creation request:
2025-08-10T01:10:55.3164724Z 2025-08-10 01:10:55,315 - main - INFO -   Character: Test Character
2025-08-10T01:10:55.3165363Z 2025-08-10 01:10:55,316 - main - INFO -   Setting: Test Setting
2025-08-10T01:10:55.3166117Z 2025-08-10 01:10:55,316 - main - INFO -   Description: Testing interaction workflow
2025-08-10T01:10:55.3166571Z 2025-08-10 01:10:55,316 - main - INFO -   Custom options: []
2025-08-10T01:10:55.3167496Z 2025-08-10 01:10:55,316 - main - INFO -   Selected prompts: []
2025-08-10T01:10:55.3184463Z 2025-08-10 01:10:55,318 - root - ERROR - üî•üî¥ Failed to get user settings for user_422246: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.3187569Z 2025-08-10 01:10:55,318 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:55.3188866Z 2025-08-10 01:10:55,318 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:55.3209890Z 2025-08-10 01:10:55,320 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:10:55.3215349Z Args: ('mcp-comprehensive-test-user', 'MCP Interaction Test', 'Character: Test Character | Setting: Test Setting | Description: Testing interaction workflow', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 10, 55, 318265, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-comprehensive-test-user'}, [], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:10:55.3220172Z Kwargs: {}
2025-08-10T01:10:55.3221425Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.3222653Z Traceback:
2025-08-10T01:10:55.3222992Z Traceback (most recent call last):
2025-08-10T01:10:55.3223845Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:10:55.3224676Z     asyncio.get_running_loop()
2025-08-10T01:10:55.3225096Z RuntimeError: no running event loop
2025-08-10T01:10:55.3225400Z
2025-08-10T01:10:55.3225699Z During handling of the above exception, another exception occurred:
2025-08-10T01:10:55.3226144Z
2025-08-10T01:10:55.3226310Z Traceback (most recent call last):
2025-08-10T01:10:55.3227160Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:10:55.3228194Z     return func(*args, **kwargs)
2025-08-10T01:10:55.3228603Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3229531Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:10:55.3230671Z     db = get_db()
2025-08-10T01:10:55.3230982Z          ^^^^^^^^
2025-08-10T01:10:55.3231774Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:10:55.3232663Z     return firestore.client()
2025-08-10T01:10:55.3233037Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3234086Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:10:55.3235749Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:10:55.3236499Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3238006Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:10:55.3239469Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:10:55.3240182Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3241394Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:10:55.3242620Z     self._services[name] = initializer(self)
2025-08-10T01:10:55.3243097Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3244239Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:10:55.3245459Z     credentials = app.credential.get_credential()
2025-08-10T01:10:55.3245989Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3247228Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:10:55.3248655Z     self._load_credential()
2025-08-10T01:10:55.3249864Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:10:55.3251297Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:10:55.3251988Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:10:55.3253171Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:10:55.3254620Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:10:55.3256452Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.3258295Z --- END EXCEPTION ---
2025-08-10T01:10:55.3260082Z 2025-08-10 01:10:55,320 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.3261829Z .2025-08-10 01:10:55,323 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:55.3263479Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:55.3264938Z   setup_file_logging()
2025-08-10T01:10:55.3265557Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:55.3335789Z 2025-08-10 01:10:55,333 - root - ERROR - üî•üî¥ Failed to get user settings for user_422246: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.3363815Z 2025-08-10 01:10:55,336 - root - ERROR - üî•üî¥ Failed to get user settings for user_422246: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:10:55.3367464Z .
2025-08-10T01:10:55.3368417Z ----------------------------------------------------------------------
2025-08-10T01:10:55.3369164Z Ran 10 tests in 3.183s
2025-08-10T01:10:55.3371517Z
2025-08-10T01:10:55.3371657Z OK (skipped=1)
2025-08-10T01:10:55.3373507Z Warning: Could not start MCP server for comprehensive tests: HTTPConnectionPool(host='localhost', port=8003): Max retries exceeded with url: / (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8796718d90>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-08-10T01:10:55.3375330Z Falling back to mock-only testing
2025-08-10T01:10:55.5509847Z ‚úÖ PASS: tests/test_end2end/test_mcp_integration_comprehensive.py
2025-08-10T01:10:55.5511317Z ----------------------------------------
2025-08-10T01:10:55.5511860Z Running: tests/test_end2end/test_mcp_protocol_end2end.py
2025-08-10T01:10:55.8817420Z 2025-08-10 01:10:55,881 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:55.8938662Z sssssssss
2025-08-10T01:10:55.8939769Z ----------------------------------------------------------------------
2025-08-10T01:10:55.8941622Z Ran 9 tests in 0.000s
2025-08-10T01:10:55.8943060Z
2025-08-10T01:10:55.8943318Z OK (skipped=9)
2025-08-10T01:10:55.9491174Z ‚úÖ PASS: tests/test_end2end/test_mcp_protocol_end2end.py
2025-08-10T01:10:55.9494263Z ----------------------------------------
2025-08-10T01:10:55.9494795Z Running: tests/test_end2end/test_settings_e2e.py
2025-08-10T01:10:56.2862487Z 2025-08-10 01:10:56,285 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:57.0142794Z 2025-08-10 01:10:57,014 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:57.0153907Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:57.0155963Z   setup_file_logging()
2025-08-10T01:10:57.0157093Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:57.2214191Z 2025-08-10 01:10:57,221 - root - INFO - Updated settings for user e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:57.2217481Z 2025-08-10 01:10:57,221 - root - INFO - Updated user settings for e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:57.2231956Z 2025-08-10 01:10:57,223 - main - INFO - Received campaign creation request:
2025-08-10T01:10:57.2233123Z 2025-08-10 01:10:57,223 - main - INFO -   Character: MCP Switch Hero
2025-08-10T01:10:57.2234232Z 2025-08-10 01:10:57,223 - main - INFO -   Setting: MCP Switch World
2025-08-10T01:10:57.2235128Z 2025-08-10 01:10:57,223 - main - INFO -   Description: Testing model switching via MCP
2025-08-10T01:10:57.2235809Z 2025-08-10 01:10:57,223 - main - INFO -   Custom options: []
2025-08-10T01:10:57.2242715Z 2025-08-10 01:10:57,223 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:57.2243860Z 2025-08-10 01:10:57,223 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:57.2244997Z 2025-08-10 01:10:57,223 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:57.2250746Z 2025-08-10 01:10:57,224 - root - INFO - ‚úÖ Write-then-read (mock mode): user=e2e-mcp-test-user, campaign=generated-id-1, actor=user
2025-08-10T01:10:57.2252483Z 2025-08-10 01:10:57,225 - root - INFO - ‚úÖ Write-then-read (mock mode): user=e2e-mcp-test-user, campaign=generated-id-1, actor=gemini
2025-08-10T01:10:57.2266100Z 2025-08-10 01:10:57,226 - root - INFO - Updated settings for user e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:57.2267701Z 2025-08-10 01:10:57,226 - root - INFO - Updated user settings for e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:57.2275359Z 2025-08-10 01:10:57,227 - main - INFO - Received campaign creation request:
2025-08-10T01:10:57.2281861Z 2025-08-10 01:10:57,227 - main - INFO -   Character: MCP Switch Hero
2025-08-10T01:10:57.2282883Z 2025-08-10 01:10:57,227 - main - INFO -   Setting: MCP Switch World
2025-08-10T01:10:57.2283636Z 2025-08-10 01:10:57,227 - main - INFO -   Description: Testing model switching via MCP
2025-08-10T01:10:57.2284392Z 2025-08-10 01:10:57,227 - main - INFO -   Custom options: []
2025-08-10T01:10:57.2285085Z 2025-08-10 01:10:57,227 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:57.2285923Z 2025-08-10 01:10:57,227 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:57.2286732Z 2025-08-10 01:10:57,227 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:57.2288139Z 2025-08-10 01:10:57,227 - root - INFO - ‚úÖ Write-then-read (mock mode): user=e2e-mcp-test-user, campaign=generated-id-2, actor=user
2025-08-10T01:10:57.2289911Z 2025-08-10 01:10:57,228 - root - INFO - ‚úÖ Write-then-read (mock mode): user=e2e-mcp-test-user, campaign=generated-id-2, actor=gemini
2025-08-10T01:10:57.2310068Z .2025-08-10 01:10:57,230 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:57.2312982Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:57.2314476Z   setup_file_logging()
2025-08-10T01:10:57.2315105Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:57.2394991Z 2025-08-10 01:10:57,239 - root - INFO - Updated settings for user e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:57.2397328Z 2025-08-10 01:10:57,239 - root - INFO - Updated user settings for e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:57.2410685Z 2025-08-10 01:10:57,240 - main - INFO - Received campaign creation request:
2025-08-10T01:10:57.2412443Z 2025-08-10 01:10:57,241 - main - INFO -   Character: MCP Hero
2025-08-10T01:10:57.2413648Z 2025-08-10 01:10:57,241 - main - INFO -   Setting: MCP World
2025-08-10T01:10:57.2415385Z 2025-08-10 01:10:57,241 - main - INFO -   Description: End-to-end test with MCP architecture
2025-08-10T01:10:57.2416847Z 2025-08-10 01:10:57,241 - main - INFO -   Custom options: []
2025-08-10T01:10:57.2418008Z 2025-08-10 01:10:57,241 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:57.2419228Z 2025-08-10 01:10:57,241 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:57.2422892Z 2025-08-10 01:10:57,241 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:57.2424150Z 2025-08-10 01:10:57,241 - root - INFO - ‚úÖ Write-then-read (mock mode): user=e2e-mcp-test-user, campaign=generated-id-1, actor=user
2025-08-10T01:10:57.2425567Z 2025-08-10 01:10:57,241 - root - INFO - ‚úÖ Write-then-read (mock mode): user=e2e-mcp-test-user, campaign=generated-id-1, actor=gemini
2025-08-10T01:10:57.2443448Z .2025-08-10 01:10:57,244 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:57.2445627Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:57.2447459Z   setup_file_logging()
2025-08-10T01:10:57.2448549Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:57.2529214Z 2025-08-10 01:10:57,252 - root - INFO - Updated settings for user e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:57.2530499Z 2025-08-10 01:10:57,252 - root - INFO - Updated user settings for e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:57.2538765Z 2025-08-10 01:10:57,253 - main - INFO - Received campaign creation request:
2025-08-10T01:10:57.2540121Z 2025-08-10 01:10:57,253 - main - INFO -   Character: MCP Pro Hero
2025-08-10T01:10:57.2542495Z 2025-08-10 01:10:57,253 - main - INFO -   Setting: MCP Pro World
2025-08-10T01:10:57.2543604Z 2025-08-10 01:10:57,253 - main - INFO -   Description: End-to-end test with pro model via MCP
2025-08-10T01:10:57.2545167Z 2025-08-10 01:10:57,253 - main - INFO -   Custom options: []
2025-08-10T01:10:57.2546457Z 2025-08-10 01:10:57,253 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:57.2547602Z 2025-08-10 01:10:57,254 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:57.2550199Z 2025-08-10 01:10:57,254 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:57.2551736Z 2025-08-10 01:10:57,254 - root - INFO - ‚úÖ Write-then-read (mock mode): user=e2e-mcp-test-user, campaign=generated-id-1, actor=user
2025-08-10T01:10:57.2557209Z 2025-08-10 01:10:57,254 - root - INFO - ‚úÖ Write-then-read (mock mode): user=e2e-mcp-test-user, campaign=generated-id-1, actor=gemini
2025-08-10T01:10:57.2570322Z .2025-08-10 01:10:57,256 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:57.2572483Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:57.2574379Z   setup_file_logging()
2025-08-10T01:10:57.2575417Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:57.2661362Z 2025-08-10 01:10:57,266 - root - INFO - Updated settings for user e2e-mcp-user-1: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:57.2662981Z 2025-08-10 01:10:57,266 - root - INFO - Updated user settings for e2e-mcp-user-1: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:57.2670688Z 2025-08-10 01:10:57,266 - root - INFO - Updated settings for user e2e-mcp-user-2: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:57.2672292Z 2025-08-10 01:10:57,267 - root - INFO - Updated user settings for e2e-mcp-user-2: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:57.2702610Z .2025-08-10 01:10:57,270 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:57.2704794Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:57.2706632Z   setup_file_logging()
2025-08-10T01:10:57.2707645Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:57.2785800Z 2025-08-10 01:10:57,278 - root - INFO - Updated settings for user e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:57.2787441Z 2025-08-10 01:10:57,278 - root - INFO - Updated user settings for e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:57.2800946Z 2025-08-10 01:10:57,279 - root - INFO - Updated settings for user e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:57.2802573Z 2025-08-10 01:10:57,280 - root - INFO - Updated user settings for e2e-mcp-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:57.2812342Z .
2025-08-10T01:10:57.2815352Z ----------------------------------------------------------------------
2025-08-10T01:10:57.2815842Z Ran 5 tests in 0.269s
2025-08-10T01:10:57.2816044Z
2025-08-10T01:10:57.2816167Z OK
2025-08-10T01:10:57.2816686Z üîµ Layer 4: Running end-to-end tests with MCP architecture
2025-08-10T01:10:57.2817283Z üìù NOTE: Tests MCP API gateway routing behavior
2025-08-10T01:10:57.4772046Z ‚úÖ PASS: tests/test_end2end/test_settings_e2e.py
2025-08-10T01:10:57.4773531Z ----------------------------------------
2025-08-10T01:10:57.4783538Z Running: tests/test_end2end/test_settings_integration.py
2025-08-10T01:10:57.8114134Z 2025-08-10 01:10:57,811 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.5335525Z 2025-08-10 01:10:58,533 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.5346710Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.5349405Z   setup_file_logging()
2025-08-10T01:10:58.5350562Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.5466004Z .2025-08-10 01:10:58,546 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.5468252Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.5470137Z   setup_file_logging()
2025-08-10T01:10:58.5471816Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.5552264Z 2025-08-10 01:10:58,555 - main - INFO - Received campaign creation request:
2025-08-10T01:10:58.5553409Z 2025-08-10 01:10:58,555 - main - INFO -   Character: MCP Test Hero
2025-08-10T01:10:58.5554439Z 2025-08-10 01:10:58,555 - main - INFO -   Setting: MCP Test World
2025-08-10T01:10:58.5555724Z 2025-08-10 01:10:58,555 - main - INFO -   Description: Integration test campaign through MCP
2025-08-10T01:10:58.5556918Z 2025-08-10 01:10:58,555 - main - INFO -   Custom options: []
2025-08-10T01:10:58.5558202Z 2025-08-10 01:10:58,555 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:58.7476987Z 2025-08-10 01:10:58,747 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:58.7480367Z 2025-08-10 01:10:58,747 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:58.7486883Z 2025-08-10 01:10:58,748 - root - INFO - ‚úÖ Write-then-read (mock mode): user=mcp-integration-test-user, campaign=generated-id-1, actor=user
2025-08-10T01:10:58.7489221Z 2025-08-10 01:10:58,748 - root - INFO - ‚úÖ Write-then-read (mock mode): user=mcp-integration-test-user, campaign=generated-id-1, actor=gemini
2025-08-10T01:10:58.7520529Z .2025-08-10 01:10:58,751 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.7522589Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.7524472Z   setup_file_logging()
2025-08-10T01:10:58.7525409Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.7606758Z 2025-08-10 01:10:58,760 - main - INFO - Received campaign creation request:
2025-08-10T01:10:58.7608261Z 2025-08-10 01:10:58,760 - main - INFO -   Character: MCP Test Hero
2025-08-10T01:10:58.7609196Z 2025-08-10 01:10:58,760 - main - INFO -   Setting: MCP Test World
2025-08-10T01:10:58.7610338Z 2025-08-10 01:10:58,760 - main - INFO -   Description: Integration test campaign through MCP
2025-08-10T01:10:58.7611456Z 2025-08-10 01:10:58,760 - main - INFO -   Custom options: []
2025-08-10T01:10:58.7612536Z 2025-08-10 01:10:58,760 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:58.7613745Z 2025-08-10 01:10:58,760 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:58.7615053Z 2025-08-10 01:10:58,761 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:58.7616572Z 2025-08-10 01:10:58,761 - root - INFO - ‚úÖ Write-then-read (mock mode): user=mcp-integration-test-user, campaign=generated-id-1, actor=user
2025-08-10T01:10:58.7619032Z 2025-08-10 01:10:58,761 - root - INFO - ‚úÖ Write-then-read (mock mode): user=mcp-integration-test-user, campaign=generated-id-1, actor=gemini
2025-08-10T01:10:58.7639206Z .2025-08-10 01:10:58,763 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.7642513Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.7644005Z   setup_file_logging()
2025-08-10T01:10:58.7644640Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.7724321Z 2025-08-10 01:10:58,772 - main - INFO - Received campaign creation request:
2025-08-10T01:10:58.7726805Z 2025-08-10 01:10:58,772 - main - INFO -   Character: MCP Test Hero
2025-08-10T01:10:58.7729396Z 2025-08-10 01:10:58,772 - main - INFO -   Setting: MCP Test World
2025-08-10T01:10:58.7733035Z 2025-08-10 01:10:58,772 - main - INFO -   Description: Integration test campaign through MCP
2025-08-10T01:10:58.7733883Z 2025-08-10 01:10:58,772 - main - INFO -   Custom options: []
2025-08-10T01:10:58.7734599Z 2025-08-10 01:10:58,772 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:58.7735472Z 2025-08-10 01:10:58,772 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:58.7736307Z 2025-08-10 01:10:58,772 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:58.7737659Z 2025-08-10 01:10:58,772 - root - INFO - ‚úÖ Write-then-read (mock mode): user=mcp-integration-test-user, campaign=generated-id-1, actor=user
2025-08-10T01:10:58.7741177Z 2025-08-10 01:10:58,773 - root - INFO - ‚úÖ Write-then-read (mock mode): user=mcp-integration-test-user, campaign=generated-id-1, actor=gemini
2025-08-10T01:10:58.7754389Z .2025-08-10 01:10:58,775 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.7757226Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.7759013Z   setup_file_logging()
2025-08-10T01:10:58.7759657Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.7854842Z .2025-08-10 01:10:58,785 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.7858758Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.7860284Z   setup_file_logging()
2025-08-10T01:10:58.7860911Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.7939276Z 2025-08-10 01:10:58,793 - root - INFO - Updated settings for user mcp-integration-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:58.7941024Z 2025-08-10 01:10:58,793 - root - INFO - Updated user settings for mcp-integration-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:58.7961044Z .2025-08-10 01:10:58,795 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.7963213Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.7964997Z   setup_file_logging()
2025-08-10T01:10:58.7965775Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.8043689Z 2025-08-10 01:10:58,804 - root - INFO - Updated settings for user mcp-integration-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:58.8045444Z 2025-08-10 01:10:58,804 - root - INFO - Updated user settings for mcp-integration-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:58.8053217Z 2025-08-10 01:10:58,805 - main - INFO - Received campaign creation request:
2025-08-10T01:10:58.8054330Z 2025-08-10 01:10:58,805 - main - INFO -   Character: MCP Test Hero
2025-08-10T01:10:58.8055265Z 2025-08-10 01:10:58,805 - main - INFO -   Setting: MCP Test World
2025-08-10T01:10:58.8057420Z 2025-08-10 01:10:58,805 - main - INFO -   Description: Integration test campaign through MCP
2025-08-10T01:10:58.8058434Z 2025-08-10 01:10:58,805 - main - INFO -   Custom options: []
2025-08-10T01:10:58.8059109Z 2025-08-10 01:10:58,805 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:58.8059939Z 2025-08-10 01:10:58,805 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:58.8061011Z 2025-08-10 01:10:58,805 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:58.8066262Z 2025-08-10 01:10:58,805 - root - INFO - ‚úÖ Write-then-read (mock mode): user=mcp-integration-test-user, campaign=generated-id-1, actor=user
2025-08-10T01:10:58.8068638Z 2025-08-10 01:10:58,806 - root - INFO - ‚úÖ Write-then-read (mock mode): user=mcp-integration-test-user, campaign=generated-id-1, actor=gemini
2025-08-10T01:10:58.8084437Z .2025-08-10 01:10:58,808 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.8088103Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.8089616Z   setup_file_logging()
2025-08-10T01:10:58.8090226Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.8260259Z .2025-08-10 01:10:58,825 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.8265778Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.8267326Z   setup_file_logging()
2025-08-10T01:10:58.8268219Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.8339458Z 2025-08-10 01:10:58,833 - main - INFO - Received campaign creation request:
2025-08-10T01:10:58.8344837Z 2025-08-10 01:10:58,833 - main - INFO -   Character: MCP Test Hero
2025-08-10T01:10:58.8345567Z 2025-08-10 01:10:58,833 - main - INFO -   Setting: MCP Test World
2025-08-10T01:10:58.8346372Z 2025-08-10 01:10:58,833 - main - INFO -   Description: Integration test campaign through MCP
2025-08-10T01:10:58.8347190Z 2025-08-10 01:10:58,833 - main - INFO -   Custom options: []
2025-08-10T01:10:58.8348102Z 2025-08-10 01:10:58,833 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:10:58.8348969Z 2025-08-10 01:10:58,834 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:10:58.8349817Z 2025-08-10 01:10:58,834 - root - INFO - Mock mode: No companions requested
2025-08-10T01:10:58.8351825Z 2025-08-10 01:10:58,834 - root - INFO - ‚úÖ Write-then-read (mock mode): user=mcp-integration-test-user, campaign=generated-id-1, actor=user
2025-08-10T01:10:58.8353885Z 2025-08-10 01:10:58,834 - root - INFO - ‚úÖ Write-then-read (mock mode): user=mcp-integration-test-user, campaign=generated-id-1, actor=gemini
2025-08-10T01:10:58.8369699Z .2025-08-10 01:10:58,836 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.8373055Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.8374574Z   setup_file_logging()
2025-08-10T01:10:58.8375168Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.8449205Z 2025-08-10 01:10:58,844 - root - INFO - Updated settings for user mcp-integration-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:58.8452654Z 2025-08-10 01:10:58,844 - root - INFO - Updated user settings for mcp-integration-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:58.8474390Z .2025-08-10 01:10:58,847 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.8476711Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.8482004Z   setup_file_logging()
2025-08-10T01:10:58.8482614Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.8557432Z 2025-08-10 01:10:58,855 - root - INFO - Updated settings for user mcp-integration-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:58.8559612Z 2025-08-10 01:10:58,855 - root - INFO - Updated user settings for mcp-integration-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:58.8566413Z 2025-08-10 01:10:58,856 - root - INFO - Updated settings for user mcp-integration-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:58.8568776Z 2025-08-10 01:10:58,856 - root - INFO - Updated user settings for mcp-integration-test-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:10:58.8586997Z 2025-08-10 01:10:58,858 - root - INFO - Updated settings for user mcp-integration-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:58.8589042Z 2025-08-10 01:10:58,858 - root - INFO - Updated user settings for mcp-integration-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:10:58.8608568Z .2025-08-10 01:10:58,860 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:58.8610787Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:10:58.8612527Z   setup_file_logging()
2025-08-10T01:10:58.8614039Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:10:58.8688476Z .
2025-08-10T01:10:58.8689308Z üîµ Running integration tests for settings flow through MCP architecture
2025-08-10T01:10:58.8690229Z ‚úÖ Consistent mock patching demonstrated
2025-08-10T01:10:58.8691026Z ‚úÖ Technical debt fixes applied successfully
2025-08-10T01:10:58.8692298Z ----------------------------------------------------------------------
2025-08-10T01:10:58.8692947Z Ran 12 tests in 0.337s
2025-08-10T01:10:58.8693249Z
2025-08-10T01:10:58.8693506Z OK
2025-08-10T01:10:59.0740297Z ‚úÖ PASS: tests/test_end2end/test_settings_integration.py
2025-08-10T01:10:59.0742278Z ----------------------------------------
2025-08-10T01:10:59.0742883Z Running: tests/test_end2end/test_visit_campaign_end2end.py
2025-08-10T01:10:59.4087153Z 2025-08-10 01:10:59,408 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:10:59.4210048Z sssss
2025-08-10T01:10:59.4211098Z ----------------------------------------------------------------------
2025-08-10T01:10:59.4211842Z Ran 5 tests in 0.000s
2025-08-10T01:10:59.4212229Z
2025-08-10T01:10:59.4212454Z OK (skipped=5)
2025-08-10T01:10:59.4749877Z ‚úÖ PASS: tests/test_end2end/test_visit_campaign_end2end.py
2025-08-10T01:10:59.4752935Z ----------------------------------------
2025-08-10T01:10:59.4753482Z Running: tests/test_entities_pydantic_integration.py
2025-08-10T01:10:59.7018409Z .................
2025-08-10T01:10:59.7020502Z ----------------------------------------------------------------------
2025-08-10T01:10:59.7021001Z Ran 17 tests in 0.002s
2025-08-10T01:10:59.7021200Z
2025-08-10T01:10:59.7021320Z OK
2025-08-10T01:10:59.7324054Z ‚úÖ PASS: tests/test_entities_pydantic_integration.py
2025-08-10T01:10:59.7325516Z ----------------------------------------
2025-08-10T01:10:59.7325965Z Running: tests/test_entity_classes.py
2025-08-10T01:10:59.9576132Z ......WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'level'. Using default: 1
2025-08-10T01:10:59.9578591Z .....WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp'. Using default: 1
2025-08-10T01:10:59.9579757Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'hp_max'. Using default: 1
2025-08-10T01:10:59.9580977Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'temp_hp'. Using default: 0
2025-08-10T01:10:59.9588378Z ..........WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'strength'. Using default: 10
2025-08-10T01:10:59.9592191Z WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'dexterity'. Using default: 10
2025-08-10T01:10:59.9593131Z WARNING:root:‚ö†Ô∏è Failed to convert 'invalid' to int for field 'constitution'. Using default: 10
2025-08-10T01:10:59.9594048Z .
2025-08-10T01:10:59.9594402Z ----------------------------------------------------------------------
2025-08-10T01:10:59.9594885Z Ran 22 tests in 0.002s
2025-08-10T01:10:59.9595088Z
2025-08-10T01:10:59.9595187Z OK
2025-08-10T01:10:59.9880319Z ‚úÖ PASS: tests/test_entity_classes.py
2025-08-10T01:10:59.9881321Z ----------------------------------------
2025-08-10T01:10:59.9881846Z Running: tests/test_entity_id_special_chars.py
2025-08-10T01:11:00.2138986Z .....
2025-08-10T01:11:00.2141325Z ----------------------------------------------------------------------
2025-08-10T01:11:00.2141829Z Ran 5 tests in 0.001s
2025-08-10T01:11:00.2142054Z
2025-08-10T01:11:00.2142172Z OK
2025-08-10T01:11:00.2455485Z ‚úÖ PASS: tests/test_entity_id_special_chars.py
2025-08-10T01:11:00.2456917Z ----------------------------------------
2025-08-10T01:11:00.2457396Z Running: tests/test_entity_instructions.py
2025-08-10T01:11:00.2931877Z .........................
2025-08-10T01:11:00.2932441Z ----------------------------------------------------------------------
2025-08-10T01:11:00.2933007Z Ran 25 tests in 0.002s
2025-08-10T01:11:00.2933225Z
2025-08-10T01:11:00.2933804Z OK
2025-08-10T01:11:00.3008279Z ‚úÖ PASS: tests/test_entity_instructions.py
2025-08-10T01:11:00.3009709Z ----------------------------------------
2025-08-10T01:11:00.3010173Z Running: tests/test_entity_preloader.py
2025-08-10T01:11:00.5245477Z .............
2025-08-10T01:11:00.5246484Z ----------------------------------------------------------------------
2025-08-10T01:11:00.5248230Z Ran 13 tests in 0.004s
2025-08-10T01:11:00.5248456Z
2025-08-10T01:11:00.5248570Z OK
2025-08-10T01:11:00.5462489Z ‚úÖ PASS: tests/test_entity_preloader.py
2025-08-10T01:11:00.5464057Z ----------------------------------------
2025-08-10T01:11:00.5464545Z Running: tests/test_entity_tracking.py
2025-08-10T01:11:00.7270437Z test_dual_pass_generator_integration (__main__.TestEntityTracking.test_dual_pass_generator_integration)
2025-08-10T01:11:00.7273459Z Test DualPassGenerator uses EntityValidator properly ... ok
2025-08-10T01:11:00.7274376Z test_edge_cases_and_robustness (__main__.TestEntityTracking.test_edge_cases_and_robustness)
2025-08-10T01:11:00.7275352Z Test edge cases for robustness ... ok
2025-08-10T01:11:00.7276450Z test_end_to_end_missing_entity_red_green_workflow (__main__.TestEntityTracking.test_end_to_end_missing_entity_red_green_workflow)
2025-08-10T01:11:00.7289519Z End-to-end RED-GREEN test: Demonstrates missing entity detection and handling ... ok
2025-08-10T01:11:00.7291198Z test_entity_id_format_standardization (__main__.TestEntityTracking.test_entity_id_format_standardization)
2025-08-10T01:11:00.7296115Z Test that entity IDs follow underscore format like 'pc_name_001' ... ok
2025-08-10T01:11:00.7298607Z test_entity_presence_type_detection (__main__.TestEntityTracking.test_entity_presence_type_detection)
2025-08-10T01:11:00.7300114Z Test EntityPresenceType detection in EntityValidator ... ok
2025-08-10T01:11:00.7302505Z test_entity_validator_comprehensive_validation (__main__.TestEntityTracking.test_entity_validator_comprehensive_validation)
2025-08-10T01:11:00.7303819Z Test EntityValidator's comprehensive validation method ... ok
2025-08-10T01:11:00.7305226Z test_existing_string_ids_preserved (__main__.TestEntityTracking.test_existing_string_ids_preserved)
2025-08-10T01:11:00.7307585Z Test that existing string_ids from game state are preserved ... ok
2025-08-10T01:11:00.7308733Z test_expected_entities_filtering (__main__.TestEntityTracking.test_expected_entities_filtering)
2025-08-10T01:11:00.7309728Z Test that expected entities correctly filters visible, conscious entities ... ok
2025-08-10T01:11:00.7310989Z test_get_validation_info (__main__.TestEntityTracking.test_get_validation_info)
2025-08-10T01:11:00.7311866Z Test get_validation_info function returns correct information. ... ok
2025-08-10T01:11:00.7312831Z test_injection_template_creation (__main__.TestEntityTracking.test_injection_template_creation)
2025-08-10T01:11:00.7313669Z Test entity injection template creation ... ok
2025-08-10T01:11:00.7314648Z test_integration_flow (__main__.TestEntityTracking.test_integration_flow)
2025-08-10T01:11:00.7315384Z Test the complete entity tracking flow ... ok
2025-08-10T01:11:00.7330155Z test_manifest_prompt_format (__main__.TestEntityTracking.test_manifest_prompt_format)
2025-08-10T01:11:00.7331029Z Test manifest to prompt format conversion ... ok
2025-08-10T01:11:00.7331863Z test_multiple_unknown_entities (__main__.TestEntityTracking.test_multiple_unknown_entities)
2025-08-10T01:11:00.7332793Z Test filtering multiple Unknown entities and variations ... ok
2025-08-10T01:11:00.7333671Z test_narrative_sync_validator (__main__.TestEntityTracking.test_narrative_sync_validator)
2025-08-10T01:11:00.7334511Z Test NarrativeSyncValidator functionality ... ok
2025-08-10T01:11:00.7335469Z test_narrative_sync_validator_delegation (__main__.TestEntityTracking.test_narrative_sync_validator_delegation)
2025-08-10T01:11:00.7339427Z Test that NarrativeSyncValidator properly delegates to EntityValidator ... ok
2025-08-10T01:11:00.7340415Z test_physical_state_extraction (__main__.TestEntityTracking.test_physical_state_extraction)
2025-08-10T01:11:00.7344505Z Test physical state extraction from EntityValidator ... ok
2025-08-10T01:11:00.7345244Z test_scene_manifest_creation (__main__.TestEntityTracking.test_scene_manifest_creation)
2025-08-10T01:11:00.7345915Z Test SceneManifest creation from game state ... ok
2025-08-10T01:11:00.7346624Z test_scene_transition_detection (__main__.TestEntityTracking.test_scene_transition_detection)
2025-08-10T01:11:00.7347388Z Test scene transition detection from EntityValidator ... ok
2025-08-10T01:11:00.7348462Z test_unknown_entity_filtering_comprehensive (__main__.TestEntityTracking.test_unknown_entity_filtering_comprehensive)
2025-08-10T01:11:00.7349471Z Test comprehensive Unknown entity filtering across all validators ... ok
2025-08-10T01:11:00.7350362Z test_validation_result_compatibility (__main__.TestEntityTracking.test_validation_result_compatibility)
2025-08-10T01:11:00.7351247Z Test ValidationResult supports both old and new interfaces ... ok
2025-08-10T01:11:00.7352063Z test_validator_presence_detection (__main__.TestEntityTracking.test_validator_presence_detection)
2025-08-10T01:11:00.7352935Z Test validator's presence detection logic (REFACTORED: uses EntityValidator) ... ok
2025-08-10T01:11:00.7353406Z
2025-08-10T01:11:00.7353601Z ----------------------------------------------------------------------
2025-08-10T01:11:00.7354039Z Ran 21 tests in 0.007s
2025-08-10T01:11:00.7354234Z
2025-08-10T01:11:00.7354340Z OK
2025-08-10T01:11:00.7354953Z üß™ Testing Entity Tracking Production Implementation
2025-08-10T01:11:00.7355416Z ============================================================
2025-08-10T01:11:00.7355681Z
2025-08-10T01:11:00.7355919Z üî¥ RED PHASE: Testing missing entity detection
2025-08-10T01:11:00.7356497Z    ‚ùå DETECTED MISSING: ['Sariel', 'Rowan', 'Tavern Keeper']
2025-08-10T01:11:00.7356975Z    ‚úÖ FOUND: ['Gideon']
2025-08-10T01:11:00.7357328Z    üîÑ RETRY NEEDED: True
2025-08-10T01:11:00.7357864Z    üìù SUGGESTIONS: 5 provided
2025-08-10T01:11:00.7358357Z    üö´ FILTERED UNKNOWN: Unknown entities properly excluded
2025-08-10T01:11:00.7358686Z
2025-08-10T01:11:00.7358926Z üü¢ GREEN PHASE: Testing complete entity handling
2025-08-10T01:11:00.7359540Z    ‚úÖ ALL ENTITIES FOUND: ['Gideon', 'Sariel', 'Rowan', 'Tavern Keeper']
2025-08-10T01:11:00.7360065Z    üìä CONFIDENCE: 1.00
2025-08-10T01:11:00.7360404Z    üéØ PASSED: True
2025-08-10T01:11:00.7360894Z    üö´ UNKNOWN FILTERED: Still properly excluded in success case
2025-08-10T01:11:00.7361259Z
2025-08-10T01:11:00.7361510Z üîÑ RETRY WORKFLOW: Testing retry suggestion system
2025-08-10T01:11:00.7362409Z    üìù RETRY PROMPT GENERATED: Contains guidance for missing entities
2025-08-10T01:11:00.7362790Z
2025-08-10T01:11:00.7363180Z ‚úÖ RED-GREEN WORKFLOW COMPLETE: Missing entity detection and handling verified
2025-08-10T01:11:00.7363779Z ‚úÖ Integration test passed!
2025-08-10T01:11:00.7364154Z    Expected entities: ['Gideon', 'Sariel', 'Rowan']
2025-08-10T01:11:00.7364798Z    Found entities: ['Gideon', 'Sariel', 'Rowan']
2025-08-10T01:11:00.7365216Z    Confidence: 1.00
2025-08-10T01:11:00.7573815Z ‚úÖ PASS: tests/test_entity_tracking.py
2025-08-10T01:11:00.7575083Z ----------------------------------------
2025-08-10T01:11:00.7575576Z Running: tests/test_entity_tracking_generic.py
2025-08-10T01:11:00.9342577Z ..........
2025-08-10T01:11:00.9343553Z ----------------------------------------------------------------------
2025-08-10T01:11:00.9344366Z Ran 10 tests in 0.001s
2025-08-10T01:11:00.9344834Z
2025-08-10T01:11:00.9345185Z OK
2025-08-10T01:11:00.9566034Z ‚úÖ PASS: tests/test_entity_tracking_generic.py
2025-08-10T01:11:00.9567414Z ----------------------------------------
2025-08-10T01:11:00.9568040Z Running: tests/test_entity_utils.py
2025-08-10T01:11:00.9935149Z ........
2025-08-10T01:11:00.9935916Z ----------------------------------------------------------------------
2025-08-10T01:11:00.9936726Z Ran 8 tests in 0.000s
2025-08-10T01:11:00.9937285Z
2025-08-10T01:11:00.9937628Z OK
2025-08-10T01:11:00.9991404Z ‚úÖ PASS: tests/test_entity_utils.py
2025-08-10T01:11:00.9992825Z ----------------------------------------
2025-08-10T01:11:00.9993316Z Running: tests/test_entity_validator.py
2025-08-10T01:11:01.0643209Z .Entity validation failed after 2 retries. Missing: ['Cassian']
2025-08-10T01:11:01.0650534Z .Entity validation failed after 0 retries. Missing: ['Cassian']
2025-08-10T01:11:01.0670606Z ...............
2025-08-10T01:11:01.0671280Z ----------------------------------------------------------------------
2025-08-10T01:11:01.0672686Z Ran 17 tests in 0.004s
2025-08-10T01:11:01.0673170Z
2025-08-10T01:11:01.0673404Z OK
2025-08-10T01:11:01.0772032Z ‚úÖ PASS: tests/test_entity_validator.py
2025-08-10T01:11:01.0773317Z ----------------------------------------
2025-08-10T01:11:01.0773792Z Running: tests/test_extra_json_fields.py
2025-08-10T01:11:01.1237195Z ..
2025-08-10T01:11:01.1238355Z ----------------------------------------------------------------------
2025-08-10T01:11:01.1239092Z Ran 2 tests in 0.000s
2025-08-10T01:11:01.1240131Z
2025-08-10T01:11:01.1240264Z OK
2025-08-10T01:11:01.1308899Z ‚úÖ PASS: tests/test_extra_json_fields.py
2025-08-10T01:11:01.1309709Z ----------------------------------------
2025-08-10T01:11:01.1310427Z Running: tests/test_fake_services_simple.py
2025-08-10T01:11:01.1732076Z test_fake_auth_user_management (__main__.TestFakeServicesSimple.test_fake_auth_user_management)
2025-08-10T01:11:01.1733455Z Test that fake Auth manages users realistically. ... ok
2025-08-10T01:11:01.1734758Z test_fake_firestore_basic_operations (__main__.TestFakeServicesSimple.test_fake_firestore_basic_operations)
2025-08-10T01:11:01.1736157Z Test that fake Firestore behaves like the real thing. ... ok
2025-08-10T01:11:01.1737429Z test_fake_gemini_response_generation (__main__.TestFakeServicesSimple.test_fake_gemini_response_generation)
2025-08-10T01:11:01.1741418Z Test that fake Gemini generates realistic responses. ... ok
2025-08-10T01:11:01.1743608Z test_fake_services_integration (__main__.TestFakeServicesSimple.test_fake_services_integration)
2025-08-10T01:11:01.1750965Z Test that all fake services work together. ... ok
2025-08-10T01:11:01.1751355Z
2025-08-10T01:11:01.1751588Z ----------------------------------------------------------------------
2025-08-10T01:11:01.1752073Z Ran 4 tests in 0.002s
2025-08-10T01:11:01.1752296Z
2025-08-10T01:11:01.1752405Z OK
2025-08-10T01:11:01.1753248Z ‚úÖ Integration test passed - all fake services working together
2025-08-10T01:11:01.1753940Z Data size: 1092 characters
2025-08-10T01:11:01.1817551Z ‚úÖ PASS: tests/test_fake_services_simple.py
2025-08-10T01:11:01.1819375Z ----------------------------------------
2025-08-10T01:11:01.1819876Z Running: tests/test_fallback_logic_json_bug.py
2025-08-10T01:11:01.2286122Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:01.2300452Z ....
2025-08-10T01:11:01.2301193Z ----------------------------------------------------------------------
2025-08-10T01:11:01.2303640Z Ran 4 tests in 0.002s
2025-08-10T01:11:01.2304117Z
2025-08-10T01:11:01.2304454Z OK
2025-08-10T01:11:01.2371116Z ‚úÖ PASS: tests/test_fallback_logic_json_bug.py
2025-08-10T01:11:01.2372448Z ----------------------------------------
2025-08-10T01:11:01.2372942Z Running: tests/test_field_format_validation.py
2025-08-10T01:11:01.2989314Z test_field_format_consistency_red_green (__main__.TestFieldFormatValidation.test_field_format_consistency_red_green)
2025-08-10T01:11:02.2933117Z RED-GREEN TEST: Field format consistency between world_logic and main.py ... 2025-08-10 01:11:02,293 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:02.4866936Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:02.4870414Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:02.5071730Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:02.5076404Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:02.5185418Z 2025-08-10 01:11:02,518 - root - WARNING - ‚ö†Ô∏è GET_CAMPAIGN_GAME_STATE: GameState.from_dict returned None, returning empty GameState
2025-08-10T01:11:02.5187528Z 2025-08-10 01:11:02,518 - root - INFO - üìñ FETCHED STORY ENTRIES: user=field-format-test-user, campaign=field-format-test-campaign, total_entries=0
2025-08-10T01:11:02.5189721Z 2025-08-10 01:11:02,518 - root - INFO - üìä STORY BREAKDOWN: user_entries=0, ai_entries=0, other_entries=0
2025-08-10T01:11:02.5191486Z 2025-08-10 01:11:02,518 - root - WARNING - ‚ö†Ô∏è ‚ö†Ô∏è NO STORY ENTRIES FOUND for campaign field-format-test-campaign
2025-08-10T01:11:02.5193002Z 2025-08-10 01:11:02,518 - root - INFO - Cache MISS for master_directive.md: loaded and cached 8299 characters (~2074 tokens)
2025-08-10T01:11:02.5194608Z 2025-08-10 01:11:02,519 - root - INFO - Cache MISS for game_state_instruction.md: loaded and cached 56680 characters (~14170 tokens)
2025-08-10T01:11:02.5196195Z 2025-08-10 01:11:02,519 - root - INFO - Cache MISS for character_template.md: loaded and cached 6696 characters (~1674 tokens)
2025-08-10T01:11:02.5198587Z 2025-08-10 01:11:02,519 - root - INFO - Cache MISS for narrative_system_instruction.md: loaded and cached 40868 characters (~10217 tokens)
2025-08-10T01:11:02.5206885Z 2025-08-10 01:11:02,519 - root - INFO - Cache MISS for dnd_srd_instruction.md: loaded and cached 1216 characters (~304 tokens)
2025-08-10T01:11:02.5208642Z 2025-08-10 01:11:02,520 - root - INFO - Prompt scaffold is 125 chars (~31 tokens). Remaining budget for story: 2999875 chars (~749968 tokens)
2025-08-10T01:11:02.5209636Z 2025-08-10 01:11:02,520 - root - INFO - Initial context stats: Turns: 0, Tokens: 0
2025-08-10T01:11:02.5214637Z 2025-08-10 01:11:02,521 - root - INFO - Context is within token budget. No truncation needed.
2025-08-10T01:11:02.5220805Z 2025-08-10 01:11:02,521 - entity_preloader - INFO - Generated entity manifest for session 1, turn 1
2025-08-10T01:11:02.5224094Z 2025-08-10 01:11:02,522 - root - INFO - Initializing Gemini Client
2025-08-10T01:11:02.5225617Z 2025-08-10 01:11:02,522 - root - INFO - Gemini Client initialized successfully
2025-08-10T01:11:02.5228672Z 2025-08-10 01:11:02,522 - root - INFO - Calling Gemini API with prompt: GeminiRequest: I examine the testing environment carefully.......
2025-08-10T01:11:02.5230148Z 2025-08-10 01:11:02,522 - root - INFO - Calling Gemini API: 118405 characters (~29601 tokens)
2025-08-10T01:11:02.5233354Z 2025-08-10 01:11:02,522 - root - INFO - üîç MODEL_INFO: Using gemini-1.5-flash (Gemini 2.5 Flash supports up to 65,535 output tokens)
2025-08-10T01:11:02.5234357Z 2025-08-10 01:11:02,523 - root - INFO - Using model: gemini-1.5-flash
2025-08-10T01:11:02.5240308Z 2025-08-10 01:11:02,523 - root - INFO - Successfully used GeminiRequest for structured JSON communication
2025-08-10T01:11:02.5242402Z 2025-08-10 01:11:02,523 - root - ERROR - üî•üî¥ ‚ùå STRING PLANNING BLOCKS NO LONGER SUPPORTED: String planning blocks are deprecated. Only JSON format is allowed. Received: The field format test begins successfully....
2025-08-10T01:11:02.5248736Z 2025-08-10 01:11:02,524 - entity_validator - INFO - Comprehensive validation: 0/0 found, confidence: 1.00, warnings: 0
2025-08-10T01:11:02.5251795Z 2025-08-10 01:11:02,524 - NarrativeSyncValidator - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/1 found
2025-08-10T01:11:02.5253687Z 2025-08-10 01:11:02,524 - entity_validator - INFO - Comprehensive validation: 0/0 found, confidence: 1.00, warnings: 0
2025-08-10T01:11:02.5256726Z 2025-08-10 01:11:02,524 - NarrativeSyncValidator - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/1 found
2025-08-10T01:11:02.5260967Z 2025-08-10 01:11:02,524 - root - WARNING - ‚ö†Ô∏è ‚ö†Ô∏è PLANNING_BLOCK_MISSING: Story mode response missing required planning block
2025-08-10T01:11:02.5262277Z 2025-08-10 01:11:02,525 - root - INFO - üîç PLANNING_BLOCK_REGENERATION: Sending prompt to API
2025-08-10T01:11:02.5263229Z 2025-08-10 01:11:02,525 - root - INFO - üîç PLANNING_BLOCK_PROMPT:
2025-08-10T01:11:02.5264064Z CRITICAL: Generate planning options ONLY for the character in current location.
2025-08-10T01:11:02.5264948Z DO NOT reference other characters, campaigns, or unrelated narrative elements.
2025-08-10T01:11:02.5265459Z
2025-08-10T01:11:02.5265649Z Generate ONLY a planning block using th...
2025-08-10T01:11:02.5266418Z 2025-08-10 01:11:02,525 - root - INFO - Calling Gemini API with prompt: Planning block generation...
2025-08-10T01:11:02.5267386Z 2025-08-10 01:11:02,525 - root - INFO - Calling Gemini API: 116832 characters (~29208 tokens)
2025-08-10T01:11:02.5268890Z 2025-08-10 01:11:02,525 - root - INFO - üîç MODEL_INFO: Using gemini-1.5-flash (Gemini 2.5 Flash supports up to 65,535 output tokens)
2025-08-10T01:11:02.5269894Z 2025-08-10 01:11:02,525 - root - INFO - Using model: gemini-1.5-flash
2025-08-10T01:11:02.5270974Z 2025-08-10 01:11:02,525 - root - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_RESPONSE): Length: 361 chars
2025-08-10T01:11:02.5274435Z 2025-08-10 01:11:02,525 - root - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_RESPONSE): Content: {"narrative": "You find yourself in a mystical testing realm, surrounded by glowing validation runes.", "entities_mentioned": ["Test Hero", "Validation Runes"], "location_confirmed": "Testing Realm", "planning_block": "The field format test begins successfully.", "dice_rolls": [], "resources": "None", "state_updates": {"hp": 100, "location": "Testing Realm"}}
2025-08-10T01:11:02.5277655Z 2025-08-10 01:11:02,525 - root - INFO - üîç PLANNING_BLOCK_PARSING: Attempting to parse response
2025-08-10T01:11:02.5279674Z 2025-08-10 01:11:02,525 - root - ERROR - üî•üî¥ ‚ùå STRING PLANNING BLOCKS NO LONGER SUPPORTED: String planning blocks are deprecated. Only JSON format is allowed. Received: The field format test begins successfully....
2025-08-10T01:11:02.5282217Z 2025-08-10 01:11:02,525 - root - INFO - üîç PLANNING_BLOCK_PARSING_RESULT: planning_text length: 86
2025-08-10T01:11:02.5283377Z 2025-08-10 01:11:02,526 - root - INFO - üîç PLANNING_BLOCK_PARSING_RESULT: structured_response exists: True
2025-08-10T01:11:02.5284706Z 2025-08-10 01:11:02,526 - root - INFO - üîç PLANNING_BLOCK_SOURCE: Using raw planning_text (length: 86)
2025-08-10T01:11:02.5285774Z 2025-08-10 01:11:02,526 - root - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_CONTENT): Length: 86 chars
2025-08-10T01:11:02.5287414Z 2025-08-10 01:11:02,526 - root - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_CONTENT): Content: You find yourself in a mystical testing realm, surrounded by glowing validation runes.
2025-08-10T01:11:02.5289261Z 2025-08-10 01:11:02,526 - root - INFO - üîç VALIDATION_SUCCESS: String planning block passed validation (length: 86)
2025-08-10T01:11:02.5290516Z 2025-08-10 01:11:02,526 - root - INFO - Updated structured_response.planning_block with raw LLM content (JSON parse failed)
2025-08-10T01:11:02.5291507Z 2025-08-10 01:11:02,526 - root - INFO - Added LLM-generated standard planning block
2025-08-10T01:11:02.5292294Z 2025-08-10 01:11:02,526 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:02.5292929Z   "hp": 100,
2025-08-10T01:11:02.5293244Z   "location": "Testing Realm"
2025-08-10T01:11:02.5293601Z }
2025-08-10T01:11:02.5294042Z 2025-08-10 01:11:02,526 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:02.5294918Z 2025-08-10 01:11:02,526 - root - INFO - Successfully set new game state for campaign field-format-test-campaign.
2025-08-10T01:11:02.5295955Z 2025-08-10 01:11:02,526 - root - INFO - Final state written to Firestore for campaign field-format-test-campaign:\n{
2025-08-10T01:11:02.5296700Z   "game_state_version": 1,
2025-08-10T01:11:02.5297084Z   "player_character_data": {},
2025-08-10T01:11:02.5297470Z   "world_data": {},
2025-08-10T01:11:02.5298581Z   "npc_data": {},
2025-08-10T01:11:02.5298963Z   "custom_campaign_state": {
2025-08-10T01:11:02.5299371Z     "attribute_system": "D&D"
2025-08-10T01:11:02.5299729Z   },
2025-08-10T01:11:02.5300001Z   "combat_state": {
2025-08-10T01:11:02.5300328Z     "in_combat": false
2025-08-10T01:11:02.5300666Z   },
2025-08-10T01:11:02.5301287Z   "last_state_update_timestamp": "Sentinel: Value used to set a document field to the server timestamp.",
2025-08-10T01:11:02.5302052Z   "time_sensitive_events": {},
2025-08-10T01:11:02.5302447Z   "npc_agendas": {},
2025-08-10T01:11:02.5302788Z   "world_resources": {},
2025-08-10T01:11:02.5303167Z   "time_pressure_warnings": {},
2025-08-10T01:11:02.5303569Z   "debug_mode": true,
2025-08-10T01:11:02.5303940Z   "user_id": "field-format-test-user",
2025-08-10T01:11:02.5304769Z   "hp": 100,
2025-08-10T01:11:02.5305162Z ... (truncated, showing 19/21 lines)
2025-08-10T01:11:02.5306344Z 2025-08-10 01:11:02,526 - root - INFO - ‚úÖ Write-then-read (mock mode): user=field-format-test-user, campaign=field-format-test-campaign, actor=user
2025-08-10T01:11:02.5308217Z 2025-08-10 01:11:02,526 - root - INFO - ‚úÖ Write-then-read (mock mode): user=field-format-test-user, campaign=field-format-test-campaign, actor=gemini
2025-08-10T01:11:02.5309428Z 2025-08-10 01:11:02,527 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:02.5310111Z   "custom_campaign_state": {
2025-08-10T01:11:02.5310513Z     "last_story_mode_sequence_id": 2
2025-08-10T01:11:02.5310914Z   }
2025-08-10T01:11:02.5311184Z }
2025-08-10T01:11:02.5311672Z 2025-08-10 01:11:02,527 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:02.5312546Z   "last_story_mode_sequence_id": 2
2025-08-10T01:11:02.5312929Z }
2025-08-10T01:11:02.5313389Z 2025-08-10 01:11:02,527 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:02.5314166Z 2025-08-10 01:11:02,527 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:02.5315016Z 2025-08-10 01:11:02,527 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:02.5315696Z   "custom_campaign_state": {
2025-08-10T01:11:02.5316092Z     "last_story_mode_sequence_id": 2
2025-08-10T01:11:02.5316507Z   }
2025-08-10T01:11:02.5316789Z }
2025-08-10T01:11:02.5317542Z 2025-08-10 01:11:02,527 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:02.5318405Z   "last_story_mode_sequence_id": 2
2025-08-10T01:11:02.5318815Z }
2025-08-10T01:11:02.5319259Z 2025-08-10 01:11:02,527 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:02.5319996Z 2025-08-10 01:11:02,527 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:02.5320934Z 2025-08-10 01:11:02,527 - root - INFO - Successfully set new game state for campaign field-format-test-campaign.
2025-08-10T01:11:02.5322056Z 2025-08-10 01:11:02,527 - root - INFO - Final state written to Firestore for campaign field-format-test-campaign:\n{
2025-08-10T01:11:02.5322886Z   "game_state_version": 1,
2025-08-10T01:11:02.5323300Z   "player_character_data": {},
2025-08-10T01:11:02.5323711Z   "world_data": {},
2025-08-10T01:11:02.5324037Z   "npc_data": {},
2025-08-10T01:11:02.5324391Z   "custom_campaign_state": {
2025-08-10T01:11:02.5324817Z     "attribute_system": "D&D",
2025-08-10T01:11:02.5325266Z     "last_story_mode_sequence_id": 2
2025-08-10T01:11:02.5325679Z   },
2025-08-10T01:11:02.5325968Z   "combat_state": {
2025-08-10T01:11:02.5326306Z     "in_combat": false
2025-08-10T01:11:02.5326630Z   },
2025-08-10T01:11:02.5327264Z   "last_state_update_timestamp": "Sentinel: Value used to set a document field to the server timestamp.",
2025-08-10T01:11:02.5334008Z   "time_sensitive_events": {},
2025-08-10T01:11:02.5334454Z   "npc_agendas": {},
2025-08-10T01:11:02.5334825Z   "world_resources": {},
2025-08-10T01:11:02.5335234Z   "time_pressure_warnings": {},
2025-08-10T01:11:02.5335654Z   "debug_mode": true,
2025-08-10T01:11:02.5336047Z   "user_id": "field-format-test-user",
2025-08-10T01:11:02.5336508Z ... (truncated, showing 19/22 lines)
2025-08-10T01:11:02.5337375Z 2025-08-10 01:11:02,530 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:02.5339508Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:02.5340989Z   setup_file_logging()
2025-08-10T01:11:02.5341612Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:02.5405367Z 2025-08-10 01:11:02,540 - root - INFO - üìñ FETCHED STORY ENTRIES: user=field-format-test-user, campaign=field-format-test-campaign, total_entries=2
2025-08-10T01:11:02.5419649Z 2025-08-10 01:11:02,540 - root - INFO - üìä STORY BREAKDOWN: user_entries=1, ai_entries=1, other_entries=0
2025-08-10T01:11:02.5420727Z 2025-08-10 01:11:02,540 - root - INFO - üîç RECENT ENTRIES (last 2):
2025-08-10T01:11:02.5421764Z 2025-08-10 01:11:02,540 - root - INFO -   1. [user] character | I examine the testing environment carefully. | 2025-08-10 01:11:02.526868+00:00
2025-08-10T01:11:02.5423149Z 2025-08-10 01:11:02,540 - root - INFO -   2. [gemini] N/A | You find yourself in a mystical testing realm, sur... | 2025-08-10 01:11:02.526976+00:00
2025-08-10T01:11:02.5424521Z 2025-08-10 01:11:02,540 - root - INFO - Prompt scaffold is 125 chars (~31 tokens). Remaining budget for story: 2999875 chars (~749968 tokens)
2025-08-10T01:11:02.5426937Z 2025-08-10 01:11:02,540 - root - INFO - Initial context stats: Turns: 2, Tokens: 1000 (est: 32), Core Memories: 0
2025-08-10T01:11:02.5428335Z 2025-08-10 01:11:02,541 - root - INFO - Context is within token budget. No truncation needed.
2025-08-10T01:11:02.5429788Z 2025-08-10 01:11:02,541 - entity_preloader - INFO - Generated entity manifest for session 1, turn 3
2025-08-10T01:11:02.5432409Z 2025-08-10 01:11:02,542 - root - WARNING - ‚ö†Ô∏è Converting Sentinel object Sentinel: Value used to set a document field to the server timestamp. to None during JSON serialization. This may indicate unexpected test framework objects in production data.
2025-08-10T01:11:02.5435062Z 2025-08-10 01:11:02,542 - root - ERROR - üî•üî¥ Unexpected Sentinel object from module google.cloud.firestore_v1.transforms - potential data corruption risk
2025-08-10T01:11:02.5437351Z 2025-08-10 01:11:02,542 - root - INFO - Calling Gemini API with prompt: GeminiRequest: I continue exploring this testing realm.......
2025-08-10T01:11:02.5439259Z 2025-08-10 01:11:02,542 - root - INFO - Calling Gemini API: 119352 characters (~29838 tokens)
2025-08-10T01:11:02.5441893Z 2025-08-10 01:11:02,542 - root - INFO - üîç MODEL_INFO: Using gemini-1.5-flash (Gemini 2.5 Flash supports up to 65,535 output tokens)
2025-08-10T01:11:02.5443241Z 2025-08-10 01:11:02,542 - root - INFO - Using model: gemini-1.5-flash
2025-08-10T01:11:02.5444431Z 2025-08-10 01:11:02,543 - root - INFO - Successfully used GeminiRequest for structured JSON communication
2025-08-10T01:11:02.5446810Z 2025-08-10 01:11:02,543 - root - ERROR - üî•üî¥ ‚ùå STRING PLANNING BLOCKS NO LONGER SUPPORTED: String planning blocks are deprecated. Only JSON format is allowed. Received: The field format test begins successfully....
2025-08-10T01:11:02.5449037Z 2025-08-10 01:11:02,543 - entity_validator - INFO - Comprehensive validation: 0/0 found, confidence: 1.00, warnings: 0
2025-08-10T01:11:02.5450590Z 2025-08-10 01:11:02,543 - NarrativeSyncValidator - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/1 found
2025-08-10T01:11:02.5455378Z 2025-08-10 01:11:02,543 - entity_validator - INFO - Comprehensive validation: 0/0 found, confidence: 1.00, warnings: 0
2025-08-10T01:11:02.5468335Z 2025-08-10 01:11:02,543 - NarrativeSyncValidator - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/1 found
2025-08-10T01:11:02.5469912Z 2025-08-10 01:11:02,543 - root - WARNING - ‚ö†Ô∏è ‚ö†Ô∏è PLANNING_BLOCK_MISSING: Story mode response missing required planning block
2025-08-10T01:11:02.5471172Z 2025-08-10 01:11:02,543 - root - INFO - üîç PLANNING_BLOCK_REGENERATION: Sending prompt to API
2025-08-10T01:11:02.5472135Z 2025-08-10 01:11:02,543 - root - INFO - üîç PLANNING_BLOCK_PROMPT:
2025-08-10T01:11:02.5472937Z CRITICAL: Generate planning options ONLY for the character in current location.
2025-08-10T01:11:02.5473837Z DO NOT reference other characters, campaigns, or unrelated narrative elements.
2025-08-10T01:11:02.5474347Z
2025-08-10T01:11:02.5474540Z Generate ONLY a planning block using th...
2025-08-10T01:11:02.5475248Z 2025-08-10 01:11:02,543 - root - INFO - Calling Gemini API with prompt: Planning block generation...
2025-08-10T01:11:02.5476154Z 2025-08-10 01:11:02,543 - root - INFO - Calling Gemini API: 116832 characters (~29208 tokens)
2025-08-10T01:11:02.5477430Z 2025-08-10 01:11:02,543 - root - INFO - üîç MODEL_INFO: Using gemini-1.5-flash (Gemini 2.5 Flash supports up to 65,535 output tokens)
2025-08-10T01:11:02.5478586Z 2025-08-10 01:11:02,543 - root - INFO - Using model: gemini-1.5-flash
2025-08-10T01:11:02.5489647Z 2025-08-10 01:11:02,544 - root - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_RESPONSE): Length: 361 chars
2025-08-10T01:11:02.5492615Z 2025-08-10 01:11:02,544 - root - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_RESPONSE): Content: {"narrative": "You find yourself in a mystical testing realm, surrounded by glowing validation runes.", "entities_mentioned": ["Test Hero", "Validation Runes"], "location_confirmed": "Testing Realm", "planning_block": "The field format test begins successfully.", "dice_rolls": [], "resources": "None", "state_updates": {"hp": 100, "location": "Testing Realm"}}
2025-08-10T01:11:02.5495272Z 2025-08-10 01:11:02,544 - root - INFO - üîç PLANNING_BLOCK_PARSING: Attempting to parse response
2025-08-10T01:11:02.5497093Z 2025-08-10 01:11:02,544 - root - ERROR - üî•üî¥ ‚ùå STRING PLANNING BLOCKS NO LONGER SUPPORTED: String planning blocks are deprecated. Only JSON format is allowed. Received: The field format test begins successfully....
2025-08-10T01:11:02.5498835Z 2025-08-10 01:11:02,544 - root - INFO - üîç PLANNING_BLOCK_PARSING_RESULT: planning_text length: 86
2025-08-10T01:11:02.5499794Z 2025-08-10 01:11:02,544 - root - INFO - üîç PLANNING_BLOCK_PARSING_RESULT: structured_response exists: True
2025-08-10T01:11:02.5500764Z 2025-08-10 01:11:02,544 - root - INFO - üîç PLANNING_BLOCK_SOURCE: Using raw planning_text (length: 86)
2025-08-10T01:11:02.5501898Z 2025-08-10 01:11:02,544 - root - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_CONTENT): Length: 86 chars
2025-08-10T01:11:02.5503308Z 2025-08-10 01:11:02,544 - root - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_CONTENT): Content: You find yourself in a mystical testing realm, surrounded by glowing validation runes.
2025-08-10T01:11:02.5504714Z 2025-08-10 01:11:02,544 - root - INFO - üîç VALIDATION_SUCCESS: String planning block passed validation (length: 86)
2025-08-10T01:11:02.5505709Z 2025-08-10 01:11:02,544 - root - INFO - Updated structured_response.planning_block with raw LLM content (JSON parse failed)
2025-08-10T01:11:02.5506600Z 2025-08-10 01:11:02,544 - root - INFO - Added LLM-generated standard planning block
2025-08-10T01:11:02.5507302Z 2025-08-10 01:11:02,544 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:02.5508002Z   "hp": 100,
2025-08-10T01:11:02.5508304Z   "location": "Testing Realm"
2025-08-10T01:11:02.5508626Z }
2025-08-10T01:11:02.5509013Z 2025-08-10 01:11:02,545 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:02.5509892Z 2025-08-10 01:11:02,545 - root - INFO - Successfully set new game state for campaign field-format-test-campaign.
2025-08-10T01:11:02.5510868Z 2025-08-10 01:11:02,545 - root - INFO - Final state written to Firestore for campaign field-format-test-campaign:\n{
2025-08-10T01:11:02.5511573Z   "game_state_version": 1,
2025-08-10T01:11:02.5511916Z   "player_character_data": {},
2025-08-10T01:11:02.5512251Z   "world_data": {},
2025-08-10T01:11:02.5512544Z   "npc_data": {},
2025-08-10T01:11:02.5512845Z   "custom_campaign_state": {
2025-08-10T01:11:02.5513188Z     "attribute_system": "D&D",
2025-08-10T01:11:02.5513531Z     "last_story_mode_sequence_id": 2
2025-08-10T01:11:02.5513880Z   },
2025-08-10T01:11:02.5514117Z   "combat_state": {
2025-08-10T01:11:02.5514399Z     "in_combat": false
2025-08-10T01:11:02.5514692Z   },
2025-08-10T01:11:02.5515243Z   "last_state_update_timestamp": "Sentinel: Value used to set a document field to the server timestamp.",
2025-08-10T01:11:02.5515944Z   "time_sensitive_events": {},
2025-08-10T01:11:02.5516286Z   "npc_agendas": {},
2025-08-10T01:11:02.5516584Z   "world_resources": {},
2025-08-10T01:11:02.5516915Z   "time_pressure_warnings": {},
2025-08-10T01:11:02.5517277Z   "debug_mode": true,
2025-08-10T01:11:02.5517604Z   "user_id": "field-format-test-user",
2025-08-10T01:11:02.5518143Z ... (truncated, showing 19/22 lines)
2025-08-10T01:11:02.5519124Z 2025-08-10 01:11:02,545 - root - INFO - ‚úÖ Write-then-read (mock mode): user=field-format-test-user, campaign=field-format-test-campaign, actor=user
2025-08-10T01:11:02.5520562Z 2025-08-10 01:11:02,545 - root - INFO - ‚úÖ Write-then-read (mock mode): user=field-format-test-user, campaign=field-format-test-campaign, actor=gemini
2025-08-10T01:11:02.5521563Z 2025-08-10 01:11:02,545 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:02.5522117Z   "custom_campaign_state": {
2025-08-10T01:11:02.5522465Z     "last_story_mode_sequence_id": 4
2025-08-10T01:11:02.5522808Z   }
2025-08-10T01:11:02.5523031Z }
2025-08-10T01:11:02.5523445Z 2025-08-10 01:11:02,545 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:02.5523998Z   "last_story_mode_sequence_id": 4
2025-08-10T01:11:02.5524538Z }
2025-08-10T01:11:02.5524927Z 2025-08-10 01:11:02,546 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:02.5525586Z 2025-08-10 01:11:02,546 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:02.5526261Z 2025-08-10 01:11:02,546 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:02.5526815Z   "custom_campaign_state": {
2025-08-10T01:11:02.5527160Z     "last_story_mode_sequence_id": 4
2025-08-10T01:11:02.5527497Z   }
2025-08-10T01:11:02.5527856Z }
2025-08-10T01:11:02.5528284Z 2025-08-10 01:11:02,546 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:02.5529008Z   "last_story_mode_sequence_id": 4
2025-08-10T01:11:02.5529331Z }
2025-08-10T01:11:02.5529711Z 2025-08-10 01:11:02,546 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:02.5530340Z 2025-08-10 01:11:02,546 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:02.5531126Z 2025-08-10 01:11:02,546 - root - INFO - Successfully set new game state for campaign field-format-test-campaign.
2025-08-10T01:11:02.5532086Z 2025-08-10 01:11:02,546 - root - INFO - Final state written to Firestore for campaign field-format-test-campaign:\n{
2025-08-10T01:11:02.5532772Z   "game_state_version": 1,
2025-08-10T01:11:02.5533110Z   "player_character_data": {},
2025-08-10T01:11:02.5533434Z   "world_data": {},
2025-08-10T01:11:02.5533714Z   "npc_data": {},
2025-08-10T01:11:02.5534008Z   "custom_campaign_state": {
2025-08-10T01:11:02.5534344Z     "attribute_system": "D&D",
2025-08-10T01:11:02.5534677Z     "last_story_mode_sequence_id": 4
2025-08-10T01:11:02.5535029Z   },
2025-08-10T01:11:02.5535265Z   "combat_state": {
2025-08-10T01:11:02.5535539Z     "in_combat": false
2025-08-10T01:11:02.5535832Z   },
2025-08-10T01:11:02.5536396Z   "last_state_update_timestamp": "Sentinel: Value used to set a document field to the server timestamp.",
2025-08-10T01:11:02.5537099Z   "time_sensitive_events": {},
2025-08-10T01:11:02.5537455Z   "npc_agendas": {},
2025-08-10T01:11:02.5537895Z   "world_resources": {},
2025-08-10T01:11:02.5538232Z   "time_pressure_warnings": {},
2025-08-10T01:11:02.5538599Z   "debug_mode": true,
2025-08-10T01:11:02.5538956Z   "user_id": "field-format-test-user",
2025-08-10T01:11:02.5539361Z ... (truncated, showing 19/22 lines)
2025-08-10T01:11:02.5541138Z 2025-08-10 01:11:02,546 - root - INFO - MCP process_action result keys: ['success', 'story', 'narrative', 'response', 'game_state', 'mode', 'user_input', 'state_cleaned', 'entries_cleaned', 'sequence_id', 'user_scene_number', 'debug_mode', 'state_updates', 'entities_mentioned', 'location_confirmed', 'session_header', 'planning_block', 'dice_rolls', 'resources', 'debug_info']
2025-08-10T01:11:02.5543087Z 2025-08-10 01:11:02,546 - root - INFO - Story field type: <class 'list'>, length: 1
2025-08-10T01:11:02.5543580Z ok
2025-08-10T01:11:02.5544317Z test_red_phase_field_format_mismatch_detection (__main__.TestFieldFormatValidation.test_red_phase_field_format_mismatch_detection)
2025-08-10T01:11:02.5545337Z RED PHASE: Temporarily test what happens with wrong field format ... ok
2025-08-10T01:11:02.5545751Z
2025-08-10T01:11:02.5545941Z ----------------------------------------------------------------------
2025-08-10T01:11:02.5546398Z Ran 2 tests in 1.249s
2025-08-10T01:11:02.5546600Z
2025-08-10T01:11:02.5546702Z OK
2025-08-10T01:11:02.5547064Z üß™ Field Format Validation Test
2025-08-10T01:11:02.5547617Z Testing consistency between world_logic.py and main.py translation layer
2025-08-10T01:11:02.5548327Z ======================================================================
2025-08-10T01:11:02.5548622Z
2025-08-10T01:11:02.5548878Z üîç Testing world_logic.py story entry creation...
2025-08-10T01:11:02.5549484Z ‚úÖ world_logic.py creates entries with correct 'text' field
2025-08-10T01:11:02.5550260Z    Entry content: You find yourself in a mystical testing realm, surrounded by glowing validation runes....
2025-08-10T01:11:02.5550831Z
2025-08-10T01:11:02.5551290Z üîç Testing main.py translation layer compatibility...
2025-08-10T01:11:02.5551912Z ‚úÖ main.py translation layer successfully extracts narrative
2025-08-10T01:11:02.5552734Z    Narrative content: You find yourself in a mystical testing realm, surrounded by glowing validation runes....
2025-08-10T01:11:02.5553322Z
2025-08-10T01:11:02.5553594Z üü¢ GREEN PHASE: Field format consistency test PASSED
2025-08-10T01:11:02.5554169Z ‚úÖ world_logic.py creates story entries with 'text' field
2025-08-10T01:11:02.5554832Z ‚úÖ main.py translation layer successfully processes 'text' field
2025-08-10T01:11:02.5555449Z ‚úÖ End-to-end narrative extraction works correctly
2025-08-10T01:11:02.5555947Z
2025-08-10T01:11:02.5556210Z üî¥ RED PHASE: Testing field format mismatch detection
2025-08-10T01:11:02.5556831Z üî¥ RED TEST CONFIRMED: 'story' field format causes empty narrative
2025-08-10T01:11:02.5557452Z    Expected field: 'text', Actual field: 'story', Result: empty
2025-08-10T01:11:02.5558262Z üü¢ CORRECTION CONFIRMED: 'text' field format works correctly
2025-08-10T01:11:02.5558812Z    Field: 'text', Result: narrative content preserved
2025-08-10T01:11:02.7478273Z ‚úÖ PASS: tests/test_field_format_validation.py
2025-08-10T01:11:02.7479766Z ----------------------------------------
2025-08-10T01:11:02.7480228Z Running: tests/test_file_cache.py
2025-08-10T01:11:02.8671670Z ......ERROR:root:üî•üî¥ Failed to read file /path/that/does/not/exist.txt: [Errno 2] No such file or directory: '/path/that/does/not/exist.txt'
2025-08-10T01:11:02.8702942Z .....
2025-08-10T01:11:02.8703546Z ----------------------------------------------------------------------
2025-08-10T01:11:02.8704122Z Ran 11 tests in 0.006s
2025-08-10T01:11:02.8704341Z
2025-08-10T01:11:02.8704469Z OK
2025-08-10T01:11:02.8854701Z ‚úÖ PASS: tests/test_file_cache.py
2025-08-10T01:11:02.8856139Z ----------------------------------------
2025-08-10T01:11:02.8856664Z Running: tests/test_firestore_database_errors.py
2025-08-10T01:11:03.2076318Z üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:03.2079434Z Args: ('test_user_123',)
2025-08-10T01:11:03.2081974Z Kwargs: {}
2025-08-10T01:11:03.2084457Z Error: 401 Token expired
2025-08-10T01:11:03.2086866Z Traceback:
2025-08-10T01:11:03.2089503Z Traceback (most recent call last):
2025-08-10T01:11:03.2092708Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:03.2094947Z     return func(*args, **kwargs)
2025-08-10T01:11:03.2097341Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2098593Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 440, in get_campaigns_for_user
2025-08-10T01:11:03.2101281Z     campaigns_ref = db.collection("users").document(user_id).collection("campaigns")
2025-08-10T01:11:03.2104870Z                     ^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2105777Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1124, in __call__
2025-08-10T01:11:03.2106645Z     return self._mock_call(*args, **kwargs)
2025-08-10T01:11:03.2107133Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2108185Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1128, in _mock_call
2025-08-10T01:11:03.2109082Z     return self._execute_mock_call(*args, **kwargs)
2025-08-10T01:11:03.2109576Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2110484Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1183, in _execute_mock_call
2025-08-10T01:11:03.2111376Z     raise effect
2025-08-10T01:11:03.2111880Z google.api_core.exceptions.Unauthenticated: 401 Token expired
2025-08-10T01:11:03.2112470Z --- END EXCEPTION ---
2025-08-10T01:11:03.2113244Z ..ERROR:decorators:üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:03.2113868Z Args: ('test_user_123',)
2025-08-10T01:11:03.2114248Z Kwargs: {}
2025-08-10T01:11:03.2114579Z Error: 404 Collection not found
2025-08-10T01:11:03.2115424Z Traceback:
2025-08-10T01:11:03.2115765Z Traceback (most recent call last):
2025-08-10T01:11:03.2120417Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:03.2121356Z     return func(*args, **kwargs)
2025-08-10T01:11:03.2121767Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2122813Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 440, in get_campaigns_for_user
2025-08-10T01:11:03.2124067Z     campaigns_ref = db.collection("users").document(user_id).collection("campaigns")
2025-08-10T01:11:03.2125033Z                     ^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2125908Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1124, in __call__
2025-08-10T01:11:03.2126763Z     return self._mock_call(*args, **kwargs)
2025-08-10T01:11:03.2127236Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2128297Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1128, in _mock_call
2025-08-10T01:11:03.2129235Z     return self._execute_mock_call(*args, **kwargs)
2025-08-10T01:11:03.2129750Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2134430Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1183, in _execute_mock_call
2025-08-10T01:11:03.2135351Z     raise effect
2025-08-10T01:11:03.2135841Z google.api_core.exceptions.NotFound: 404 Collection not found
2025-08-10T01:11:03.2136432Z --- END EXCEPTION ---
2025-08-10T01:11:03.2137170Z .ERROR:decorators:üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:03.2137979Z Args: ('test_user_123',)
2025-08-10T01:11:03.2138349Z Kwargs: {}
2025-08-10T01:11:03.2138658Z Error: 503 Connection refused
2025-08-10T01:11:03.2139032Z Traceback:
2025-08-10T01:11:03.2139349Z Traceback (most recent call last):
2025-08-10T01:11:03.2140267Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:03.2141172Z     return func(*args, **kwargs)
2025-08-10T01:11:03.2141580Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2142576Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 440, in get_campaigns_for_user
2025-08-10T01:11:03.2143796Z     campaigns_ref = db.collection("users").document(user_id).collection("campaigns")
2025-08-10T01:11:03.2144510Z                     ^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2145386Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1124, in __call__
2025-08-10T01:11:03.2146246Z     return self._mock_call(*args, **kwargs)
2025-08-10T01:11:03.2146694Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2147539Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1128, in _mock_call
2025-08-10T01:11:03.2148621Z     return self._execute_mock_call(*args, **kwargs)
2025-08-10T01:11:03.2149141Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2150062Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1183, in _execute_mock_call
2025-08-10T01:11:03.2150935Z     raise effect
2025-08-10T01:11:03.2151473Z google.api_core.exceptions.ServiceUnavailable: 503 Connection refused
2025-08-10T01:11:03.2152099Z --- END EXCEPTION ---
2025-08-10T01:11:03.2152930Z .ERROR:decorators:üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:03.2153574Z Args: ('test_user_123',)
2025-08-10T01:11:03.2153929Z Kwargs: {}
2025-08-10T01:11:03.2154246Z Error: 504 Connection timeout
2025-08-10T01:11:03.2154644Z Traceback:
2025-08-10T01:11:03.2154974Z Traceback (most recent call last):
2025-08-10T01:11:03.2155835Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:03.2156716Z     return func(*args, **kwargs)
2025-08-10T01:11:03.2157127Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2175335Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 440, in get_campaigns_for_user
2025-08-10T01:11:03.2176635Z     campaigns_ref = db.collection("users").document(user_id).collection("campaigns")
2025-08-10T01:11:03.2177333Z                     ^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2178387Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1124, in __call__
2025-08-10T01:11:03.2179285Z     return self._mock_call(*args, **kwargs)
2025-08-10T01:11:03.2179751Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2180897Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1128, in _mock_call
2025-08-10T01:11:03.2181809Z     return self._execute_mock_call(*args, **kwargs)
2025-08-10T01:11:03.2182326Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2183260Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1183, in _execute_mock_call
2025-08-10T01:11:03.2184158Z     raise effect
2025-08-10T01:11:03.2184690Z google.api_core.exceptions.DeadlineExceeded: 504 Connection timeout
2025-08-10T01:11:03.2185333Z --- END EXCEPTION ---
2025-08-10T01:11:03.2327243Z .....ERROR:decorators:üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:03.2328553Z Args: ('invalid/id/with/slashes',)
2025-08-10T01:11:03.2329267Z Kwargs: {}
2025-08-10T01:11:03.2329845Z Error: 400 Invalid document ID
2025-08-10T01:11:03.2330386Z Traceback:
2025-08-10T01:11:03.2330887Z Traceback (most recent call last):
2025-08-10T01:11:03.2332018Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:03.2333075Z     return func(*args, **kwargs)
2025-08-10T01:11:03.2333611Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2334748Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 440, in get_campaigns_for_user
2025-08-10T01:11:03.2336104Z     campaigns_ref = db.collection("users").document(user_id).collection("campaigns")
2025-08-10T01:11:03.2336987Z                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2338327Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1124, in __call__
2025-08-10T01:11:03.2339231Z     return self._mock_call(*args, **kwargs)
2025-08-10T01:11:03.2339823Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2340775Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1128, in _mock_call
2025-08-10T01:11:03.2341808Z     return self._execute_mock_call(*args, **kwargs)
2025-08-10T01:11:03.2342397Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:03.2343418Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1183, in _execute_mock_call
2025-08-10T01:11:03.2344423Z     raise effect
2025-08-10T01:11:03.2345048Z google.api_core.exceptions.InvalidArgument: 400 Invalid document ID
2025-08-10T01:11:03.2345794Z --- END EXCEPTION ---
2025-08-10T01:11:03.2419919Z ......
2025-08-10T01:11:03.2423888Z ----------------------------------------------------------------------
2025-08-10T01:11:03.2424721Z Ran 15 tests in 0.037s
2025-08-10T01:11:03.2425155Z
2025-08-10T01:11:03.2425484Z OK
2025-08-10T01:11:03.2906752Z ‚úÖ PASS: tests/test_firestore_database_errors.py
2025-08-10T01:11:03.2908586Z ----------------------------------------
2025-08-10T01:11:03.2909172Z Running: tests/test_firestore_empty_narrative_bug_redgreen.py
2025-08-10T01:11:03.5515294Z ..
2025-08-10T01:11:03.5516823Z ----------------------------------------------------------------------
2025-08-10T01:11:03.5517365Z Ran 2 tests in 0.001s
2025-08-10T01:11:03.5517585Z
2025-08-10T01:11:03.5517901Z OK
2025-08-10T01:11:03.5904574Z ‚úÖ PASS: tests/test_firestore_empty_narrative_bug_redgreen.py
2025-08-10T01:11:03.5908207Z ----------------------------------------
2025-08-10T01:11:03.5908776Z Running: tests/test_firestore_helper_functions_fixed.py
2025-08-10T01:11:03.8511134Z test_perform_append_all_duplicates (__main__.TestFirestoreHelperFunctions.test_perform_append_all_duplicates)
2025-08-10T01:11:03.8518624Z Test _perform_append when all items are duplicates ... ok
2025-08-10T01:11:03.8521091Z test_perform_append_complex_objects (__main__.TestFirestoreHelperFunctions.test_perform_append_complex_objects)
2025-08-10T01:11:03.8522777Z Test _perform_append with complex objects ... ok
2025-08-10T01:11:03.8523981Z test_perform_append_deduplicate_complex_objects (__main__.TestFirestoreHelperFunctions.test_perform_append_deduplicate_complex_objects)
2025-08-10T01:11:03.8530423Z Test _perform_append deduplication with complex objects ... ok
2025-08-10T01:11:03.8532042Z test_perform_append_deduplicate_false (__main__.TestFirestoreHelperFunctions.test_perform_append_deduplicate_false)
2025-08-10T01:11:03.8534474Z Test _perform_append with deduplication disabled ... ok
2025-08-10T01:11:03.8548598Z test_perform_append_deduplicate_true (__main__.TestFirestoreHelperFunctions.test_perform_append_deduplicate_true)
2025-08-10T01:11:03.8556607Z Test _perform_append with deduplication enabled ... ok
2025-08-10T01:11:03.8557551Z test_perform_append_empty_list (__main__.TestFirestoreHelperFunctions.test_perform_append_empty_list)
2025-08-10T01:11:03.8558648Z Test _perform_append with empty items list ... ok
2025-08-10T01:11:03.8559549Z test_perform_append_list_items (__main__.TestFirestoreHelperFunctions.test_perform_append_list_items)
2025-08-10T01:11:03.8560439Z Test _perform_append with list of items ... ok
2025-08-10T01:11:03.8561298Z test_perform_append_none_item (__main__.TestFirestoreHelperFunctions.test_perform_append_none_item)
2025-08-10T01:11:03.8562253Z Test _perform_append with None as single item ... ok
2025-08-10T01:11:03.8566552Z test_perform_append_single_item (__main__.TestFirestoreHelperFunctions.test_perform_append_single_item)
2025-08-10T01:11:03.8573211Z Test _perform_append with single item (not a list) ... ok
2025-08-10T01:11:03.8574316Z test_truncate_log_json_circular_reference (__main__.TestFirestoreHelperFunctions.test_truncate_log_json_circular_reference)
2025-08-10T01:11:03.8575378Z Test _truncate_log_json with circular reference ... ok
2025-08-10T01:11:03.8576283Z test_truncate_log_json_empty_data (__main__.TestFirestoreHelperFunctions.test_truncate_log_json_empty_data)
2025-08-10T01:11:03.8577186Z Test _truncate_log_json with empty data ... ok
2025-08-10T01:11:03.8578322Z test_truncate_log_json_exact_boundary (__main__.TestFirestoreHelperFunctions.test_truncate_log_json_exact_boundary)
2025-08-10T01:11:03.8579312Z Test _truncate_log_json with exactly max_lines ... ok
2025-08-10T01:11:03.8580272Z test_truncate_log_json_invalid_json (__main__.TestFirestoreHelperFunctions.test_truncate_log_json_invalid_json)
2025-08-10T01:11:03.8581281Z Test _truncate_log_json exception handling with non-serializable data ... ok
2025-08-10T01:11:03.8582290Z test_truncate_log_json_large_data (__main__.TestFirestoreHelperFunctions.test_truncate_log_json_large_data)
2025-08-10T01:11:03.8585580Z Test _truncate_log_json with data exceeding max_lines ... ok
2025-08-10T01:11:03.8595987Z test_truncate_log_json_max_lines_parameter (__main__.TestFirestoreHelperFunctions.test_truncate_log_json_max_lines_parameter)
2025-08-10T01:11:03.8596948Z Test _truncate_log_json respects max_lines parameter ... ok
2025-08-10T01:11:03.8597917Z test_truncate_log_json_none_data (__main__.TestFirestoreHelperFunctions.test_truncate_log_json_none_data)
2025-08-10T01:11:03.8598671Z Test _truncate_log_json with None ... ok
2025-08-10T01:11:03.8599430Z test_truncate_log_json_small_data (__main__.TestFirestoreHelperFunctions.test_truncate_log_json_small_data)
2025-08-10T01:11:03.8600282Z Test _truncate_log_json with data smaller than max_lines ... ok
2025-08-10T01:11:03.8600665Z
2025-08-10T01:11:03.8600856Z ----------------------------------------------------------------------
2025-08-10T01:11:03.8601306Z Ran 17 tests in 0.007s
2025-08-10T01:11:03.8601496Z
2025-08-10T01:11:03.8601853Z OK
2025-08-10T01:11:03.8999040Z ‚úÖ PASS: tests/test_firestore_helper_functions_fixed.py
2025-08-10T01:11:03.9000566Z ----------------------------------------
2025-08-10T01:11:03.9001071Z Running: tests/test_firestore_mission_handler.py
2025-08-10T01:11:04.1606721Z test_find_existing_mission_index_empty_list (__main__.TestMissionHandler.test_find_existing_mission_index_empty_list)
2025-08-10T01:11:04.1608439Z Test find_existing_mission_index with empty list ... ok
2025-08-10T01:11:04.1610180Z test_find_existing_mission_index_found (__main__.TestMissionHandler.test_find_existing_mission_index_found)
2025-08-10T01:11:04.1611922Z Test find_existing_mission_index when mission exists ... ok
2025-08-10T01:11:04.1613270Z test_find_existing_mission_index_invalid_mission_objects (__main__.TestMissionHandler.test_find_existing_mission_index_invalid_mission_objects)
2025-08-10T01:11:04.1614807Z Test find_existing_mission_index with non-dict items in list ... ok
2025-08-10T01:11:04.1616330Z test_find_existing_mission_index_missing_mission_id (__main__.TestMissionHandler.test_find_existing_mission_index_missing_mission_id)
2025-08-10T01:11:04.1618037Z Test find_existing_mission_index when dicts lack mission_id ... ok
2025-08-10T01:11:04.1620347Z test_find_existing_mission_index_not_found (__main__.TestMissionHandler.test_find_existing_mission_index_not_found)
2025-08-10T01:11:04.1621400Z Test find_existing_mission_index when mission doesn't exist ... ok
2025-08-10T01:11:04.1622479Z test_handle_active_missions_conversion_dict (__main__.TestMissionHandler.test_handle_active_missions_conversion_dict)
2025-08-10T01:11:04.1632766Z Test handle_active_missions_conversion with dict value ... ok
2025-08-10T01:11:04.1636119Z test_handle_active_missions_conversion_invalid_type (__main__.TestMissionHandler.test_handle_active_missions_conversion_invalid_type)
2025-08-10T01:11:04.1637424Z Test handle_active_missions_conversion with non-dict, non-list value ... ok
2025-08-10T01:11:04.1638677Z test_handle_missions_dict_conversion (__main__.TestMissionHandler.test_handle_missions_dict_conversion)
2025-08-10T01:11:04.1640250Z Test handle_missions_dict_conversion with dict of missions ... ok
2025-08-10T01:11:04.1641494Z test_handle_missions_dict_conversion_empty (__main__.TestMissionHandler.test_handle_missions_dict_conversion_empty)
2025-08-10T01:11:04.1642720Z Test handle_missions_dict_conversion with empty dict ... ok
2025-08-10T01:11:04.1643963Z test_handle_missions_dict_conversion_mixed_types (__main__.TestMissionHandler.test_handle_missions_dict_conversion_mixed_types)
2025-08-10T01:11:04.1649384Z Test handle_missions_dict_conversion with various invalid types ... ok
2025-08-10T01:11:04.1651020Z test_initialize_missions_list_already_list (__main__.TestMissionHandler.test_initialize_missions_list_already_list)
2025-08-10T01:11:04.1657657Z Test initialize_missions_list when key already has a list ... ok
2025-08-10T01:11:04.1658920Z test_initialize_missions_list_missing_key (__main__.TestMissionHandler.test_initialize_missions_list_missing_key)
2025-08-10T01:11:04.1659966Z Test initialize_missions_list when key doesn't exist ... ok
2025-08-10T01:11:04.1661009Z test_initialize_missions_list_non_list_value (__main__.TestMissionHandler.test_initialize_missions_list_non_list_value)
2025-08-10T01:11:04.1662111Z Test initialize_missions_list when key exists but isn't a list ... ok
2025-08-10T01:11:04.1663162Z test_initialize_missions_list_none_value (__main__.TestMissionHandler.test_initialize_missions_list_none_value)
2025-08-10T01:11:04.1664176Z Test initialize_missions_list when key has None value ... ok
2025-08-10T01:11:04.1665160Z test_process_mission_data_adds_missing_id (__main__.TestMissionHandler.test_process_mission_data_adds_missing_id)
2025-08-10T01:11:04.1666168Z Test process_mission_data adds mission_id if missing ... ok
2025-08-10T01:11:04.1667086Z test_process_mission_data_new_mission (__main__.TestMissionHandler.test_process_mission_data_new_mission)
2025-08-10T01:11:04.1668493Z Test process_mission_data adding a new mission ... ok
2025-08-10T01:11:04.1669675Z test_process_mission_data_update_existing (__main__.TestMissionHandler.test_process_mission_data_update_existing)
2025-08-10T01:11:04.1670603Z Test process_mission_data updating an existing mission ... ok
2025-08-10T01:11:04.1670994Z
2025-08-10T01:11:04.1671197Z ----------------------------------------------------------------------
2025-08-10T01:11:04.1671656Z Ran 17 tests in 0.006s
2025-08-10T01:11:04.1671870Z
2025-08-10T01:11:04.1671983Z OK
2025-08-10T01:11:04.2043298Z ‚úÖ PASS: tests/test_firestore_mission_handler.py
2025-08-10T01:11:04.2044773Z ----------------------------------------
2025-08-10T01:11:04.2045657Z Running: tests/test_firestore_state_helpers.py
2025-08-10T01:11:04.4668516Z test_handle_append_syntax_core_memories_dedup (__main__.TestFirestoreStateHelpers.test_handle_append_syntax_core_memories_dedup)
2025-08-10T01:11:04.4678540Z Test _handle_append_syntax with core_memories uses deduplication ... ok
2025-08-10T01:11:04.4680197Z test_handle_append_syntax_creates_list (__main__.TestFirestoreStateHelpers.test_handle_append_syntax_creates_list)
2025-08-10T01:11:04.4687371Z Test _handle_append_syntax creates list if missing ... ok
2025-08-10T01:11:04.4688974Z test_handle_append_syntax_no_append_key (__main__.TestFirestoreStateHelpers.test_handle_append_syntax_no_append_key)
2025-08-10T01:11:04.4690373Z Test _handle_append_syntax with dict missing 'append' key ... ok
2025-08-10T01:11:04.4691756Z test_handle_append_syntax_not_dict (__main__.TestFirestoreStateHelpers.test_handle_append_syntax_not_dict)
2025-08-10T01:11:04.4693684Z Test _handle_append_syntax with non-dict value ... ok
2025-08-10T01:11:04.4694812Z test_handle_append_syntax_valid (__main__.TestFirestoreStateHelpers.test_handle_append_syntax_valid)
2025-08-10T01:11:04.4698558Z Test _handle_append_syntax with valid append syntax ... ok
2025-08-10T01:11:04.4699873Z test_handle_core_memories_safeguard_creates_list (__main__.TestFirestoreStateHelpers.test_handle_core_memories_safeguard_creates_list)
2025-08-10T01:11:04.4710641Z Test _handle_core_memories_safeguard creates list if missing ... ok
2025-08-10T01:11:04.4713626Z test_handle_core_memories_safeguard_other_key (__main__.TestFirestoreStateHelpers.test_handle_core_memories_safeguard_other_key)
2025-08-10T01:11:04.4714778Z Test _handle_core_memories_safeguard ignores other keys ... ok
2025-08-10T01:11:04.4715918Z test_handle_core_memories_safeguard_triggered (__main__.TestFirestoreStateHelpers.test_handle_core_memories_safeguard_triggered)
2025-08-10T01:11:04.4720791Z Test _handle_core_memories_safeguard prevents overwrite ... ok
2025-08-10T01:11:04.4724045Z test_handle_delete_token_deletes_existing (__main__.TestFirestoreStateHelpers.test_handle_delete_token_deletes_existing)
2025-08-10T01:11:04.4726902Z Test _handle_delete_token removes existing key ... ok
2025-08-10T01:11:04.4728383Z test_handle_delete_token_missing_key (__main__.TestFirestoreStateHelpers.test_handle_delete_token_missing_key)
2025-08-10T01:11:04.4731408Z Test _handle_delete_token with non-existent key ... ok
2025-08-10T01:11:04.4733819Z test_handle_delete_token_wrong_value (__main__.TestFirestoreStateHelpers.test_handle_delete_token_wrong_value)
2025-08-10T01:11:04.4734841Z Test _handle_delete_token with value not DELETE_TOKEN ... ok
2025-08-10T01:11:04.4735825Z test_handle_dict_merge_existing_dict (__main__.TestFirestoreStateHelpers.test_handle_dict_merge_existing_dict)
2025-08-10T01:11:04.4739480Z Test _handle_dict_merge merges with existing dict ... ok
2025-08-10T01:11:04.4744066Z test_handle_dict_merge_new_dict (__main__.TestFirestoreStateHelpers.test_handle_dict_merge_new_dict)
2025-08-10T01:11:04.4745071Z Test _handle_dict_merge creates new dict when key missing ... ok
2025-08-10T01:11:04.4746094Z test_handle_dict_merge_non_dict_value (__main__.TestFirestoreStateHelpers.test_handle_dict_merge_non_dict_value)
2025-08-10T01:11:04.4747053Z Test _handle_dict_merge with non-dict value ... ok
2025-08-10T01:11:04.4748223Z test_handle_dict_merge_overwrite_non_dict (__main__.TestFirestoreStateHelpers.test_handle_dict_merge_overwrite_non_dict)
2025-08-10T01:11:04.4760169Z Test _handle_dict_merge overwrites non-dict existing value ... ok
2025-08-10T01:11:04.4761328Z test_handle_string_to_dict_update_missing_key (__main__.TestFirestoreStateHelpers.test_handle_string_to_dict_update_missing_key)
2025-08-10T01:11:04.4762419Z Test _handle_string_to_dict_update with missing key ... ok
2025-08-10T01:11:04.4763570Z test_handle_string_to_dict_update_non_dict_existing (__main__.TestFirestoreStateHelpers.test_handle_string_to_dict_update_non_dict_existing)
2025-08-10T01:11:04.4764775Z Test _handle_string_to_dict_update with non-dict existing value ... ok
2025-08-10T01:11:04.4766269Z test_handle_string_to_dict_update_overwrites_status (__main__.TestFirestoreStateHelpers.test_handle_string_to_dict_update_overwrites_status)
2025-08-10T01:11:04.4767449Z Test _handle_string_to_dict_update overwrites existing status ... ok
2025-08-10T01:11:04.4768835Z test_handle_string_to_dict_update_preserves_dict (__main__.TestFirestoreStateHelpers.test_handle_string_to_dict_update_preserves_dict)
2025-08-10T01:11:04.4772631Z Test _handle_string_to_dict_update preserves dict structure ... ok
2025-08-10T01:11:04.4773613Z test_update_state_with_changes_integration (__main__.TestFirestoreStateHelpers.test_update_state_with_changes_integration)
2025-08-10T01:11:04.4774579Z Test update_state_with_changes with various scenarios ... ok
2025-08-10T01:11:04.4774958Z
2025-08-10T01:11:04.4775160Z ----------------------------------------------------------------------
2025-08-10T01:11:04.4775645Z Ran 20 tests in 0.011s
2025-08-10T01:11:04.4775844Z
2025-08-10T01:11:04.4775969Z OK
2025-08-10T01:11:04.5177104Z ‚úÖ PASS: tests/test_firestore_state_helpers.py
2025-08-10T01:11:04.5178815Z ----------------------------------------
2025-08-10T01:11:04.5179372Z Running: tests/test_firestore_state_helpers_edge_cases.py
2025-08-10T01:11:04.7796598Z test_handle_append_syntax_nested_append_structure (__main__.TestFirestoreStateHelpersEdgeCases.test_handle_append_syntax_nested_append_structure)
2025-08-10T01:11:04.7808456Z Test append syntax with nested append structure ... ok
2025-08-10T01:11:04.7811136Z test_handle_dict_merge_with_delete_token_in_value (__main__.TestFirestoreStateHelpersEdgeCases.test_handle_dict_merge_with_delete_token_in_value)
2025-08-10T01:11:04.7816627Z Test dict merge where new dict contains DELETE_TOKEN ... ok
2025-08-10T01:11:04.7818537Z test_update_state_complex_nested_structure (__main__.TestFirestoreStateHelpersEdgeCases.test_update_state_complex_nested_structure)
2025-08-10T01:11:04.7824699Z Test deeply nested structure updates ... ok
2025-08-10T01:11:04.7826127Z test_update_state_core_memories_multiple_attempts (__main__.TestFirestoreStateHelpersEdgeCases.test_update_state_core_memories_multiple_attempts)
2025-08-10T01:11:04.7830629Z Test multiple types of core_memories updates in one call ... ok
2025-08-10T01:11:04.7832078Z test_update_state_delete_nested_keys (__main__.TestFirestoreStateHelpersEdgeCases.test_update_state_delete_nested_keys)
2025-08-10T01:11:04.7838392Z Test DELETE_TOKEN on nested dictionary keys ... ok
2025-08-10T01:11:04.7839704Z test_update_state_empty_changes (__main__.TestFirestoreStateHelpersEdgeCases.test_update_state_empty_changes)
2025-08-10T01:11:04.7841089Z Test update_state_with_changes with empty changes dict ... ok
2025-08-10T01:11:04.7842487Z test_update_state_list_overwrite (__main__.TestFirestoreStateHelpersEdgeCases.test_update_state_list_overwrite)
2025-08-10T01:11:04.7843858Z Test that non-append list updates do overwrite ... ok
2025-08-10T01:11:04.7845068Z test_update_state_nested_append_syntax (__main__.TestFirestoreStateHelpersEdgeCases.test_update_state_nested_append_syntax)
2025-08-10T01:11:04.7849704Z Test nested append syntax in dict values ... ok
2025-08-10T01:11:04.7851277Z test_update_state_none_values (__main__.TestFirestoreStateHelpersEdgeCases.test_update_state_none_values)
2025-08-10T01:11:04.7852267Z Test update_state_with_changes with None values ... ok
2025-08-10T01:11:04.7853963Z test_update_state_preserve_unchanged_keys (__main__.TestFirestoreStateHelpersEdgeCases.test_update_state_preserve_unchanged_keys)
2025-08-10T01:11:04.7855236Z Test that unchanged keys are preserved ... ok
2025-08-10T01:11:04.7856456Z test_api_response_required_fields_completeness (__main__.TestMCPMigrationEdgeCases.test_api_response_required_fields_completeness)
2025-08-10T01:11:04.7857935Z Verify API response contains ALL frontend-required fields. ... ok
2025-08-10T01:11:04.7858843Z test_logging_edge_cases (__main__.TestMCPMigrationEdgeCases.test_logging_edge_cases)
2025-08-10T01:11:05.0132974Z Test enhanced logging with various edge cases. ... /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:05.0138710Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:05.0335918Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:05.0340688Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:05.7060272Z ok
2025-08-10T01:11:05.7061538Z test_sequence_id_edge_cases (__main__.TestMCPMigrationEdgeCases.test_sequence_id_edge_cases)
2025-08-10T01:11:05.7062765Z Test sequence_id calculation with edge cases. ... ok
2025-08-10T01:11:05.7063915Z test_user_scene_number_edge_cases (__main__.TestMCPMigrationEdgeCases.test_user_scene_number_edge_cases)
2025-08-10T01:11:05.7064923Z Test user_scene_number calculation with various actor distributions. ... ok
2025-08-10T01:11:05.7065429Z
2025-08-10T01:11:05.7065648Z ----------------------------------------------------------------------
2025-08-10T01:11:05.7066156Z Ran 14 tests in 0.927s
2025-08-10T01:11:05.7066370Z
2025-08-10T01:11:05.7066491Z OK
2025-08-10T01:11:05.9018273Z ‚úÖ PASS: tests/test_firestore_state_helpers_edge_cases.py
2025-08-10T01:11:05.9020213Z ----------------------------------------
2025-08-10T01:11:05.9022455Z Running: tests/test_firestore_structured_fields.py
2025-08-10T01:11:06.1970860Z ....WARNING:root:‚ö†Ô∏è AI response missing structured_fields for campaign campaign-789
2025-08-10T01:11:06.1987336Z .
2025-08-10T01:11:06.1988150Z ----------------------------------------------------------------------
2025-08-10T01:11:06.1988976Z Ran 5 tests in 0.025s
2025-08-10T01:11:06.1989443Z
2025-08-10T01:11:06.1990719Z OK
2025-08-10T01:11:06.2382583Z ‚úÖ PASS: tests/test_firestore_structured_fields.py
2025-08-10T01:11:06.2383547Z ----------------------------------------
2025-08-10T01:11:06.2384401Z Running: tests/test_flask_app_import.py
2025-08-10T01:11:06.5924003Z 2025-08-10 01:11:06,592 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:06.6005091Z .2025-08-10 01:11:06,600 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:06.6014738Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:06.6016878Z   setup_file_logging()
2025-08-10T01:11:06.6018337Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:06.6073926Z .
2025-08-10T01:11:06.6074662Z ----------------------------------------------------------------------
2025-08-10T01:11:06.6075525Z Ran 2 tests in 0.326s
2025-08-10T01:11:06.6076004Z
2025-08-10T01:11:06.6076318Z OK
2025-08-10T01:11:06.6596889Z ‚úÖ PASS: tests/test_flask_app_import.py
2025-08-10T01:11:06.6598214Z ----------------------------------------
2025-08-10T01:11:06.6598762Z Running: tests/test_game_state.py
2025-08-10T01:11:07.7822135Z 2025-08-10 01:11:07,781 - INFO - Skipping Firebase initialization in testing mode
2025-08-10T01:11:07.7857945Z .............................2025-08-10 01:11:07,785 - WARNING - ‚ö†Ô∏è Skipping line in SET command due to invalid JSON value: invalid_key = invalid_json
2025-08-10T01:11:07.7860462Z ....2025-08-10 01:11:07,785 - INFO - APPEND/SAFEGUARD: Added 7 new items to 'test_key'.
2025-08-10T01:11:07.7862938Z .2025-08-10 01:11:07,786 - INFO - APPEND/SAFEGUARD: No new items were added to 'test_key' (duplicates may have been found).
2025-08-10T01:11:07.7866287Z .2025-08-10 01:11:07,786 - INFO - APPEND/SAFEGUARD: Added 2 new items to 'test_key'.
2025-08-10T01:11:07.7867164Z .2025-08-10 01:11:07,786 - INFO - APPEND/SAFEGUARD: Added 1 new items to 'test_key'.
2025-08-10T01:11:07.7868185Z .2025-08-10 01:11:07,786 - INFO - APPEND/SAFEGUARD: Added 1 new items to 'test_key'.
2025-08-10T01:11:07.7869044Z .2025-08-10 01:11:07,786 - INFO - APPEND/SAFEGUARD: Added 2 new items to 'test_key'.
2025-08-10T01:11:07.7870323Z .2025-08-10 01:11:07,786 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7871149Z   "core_memories": [
2025-08-10T01:11:07.7871735Z     "memory2",
2025-08-10T01:11:07.7872284Z     "memory3"
2025-08-10T01:11:07.7872770Z   ]
2025-08-10T01:11:07.7873187Z }
2025-08-10T01:11:07.7874529Z 2025-08-10 01:11:07,786 - WARNING - ‚ö†Ô∏è CRITICAL SAFEGUARD: Intercepted direct overwrite on 'core_memories'. Converting to safe, deduplicated append.
2025-08-10T01:11:07.7876542Z 2025-08-10 01:11:07,786 - INFO - APPEND/SAFEGUARD: Added 1 new items to 'core_memories'.
2025-08-10T01:11:07.7877583Z 2025-08-10 01:11:07,786 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7878776Z .2025-08-10 01:11:07,786 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7879704Z   "core_memories": [
2025-08-10T01:11:07.7880244Z     "new_memory1",
2025-08-10T01:11:07.7880721Z     "new_memory2"
2025-08-10T01:11:07.7881263Z   ]
2025-08-10T01:11:07.7881802Z }
2025-08-10T01:11:07.7883127Z 2025-08-10 01:11:07,786 - WARNING - ‚ö†Ô∏è CRITICAL SAFEGUARD: Intercepted direct overwrite on 'core_memories'. Converting to safe, deduplicated append.
2025-08-10T01:11:07.7885311Z 2025-08-10 01:11:07,786 - INFO - APPEND/SAFEGUARD: Added 2 new items to 'core_memories'.
2025-08-10T01:11:07.7886406Z 2025-08-10 01:11:07,786 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7887448Z .2025-08-10 01:11:07,786 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7888472Z   "core_memories": [
2025-08-10T01:11:07.7888821Z     "memory1",
2025-08-10T01:11:07.7889108Z     "memory2"
2025-08-10T01:11:07.7889386Z   ]
2025-08-10T01:11:07.7889642Z }
2025-08-10T01:11:07.7890684Z 2025-08-10 01:11:07,786 - WARNING - ‚ö†Ô∏è CRITICAL SAFEGUARD: Intercepted direct overwrite on 'core_memories'. Converting to safe, deduplicated append.
2025-08-10T01:11:07.7891868Z 2025-08-10 01:11:07,786 - INFO - APPEND/SAFEGUARD: Added 2 new items to 'core_memories'.
2025-08-10T01:11:07.7892612Z 2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7893322Z .2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7893882Z   "level1": {
2025-08-10T01:11:07.7894173Z     "level2": {
2025-08-10T01:11:07.7894469Z       "level3": {
2025-08-10T01:11:07.7894778Z         "value": "new",
2025-08-10T01:11:07.7895099Z         "add": "this"
2025-08-10T01:11:07.7895414Z       }
2025-08-10T01:11:07.7895692Z     }
2025-08-10T01:11:07.7895947Z   }
2025-08-10T01:11:07.7896204Z }
2025-08-10T01:11:07.7896646Z 2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7897202Z   "level2": {
2025-08-10T01:11:07.7897494Z     "level3": {
2025-08-10T01:11:07.7897932Z       "value": "new",
2025-08-10T01:11:07.7898263Z       "add": "this"
2025-08-10T01:11:07.7898888Z     }
2025-08-10T01:11:07.7899176Z   }
2025-08-10T01:11:07.7899429Z }
2025-08-10T01:11:07.7899891Z 2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7900463Z   "level3": {
2025-08-10T01:11:07.7900749Z     "value": "new",
2025-08-10T01:11:07.7901107Z     "add": "this"
2025-08-10T01:11:07.7901397Z   }
2025-08-10T01:11:07.7901642Z }
2025-08-10T01:11:07.7902082Z 2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7902660Z   "value": "new",
2025-08-10T01:11:07.7902986Z   "add": "this"
2025-08-10T01:11:07.7903538Z }
2025-08-10T01:11:07.7903968Z 2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7904649Z 2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7905302Z 2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7905959Z 2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7906722Z .2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7907297Z   "items": {
2025-08-10T01:11:07.7907590Z     "append": [
2025-08-10T01:11:07.7908054Z       "potion",
2025-08-10T01:11:07.7908342Z       "key"
2025-08-10T01:11:07.7908602Z     ]
2025-08-10T01:11:07.7908860Z   }
2025-08-10T01:11:07.7909117Z }
2025-08-10T01:11:07.7909561Z 2025-08-10 01:11:07,787 - INFO - update_state: Detected explicit append for 'items'.
2025-08-10T01:11:07.7910331Z 2025-08-10 01:11:07,787 - INFO - APPEND/SAFEGUARD: Added 2 new items to 'items'.
2025-08-10T01:11:07.7911051Z 2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7911796Z .2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7912365Z   "key": {
2025-08-10T01:11:07.7912647Z     "append": [
2025-08-10T01:11:07.7912946Z       "item1"
2025-08-10T01:11:07.7913260Z     ]
2025-08-10T01:11:07.7913525Z   }
2025-08-10T01:11:07.7913775Z }
2025-08-10T01:11:07.7914244Z 2025-08-10 01:11:07,787 - INFO - update_state: Detected explicit append for 'key'.
2025-08-10T01:11:07.7914987Z 2025-08-10 01:11:07,787 - INFO - APPEND/SAFEGUARD: Added 1 new items to 'key'.
2025-08-10T01:11:07.7915695Z 2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7916444Z .2025-08-10 01:11:07,787 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7917051Z   "new_list": {
2025-08-10T01:11:07.7917357Z     "append": [
2025-08-10T01:11:07.7917654Z       "item1",
2025-08-10T01:11:07.7918107Z       "item2"
2025-08-10T01:11:07.7918392Z     ]
2025-08-10T01:11:07.7918662Z   }
2025-08-10T01:11:07.7918940Z }
2025-08-10T01:11:07.7919411Z 2025-08-10 01:11:07,787 - INFO - update_state: Detected explicit append for 'new_list'.
2025-08-10T01:11:07.7920201Z 2025-08-10 01:11:07,787 - INFO - APPEND/SAFEGUARD: Added 2 new items to 'new_list'.
2025-08-10T01:11:07.7920960Z 2025-08-10 01:11:07,788 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7921725Z .2025-08-10 01:11:07,788 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7922348Z   "player": {
2025-08-10T01:11:07.7922657Z     "level": 2,
2025-08-10T01:11:07.7922947Z     "gold": 100
2025-08-10T01:11:07.7923231Z   },
2025-08-10T01:11:07.7923494Z   "inventory": {
2025-08-10T01:11:07.7923795Z     "append": [
2025-08-10T01:11:07.7924087Z       "potion"
2025-08-10T01:11:07.7924360Z     ]
2025-08-10T01:11:07.7924620Z   },
2025-08-10T01:11:07.7924917Z   "core_memories": [
2025-08-10T01:11:07.7925253Z     "memory1",
2025-08-10T01:11:07.7925561Z     "memory2"
2025-08-10T01:11:07.7925863Z   ],
2025-08-10T01:11:07.7926148Z   "simple_value": "new",
2025-08-10T01:11:07.7926503Z   "new_key": "new_value"
2025-08-10T01:11:07.7926825Z }
2025-08-10T01:11:07.7927268Z 2025-08-10 01:11:07,788 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7928292Z   "level": 2,
2025-08-10T01:11:07.7928581Z   "gold": 100
2025-08-10T01:11:07.7928875Z }
2025-08-10T01:11:07.7929310Z 2025-08-10 01:11:07,788 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7930071Z 2025-08-10 01:11:07,788 - INFO - update_state: Detected explicit append for 'inventory'.
2025-08-10T01:11:07.7930839Z 2025-08-10 01:11:07,788 - INFO - APPEND/SAFEGUARD: Added 1 new items to 'inventory'.
2025-08-10T01:11:07.7932259Z 2025-08-10 01:11:07,788 - WARNING - ‚ö†Ô∏è CRITICAL SAFEGUARD: Intercepted direct overwrite on 'core_memories'. Converting to safe, deduplicated append.
2025-08-10T01:11:07.7933604Z 2025-08-10 01:11:07,788 - INFO - APPEND/SAFEGUARD: Added 1 new items to 'core_memories'.
2025-08-10T01:11:07.7934336Z 2025-08-10 01:11:07,788 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7935023Z .2025-08-10 01:11:07,788 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7935607Z   "player": {
2025-08-10T01:11:07.7935935Z     "level": 2,
2025-08-10T01:11:07.7936234Z     "stats": {
2025-08-10T01:11:07.7936519Z       "mp": 50
2025-08-10T01:11:07.7936805Z     }
2025-08-10T01:11:07.7937068Z   },
2025-08-10T01:11:07.7937323Z   "world": {
2025-08-10T01:11:07.7937627Z     "weather": "sunny"
2025-08-10T01:11:07.7938150Z   }
2025-08-10T01:11:07.7938430Z }
2025-08-10T01:11:07.7938929Z 2025-08-10 01:11:07,789 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7939506Z   "level": 2,
2025-08-10T01:11:07.7939792Z   "stats": {
2025-08-10T01:11:07.7940068Z     "mp": 50
2025-08-10T01:11:07.7940345Z   }
2025-08-10T01:11:07.7940599Z }
2025-08-10T01:11:07.7941033Z 2025-08-10 01:11:07,790 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7941603Z   "mp": 50
2025-08-10T01:11:07.7941905Z }
2025-08-10T01:11:07.7942337Z 2025-08-10 01:11:07,790 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7943014Z 2025-08-10 01:11:07,790 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7943750Z 2025-08-10 01:11:07,791 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7944337Z   "weather": "sunny"
2025-08-10T01:11:07.7944641Z }
2025-08-10T01:11:07.7945050Z 2025-08-10 01:11:07,791 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7945753Z 2025-08-10 01:11:07,791 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7946524Z .2025-08-10 01:11:07,791 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7947112Z   "key1": "new_value",
2025-08-10T01:11:07.7947477Z   "key3": "added_value"
2025-08-10T01:11:07.7947957Z }
2025-08-10T01:11:07.7948393Z 2025-08-10 01:11:07,791 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7949155Z .2025-08-10 01:11:07,792 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7949744Z   "game_data": {
2025-08-10T01:11:07.7950052Z     "player_info": {
2025-08-10T01:11:07.7950396Z       "character_sheet": {
2025-08-10T01:11:07.7950759Z         "name": "UpdatedHero",
2025-08-10T01:11:07.7951132Z         "level": 5,
2025-08-10T01:11:07.7951467Z         "health_ratio": 0.8,
2025-08-10T01:11:07.7951870Z         "is_active": false,
2025-08-10T01:11:07.7952267Z         "special_items": [
2025-08-10T01:11:07.7952641Z           "magic_ring"
2025-08-10T01:11:07.7952983Z         ],
2025-08-10T01:11:07.7953292Z         "skills": {
2025-08-10T01:11:07.7953634Z           "append": [
2025-08-10T01:11:07.7953991Z             "fireball",
2025-08-10T01:11:07.7954343Z             "heal"
2025-08-10T01:11:07.7954667Z           ]
2025-08-10T01:11:07.7954961Z         },
2025-08-10T01:11:07.7955270Z         "attributes": {
2025-08-10T01:11:07.7955630Z           "strength": 15,
2025-08-10T01:11:07.7956032Z ... (truncated, showing 19/60 lines)
2025-08-10T01:11:07.7956664Z 2025-08-10 01:11:07,792 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7957298Z   "player_info": {
2025-08-10T01:11:07.7958090Z     "character_sheet": {
2025-08-10T01:11:07.7958511Z       "name": "UpdatedHero",
2025-08-10T01:11:07.7958903Z       "level": 5,
2025-08-10T01:11:07.7959235Z       "health_ratio": 0.8,
2025-08-10T01:11:07.7959626Z       "is_active": false,
2025-08-10T01:11:07.7960012Z       "special_items": [
2025-08-10T01:11:07.7960372Z         "magic_ring"
2025-08-10T01:11:07.7960696Z       ],
2025-08-10T01:11:07.7960969Z       "skills": {
2025-08-10T01:11:07.7961265Z         "append": [
2025-08-10T01:11:07.7961601Z           "fireball",
2025-08-10T01:11:07.7961943Z           "heal"
2025-08-10T01:11:07.7962484Z         ]
2025-08-10T01:11:07.7962781Z       },
2025-08-10T01:11:07.7963095Z       "attributes": {
2025-08-10T01:11:07.7963454Z         "strength": 15,
2025-08-10T01:11:07.7963817Z         "wisdom": 14
2025-08-10T01:11:07.7964192Z ... (truncated, showing 19/23 lines)
2025-08-10T01:11:07.7964831Z 2025-08-10 01:11:07,792 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7965495Z   "character_sheet": {
2025-08-10T01:11:07.7965876Z     "name": "UpdatedHero",
2025-08-10T01:11:07.7966198Z     "level": 5,
2025-08-10T01:11:07.7966493Z     "health_ratio": 0.8,
2025-08-10T01:11:07.7966834Z     "is_active": false,
2025-08-10T01:11:07.7967162Z     "special_items": [
2025-08-10T01:11:07.7967475Z       "magic_ring"
2025-08-10T01:11:07.7967958Z     ],
2025-08-10T01:11:07.7968247Z     "skills": {
2025-08-10T01:11:07.7968550Z       "append": [
2025-08-10T01:11:07.7968865Z         "fireball",
2025-08-10T01:11:07.7969160Z         "heal"
2025-08-10T01:11:07.7969438Z       ]
2025-08-10T01:11:07.7969710Z     },
2025-08-10T01:11:07.7969981Z     "attributes": {
2025-08-10T01:11:07.7970288Z       "strength": 15,
2025-08-10T01:11:07.7970608Z       "wisdom": 14
2025-08-10T01:11:07.7970903Z     }
2025-08-10T01:11:07.7971193Z ... (truncated, showing 19/21 lines)
2025-08-10T01:11:07.7971773Z 2025-08-10 01:11:07,793 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7972352Z   "name": "UpdatedHero",
2025-08-10T01:11:07.7972658Z   "level": 5,
2025-08-10T01:11:07.7972928Z   "health_ratio": 0.8,
2025-08-10T01:11:07.7973245Z   "is_active": false,
2025-08-10T01:11:07.7973538Z   "special_items": [
2025-08-10T01:11:07.7973819Z     "magic_ring"
2025-08-10T01:11:07.7974082Z   ],
2025-08-10T01:11:07.7974325Z   "skills": {
2025-08-10T01:11:07.7974582Z     "append": [
2025-08-10T01:11:07.7974844Z       "fireball",
2025-08-10T01:11:07.7975108Z       "heal"
2025-08-10T01:11:07.7975350Z     ]
2025-08-10T01:11:07.7975582Z   },
2025-08-10T01:11:07.7975838Z   "attributes": {
2025-08-10T01:11:07.7976122Z     "strength": 15,
2025-08-10T01:11:07.7976397Z     "wisdom": 14
2025-08-10T01:11:07.7976669Z   }
2025-08-10T01:11:07.7976904Z }
2025-08-10T01:11:07.7977342Z 2025-08-10 01:11:07,793 - INFO - update_state: Detected explicit append for 'skills'.
2025-08-10T01:11:07.7978187Z 2025-08-10 01:11:07,793 - INFO - APPEND/SAFEGUARD: Added 2 new items to 'skills'.
2025-08-10T01:11:07.7978935Z 2025-08-10 01:11:07,794 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7979455Z   "strength": 15,
2025-08-10T01:11:07.7979715Z   "wisdom": 14
2025-08-10T01:11:07.7979972Z }
2025-08-10T01:11:07.7980347Z 2025-08-10 01:11:07,794 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7980968Z 2025-08-10 01:11:07,794 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7981572Z 2025-08-10 01:11:07,794 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7982188Z 2025-08-10 01:11:07,794 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.7982839Z 2025-08-10 01:11:07,794 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7983382Z   "environment": {
2025-08-10T01:11:07.7983693Z     "current_location": {
2025-08-10T01:11:07.7984022Z       "danger_level": 2,
2025-08-10T01:11:07.7984330Z       "weather_factor": 0.3,
2025-08-10T01:11:07.7984674Z       "is_discovered": false,
2025-08-10T01:11:07.7985246Z       "hidden_treasure": "gold_coins",
2025-08-10T01:11:07.7985617Z       "npcs": {
2025-08-10T01:11:07.7985875Z         "append": [
2025-08-10T01:11:07.7986163Z           "merchant",
2025-08-10T01:11:07.7986445Z           "guard"
2025-08-10T01:11:07.7986704Z         ]
2025-08-10T01:11:07.7986940Z       },
2025-08-10T01:11:07.7987199Z       "connections": {
2025-08-10T01:11:07.7987486Z         "east": "mountain",
2025-08-10T01:11:07.7987953Z         "west": null
2025-08-10T01:11:07.7988233Z       }
2025-08-10T01:11:07.7988462Z     }
2025-08-10T01:11:07.7988706Z   }
2025-08-10T01:11:07.7989102Z }
2025-08-10T01:11:07.7989518Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7990068Z   "current_location": {
2025-08-10T01:11:07.7990392Z     "danger_level": 2,
2025-08-10T01:11:07.7990695Z     "weather_factor": 0.3,
2025-08-10T01:11:07.7991027Z     "is_discovered": false,
2025-08-10T01:11:07.7991366Z     "hidden_treasure": "gold_coins",
2025-08-10T01:11:07.7991729Z     "npcs": {
2025-08-10T01:11:07.7992004Z       "append": [
2025-08-10T01:11:07.7992281Z         "merchant",
2025-08-10T01:11:07.7992543Z         "guard"
2025-08-10T01:11:07.7992796Z       ]
2025-08-10T01:11:07.7993036Z     },
2025-08-10T01:11:07.7993282Z     "connections": {
2025-08-10T01:11:07.7993576Z       "east": "mountain",
2025-08-10T01:11:07.7993888Z       "west": null
2025-08-10T01:11:07.7994151Z     }
2025-08-10T01:11:07.7994377Z   }
2025-08-10T01:11:07.7994606Z }
2025-08-10T01:11:07.7995004Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.7995556Z   "danger_level": 2,
2025-08-10T01:11:07.7995851Z   "weather_factor": 0.3,
2025-08-10T01:11:07.7996166Z   "is_discovered": false,
2025-08-10T01:11:07.7996484Z   "hidden_treasure": "gold_coins",
2025-08-10T01:11:07.7996826Z   "npcs": {
2025-08-10T01:11:07.7997079Z     "append": [
2025-08-10T01:11:07.7997329Z       "merchant",
2025-08-10T01:11:07.7997599Z       "guard"
2025-08-10T01:11:07.7997995Z     ]
2025-08-10T01:11:07.7998222Z   },
2025-08-10T01:11:07.7998458Z   "connections": {
2025-08-10T01:11:07.7998747Z     "east": "mountain",
2025-08-10T01:11:07.7999037Z     "west": null
2025-08-10T01:11:07.7999301Z   }
2025-08-10T01:11:07.7999527Z }
2025-08-10T01:11:07.7999920Z 2025-08-10 01:11:07,795 - INFO - update_state: Detected explicit append for 'npcs'.
2025-08-10T01:11:07.8000603Z 2025-08-10 01:11:07,795 - INFO - APPEND/SAFEGUARD: Added 2 new items to 'npcs'.
2025-08-10T01:11:07.8001344Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.8001874Z   "east": "mountain",
2025-08-10T01:11:07.8002148Z   "west": null
2025-08-10T01:11:07.8002397Z }
2025-08-10T01:11:07.8002774Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8003411Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8004025Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8004642Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8005278Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.8005794Z   "session_info": {
2025-08-10T01:11:07.8006098Z     "start_time": "2023-06-15 14:30:45+00:00",
2025-08-10T01:11:07.8006475Z     "session_id": 12345,
2025-08-10T01:11:07.8006787Z     "is_tutorial": false,
2025-08-10T01:11:07.8007096Z     "notes": null,
2025-08-10T01:11:07.8007388Z     "participants": [
2025-08-10T01:11:07.8007670Z       "player1"
2025-08-10T01:11:07.8008074Z     ],
2025-08-10T01:11:07.8008317Z     "settings": {
2025-08-10T01:11:07.8008598Z       "difficulty": "normal",
2025-08-10T01:11:07.8008936Z       "auto_save": true
2025-08-10T01:11:07.8009219Z     }
2025-08-10T01:11:07.8009461Z   }
2025-08-10T01:11:07.8009680Z }
2025-08-10T01:11:07.8010072Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.8010775Z   "start_time": "2023-06-15 14:30:45+00:00",
2025-08-10T01:11:07.8011136Z   "session_id": 12345,
2025-08-10T01:11:07.8011439Z   "is_tutorial": false,
2025-08-10T01:11:07.8011726Z   "notes": null,
2025-08-10T01:11:07.8012000Z   "participants": [
2025-08-10T01:11:07.8012289Z     "player1"
2025-08-10T01:11:07.8012536Z   ],
2025-08-10T01:11:07.8012761Z   "settings": {
2025-08-10T01:11:07.8013047Z     "difficulty": "normal",
2025-08-10T01:11:07.8013364Z     "auto_save": true
2025-08-10T01:11:07.8013637Z   }
2025-08-10T01:11:07.8013859Z }
2025-08-10T01:11:07.8014245Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.8014919Z   "difficulty": "normal",
2025-08-10T01:11:07.8015218Z   "auto_save": true
2025-08-10T01:11:07.8015478Z }
2025-08-10T01:11:07.8015830Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8016419Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8017022Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8017616Z 2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8018401Z .2025-08-10 01:11:07,795 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.8018917Z   "container1": {
2025-08-10T01:11:07.8019191Z     "container2": {
2025-08-10T01:11:07.8019462Z       "container3": {
2025-08-10T01:11:07.8019752Z         "empty_list": {
2025-08-10T01:11:07.8020041Z           "append": [
2025-08-10T01:11:07.8020329Z             "first_item"
2025-08-10T01:11:07.8020603Z           ]
2025-08-10T01:11:07.8020841Z         },
2025-08-10T01:11:07.8021089Z         "empty_dict": {
2025-08-10T01:11:07.8021386Z           "new_key": "new_value"
2025-08-10T01:11:07.8021707Z         },
2025-08-10T01:11:07.8021954Z         "zero_int": 42,
2025-08-10T01:11:07.8022240Z         "zero_float": 3.14,
2025-08-10T01:11:07.8022565Z         "false_bool": true,
2025-08-10T01:11:07.8022902Z         "empty_string": "now_has_content",
2025-08-10T01:11:07.8023298Z         "completely_new": "brand_new_value"
2025-08-10T01:11:07.8023665Z       }
2025-08-10T01:11:07.8023899Z     }
2025-08-10T01:11:07.8024153Z ... (truncated, showing 19/21 lines)
2025-08-10T01:11:07.8024692Z 2025-08-10 01:11:07,796 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.8025209Z   "container2": {
2025-08-10T01:11:07.8025496Z     "container3": {
2025-08-10T01:11:07.8025773Z       "empty_list": {
2025-08-10T01:11:07.8026058Z         "append": [
2025-08-10T01:11:07.8026333Z           "first_item"
2025-08-10T01:11:07.8026604Z         ]
2025-08-10T01:11:07.8026840Z       },
2025-08-10T01:11:07.8027088Z       "empty_dict": {
2025-08-10T01:11:07.8027376Z         "new_key": "new_value"
2025-08-10T01:11:07.8027699Z       },
2025-08-10T01:11:07.8028088Z       "zero_int": 42,
2025-08-10T01:11:07.8028380Z       "zero_float": 3.14,
2025-08-10T01:11:07.8028699Z       "false_bool": true,
2025-08-10T01:11:07.8029024Z       "empty_string": "now_has_content",
2025-08-10T01:11:07.8029416Z       "completely_new": "brand_new_value"
2025-08-10T01:11:07.8029773Z     }
2025-08-10T01:11:07.8029997Z   }
2025-08-10T01:11:07.8030224Z }
2025-08-10T01:11:07.8030626Z 2025-08-10 01:11:07,796 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.8031137Z   "container3": {
2025-08-10T01:11:07.8031407Z     "empty_list": {
2025-08-10T01:11:07.8031675Z       "append": [
2025-08-10T01:11:07.8031942Z         "first_item"
2025-08-10T01:11:07.8032211Z       ]
2025-08-10T01:11:07.8032440Z     },
2025-08-10T01:11:07.8032689Z     "empty_dict": {
2025-08-10T01:11:07.8032976Z       "new_key": "new_value"
2025-08-10T01:11:07.8033275Z     },
2025-08-10T01:11:07.8033521Z     "zero_int": 42,
2025-08-10T01:11:07.8033802Z     "zero_float": 3.14,
2025-08-10T01:11:07.8034108Z     "false_bool": true,
2025-08-10T01:11:07.8034436Z     "empty_string": "now_has_content",
2025-08-10T01:11:07.8035000Z     "completely_new": "brand_new_value"
2025-08-10T01:11:07.8035365Z   }
2025-08-10T01:11:07.8035596Z }
2025-08-10T01:11:07.8035983Z 2025-08-10 01:11:07,796 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.8036491Z   "empty_list": {
2025-08-10T01:11:07.8036757Z     "append": [
2025-08-10T01:11:07.8037024Z       "first_item"
2025-08-10T01:11:07.8037281Z     ]
2025-08-10T01:11:07.8037507Z   },
2025-08-10T01:11:07.8037870Z   "empty_dict": {
2025-08-10T01:11:07.8038148Z     "new_key": "new_value"
2025-08-10T01:11:07.8038443Z   },
2025-08-10T01:11:07.8038839Z   "zero_int": 42,
2025-08-10T01:11:07.8039110Z   "zero_float": 3.14,
2025-08-10T01:11:07.8039393Z   "false_bool": true,
2025-08-10T01:11:07.8039695Z   "empty_string": "now_has_content",
2025-08-10T01:11:07.8040072Z   "completely_new": "brand_new_value"
2025-08-10T01:11:07.8040409Z }
2025-08-10T01:11:07.8040840Z 2025-08-10 01:11:07,796 - INFO - update_state: Detected explicit append for 'empty_list'.
2025-08-10T01:11:07.8041568Z 2025-08-10 01:11:07,796 - INFO - APPEND/SAFEGUARD: Added 1 new items to 'empty_list'.
2025-08-10T01:11:07.8042231Z 2025-08-10 01:11:07,796 - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:11:07.8042756Z   "new_key": "new_value"
2025-08-10T01:11:07.8043046Z }
2025-08-10T01:11:07.8043412Z 2025-08-10 01:11:07,796 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8044012Z 2025-08-10 01:11:07,796 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8044597Z 2025-08-10 01:11:07,796 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8045205Z 2025-08-10 01:11:07,796 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8045791Z 2025-08-10 01:11:07,796 - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:11:07.8046255Z .
2025-08-10T01:11:07.8046572Z ----------------------------------------------------------------------
2025-08-10T01:11:07.8047010Z Ran 51 tests in 0.012s
2025-08-10T01:11:07.8047209Z
2025-08-10T01:11:07.8047310Z OK
2025-08-10T01:11:07.9867384Z ‚úÖ PASS: tests/test_game_state.py
2025-08-10T01:11:07.9869178Z ----------------------------------------
2025-08-10T01:11:07.9869702Z Running: tests/test_game_state_division_by_zero.py
2025-08-10T01:11:08.0333059Z .......
2025-08-10T01:11:08.0333545Z ----------------------------------------------------------------------
2025-08-10T01:11:08.0334091Z Ran 7 tests in 0.000s
2025-08-10T01:11:08.0334328Z
2025-08-10T01:11:08.0334451Z OK
2025-08-10T01:11:08.0398808Z ‚úÖ PASS: tests/test_game_state_division_by_zero.py
2025-08-10T01:11:08.0400215Z ----------------------------------------
2025-08-10T01:11:08.0400727Z Running: tests/test_gemini_entity_sanitization.py
2025-08-10T01:11:09.0324697Z .........
2025-08-10T01:11:09.0326607Z ----------------------------------------------------------------------
2025-08-10T01:11:09.0328544Z Ran 9 tests in 0.001s
2025-08-10T01:11:09.0328764Z
2025-08-10T01:11:09.0328883Z OK
2025-08-10T01:11:09.1645329Z ‚úÖ PASS: tests/test_gemini_entity_sanitization.py
2025-08-10T01:11:09.1647352Z ----------------------------------------
2025-08-10T01:11:09.1649153Z Running: tests/test_gemini_request_tdd.py
2025-08-10T01:11:10.1670777Z 2025-08-10 01:11:10,166 - WARNING - ‚ö†Ô∏è CHECKPOINT_VALIDATION: Found 1 potential discrepancies:
2025-08-10T01:11:10.1673732Z 2025-08-10 01:11:10,166 - WARNING - ‚ö†Ô∏è   1. State location 'Enchanted Forest' conflicts with narrative mentioning tavern
2025-08-10T01:11:10.1679302Z 2025-08-10 01:11:10,167 - INFO - Cache MISS for master_directive.md: loaded and cached 8299 characters (~2074 tokens)
2025-08-10T01:11:10.1680579Z 2025-08-10 01:11:10,167 - INFO - Cache MISS for game_state_instruction.md: loaded and cached 56680 characters (~14170 tokens)
2025-08-10T01:11:10.1683298Z 2025-08-10 01:11:10,167 - INFO - Cache MISS for character_template.md: loaded and cached 6696 characters (~1674 tokens)
2025-08-10T01:11:10.1684539Z 2025-08-10 01:11:10,168 - INFO - Cache MISS for narrative_system_instruction.md: loaded and cached 40868 characters (~10217 tokens)
2025-08-10T01:11:10.1686549Z 2025-08-10 01:11:10,168 - INFO - Cache MISS for dnd_srd_instruction.md: loaded and cached 1216 characters (~304 tokens)
2025-08-10T01:11:10.1689471Z 2025-08-10 01:11:10,168 - INFO - Prompt scaffold is 134 chars (~33 tokens). Remaining budget for story: 2999866 chars (~749966 tokens)
2025-08-10T01:11:10.1699983Z 2025-08-10 01:11:10,169 - INFO - Initial context stats: Turns: 2, Tokens: <MagicMock name='get_client().models.count_tokens().total_tokens' id='139798091364752'> (est: 11), Core Memories: 0
2025-08-10T01:11:10.1715845Z 2025-08-10 01:11:10,171 - INFO - Context is within token budget. No truncation needed.
2025-08-10T01:11:10.1724787Z 2025-08-10 01:11:10,172 - INFO - Generated entity manifest for session 1, turn 3
2025-08-10T01:11:10.1729992Z 2025-08-10 01:11:10,172 - INFO - Successfully used GeminiRequest for structured JSON communication
2025-08-10T01:11:10.1742051Z 2025-08-10 01:11:10,174 - INFO - Comprehensive validation: 0/2 found, confidence: 0.00, warnings: 0
2025-08-10T01:11:10.1743538Z 2025-08-10 01:11:10,174 - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/2 found
2025-08-10T01:11:10.1746712Z 2025-08-10 01:11:10,174 - WARNING - ‚ö†Ô∏è ENTITY_TRACKING_VALIDATION: Narrative failed entity validation
2025-08-10T01:11:10.1750718Z 2025-08-10 01:11:10,174 - WARNING - ‚ö†Ô∏è Missing entities: ['Test Hero', 'Town Guard']
2025-08-10T01:11:10.1751789Z 2025-08-10 01:11:10,174 - INFO - ENTITY_TRACKING_RETRY: Attempting dual-pass generation to fix missing entities
2025-08-10T01:11:10.1752720Z 2025-08-10 01:11:10,174 - INFO - Starting dual-pass generation
2025-08-10T01:11:10.1754757Z 2025-08-10 01:11:10,174 - INFO - Filtered expected entities: ['Test Hero', 'Town Guard']
2025-08-10T01:11:10.1755574Z 2025-08-10 01:11:10,174 - INFO - Pass 1: Generating initial narrative
2025-08-10T01:11:10.1756424Z 2025-08-10 01:11:10,174 - INFO - STRUCTURED_GENERATION: Coverage rate 0.00, Schema valid: False
2025-08-10T01:11:10.1757896Z 2025-08-10 01:11:10,174 - WARNING - ‚ö†Ô∏è STRUCTURED_GENERATION: Missing from schema: ['town guard', 'test hero']
2025-08-10T01:11:10.1758889Z 2025-08-10 01:11:10,175 - INFO - Entity validation: 0/2 found, confidence: 0.00
2025-08-10T01:11:10.1759632Z 2025-08-10 01:11:10,175 - INFO - Pass 1 completed: 0/2 entities found
2025-08-10T01:11:10.1760472Z 2025-08-10 01:11:10,175 - INFO - Pass 2: Injecting missing entities: ['Test Hero', 'Town Guard']
2025-08-10T01:11:10.1761787Z 2025-08-10 01:11:10,175 - INFO - STRUCTURED_GENERATION: Coverage rate 0.00, Schema valid: False
2025-08-10T01:11:10.1763216Z 2025-08-10 01:11:10,175 - WARNING - ‚ö†Ô∏è STRUCTURED_GENERATION: Missing from schema: ['town guard', 'test hero']
2025-08-10T01:11:10.1765996Z 2025-08-10 01:11:10,175 - INFO - Entity validation: 0/2 found, confidence: 0.00
2025-08-10T01:11:10.1771320Z 2025-08-10 01:11:10,175 - INFO - Dual-pass completed: 0/2 entities found, improvement: False
2025-08-10T01:11:10.1772315Z 2025-08-10 01:11:10,175 - INFO - Updated structured_response.narrative with dual-pass result
2025-08-10T01:11:10.1773197Z 2025-08-10 01:11:10,175 - INFO - ENTITY_TRACKING_RETRY: Dual-pass succeeded. Entities recovered: 0
2025-08-10T01:11:10.1774089Z 2025-08-10 01:11:10,175 - INFO - Comprehensive validation: 0/2 found, confidence: 0.00, warnings: 0
2025-08-10T01:11:10.1774944Z 2025-08-10 01:11:10,175 - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/2 found
2025-08-10T01:11:10.1776021Z 2025-08-10 01:11:10,175 - WARNING - ‚ö†Ô∏è ENTITY_TRACKING_VALIDATION: Narrative failed entity validation
2025-08-10T01:11:10.1776921Z 2025-08-10 01:11:10,175 - WARNING - ‚ö†Ô∏è Missing entities: ['Test Hero', 'Town Guard']
2025-08-10T01:11:10.1778112Z 2025-08-10 01:11:10,175 - WARNING - ‚ö†Ô∏è ‚ö†Ô∏è PLANNING_BLOCK_MISSING: Story mode response missing required planning block
2025-08-10T01:11:10.1779058Z 2025-08-10 01:11:10,176 - INFO - üîç PLANNING_BLOCK_REGENERATION: Sending prompt to API
2025-08-10T01:11:10.1779756Z 2025-08-10 01:11:10,176 - INFO - üîç PLANNING_BLOCK_PROMPT:
2025-08-10T01:11:10.1780660Z CRITICAL: Generate planning options ONLY for Test Hero in Enchanted Forest.
2025-08-10T01:11:10.1781428Z DO NOT reference other characters, campaigns, or unrelated narrative elements.
2025-08-10T01:11:10.1781889Z
2025-08-10T01:11:10.1782069Z Generate ONLY a planning block using the st...
2025-08-10T01:11:10.1782848Z 2025-08-10 01:11:10,176 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_RESPONSE): Length: 47 chars
2025-08-10T01:11:10.1784042Z 2025-08-10 01:11:10,176 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_RESPONSE): Content: {"narrative": "You continue your adventure..."}
2025-08-10T01:11:10.1785322Z 2025-08-10 01:11:10,176 - INFO - üîç PLANNING_BLOCK_PARSING: Attempting to parse response
2025-08-10T01:11:10.1786168Z 2025-08-10 01:11:10,176 - INFO - üîç PLANNING_BLOCK_PARSING_RESULT: planning_text length: 30
2025-08-10T01:11:10.1787065Z 2025-08-10 01:11:10,176 - INFO - üîç PLANNING_BLOCK_PARSING_RESULT: structured_response exists: True
2025-08-10T01:11:10.1788135Z 2025-08-10 01:11:10,176 - INFO - üîç PLANNING_BLOCK_SOURCE: Using raw planning_text (length: 30)
2025-08-10T01:11:10.1789055Z 2025-08-10 01:11:10,176 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_CONTENT): Length: 30 chars
2025-08-10T01:11:10.1790109Z 2025-08-10 01:11:10,176 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_CONTENT): Content: You continue your adventure...
2025-08-10T01:11:10.1791206Z 2025-08-10 01:11:10,176 - INFO - üîç VALIDATION_SUCCESS: String planning block passed validation (length: 30)
2025-08-10T01:11:10.1792174Z 2025-08-10 01:11:10,176 - INFO - Updated structured_response.planning_block with raw LLM content (JSON parse failed)
2025-08-10T01:11:10.1792991Z 2025-08-10 01:11:10,176 - INFO - Added LLM-generated standard planning block
2025-08-10T01:11:10.1793683Z ..2025-08-10 01:11:10,176 - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:10.1794350Z 2025-08-10 01:11:10,176 - INFO - Mock mode: Generating companions as requested
2025-08-10T01:11:10.1794848Z .
2025-08-10T01:11:10.1795163Z ----------------------------------------------------------------------
2025-08-10T01:11:10.1795604Z Ran 3 tests in 0.012s
2025-08-10T01:11:10.1795796Z
2025-08-10T01:11:10.1795906Z OK
2025-08-10T01:11:10.3581319Z ‚úÖ PASS: tests/test_gemini_request_tdd.py
2025-08-10T01:11:10.3582807Z ----------------------------------------
2025-08-10T01:11:10.3583323Z Running: tests/test_gemini_request_validation.py
2025-08-10T01:11:10.4054671Z test_build_initial_story_validates_parameters (__main__.TestGeminiRequestValidation.test_build_initial_story_validates_parameters)
2025-08-10T01:11:10.4057201Z Test that build_initial_story validates input parameters. ... ok
2025-08-10T01:11:10.4058605Z test_build_story_continuation_validates_parameters (__main__.TestGeminiRequestValidation.test_build_story_continuation_validates_parameters)
2025-08-10T01:11:10.4059854Z Test that build_story_continuation validates input parameters. ... ok
2025-08-10T01:11:10.4060946Z test_empty_game_mode_raises_validation_error (__main__.TestGeminiRequestValidation.test_empty_game_mode_raises_validation_error)
2025-08-10T01:11:10.4061991Z Test that empty game_mode raises ValidationError. ... ok
2025-08-10T01:11:10.4062967Z test_empty_user_id_raises_validation_error (__main__.TestGeminiRequestValidation.test_empty_user_id_raises_validation_error)
2025-08-10T01:11:10.4063961Z Test that empty user_id raises ValidationError. ... ok
2025-08-10T01:11:10.4064927Z test_json_serialization_error_handling (__main__.TestGeminiRequestValidation.test_json_serialization_error_handling)
2025-08-10T01:11:10.4066327Z Test that JSON serialization errors are properly handled. ... Failed to validate payload size: Circular reference detected
2025-08-10T01:11:10.4067212Z ok
2025-08-10T01:11:10.4071807Z test_large_payload_raises_payload_too_large_error (__main__.TestGeminiRequestValidation.test_large_payload_raises_payload_too_large_error)
2025-08-10T01:11:10.4073020Z Test that oversized JSON payload raises PayloadTooLargeError. ... ok
2025-08-10T01:11:10.4078739Z test_too_long_checkpoint_block_raises_validation_error (__main__.TestGeminiRequestValidation.test_too_long_checkpoint_block_raises_validation_error)
2025-08-10T01:11:10.4087226Z Test that overly long checkpoint_block raises ValidationError. ... ok
2025-08-10T01:11:10.4088519Z test_too_long_user_action_raises_validation_error (__main__.TestGeminiRequestValidation.test_too_long_user_action_raises_validation_error)
2025-08-10T01:11:10.4089552Z Test that overly long user_action raises ValidationError. ... ok
2025-08-10T01:11:10.4090449Z test_valid_request_passes_validation (__main__.TestGeminiRequestValidation.test_valid_request_passes_validation)
2025-08-10T01:11:10.4091705Z Test that valid GeminiRequest passes all validation. ... ok
2025-08-10T01:11:10.4092725Z test_whitespace_user_id_raises_validation_error (__main__.TestGeminiRequestValidation.test_whitespace_user_id_raises_validation_error)
2025-08-10T01:11:10.4093767Z Test that whitespace-only user_id raises ValidationError. ... ok
2025-08-10T01:11:10.4094969Z test_wrong_core_memories_item_type_raises_validation_error (__main__.TestGeminiRequestValidation.test_wrong_core_memories_item_type_raises_validation_error)
2025-08-10T01:11:10.4098704Z Test that non-string items in core_memories raise ValidationError. ... ok
2025-08-10T01:11:10.4103576Z test_wrong_core_memories_type_raises_validation_error (__main__.TestGeminiRequestValidation.test_wrong_core_memories_type_raises_validation_error)
2025-08-10T01:11:10.4104692Z Test that non-list core_memories raises ValidationError. ... ok
2025-08-10T01:11:10.4105812Z test_wrong_game_state_type_raises_validation_error (__main__.TestGeminiRequestValidation.test_wrong_game_state_type_raises_validation_error)
2025-08-10T01:11:10.4106855Z Test that non-dict game_state raises ValidationError. ... ok
2025-08-10T01:11:10.4108100Z test_wrong_story_history_type_raises_validation_error (__main__.TestGeminiRequestValidation.test_wrong_story_history_type_raises_validation_error)
2025-08-10T01:11:10.4109243Z Test that non-list story_history raises ValidationError. ... ok
2025-08-10T01:11:10.4109660Z
2025-08-10T01:11:10.4109880Z ----------------------------------------------------------------------
2025-08-10T01:11:10.4110375Z Ran 14 tests in 0.003s
2025-08-10T01:11:10.4110583Z
2025-08-10T01:11:10.4110693Z OK
2025-08-10T01:11:10.4172735Z ‚úÖ PASS: tests/test_gemini_request_validation.py
2025-08-10T01:11:10.4178586Z ----------------------------------------
2025-08-10T01:11:10.4179084Z Running: tests/test_gemini_response.py
2025-08-10T01:11:11.4263683Z 2025-08-10 01:11:11,426 - WARNING - ‚ö†Ô∏è No specific system prompts selected for continue_story. Using none.
2025-08-10T01:11:11.4265352Z 2025-08-10 01:11:11,426 - INFO - Cache MISS for master_directive.md: loaded and cached 8299 characters (~2074 tokens)
2025-08-10T01:11:11.4267693Z 2025-08-10 01:11:11,426 - INFO - Cache MISS for game_state_instruction.md: loaded and cached 56680 characters (~14170 tokens)
2025-08-10T01:11:11.4270309Z 2025-08-10 01:11:11,426 - INFO - Cache MISS for dnd_srd_instruction.md: loaded and cached 1216 characters (~304 tokens)
2025-08-10T01:11:11.4275282Z 2025-08-10 01:11:11,427 - INFO - Prompt scaffold is 125 chars (~31 tokens). Remaining budget for story: 2999875 chars (~749968 tokens)
2025-08-10T01:11:11.4276258Z 2025-08-10 01:11:11,427 - INFO - Initial context stats: Turns: 0, Tokens: 0
2025-08-10T01:11:11.4292123Z 2025-08-10 01:11:11,429 - INFO - Context is within token budget. No truncation needed.
2025-08-10T01:11:11.4299094Z 2025-08-10 01:11:11,429 - INFO - Generated entity manifest for session 1, turn 1
2025-08-10T01:11:11.4302839Z 2025-08-10 01:11:11,430 - INFO - Calling Gemini API with prompt: GeminiRequest: I approach the barkeep......
2025-08-10T01:11:11.4304445Z 2025-08-10 01:11:11,430 - INFO - Calling Gemini API: 70087 characters (~17521 tokens)
2025-08-10T01:11:11.4311067Z 2025-08-10 01:11:11,430 - WARNING - ‚ö†Ô∏è Could not count tokens before API call: unsupported operand type(s) for +: 'Mock' and 'Mock'
2025-08-10T01:11:11.4312799Z 2025-08-10 01:11:11,430 - INFO - Using model: gemini-1.5-flash
2025-08-10T01:11:11.4318683Z 2025-08-10 01:11:11,431 - INFO - Successfully used GeminiRequest for structured JSON communication
2025-08-10T01:11:11.4327015Z 2025-08-10 01:11:11,432 - INFO - Comprehensive validation: 0/0 found, confidence: 1.00, warnings: 0
2025-08-10T01:11:11.4328476Z 2025-08-10 01:11:11,432 - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/1 found
2025-08-10T01:11:11.4331656Z 2025-08-10 01:11:11,432 - INFO - Comprehensive validation: 0/0 found, confidence: 1.00, warnings: 0
2025-08-10T01:11:11.4334762Z 2025-08-10 01:11:11,432 - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/1 found
2025-08-10T01:11:11.4342058Z ......2025-08-10 01:11:11,433 - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:11.4343413Z 2025-08-10 01:11:11,434 - INFO - Mock mode: No companions requested
2025-08-10T01:11:11.4350654Z ....2025-08-10 01:11:11,434 - WARNING - ‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:11.4360811Z 2025-08-10 01:11:11,435 - ERROR - üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:11.4362039Z 2025-08-10 01:11:11,435 - INFO - No JSON found in response, treating as plain text narrative
2025-08-10T01:11:11.4364632Z 2025-08-10 01:11:11,436 - INFO - Recovered from incomplete JSON response. Narrative length: 42 characters (~10 tokens)
2025-08-10T01:11:11.4365366Z ..
2025-08-10T01:11:11.4365726Z ----------------------------------------------------------------------
2025-08-10T01:11:11.4366186Z Ran 12 tests in 0.011s
2025-08-10T01:11:11.4366412Z
2025-08-10T01:11:11.4366523Z OK
2025-08-10T01:11:11.5714875Z ‚úÖ PASS: tests/test_gemini_response.py
2025-08-10T01:11:11.5718207Z ----------------------------------------
2025-08-10T01:11:11.5718725Z Running: tests/test_gemini_response_integration.py
2025-08-10T01:11:11.9175642Z 2025-08-10 01:11:11,917 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:11.9258880Z test_mcp_campaign_creation_error_handling (__main__.TestGeminiResponseIntegration.test_mcp_campaign_creation_error_handling)
2025-08-10T01:11:11.9275615Z Test that MCP handles campaign creation errors gracefully. ... 2025-08-10 01:11:11,927 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:11.9285731Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:11.9288045Z   setup_file_logging()
2025-08-10T01:11:11.9289271Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:11.9391365Z 2025-08-10 01:11:11,939 - main - INFO - Received campaign creation request:
2025-08-10T01:11:11.9392431Z 2025-08-10 01:11:11,939 - main - INFO -   Character:
2025-08-10T01:11:11.9393375Z 2025-08-10 01:11:11,939 - main - INFO -   Setting:
2025-08-10T01:11:11.9394349Z 2025-08-10 01:11:11,939 - main - INFO -   Description:
2025-08-10T01:11:11.9395407Z 2025-08-10 01:11:11,939 - main - INFO -   Custom options: []
2025-08-10T01:11:11.9396473Z 2025-08-10 01:11:11,939 - main - INFO -   Selected prompts: []
2025-08-10T01:11:12.1936009Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:12.1943420Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:12.2149633Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:12.2152915Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:12.9357127Z ok
2025-08-10T01:11:12.9358408Z test_mcp_campaign_creation_with_different_prompts (__main__.TestGeminiResponseIntegration.test_mcp_campaign_creation_with_different_prompts)
2025-08-10T01:11:12.9379455Z Test campaign creation with different prompt types through MCP. ... 2025-08-10 01:11:12,937 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:12.9383438Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:12.9385246Z   setup_file_logging()
2025-08-10T01:11:12.9385867Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:12.9448672Z 2025-08-10 01:11:12,944 - main - INFO - Received campaign creation request:
2025-08-10T01:11:12.9450984Z 2025-08-10 01:11:12,944 - main - INFO -   Character:
2025-08-10T01:11:12.9452970Z 2025-08-10 01:11:12,944 - main - INFO -   Setting:
2025-08-10T01:11:12.9453584Z 2025-08-10 01:11:12,944 - main - INFO -   Description:
2025-08-10T01:11:12.9454211Z 2025-08-10 01:11:12,944 - main - INFO -   Custom options: []
2025-08-10T01:11:12.9454901Z 2025-08-10 01:11:12,945 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:12.9491174Z 2025-08-10 01:11:12,948 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9493186Z 2025-08-10 01:11:12,948 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:12.9494054Z 2025-08-10 01:11:12,948 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:12.9533355Z 2025-08-10 01:11:12,953 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:12.9542757Z Args: ('mcp-gemini-test-user', 'MCP Test Campaign 0', 'Test campaign 0 through MCP', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 12, 948623, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:12.9551337Z Kwargs: {}
2025-08-10T01:11:12.9552253Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9553260Z Traceback:
2025-08-10T01:11:12.9553503Z Traceback (most recent call last):
2025-08-10T01:11:12.9554029Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:12.9554501Z     asyncio.get_running_loop()
2025-08-10T01:11:12.9554740Z RuntimeError: no running event loop
2025-08-10T01:11:12.9554914Z
2025-08-10T01:11:12.9555094Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:12.9555355Z
2025-08-10T01:11:12.9555445Z Traceback (most recent call last):
2025-08-10T01:11:12.9555946Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:12.9556420Z     return func(*args, **kwargs)
2025-08-10T01:11:12.9556868Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9557381Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:12.9558140Z     db = get_db()
2025-08-10T01:11:12.9558319Z          ^^^^^^^^
2025-08-10T01:11:12.9558760Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:12.9559251Z     return firestore.client()
2025-08-10T01:11:12.9559474Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9560051Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:12.9560935Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:12.9561339Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9561998Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:12.9562745Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:12.9563108Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9563738Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:12.9564373Z     self._services[name] = initializer(self)
2025-08-10T01:11:12.9564632Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9565236Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:12.9565868Z     credentials = app.credential.get_credential()
2025-08-10T01:11:12.9566147Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9566795Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:12.9567440Z     self._load_credential()
2025-08-10T01:11:12.9568276Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:12.9569023Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:12.9569515Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9570699Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:12.9572168Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:12.9574044Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9575695Z --- END EXCEPTION ---
2025-08-10T01:11:12.9577605Z 2025-08-10 01:11:12,953 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9579791Z 2025-08-10 01:11:12,954 - main - INFO - Received campaign creation request:
2025-08-10T01:11:12.9580477Z 2025-08-10 01:11:12,954 - main - INFO -   Character:
2025-08-10T01:11:12.9581040Z 2025-08-10 01:11:12,954 - main - INFO -   Setting:
2025-08-10T01:11:12.9581533Z 2025-08-10 01:11:12,954 - main - INFO -   Description:
2025-08-10T01:11:12.9581875Z 2025-08-10 01:11:12,954 - main - INFO -   Custom options: []
2025-08-10T01:11:12.9582300Z 2025-08-10 01:11:12,954 - main - INFO -   Selected prompts: ['narrative', 'character']
2025-08-10T01:11:12.9583526Z 2025-08-10 01:11:12,957 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9584719Z 2025-08-10 01:11:12,957 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:12.9585174Z 2025-08-10 01:11:12,957 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:12.9602754Z 2025-08-10 01:11:12,960 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:12.9609077Z Args: ('mcp-gemini-test-user', 'MCP Test Campaign 1', 'Test campaign 1 through MCP', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 12, 957336, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, ['narrative', 'character'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:12.9613984Z Kwargs: {}
2025-08-10T01:11:12.9615277Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9616606Z Traceback:
2025-08-10T01:11:12.9616975Z Traceback (most recent call last):
2025-08-10T01:11:12.9618249Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:12.9619108Z     asyncio.get_running_loop()
2025-08-10T01:11:12.9619606Z RuntimeError: no running event loop
2025-08-10T01:11:12.9619889Z
2025-08-10T01:11:12.9620186Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:12.9620898Z
2025-08-10T01:11:12.9621064Z Traceback (most recent call last):
2025-08-10T01:11:12.9622059Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:12.9622583Z     return func(*args, **kwargs)
2025-08-10T01:11:12.9622822Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9623359Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:12.9623888Z     db = get_db()
2025-08-10T01:11:12.9624071Z          ^^^^^^^^
2025-08-10T01:11:12.9624518Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:12.9625002Z     return firestore.client()
2025-08-10T01:11:12.9625228Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9625830Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:12.9626583Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:12.9626988Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9627655Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:12.9628612Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:12.9628995Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9629634Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:12.9630457Z     self._services[name] = initializer(self)
2025-08-10T01:11:12.9630723Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9631337Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:12.9631978Z     credentials = app.credential.get_credential()
2025-08-10T01:11:12.9632250Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9632896Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:12.9633641Z     self._load_credential()
2025-08-10T01:11:12.9635119Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:12.9636560Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:12.9638229Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9640592Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:12.9642056Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:12.9643926Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9645423Z --- END EXCEPTION ---
2025-08-10T01:11:12.9647129Z 2025-08-10 01:11:12,960 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9648311Z 2025-08-10 01:11:12,961 - main - INFO - Received campaign creation request:
2025-08-10T01:11:12.9648698Z 2025-08-10 01:11:12,961 - main - INFO -   Character:
2025-08-10T01:11:12.9649004Z 2025-08-10 01:11:12,961 - main - INFO -   Setting:
2025-08-10T01:11:12.9649309Z 2025-08-10 01:11:12,961 - main - INFO -   Description:
2025-08-10T01:11:12.9649631Z 2025-08-10 01:11:12,961 - main - INFO -   Custom options: []
2025-08-10T01:11:12.9649969Z 2025-08-10 01:11:12,961 - main - INFO -   Selected prompts: []
2025-08-10T01:11:12.9651093Z 2025-08-10 01:11:12,963 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9652082Z 2025-08-10 01:11:12,963 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:12.9652556Z 2025-08-10 01:11:12,964 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:12.9668780Z 2025-08-10 01:11:12,966 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:12.9675257Z Args: ('mcp-gemini-test-user', 'MCP Test Campaign 2', 'Test campaign 2 through MCP', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 12, 963863, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, [], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:12.9679818Z Kwargs: {}
2025-08-10T01:11:12.9681039Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9682905Z Traceback:
2025-08-10T01:11:12.9683274Z Traceback (most recent call last):
2025-08-10T01:11:12.9684183Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:12.9685086Z     asyncio.get_running_loop()
2025-08-10T01:11:12.9685550Z RuntimeError: no running event loop
2025-08-10T01:11:12.9685880Z
2025-08-10T01:11:12.9686650Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:12.9687336Z
2025-08-10T01:11:12.9687507Z Traceback (most recent call last):
2025-08-10T01:11:12.9688727Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:12.9689287Z     return func(*args, **kwargs)
2025-08-10T01:11:12.9689522Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9690074Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:12.9690610Z     db = get_db()
2025-08-10T01:11:12.9690792Z          ^^^^^^^^
2025-08-10T01:11:12.9691238Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:12.9691733Z     return firestore.client()
2025-08-10T01:11:12.9691949Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9692546Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:12.9693293Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:12.9693695Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9694343Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:12.9695084Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:12.9695453Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9696100Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:12.9696734Z     self._services[name] = initializer(self)
2025-08-10T01:11:12.9696984Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9697595Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:12.9698839Z     credentials = app.credential.get_credential()
2025-08-10T01:11:12.9699155Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9699899Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:12.9700555Z     self._load_credential()
2025-08-10T01:11:12.9701194Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:12.9701942Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:12.9702313Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9702938Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:12.9703721Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:12.9704714Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9705741Z --- END EXCEPTION ---
2025-08-10T01:11:12.9706775Z 2025-08-10 01:11:12,966 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9707846Z 2025-08-10 01:11:12,968 - main - INFO - Received campaign creation request:
2025-08-10T01:11:12.9708213Z 2025-08-10 01:11:12,968 - main - INFO -   Character:
2025-08-10T01:11:12.9708510Z 2025-08-10 01:11:12,968 - main - INFO -   Setting:
2025-08-10T01:11:12.9708936Z 2025-08-10 01:11:12,968 - main - INFO -   Description:
2025-08-10T01:11:12.9709285Z 2025-08-10 01:11:12,968 - main - INFO -   Custom options: ['defaultWorld']
2025-08-10T01:11:12.9709662Z 2025-08-10 01:11:12,968 - main - INFO -   Selected prompts: []
2025-08-10T01:11:12.9717973Z 2025-08-10 01:11:12,971 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9720880Z 2025-08-10 01:11:12,971 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:12.9721658Z 2025-08-10 01:11:12,971 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:12.9748863Z 2025-08-10 01:11:12,974 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:12.9754868Z Args: ('mcp-gemini-test-user', 'MCP Test Campaign 3', 'Test campaign 3 through MCP', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 12, 971580, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, [], True, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:12.9763129Z Kwargs: {}
2025-08-10T01:11:12.9764285Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9765494Z Traceback:
2025-08-10T01:11:12.9765816Z Traceback (most recent call last):
2025-08-10T01:11:12.9766681Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:12.9767518Z     asyncio.get_running_loop()
2025-08-10T01:11:12.9768232Z RuntimeError: no running event loop
2025-08-10T01:11:12.9768552Z
2025-08-10T01:11:12.9768857Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:12.9769318Z
2025-08-10T01:11:12.9769481Z Traceback (most recent call last):
2025-08-10T01:11:12.9770350Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:12.9771209Z     return func(*args, **kwargs)
2025-08-10T01:11:12.9771605Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9772535Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:12.9773461Z     db = get_db()
2025-08-10T01:11:12.9773782Z          ^^^^^^^^
2025-08-10T01:11:12.9774600Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:12.9775569Z     return firestore.client()
2025-08-10T01:11:12.9775963Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9777080Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:12.9778960Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:12.9779725Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9781006Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:12.9782432Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:12.9783350Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9784546Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:12.9785778Z     self._services[name] = initializer(self)
2025-08-10T01:11:12.9786269Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9787485Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:12.9789090Z     credentials = app.credential.get_credential()
2025-08-10T01:11:12.9789605Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9790900Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:12.9792118Z     self._load_credential()
2025-08-10T01:11:12.9793361Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:12.9794828Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:12.9795531Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9796734Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:12.9798362Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:12.9800252Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9801887Z --- END EXCEPTION ---
2025-08-10T01:11:12.9803807Z 2025-08-10 01:11:12,974 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9805406Z ok
2025-08-10T01:11:12.9806452Z test_mcp_campaign_creation_with_gemini_response_handling (__main__.TestGeminiResponseIntegration.test_mcp_campaign_creation_with_gemini_response_handling)
2025-08-10T01:11:12.9808577Z Test Campaign creation handles GeminiResponse objects through MCP. ... 2025-08-10 01:11:12,977 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:12.9810814Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:12.9812289Z   setup_file_logging()
2025-08-10T01:11:12.9812911Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:12.9853577Z 2025-08-10 01:11:12,985 - main - INFO - Received campaign creation request:
2025-08-10T01:11:12.9855585Z 2025-08-10 01:11:12,985 - main - INFO -   Character:
2025-08-10T01:11:12.9857161Z 2025-08-10 01:11:12,985 - main - INFO -   Setting:
2025-08-10T01:11:12.9858423Z 2025-08-10 01:11:12,985 - main - INFO -   Description:
2025-08-10T01:11:12.9860812Z 2025-08-10 01:11:12,985 - main - INFO -   Custom options: []
2025-08-10T01:11:12.9864320Z 2025-08-10 01:11:12,986 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:12.9887567Z 2025-08-10 01:11:12,988 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9890073Z 2025-08-10 01:11:12,988 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:12.9891001Z 2025-08-10 01:11:12,988 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:12.9913439Z 2025-08-10 01:11:12,991 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:12.9919932Z Args: ('mcp-gemini-test-user', 'MCP Test Campaign', 'Create a fantasy adventure through MCP', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 12, 988563, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:12.9925395Z Kwargs: {}
2025-08-10T01:11:12.9926557Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9927973Z Traceback:
2025-08-10T01:11:12.9928310Z Traceback (most recent call last):
2025-08-10T01:11:12.9929156Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:12.9929970Z     asyncio.get_running_loop()
2025-08-10T01:11:12.9930394Z RuntimeError: no running event loop
2025-08-10T01:11:12.9930688Z
2025-08-10T01:11:12.9930990Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:12.9931449Z
2025-08-10T01:11:12.9931611Z Traceback (most recent call last):
2025-08-10T01:11:12.9932479Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:12.9933357Z     return func(*args, **kwargs)
2025-08-10T01:11:12.9933742Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9934667Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:12.9935593Z     db = get_db()
2025-08-10T01:11:12.9935902Z          ^^^^^^^^
2025-08-10T01:11:12.9936677Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:12.9937630Z     return firestore.client()
2025-08-10T01:11:12.9938217Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9939353Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:12.9940743Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:12.9941494Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9942776Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:12.9944216Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:12.9944911Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9946442Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:12.9947652Z     self._services[name] = initializer(self)
2025-08-10T01:11:12.9949329Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9950530Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:12.9951768Z     credentials = app.credential.get_credential()
2025-08-10T01:11:12.9952304Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9953811Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:12.9955067Z     self._load_credential()
2025-08-10T01:11:12.9956292Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:12.9957970Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:12.9958677Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:12.9959896Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:12.9961322Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:12.9963196Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9964862Z --- END EXCEPTION ---
2025-08-10T01:11:12.9966758Z 2025-08-10 01:11:12,991 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:12.9968630Z ok
2025-08-10T01:11:12.9969542Z test_mcp_campaign_creation_with_large_prompt (__main__.TestGeminiResponseIntegration.test_mcp_campaign_creation_with_large_prompt)
2025-08-10T01:11:12.9971223Z Test campaign creation with large prompt data through MCP. ... 2025-08-10 01:11:12,994 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:12.9973339Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:12.9974849Z   setup_file_logging()
2025-08-10T01:11:12.9975463Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:13.0021944Z 2025-08-10 01:11:13,001 - main - INFO - Received campaign creation request:
2025-08-10T01:11:13.0022647Z 2025-08-10 01:11:13,001 - main - INFO -   Character:
2025-08-10T01:11:13.0023086Z 2025-08-10 01:11:13,001 - main - INFO -   Setting:
2025-08-10T01:11:13.0023415Z 2025-08-10 01:11:13,001 - main - INFO -   Description:
2025-08-10T01:11:13.0023842Z 2025-08-10 01:11:13,001 - main - INFO -   Custom options: []
2025-08-10T01:11:13.0024214Z 2025-08-10 01:11:13,001 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:13.0044781Z 2025-08-10 01:11:13,004 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0047625Z 2025-08-10 01:11:13,004 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:13.0048595Z 2025-08-10 01:11:13,004 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:13.0075103Z 2025-08-10 01:11:13,007 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:13.0108544Z Args: ('mcp-gemini-test-user', 'MCP Large Prompt Test Campaign', 'Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure. Create an epic fantasy adventure.', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 13, 4337, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:13.0132651Z Kwargs: {}
2025-08-10T01:11:13.0133939Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0135238Z Traceback:
2025-08-10T01:11:13.0135593Z Traceback (most recent call last):
2025-08-10T01:11:13.0136500Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:13.0137635Z     asyncio.get_running_loop()
2025-08-10T01:11:13.0138387Z RuntimeError: no running event loop
2025-08-10T01:11:13.0138711Z
2025-08-10T01:11:13.0139030Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:13.0139508Z
2025-08-10T01:11:13.0139694Z Traceback (most recent call last):
2025-08-10T01:11:13.0140651Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:13.0141518Z     return func(*args, **kwargs)
2025-08-10T01:11:13.0141932Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0142925Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:13.0143914Z     db = get_db()
2025-08-10T01:11:13.0144234Z          ^^^^^^^^
2025-08-10T01:11:13.0145079Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:13.0146037Z     return firestore.client()
2025-08-10T01:11:13.0146447Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0147532Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:13.0149131Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:13.0149905Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0151175Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:13.0152602Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:13.0153296Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0154476Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:13.0155707Z     self._services[name] = initializer(self)
2025-08-10T01:11:13.0156194Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0157388Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:13.0158913Z     credentials = app.credential.get_credential()
2025-08-10T01:11:13.0159437Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0160698Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:13.0161924Z     self._load_credential()
2025-08-10T01:11:13.0163163Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:13.0164614Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:13.0165298Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0166486Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:13.0168131Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:13.0170328Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0171930Z --- END EXCEPTION ---
2025-08-10T01:11:13.0173845Z 2025-08-10 01:11:13,007 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0175644Z ok
2025-08-10T01:11:13.0176632Z test_mcp_campaign_creation_with_special_characters (__main__.TestGeminiResponseIntegration.test_mcp_campaign_creation_with_special_characters)
2025-08-10T01:11:13.0178701Z Test campaign creation with special characters through MCP. ... 2025-08-10 01:11:13,010 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:13.0180854Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:13.0182341Z   setup_file_logging()
2025-08-10T01:11:13.0182949Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:13.0202383Z 2025-08-10 01:11:13,019 - main - INFO - Received campaign creation request:
2025-08-10T01:11:13.0205845Z 2025-08-10 01:11:13,020 - main - INFO -   Character:
2025-08-10T01:11:13.0206409Z 2025-08-10 01:11:13,020 - main - INFO -   Setting:
2025-08-10T01:11:13.0206952Z 2025-08-10 01:11:13,020 - main - INFO -   Description:
2025-08-10T01:11:13.0207480Z 2025-08-10 01:11:13,020 - main - INFO -   Custom options: []
2025-08-10T01:11:13.0208032Z 2025-08-10 01:11:13,020 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:13.0231586Z 2025-08-10 01:11:13,022 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0234167Z 2025-08-10 01:11:13,023 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:13.0235100Z 2025-08-10 01:11:13,023 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:13.0258905Z 2025-08-10 01:11:13,025 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:13.0267358Z Args: ('mcp-gemini-test-user', 'MCP Special Chars Campaign: !@#$%^&*()', 'Create adventure with special chars: √©√±√º√≠ üêâ √±o√±√≥', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 13, 22981, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:13.0272602Z Kwargs: {}
2025-08-10T01:11:13.0275767Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0277030Z Traceback:
2025-08-10T01:11:13.0277372Z Traceback (most recent call last):
2025-08-10T01:11:13.0281724Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:13.0282595Z     asyncio.get_running_loop()
2025-08-10T01:11:13.0283297Z RuntimeError: no running event loop
2025-08-10T01:11:13.0283608Z
2025-08-10T01:11:13.0283924Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:13.0284389Z
2025-08-10T01:11:13.0284557Z Traceback (most recent call last):
2025-08-10T01:11:13.0290954Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:13.0291888Z     return func(*args, **kwargs)
2025-08-10T01:11:13.0292285Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0293289Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:13.0294589Z     db = get_db()
2025-08-10T01:11:13.0294932Z          ^^^^^^^^
2025-08-10T01:11:13.0295781Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:13.0296728Z     return firestore.client()
2025-08-10T01:11:13.0297150Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0298601Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:13.0300030Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:13.0300813Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0302074Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:13.0303534Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:13.0304202Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0305420Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:13.0306662Z     self._services[name] = initializer(self)
2025-08-10T01:11:13.0307163Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0308512Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:13.0309730Z     credentials = app.credential.get_credential()
2025-08-10T01:11:13.0310251Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0311515Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:13.0312767Z     self._load_credential()
2025-08-10T01:11:13.0314008Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:13.0315417Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:13.0316112Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0317336Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:13.0319077Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:13.0320963Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0322591Z --- END EXCEPTION ---
2025-08-10T01:11:13.0324490Z 2025-08-10 01:11:13,025 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0326058Z ok
2025-08-10T01:11:13.0327035Z test_mcp_campaign_creation_with_various_auth_headers (__main__.TestGeminiResponseIntegration.test_mcp_campaign_creation_with_various_auth_headers)
2025-08-10T01:11:13.0329347Z Test campaign creation with various authentication headers through MCP. ... 2025-08-10 01:11:13,028 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:13.0331554Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:13.0333051Z   setup_file_logging()
2025-08-10T01:11:13.0333647Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:13.0366801Z 2025-08-10 01:11:13,036 - main - INFO - Received campaign creation request:
2025-08-10T01:11:13.0368368Z 2025-08-10 01:11:13,036 - main - INFO -   Character:
2025-08-10T01:11:13.0370374Z 2025-08-10 01:11:13,036 - main - INFO -   Setting:
2025-08-10T01:11:13.0371844Z 2025-08-10 01:11:13,036 - main - INFO -   Description:
2025-08-10T01:11:13.0372312Z 2025-08-10 01:11:13,036 - main - INFO -   Custom options: []
2025-08-10T01:11:13.0372698Z 2025-08-10 01:11:13,036 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:13.0395473Z 2025-08-10 01:11:13,039 - root - ERROR - üî•üî¥ Failed to get user settings for user_591247: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0397558Z 2025-08-10 01:11:13,039 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:13.0398616Z 2025-08-10 01:11:13,039 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:13.0423862Z 2025-08-10 01:11:13,042 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:13.0429713Z Args: ('test-user', 'MCP Auth Test Campaign', 'Test campaign with auth variations', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 13, 39294, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:13.0434039Z Kwargs: {}
2025-08-10T01:11:13.0435239Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0436985Z Traceback:
2025-08-10T01:11:13.0437374Z Traceback (most recent call last):
2025-08-10T01:11:13.0438665Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:13.0439483Z     asyncio.get_running_loop()
2025-08-10T01:11:13.0439895Z RuntimeError: no running event loop
2025-08-10T01:11:13.0440175Z
2025-08-10T01:11:13.0440469Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:13.0440901Z
2025-08-10T01:11:13.0441056Z Traceback (most recent call last):
2025-08-10T01:11:13.0441888Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:13.0442711Z     return func(*args, **kwargs)
2025-08-10T01:11:13.0443102Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0444074Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:13.0445014Z     db = get_db()
2025-08-10T01:11:13.0445326Z          ^^^^^^^^
2025-08-10T01:11:13.0446298Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:13.0447216Z     return firestore.client()
2025-08-10T01:11:13.0447698Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0448958Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:13.0450308Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:13.0451031Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0452429Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:13.0453770Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:13.0454431Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0455606Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:13.0456755Z     self._services[name] = initializer(self)
2025-08-10T01:11:13.0457216Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0458545Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:13.0459697Z     credentials = app.credential.get_credential()
2025-08-10T01:11:13.0460192Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0461416Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:13.0462635Z     self._load_credential()
2025-08-10T01:11:13.0464102Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:13.0465436Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:13.0466057Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0467200Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:13.0468837Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:13.0470707Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0472333Z --- END EXCEPTION ---
2025-08-10T01:11:13.0474192Z 2025-08-10 01:11:13,042 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0475821Z ok
2025-08-10T01:11:13.0476651Z test_mcp_concurrent_campaign_creation (__main__.TestGeminiResponseIntegration.test_mcp_concurrent_campaign_creation)
2025-08-10T01:11:13.0478802Z Test concurrent campaign creation through MCP. ... 2025-08-10 01:11:13,046 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:13.0480779Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:13.0482145Z   setup_file_logging()
2025-08-10T01:11:13.0482706Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:13.0545717Z 2025-08-10 01:11:13,054 - main - INFO - Received campaign creation request:
2025-08-10T01:11:13.0547942Z 2025-08-10 01:11:13,054 - main - INFO -   Character:
2025-08-10T01:11:13.0549786Z 2025-08-10 01:11:13,054 - main - INFO -   Setting:
2025-08-10T01:11:13.0551485Z 2025-08-10 01:11:13,054 - main - INFO -   Description:
2025-08-10T01:11:13.0553154Z 2025-08-10 01:11:13,055 - main - INFO -   Custom options: []
2025-08-10T01:11:13.0554815Z 2025-08-10 01:11:13,055 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:13.0563956Z 2025-08-10 01:11:13,056 - main - INFO - Received campaign creation request:
2025-08-10T01:11:13.0566646Z 2025-08-10 01:11:13,056 - main - INFO -   Character:
2025-08-10T01:11:13.0571735Z 2025-08-10 01:11:13,057 - main - INFO -   Setting:
2025-08-10T01:11:13.0577553Z 2025-08-10 01:11:13,057 - main - INFO - Received campaign creation request:
2025-08-10T01:11:13.0578802Z 2025-08-10 01:11:13,057 - main - INFO -   Character:
2025-08-10T01:11:13.0580241Z 2025-08-10 01:11:13,057 - main - INFO -   Description:
2025-08-10T01:11:13.0582835Z 2025-08-10 01:11:13,057 - main - INFO -   Custom options: []
2025-08-10T01:11:13.0584195Z 2025-08-10 01:11:13,058 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:13.0584581Z 2025-08-10 01:11:13,057 - main - INFO -   Setting:
2025-08-10T01:11:13.0584898Z 2025-08-10 01:11:13,058 - main - INFO -   Description:
2025-08-10T01:11:13.0585222Z 2025-08-10 01:11:13,058 - main - INFO -   Custom options: []
2025-08-10T01:11:13.0585584Z 2025-08-10 01:11:13,058 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:13.0597620Z 2025-08-10 01:11:13,059 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0599703Z 2025-08-10 01:11:13,059 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:13.0600642Z 2025-08-10 01:11:13,059 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:13.0616853Z 2025-08-10 01:11:13,061 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0619978Z 2025-08-10 01:11:13,061 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:13.0620966Z 2025-08-10 01:11:13,062 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:13.0664289Z 2025-08-10 01:11:13,066 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0667688Z 2025-08-10 01:11:13,066 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:13.0669627Z 2025-08-10 01:11:13,066 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:13.0695186Z 2025-08-10 01:11:13,069 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:13.0703135Z Args: ('mcp-gemini-test-user', 'MCP Concurrent Campaign 0', 'Concurrent campaign 0 through MCP', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 13, 59567, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:13.0706070Z Kwargs: {}
2025-08-10T01:11:13.0706739Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0707421Z Traceback:
2025-08-10T01:11:13.0707606Z Traceback (most recent call last):
2025-08-10T01:11:13.0708407Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:13.0708893Z     asyncio.get_running_loop()
2025-08-10T01:11:13.0709139Z RuntimeError: no running event loop
2025-08-10T01:11:13.0709475Z
2025-08-10T01:11:13.0709643Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:13.0709906Z
2025-08-10T01:11:13.0709997Z Traceback (most recent call last):
2025-08-10T01:11:13.0710501Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:13.0711215Z     return func(*args, **kwargs)
2025-08-10T01:11:13.0711474Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0712072Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:13.0712588Z     db = get_db()
2025-08-10T01:11:13.0712772Z          ^^^^^^^^
2025-08-10T01:11:13.0713207Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:13.0713704Z     return firestore.client()
2025-08-10T01:11:13.0713934Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0714537Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:13.0715295Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:13.0715706Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0716372Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:13.0717128Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:13.0717494Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0718310Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:13.0718947Z     self._services[name] = initializer(self)
2025-08-10T01:11:13.0719205Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0719829Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:13.0720463Z     credentials = app.credential.get_credential()
2025-08-10T01:11:13.0720736Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0721419Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:13.0722074Z     self._load_credential()
2025-08-10T01:11:13.0722726Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:13.0723481Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:13.0723844Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0724487Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:13.0725248Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:13.0726221Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0727249Z --- END EXCEPTION ---
2025-08-10T01:11:13.0729120Z 2025-08-10 01:11:13,069 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0741013Z 2025-08-10 01:11:13,073 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:13.0746349Z Args: ('mcp-gemini-test-user', 'MCP Concurrent Campaign 1', 'Concurrent campaign 1 through MCP', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 13, 61849, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:13.0751126Z Kwargs: {}
2025-08-10T01:11:13.0752320Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0753684Z Traceback:
2025-08-10T01:11:13.0754057Z Traceback (most recent call last):
2025-08-10T01:11:13.0754962Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:13.0755821Z     asyncio.get_running_loop()
2025-08-10T01:11:13.0756231Z RuntimeError: no running event loop
2025-08-10T01:11:13.0756549Z
2025-08-10T01:11:13.0756853Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:13.0757325Z
2025-08-10T01:11:13.0757506Z Traceback (most recent call last):
2025-08-10T01:11:13.0758609Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:13.0759515Z     return func(*args, **kwargs)
2025-08-10T01:11:13.0759937Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0760932Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:13.0762040Z     db = get_db()
2025-08-10T01:11:13.0762368Z          ^^^^^^^^
2025-08-10T01:11:13.0763194Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:13.0764094Z     return firestore.client()
2025-08-10T01:11:13.0764506Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0765586Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:13.0766923Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:13.0767695Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0769288Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:13.0770755Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:13.0771473Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0772681Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:13.0773889Z     self._services[name] = initializer(self)
2025-08-10T01:11:13.0774619Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0775813Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:13.0776984Z     credentials = app.credential.get_credential()
2025-08-10T01:11:13.0777468Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0778851Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:13.0780240Z     self._load_credential()
2025-08-10T01:11:13.0781355Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:13.0782853Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:13.0783534Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0784723Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:13.0786095Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:13.0788160Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0789773Z --- END EXCEPTION ---
2025-08-10T01:11:13.0791659Z 2025-08-10 01:11:13,074 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0793556Z 2025-08-10 01:11:13,076 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:13.0798361Z Args: ('mcp-gemini-test-user', 'MCP Concurrent Campaign 2', 'Concurrent campaign 2 through MCP', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 13, 66540, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:13.0802903Z Kwargs: {}
2025-08-10T01:11:13.0804125Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0805419Z Traceback:
2025-08-10T01:11:13.0805780Z Traceback (most recent call last):
2025-08-10T01:11:13.0806685Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:13.0807568Z     asyncio.get_running_loop()
2025-08-10T01:11:13.0808333Z RuntimeError: no running event loop
2025-08-10T01:11:13.0808663Z
2025-08-10T01:11:13.0808996Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:13.0809490Z
2025-08-10T01:11:13.0809671Z Traceback (most recent call last):
2025-08-10T01:11:13.0810599Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:13.0811479Z     return func(*args, **kwargs)
2025-08-10T01:11:13.0811912Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0812903Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:13.0814139Z     db = get_db()
2025-08-10T01:11:13.0814478Z          ^^^^^^^^
2025-08-10T01:11:13.0815339Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:13.0816257Z     return firestore.client()
2025-08-10T01:11:13.0816659Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0817992Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:13.0819731Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:13.0820457Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0821839Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:13.0823217Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:13.0823918Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0825164Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:13.0826381Z     self._services[name] = initializer(self)
2025-08-10T01:11:13.0826880Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0828411Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:13.0829672Z     credentials = app.credential.get_credential()
2025-08-10T01:11:13.0830196Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0831459Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:13.0832711Z     self._load_credential()
2025-08-10T01:11:13.0833950Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:13.0835419Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:13.0836118Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0837332Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:13.0838997Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:13.0840893Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0842520Z --- END EXCEPTION ---
2025-08-10T01:11:13.0844451Z 2025-08-10 01:11:13,076 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0846029Z ok
2025-08-10T01:11:13.0846918Z test_mcp_gemini_response_object_integration (__main__.TestGeminiResponseIntegration.test_mcp_gemini_response_object_integration)
2025-08-10T01:11:13.0848951Z Test that MCP properly integrates with GeminiResponse objects. ... 2025-08-10 01:11:13,079 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:13.0851171Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:13.0852675Z   setup_file_logging()
2025-08-10T01:11:13.0853259Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:13.0886555Z 2025-08-10 01:11:13,088 - main - INFO - Received campaign creation request:
2025-08-10T01:11:13.0887974Z 2025-08-10 01:11:13,088 - main - INFO -   Character:
2025-08-10T01:11:13.0889859Z 2025-08-10 01:11:13,088 - main - INFO -   Setting:
2025-08-10T01:11:13.0891257Z 2025-08-10 01:11:13,089 - main - INFO -   Description:
2025-08-10T01:11:13.0893149Z 2025-08-10 01:11:13,089 - main - INFO -   Custom options: []
2025-08-10T01:11:13.0894533Z 2025-08-10 01:11:13,089 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:13.0920819Z 2025-08-10 01:11:13,091 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0923711Z 2025-08-10 01:11:13,092 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:13.0924529Z 2025-08-10 01:11:13,092 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:13.0949385Z 2025-08-10 01:11:13,094 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:13.0955188Z Args: ('mcp-gemini-test-user', 'MCP Response Test Campaign', 'Test narrative response handling through MCP', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 13, 92012, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:13.0959730Z Kwargs: {}
2025-08-10T01:11:13.0960860Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0962108Z Traceback:
2025-08-10T01:11:13.0962465Z Traceback (most recent call last):
2025-08-10T01:11:13.0963329Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:13.0964145Z     asyncio.get_running_loop()
2025-08-10T01:11:13.0964541Z RuntimeError: no running event loop
2025-08-10T01:11:13.0964844Z
2025-08-10T01:11:13.0965163Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:13.0965618Z
2025-08-10T01:11:13.0965795Z Traceback (most recent call last):
2025-08-10T01:11:13.0966765Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:13.0967644Z     return func(*args, **kwargs)
2025-08-10T01:11:13.0968306Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0969240Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:13.0970155Z     db = get_db()
2025-08-10T01:11:13.0970468Z          ^^^^^^^^
2025-08-10T01:11:13.0971255Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:13.0972148Z     return firestore.client()
2025-08-10T01:11:13.0972553Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0973627Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:13.0975006Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:13.0975733Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0977204Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:13.0978806Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:13.0979449Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0980612Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:13.0982069Z     self._services[name] = initializer(self)
2025-08-10T01:11:13.0982553Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0983654Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:13.0984856Z     credentials = app.credential.get_credential()
2025-08-10T01:11:13.0985387Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0986640Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:13.0988095Z     self._load_credential()
2025-08-10T01:11:13.0989349Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:13.0990793Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:13.0991494Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.0992648Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:13.0994105Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:13.0995981Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.0997634Z --- END EXCEPTION ---
2025-08-10T01:11:13.0999812Z 2025-08-10 01:11:13,094 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.1001418Z ok
2025-08-10T01:11:13.1002252Z test_mcp_get_initial_story_through_api (__main__.TestGeminiResponseIntegration.test_mcp_get_initial_story_through_api)
2025-08-10T01:11:13.1003857Z Test that MCP properly handles initial story generation. ... 2025-08-10 01:11:13,098 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:13.1005963Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:13.1008248Z   setup_file_logging()
2025-08-10T01:11:13.1008848Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:13.1059057Z 2025-08-10 01:11:13,105 - main - INFO - Received campaign creation request:
2025-08-10T01:11:13.1062856Z 2025-08-10 01:11:13,105 - main - INFO -   Character:
2025-08-10T01:11:13.1063220Z 2025-08-10 01:11:13,105 - main - INFO -   Setting:
2025-08-10T01:11:13.1063551Z 2025-08-10 01:11:13,105 - main - INFO -   Description:
2025-08-10T01:11:13.1063979Z 2025-08-10 01:11:13,105 - main - INFO -   Custom options: []
2025-08-10T01:11:13.1073935Z 2025-08-10 01:11:13,105 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:13.1085994Z 2025-08-10 01:11:13,108 - root - ERROR - üî•üî¥ Failed to get user settings for user_793045: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.1088557Z 2025-08-10 01:11:13,108 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:13.1089425Z 2025-08-10 01:11:13,108 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:13.1111559Z 2025-08-10 01:11:13,110 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:13.1116669Z Args: ('mcp-gemini-test-user', 'MCP Story Generation Test', 'Generate initial story through MCP architecture', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 13, 108381, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-gemini-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:13.1121895Z üîµ Running GeminiResponse integration tests through MCP architecture
2025-08-10T01:11:13.1122697Z üìù NOTE: Tests validate MCP gateway handling of response objects
2025-08-10T01:11:13.1123476Z Kwargs: {}
2025-08-10T01:11:13.1124825Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.1126109Z Traceback:
2025-08-10T01:11:13.1126644Z Traceback (most recent call last):
2025-08-10T01:11:13.1128718Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:13.1129565Z     asyncio.get_running_loop()
2025-08-10T01:11:13.1129969Z RuntimeError: no running event loop
2025-08-10T01:11:13.1130261Z
2025-08-10T01:11:13.1130548Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:13.1130989Z
2025-08-10T01:11:13.1131142Z Traceback (most recent call last):
2025-08-10T01:11:13.1131951Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:13.1132740Z     return func(*args, **kwargs)
2025-08-10T01:11:13.1133101Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.1133942Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:13.1134773Z     db = get_db()
2025-08-10T01:11:13.1135037Z          ^^^^^^^^
2025-08-10T01:11:13.1135791Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:13.1136642Z     return firestore.client()
2025-08-10T01:11:13.1136983Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.1138136Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:13.1139353Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:13.1140030Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.1141111Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:13.1142327Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:13.1142896Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.1143936Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:13.1145212Z     self._services[name] = initializer(self)
2025-08-10T01:11:13.1145625Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.1146633Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:13.1147671Z     credentials = app.credential.get_credential()
2025-08-10T01:11:13.1148327Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.1149399Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:13.1150620Z     self._load_credential()
2025-08-10T01:11:13.1151630Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:13.1152843Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:13.1153438Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:13.1154424Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:13.1155679Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:13.1157316Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.1158925Z --- END EXCEPTION ---
2025-08-10T01:11:13.1160560Z 2025-08-10 01:11:13,111 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:13.1161926Z ok
2025-08-10T01:11:13.1162065Z
2025-08-10T01:11:13.1162269Z ----------------------------------------------------------------------
2025-08-10T01:11:13.1162727Z Ran 9 tests in 1.186s
2025-08-10T01:11:13.1162912Z
2025-08-10T01:11:13.1163018Z OK
2025-08-10T01:11:13.3307225Z ‚úÖ PASS: tests/test_gemini_response_integration.py
2025-08-10T01:11:13.3308970Z ----------------------------------------
2025-08-10T01:11:13.3309510Z Running: tests/test_gemini_response_structured_fields.py
2025-08-10T01:11:13.3799738Z ...WARNING:root:‚ö†Ô∏è Invalid dice_rolls type: str, expected list. Using empty list.
2025-08-10T01:11:13.3816572Z .....
2025-08-10T01:11:13.3817317Z ----------------------------------------------------------------------
2025-08-10T01:11:13.3819350Z Ran 8 tests in 0.003s
2025-08-10T01:11:13.3821346Z
2025-08-10T01:11:13.3821477Z OK
2025-08-10T01:11:13.3889916Z ‚úÖ PASS: tests/test_gemini_response_structured_fields.py
2025-08-10T01:11:13.3891299Z ----------------------------------------
2025-08-10T01:11:13.3891840Z Running: tests/test_gemini_response_validation.py
2025-08-10T01:11:13.5069189Z ..WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:13.5081157Z .....ERROR:root:üî•üî¥ ‚ùå STRING PLANNING BLOCKS NO LONGER SUPPORTED: String planning blocks are deprecated. Only JSON format is allowed. Received: ...
2025-08-10T01:11:13.5113829Z .....
2025-08-10T01:11:13.5116001Z ----------------------------------------------------------------------
2025-08-10T01:11:13.5116497Z Ran 12 tests in 0.005s
2025-08-10T01:11:13.5118054Z
2025-08-10T01:11:13.5120459Z OK
2025-08-10T01:11:13.5272634Z ‚úÖ PASS: tests/test_gemini_response_validation.py
2025-08-10T01:11:13.5274950Z ----------------------------------------
2025-08-10T01:11:13.5275449Z Running: tests/test_gemini_token_management.py
2025-08-10T01:11:14.5169540Z .....
2025-08-10T01:11:14.5172006Z ----------------------------------------------------------------------
2025-08-10T01:11:14.5178081Z Ran 5 tests in 0.000s
2025-08-10T01:11:14.5178709Z
2025-08-10T01:11:14.5178826Z OK
2025-08-10T01:11:14.6622921Z ‚úÖ PASS: tests/test_gemini_token_management.py
2025-08-10T01:11:14.6624429Z ----------------------------------------
2025-08-10T01:11:14.6624935Z Running: tests/test_generator_isolated.py
2025-08-10T01:11:15.0504752Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/case.py:579: ResourceWarning: unclosed file <_io.BufferedReader name='/tmp/tmp5w6glbz0.pdf'>
2025-08-10T01:11:15.0505893Z   if method() is not None:
2025-08-10T01:11:15.0506438Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:15.0507406Z .
2025-08-10T01:11:15.0510787Z ----------------------------------------------------------------------
2025-08-10T01:11:15.0511290Z Ran 1 test in 0.069s
2025-08-10T01:11:15.0511484Z
2025-08-10T01:11:15.0511589Z OK
2025-08-10T01:11:15.0511889Z \n--- Running PDF Generation Test ---
2025-08-10T01:11:15.0512358Z --- PDF Generation Test Finished Successfully ---
2025-08-10T01:11:15.1133984Z ‚úÖ PASS: tests/test_generator_isolated.py
2025-08-10T01:11:15.1136131Z ----------------------------------------
2025-08-10T01:11:15.1137547Z Running: tests/test_god_mode_json_display_red_green.py
2025-08-10T01:11:15.1619490Z .......
2025-08-10T01:11:15.1621526Z ----------------------------------------------------------------------
2025-08-10T01:11:15.1622074Z Ran 7 tests in 0.001s
2025-08-10T01:11:15.1622303Z
2025-08-10T01:11:15.1622428Z OK
2025-08-10T01:11:15.1689544Z ‚úÖ PASS: tests/test_god_mode_json_display_red_green.py
2025-08-10T01:11:15.1690569Z ----------------------------------------
2025-08-10T01:11:15.1691566Z Running: tests/test_god_mode_json_logging_bug.py
2025-08-10T01:11:15.2164462Z ....
2025-08-10T01:11:15.2165137Z POTENTIAL BUG: Double JSON encoding detected
2025-08-10T01:11:15.2165775Z BUG DETECTED: Raw JSON would be logged instead of narrative
2025-08-10T01:11:15.2166680Z ----------------------------------------------------------------------
2025-08-10T01:11:15.2168148Z Ran 4 tests in 0.001s
2025-08-10T01:11:15.2168630Z
2025-08-10T01:11:15.2168899Z OK
2025-08-10T01:11:15.2239749Z ‚úÖ PASS: tests/test_god_mode_json_logging_bug.py
2025-08-10T01:11:15.2241072Z ----------------------------------------
2025-08-10T01:11:15.2241577Z Running: tests/test_god_mode_planning_blocks.py
2025-08-10T01:11:15.2718524Z .....
2025-08-10T01:11:15.2719356Z ----------------------------------------------------------------------
2025-08-10T01:11:15.2720147Z Ran 5 tests in 0.001s
2025-08-10T01:11:15.2721608Z
2025-08-10T01:11:15.2721874Z OK
2025-08-10T01:11:15.2791338Z ‚úÖ PASS: tests/test_god_mode_planning_blocks.py
2025-08-10T01:11:15.2792692Z ----------------------------------------
2025-08-10T01:11:15.2793188Z Running: tests/test_god_mode_response_field.py
2025-08-10T01:11:15.5423252Z ..........
2025-08-10T01:11:15.5424312Z ----------------------------------------------------------------------
2025-08-10T01:11:15.5425502Z Ran 10 tests in 0.005s
2025-08-10T01:11:15.5425880Z
2025-08-10T01:11:15.5426140Z OK
2025-08-10T01:11:15.5795278Z ‚úÖ PASS: tests/test_god_mode_response_field.py
2025-08-10T01:11:15.5796216Z ----------------------------------------
2025-08-10T01:11:15.5796949Z Running: tests/test_granular_mock_control.py
2025-08-10T01:11:15.9096692Z 2025-08-10 01:11:15,909 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:15.9192915Z .2025-08-10 01:11:15,919 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:15.9202742Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:15.9204912Z   setup_file_logging()
2025-08-10T01:11:15.9206153Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:15.9281543Z 2025-08-10 01:11:15,928 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:15.9284091Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:15.9285910Z   setup_file_logging()
2025-08-10T01:11:15.9286924Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:15.9368074Z 2025-08-10 01:11:15,936 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:15.9370283Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:15.9372401Z   setup_file_logging()
2025-08-10T01:11:15.9373340Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:15.9445667Z .2025-08-10 01:11:15,944 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:15.9448093Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:15.9449950Z   setup_file_logging()
2025-08-10T01:11:15.9450948Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:15.9524121Z .2025-08-10 01:11:15,952 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:15.9526345Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:15.9528442Z   setup_file_logging()
2025-08-10T01:11:15.9529443Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:15.9589718Z .
2025-08-10T01:11:15.9591636Z ----------------------------------------------------------------------
2025-08-10T01:11:15.9592550Z Ran 4 tests in 0.042s
2025-08-10T01:11:15.9593129Z
2025-08-10T01:11:15.9593656Z OK
2025-08-10T01:11:16.0162662Z ‚úÖ PASS: tests/test_granular_mock_control.py
2025-08-10T01:11:16.0164341Z ----------------------------------------
2025-08-10T01:11:16.0164815Z Running: tests/test_hp_unknown_values.py
2025-08-10T01:11:16.2533249Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp'. Using default: 1
2025-08-10T01:11:16.2545649Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp_max'. Using default: 1
2025-08-10T01:11:16.2546532Z .WARNING:root:‚ö†Ô∏è Failed to convert '' to int for field 'hp'. Using default: 1
2025-08-10T01:11:16.2547404Z .WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp_max'. Using default: 1
2025-08-10T01:11:16.2548461Z .WARNING:root:‚ö†Ô∏è Failed to convert 'not_a_number' to int for field 'hp'. Using default: 1
2025-08-10T01:11:16.2549392Z .WARNING:root:‚ö†Ô∏è Failed to convert 'not_a_number' to int for field 'hp_max'. Using default: 1
2025-08-10T01:11:16.2550292Z .WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'hp_max'. Using default: 1
2025-08-10T01:11:16.2551084Z .WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp_max'. Using default: 1
2025-08-10T01:11:16.2551867Z .WARNING:root:‚ö†Ô∏è Invalid value 'None' for field 'hp'. Using default: 1
2025-08-10T01:11:16.2552617Z ..WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp'. Using default: 1
2025-08-10T01:11:16.2553124Z ....
2025-08-10T01:11:16.2553462Z ----------------------------------------------------------------------
2025-08-10T01:11:16.2553935Z Ran 13 tests in 0.001s
2025-08-10T01:11:16.2554137Z
2025-08-10T01:11:16.2554255Z OK
2025-08-10T01:11:16.2839362Z ‚úÖ PASS: tests/test_hp_unknown_values.py
2025-08-10T01:11:16.2840767Z ----------------------------------------
2025-08-10T01:11:16.2841241Z Running: tests/test_imports.py
2025-08-10T01:11:17.3277136Z 2025-08-10 01:11:17,327 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:17.3357358Z ........
2025-08-10T01:11:17.3359435Z ----------------------------------------------------------------------
2025-08-10T01:11:17.3359931Z Ran 8 tests in 0.000s
2025-08-10T01:11:17.3360136Z
2025-08-10T01:11:17.3360254Z OK
2025-08-10T01:11:17.4951347Z ‚úÖ PASS: tests/test_imports.py
2025-08-10T01:11:17.4952733Z ----------------------------------------
2025-08-10T01:11:17.4953243Z Running: tests/test_incomplete_json_recovery.py
2025-08-10T01:11:17.5620260Z .WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:17.5650874Z ......WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:17.5654942Z ERROR:root:üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:17.5664842Z ...
2025-08-10T01:11:17.5665940Z ----------------------------------------------------------------------
2025-08-10T01:11:17.5667107Z Ran 10 tests in 0.006s
2025-08-10T01:11:17.5667335Z
2025-08-10T01:11:17.5667446Z OK
2025-08-10T01:11:17.5771625Z ‚úÖ PASS: tests/test_incomplete_json_recovery.py
2025-08-10T01:11:17.5772919Z ----------------------------------------
2025-08-10T01:11:17.5773400Z Running: tests/test_infrastructure.py
2025-08-10T01:11:17.6814103Z ............
2025-08-10T01:11:17.6815547Z ----------------------------------------------------------------------
2025-08-10T01:11:17.6816042Z Ran 12 tests in 0.041s
2025-08-10T01:11:17.6816251Z
2025-08-10T01:11:17.6816360Z OK
2025-08-10T01:11:17.6932818Z ‚úÖ PASS: tests/test_infrastructure.py
2025-08-10T01:11:17.6934107Z ----------------------------------------
2025-08-10T01:11:17.6934621Z Running: tests/test_input_field_validation.py
2025-08-10T01:11:18.0219553Z 2025-08-10 01:11:18,021 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:18.9230017Z test_end_to_end_input_field_flow (__main__.TestInputFieldTranslation.test_end_to_end_input_field_flow)
2025-08-10T01:11:18.9232661Z RED-GREEN TEST: End-to-end input field translation flow. ... ok
2025-08-10T01:11:18.9233695Z test_frontend_to_main_input_field (__main__.TestInputFieldTranslation.test_frontend_to_main_input_field)
2025-08-10T01:11:18.9234671Z Test that main.py correctly extracts 'input' field from frontend requests. ... ok
2025-08-10T01:11:18.9235637Z test_main_to_mcp_field_translation (__main__.TestInputFieldTranslation.test_main_to_mcp_field_translation)
2025-08-10T01:11:18.9236570Z Test that main.py correctly creates 'user_input' field for MCP protocol. ... ok
2025-08-10T01:11:18.9237479Z test_mcp_world_logic_input_field (__main__.TestInputFieldTranslation.test_mcp_world_logic_input_field)
2025-08-10T01:11:18.9238574Z Test that world_logic.py correctly expects 'user_input' field from MCP. ... ok
2025-08-10T01:11:18.9239622Z test_red_phase_input_field_mismatch_detection (__main__.TestInputFieldTranslation.test_red_phase_input_field_mismatch_detection)
2025-08-10T01:11:18.9240593Z RED PHASE: Test what would happen with wrong field names. ... ok
2025-08-10T01:11:18.9240971Z
2025-08-10T01:11:18.9241171Z ----------------------------------------------------------------------
2025-08-10T01:11:18.9241648Z Ran 5 tests in 0.000s
2025-08-10T01:11:18.9241848Z
2025-08-10T01:11:18.9241954Z OK
2025-08-10T01:11:18.9242753Z üß™ Input Field Translation Validation Test
2025-08-10T01:11:18.9244249Z Testing field translation across frontend ‚Üí main.py ‚Üí world_logic.py
2025-08-10T01:11:18.9244832Z ================================================================================
2025-08-10T01:11:18.9245127Z
2025-08-10T01:11:18.9245399Z üîç Testing end-to-end input field translation flow...
2025-08-10T01:11:18.9246003Z    Frontend sends: {'input': 'I test the complete flow.', 'mode': 'character'}
2025-08-10T01:11:18.9246644Z    main.py extracts: input = 'I test the complete flow.'
2025-08-10T01:11:18.9247564Z    main.py creates MCP request: {'user_id': 'test-user', 'campaign_id': 'test-campaign', 'user_input': 'I test the complete flow.', 'mode': 'character'}
2025-08-10T01:11:18.9248700Z    world_logic.py extracts: user_input = 'I test the complete flow.'
2025-08-10T01:11:18.9249796Z ‚úÖ End-to-end input field translation: WORKING CORRECTLY
2025-08-10T01:11:18.9250442Z ‚úÖ Translation layer correctly converts 'input' ‚Üí 'user_input'
2025-08-10T01:11:18.9251117Z ‚úÖ Frontend ‚Üí main.py: 'input' field extraction works correctly
2025-08-10T01:11:18.9251798Z ‚úÖ main.py ‚Üí MCP: 'user_input' field translation works correctly
2025-08-10T01:11:18.9252495Z ‚úÖ MCP ‚Üí world_logic.py: 'user_input' field extraction works correctly
2025-08-10T01:11:18.9252882Z
2025-08-10T01:11:18.9253150Z üî¥ RED PHASE: Testing input field mismatch scenarios
2025-08-10T01:11:18.9253746Z üî¥ If main.py used 'user_input' for frontend: None extracted
2025-08-10T01:11:18.9254675Z üî¥ If main.py sent 'input' to MCP: None extracted by world_logic.py
2025-08-10T01:11:18.9255394Z üî¥ RED TESTS CONFIRM: Field name mismatches would cause None extraction
2025-08-10T01:11:19.1208103Z ‚úÖ PASS: tests/test_input_field_validation.py
2025-08-10T01:11:19.1209664Z ----------------------------------------
2025-08-10T01:11:19.1210292Z Skipping integration test: tests/test_integration_long.py
2025-08-10T01:11:19.1210881Z Running: tests/test_json_bug_fix.py
2025-08-10T01:11:19.1524410Z ============================================================
2025-08-10T01:11:19.1525756Z JSON Bug Root Cause Test
2025-08-10T01:11:19.1526164Z ============================================================
2025-08-10T01:11:19.1526708Z Testing parse_structured_response with raw JSON...
2025-08-10T01:11:19.1527231Z Input (first 100 chars): {
2025-08-10T01:11:19.1528204Z     "narrative": "[Mode: STORY MODE]\n[SESSION_HEADER]\nTimestamp: Year 11 New Peace, Kythorn Day ...
2025-08-10T01:11:19.1528835Z
2025-08-10T01:11:19.1529129Z üîç Results:
2025-08-10T01:11:19.1529471Z    response_text type: <class 'str'>
2025-08-10T01:11:19.1529933Z    response_text starts with '{': False
2025-08-10T01:11:19.1530446Z    response_text first 200 chars: [Mode: STORY MODE]
2025-08-10T01:11:19.1530928Z [SESSION_HEADER]
2025-08-10T01:11:19.1531333Z Timestamp: Year 11 New Peace, Kythorn Day 2, 08:00
2025-08-10T01:11:19.1531866Z Location: Character Creation
2025-08-10T01:11:19.1532374Z Status: Lvl 1 Unknown | HP: 0/0 (Temp: 0) | XP: 0/300 | Gold: 0gp
2025-08-10T01:11:19.1532917Z Resources: HD: 0/0
2025-08-10T01:11:19.1533263Z    structured_response exists: True
2025-08-10T01:11:19.1533540Z
2025-08-10T01:11:19.1533906Z ‚úÖ parse_structured_response correctly extracted narrative!
2025-08-10T01:11:19.1534316Z
2025-08-10T01:11:19.1534574Z üü¢ parse_structured_response works correctly
2025-08-10T01:11:19.1577003Z ‚úÖ PASS: tests/test_json_bug_fix.py
2025-08-10T01:11:19.1578493Z ----------------------------------------
2025-08-10T01:11:19.1578982Z Running: tests/test_json_bug_green.py
2025-08-10T01:11:19.1903429Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:19.1913242Z ERROR:root:üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:19.1913831Z ============================================================
2025-08-10T01:11:19.1914462Z üü¢ GREEN TEST: JSON Bug Fix Verification
2025-08-10T01:11:19.1914905Z ============================================================
2025-08-10T01:11:19.1915371Z Test 1: Well-formed JSON
2025-08-10T01:11:19.1915780Z   Result starts with '{': False
2025-08-10T01:11:19.1919524Z   Result: You enter the dark cave......
2025-08-10T01:11:19.1922323Z
2025-08-10T01:11:19.1922556Z Test 2: Malformed JSON without proper structure
2025-08-10T01:11:19.1923053Z   Result starts with '{': True
2025-08-10T01:11:19.1923545Z   Result: {"Some malformed JSON that would cause the bug...
2025-08-10T01:11:19.1924251Z   ‚ö†Ô∏è  EXPECTED: Malformed JSON returned as fallback
2025-08-10T01:11:19.1925155Z   This is expected behavior for completely broken JSON
2025-08-10T01:11:19.1925520Z
2025-08-10T01:11:19.1925709Z Test 3: JSON that triggers the temporary fix
2025-08-10T01:11:19.1926158Z   Result: The story text that should be extracted
2025-08-10T01:11:19.1926662Z   ‚úÖ Narrative correctly extracted
2025-08-10T01:11:19.1927191Z
2025-08-10T01:11:19.1927387Z Test 4: Full flow with GeminiResponse creation
2025-08-10T01:11:19.1928217Z   narrative_text: You chose option 2. Let me create a character for ...
2025-08-10T01:11:19.1928864Z   narrative_text starts with '{': False
2025-08-10T01:11:19.1929512Z   ‚úÖ Full flow works correctly - no JSON in narrative_text
2025-08-10T01:11:19.1929901Z
2025-08-10T01:11:19.1930088Z ‚úÖ TESTS PASSED!
2025-08-10T01:11:19.1930453Z The JSON bug has been fixed successfully.
2025-08-10T01:11:19.1930989Z Note: Malformed JSON fallback is expected behavior.
2025-08-10T01:11:19.1969409Z ‚úÖ PASS: tests/test_json_bug_green.py
2025-08-10T01:11:19.1970039Z ----------------------------------------
2025-08-10T01:11:19.1971601Z Running: tests/test_json_bug_scenario.py
2025-08-10T01:11:20.1949857Z 2025-08-10 01:11:20,194 - INFO - STRUCTURED_GENERATION: Coverage rate 1.00, Schema valid: True
2025-08-10T01:11:20.1950696Z ============================================================
2025-08-10T01:11:20.1951182Z Exact JSON Bug Scenario Test
2025-08-10T01:11:20.1951555Z ============================================================
2025-08-10T01:11:20.1952031Z 1. Testing _get_text_from_response simulation...
2025-08-10T01:11:20.1952511Z 2. Testing _process_structured_response...
2025-08-10T01:11:20.1952802Z
2025-08-10T01:11:20.1953251Z üîç After _process_structured_response:
2025-08-10T01:11:20.1953665Z    response_text type: <class 'str'>
2025-08-10T01:11:20.1954068Z    response_text starts with '{': False
2025-08-10T01:11:20.1954467Z    response_text[:100]: [Mode: STORY MODE]
2025-08-10T01:11:20.1954873Z [CHARACTER CREATION - Step 2 of 7]
2025-08-10T01:11:20.1955159Z
2025-08-10T01:11:20.1955328Z "Excellent choice, adventurer!" The voice tha
2025-08-10T01:11:20.1955626Z
2025-08-10T01:11:20.1955906Z ‚úÖ No bug found - response_text is clean narrative
2025-08-10T01:11:20.1956334Z
2025-08-10T01:11:20.1956577Z üü¢ Could not reproduce bug with this scenario
2025-08-10T01:11:20.3571677Z ‚úÖ PASS: tests/test_json_bug_scenario.py
2025-08-10T01:11:20.3573415Z ----------------------------------------
2025-08-10T01:11:20.3573918Z Running: tests/test_json_bug_state_updates.py
2025-08-10T01:11:20.3895627Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.3904384Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.3909088Z ERROR:root:üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:20.3911618Z Initial response_text (clean):
2025-08-10T01:11:20.3912020Z   Starts with '{': False
2025-08-10T01:11:20.3912405Z   First 100 chars: [Mode: STORY MODE]
2025-08-10T01:11:20.3912889Z [CHARACTER CREATION - Step 2 of 7]
2025-08-10T01:11:20.3913175Z
2025-08-10T01:11:20.3913367Z "Excellent choice, adventurer!" The voice tha
2025-08-10T01:11:20.3913684Z
2025-08-10T01:11:20.3913833Z After appending state updates:
2025-08-10T01:11:20.3914223Z   Length increased from 155 to 315
2025-08-10T01:11:20.3914621Z   Still starts with '{': False
2025-08-10T01:11:20.3915039Z   Contains 'STATE_UPDATES_PROPOSED': True
2025-08-10T01:11:20.3915346Z
2025-08-10T01:11:20.3915549Z Conclusion: State updates don't cause the JSON bug
2025-08-10T01:11:20.3915907Z
2025-08-10T01:11:20.3916064Z ============================================================
2025-08-10T01:11:20.3916684Z Testing edge cases where parse_structured_response might return JSON
2025-08-10T01:11:20.3917136Z
2025-08-10T01:11:20.3917402Z Test case 1: {"narrative": "Test story", "entities_mentioned": ...
2025-08-10T01:11:20.3918129Z   Result starts with '{': False
2025-08-10T01:11:20.3918509Z   Result: Test story
2025-08-10T01:11:20.3919090Z
2025-08-10T01:11:20.3919322Z Test case 2: {"narrative": "Test story" "broken json here...
2025-08-10T01:11:20.3919835Z   Result starts with '{': False
2025-08-10T01:11:20.3920208Z   Result: Test story
2025-08-10T01:11:20.3920413Z
2025-08-10T01:11:20.3920634Z Test case 3: {"Some weird text that starts with brace...
2025-08-10T01:11:20.3921136Z   Result starts with '{': True
2025-08-10T01:11:20.3921771Z   Result: {"Some weird text that starts with brace
2025-08-10T01:11:20.3922432Z   üö® FOUND IT! This input causes JSON to be returned!
2025-08-10T01:11:20.3922775Z
2025-08-10T01:11:20.3923132Z üî¥ Found a case where parse_structured_response returns JSON!
2025-08-10T01:11:20.3967547Z ‚úÖ PASS: tests/test_json_bug_state_updates.py
2025-08-10T01:11:20.3969148Z ----------------------------------------
2025-08-10T01:11:20.3969640Z Running: tests/test_json_cleanup_safety.py
2025-08-10T01:11:20.4448996Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.4464453Z ......WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.4470834Z .WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.4472354Z ERROR:root:üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:20.4478096Z .......
2025-08-10T01:11:20.4478723Z ----------------------------------------------------------------------
2025-08-10T01:11:20.4479245Z Ran 14 tests in 0.003s
2025-08-10T01:11:20.4480598Z
2025-08-10T01:11:20.4480832Z OK
2025-08-10T01:11:20.4566252Z ‚úÖ PASS: tests/test_json_cleanup_safety.py
2025-08-10T01:11:20.4569340Z ----------------------------------------
2025-08-10T01:11:20.4571487Z Running: tests/test_json_display_bugs.py
2025-08-10T01:11:20.5049168Z test_empty_response_handling (__main__.TestIntegrationBugs.test_empty_response_handling)
2025-08-10T01:11:20.5050492Z Test handling of empty or null responses ... INFO:root:No JSON found in response, treating as plain text narrative
2025-08-10T01:11:20.5055021Z INFO:root:Recovered from incomplete JSON response. Narrative length: 4 characters (~1 tokens)
2025-08-10T01:11:20.5058467Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.5059453Z DEBUG:root:üîç MALFORMED_JSON_CONTENT: Length: 9 chars
2025-08-10T01:11:20.5060186Z DEBUG:root:üîç MALFORMED_JSON_CONTENT: undefined
2025-08-10T01:11:20.5066213Z ERROR:root:üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:20.5068781Z INFO:root:No JSON found in response, treating as plain text narrative
2025-08-10T01:11:20.5069713Z INFO:root:Recovered from incomplete JSON response. Narrative length: 9 characters (~2 tokens)
2025-08-10T01:11:20.5070483Z ok
2025-08-10T01:11:20.5071225Z test_state_updates_with_malformed_json (__main__.TestIntegrationBugs.test_state_updates_with_malformed_json)
2025-08-10T01:11:20.5073014Z Test that state updates work even when JSON is malformed ... WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.5079497Z DEBUG:root:üîç MALFORMED_JSON_CONTENT: Length: 235 chars
2025-08-10T01:11:20.5086342Z DEBUG:root:üîç MALFORMED_JSON_CONTENT: {
2025-08-10T01:11:20.5086889Z             "narrative": "You attack the orc.",
2025-08-10T01:11:20.5087390Z             "state_updates": {
2025-08-10T01:11:20.5088080Z                 "player_character_data": {"hp_current": "18"},
2025-08-10T01:11:20.5088694Z                 "npc_data": {"orc_warrior": {"status": "wounded"}}
2025-08-10T01:11:20.5089212Z             },
2025-08-10T01:11:20.5089521Z         }
2025-08-10T01:11:20.5089978Z INFO:root:Successfully extracted fields from malformed JSON
2025-08-10T01:11:20.5090828Z INFO:root:üîç EXTRACTED_FIELDS: ['narrative', 'state_updates']
2025-08-10T01:11:20.5091722Z INFO:root:Recovered from incomplete JSON response. Narrative length: 19 characters (~4 tokens)
2025-08-10T01:11:20.5092532Z ok
2025-08-10T01:11:20.5093225Z test_unicode_and_special_characters (__main__.TestIntegrationBugs.test_unicode_and_special_characters)
2025-08-10T01:11:20.5094665Z Test handling of unicode and special characters ... ok
2025-08-10T01:11:20.5095478Z test_very_long_json_response (__main__.TestIntegrationBugs.test_very_long_json_response)
2025-08-10T01:11:20.5096288Z Test handling of very long JSON responses ... ok
2025-08-10T01:11:20.5097379Z test_code_block_json_extraction (__main__.TestRawJsonDisplayBugs.test_code_block_json_extraction)
2025-08-10T01:11:20.5098681Z Test extraction of JSON from code blocks ... INFO:root:Extracted JSON from markdown code block
2025-08-10T01:11:20.5099367Z ok
2025-08-10T01:11:20.5100019Z test_debug_mode_content_stripping (__main__.TestRawJsonDisplayBugs.test_debug_mode_content_stripping)
2025-08-10T01:11:20.5101445Z Test that debug mode content is properly stripped ... WARNING:root:‚ö†Ô∏è Invalid debug_info type: str, expected dict. Using empty dict instead.
2025-08-10T01:11:20.5102315Z ok
2025-08-10T01:11:20.5102844Z test_json_artifact_cleaning (__main__.TestRawJsonDisplayBugs.test_json_artifact_cleaning)
2025-08-10T01:11:20.5103602Z Test that JSON artifacts are cleaned from narrative ... ok
2025-08-10T01:11:20.5104352Z test_malformed_json_fallback (__main__.TestRawJsonDisplayBugs.test_malformed_json_fallback)
2025-08-10T01:11:20.5105346Z Test that malformed JSON falls back to cleaned text ... INFO:root:Successfully completed incomplete JSON
2025-08-10T01:11:20.5106365Z INFO:root:Recovered from incomplete JSON response. Narrative length: 21 characters (~5 tokens)
2025-08-10T01:11:20.5107129Z INFO:root:Successfully fixed JSON boundaries
2025-08-10T01:11:20.5108059Z INFO:root:Recovered from incomplete JSON response. Narrative length: 21 characters (~5 tokens)
2025-08-10T01:11:20.5109222Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.5110057Z DEBUG:root:üîç MALFORMED_JSON_CONTENT: Length: 34 chars
2025-08-10T01:11:20.5110798Z DEBUG:root:üîç MALFORMED_JSON_CONTENT: narrative: "You enter the tavern."
2025-08-10T01:11:20.5111473Z INFO:root:Successfully parsed with aggressive fixes
2025-08-10T01:11:20.5112257Z INFO:root:Recovered from incomplete JSON response. Narrative length: 21 characters (~5 tokens)
2025-08-10T01:11:20.5113036Z INFO:root:Extracted JSON from markdown code block
2025-08-10T01:11:20.5113932Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.5114989Z DEBUG:root:üîç MALFORMED_JSON_CONTENT: Length: 39 chars
2025-08-10T01:11:20.5115893Z DEBUG:root:üîç MALFORMED_JSON_CONTENT: {"narrative": "You enter the tavern.",}
2025-08-10T01:11:20.5116733Z INFO:root:Successfully extracted fields from malformed JSON
2025-08-10T01:11:20.5117485Z INFO:root:üîç EXTRACTED_FIELDS: ['narrative']
2025-08-10T01:11:20.5121899Z INFO:root:Recovered from incomplete JSON response. Narrative length: 21 characters (~5 tokens)
2025-08-10T01:11:20.5122612Z ok
2025-08-10T01:11:20.5123254Z test_narrative_extraction_utility (__main__.TestRawJsonDisplayBugs.test_narrative_extraction_utility)
2025-08-10T01:11:20.5124157Z Test the narrative extraction utility function ... ok
2025-08-10T01:11:20.5124988Z test_narrative_field_extraction (__main__.TestRawJsonDisplayBugs.test_narrative_field_extraction)
2025-08-10T01:11:20.5125878Z Test extraction of narrative field from complex JSON ... ok
2025-08-10T01:11:20.5126764Z test_robust_json_parser_fallback (__main__.TestRawJsonDisplayBugs.test_robust_json_parser_fallback)
2025-08-10T01:11:20.5127991Z Test the robust JSON parser as fallback ... INFO:root:Successfully completed incomplete JSON
2025-08-10T01:11:20.5128633Z ok
2025-08-10T01:11:20.5129145Z test_valid_json_parsing (__main__.TestRawJsonDisplayBugs.test_valid_json_parsing)
2025-08-10T01:11:20.5129874Z Test that valid JSON is parsed correctly ... ok
2025-08-10T01:11:20.5130566Z test_empty_state_updates (__main__.TestStateUpdateBugs.test_empty_state_updates)
2025-08-10T01:11:20.5131281Z Test handling of responses with empty state updates ... ok
2025-08-10T01:11:20.5132344Z test_json_state_updates_extraction (__main__.TestStateUpdateBugs.test_json_state_updates_extraction)
2025-08-10T01:11:20.5133116Z Test that state updates are properly extracted from JSON format ... ok
2025-08-10T01:11:20.5133923Z test_malformed_state_updates (__main__.TestStateUpdateBugs.test_malformed_state_updates)
2025-08-10T01:11:20.5135302Z Test handling of malformed state updates ... WARNING:root:‚ö†Ô∏è Invalid state_updates type: str, expected dict. Using empty dict instead.
2025-08-10T01:11:20.5136383Z ok
2025-08-10T01:11:20.5137046Z test_markdown_state_updates_deprecated (__main__.TestStateUpdateBugs.test_markdown_state_updates_deprecated)
2025-08-10T01:11:20.5138742Z Test that old markdown state updates are handled gracefully ... WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.5139965Z DEBUG:root:üîç MALFORMED_JSON_CONTENT: Length: 212 chars
2025-08-10T01:11:20.5140733Z DEBUG:root:üîç MALFORMED_JSON_CONTENT: You swing your sword at the orc.
2025-08-10T01:11:20.5141204Z
2025-08-10T01:11:20.5141367Z         [STATE_UPDATES_PROPOSED]
2025-08-10T01:11:20.5141820Z         player_character_data: {"hp_current": "18"}
2025-08-10T01:11:20.5142349Z         npc_data: {"orc_warrior": {"status": "wounded"}}
2025-08-10T01:11:20.5142835Z         [END_STATE_UPDATES_PROPOSED]
2025-08-10T01:11:20.5143331Z INFO:root:Successfully parsed with aggressive fixes
2025-08-10T01:11:20.5144143Z INFO:root:Recovered from incomplete JSON response. Narrative length: 2 characters (~0 tokens)
2025-08-10T01:11:20.5144844Z ok
2025-08-10T01:11:20.5145380Z test_mixed_format_handling (__main__.TestStateUpdateBugs.test_mixed_format_handling)
2025-08-10T01:11:20.5146441Z Test handling of responses with both JSON and markdown formats ... INFO:root:Successfully fixed JSON boundaries
2025-08-10T01:11:20.5147550Z INFO:root:Recovered from incomplete JSON response. Narrative length: 32 characters (~8 tokens)
2025-08-10T01:11:20.5148399Z ok
2025-08-10T01:11:20.5149004Z test_state_updates_not_in_narrative (__main__.TestStateUpdateBugs.test_state_updates_not_in_narrative)
2025-08-10T01:11:20.5149885Z Test that state updates don't leak into narrative text ... ok
2025-08-10T01:11:20.5150287Z
2025-08-10T01:11:20.5150509Z ----------------------------------------------------------------------
2025-08-10T01:11:20.5151009Z Ran 18 tests in 0.005s
2025-08-10T01:11:20.5151243Z
2025-08-10T01:11:20.5151357Z OK
2025-08-10T01:11:20.5186927Z ‚úÖ PASS: tests/test_json_display_bugs.py
2025-08-10T01:11:20.5188369Z ----------------------------------------
2025-08-10T01:11:20.5188828Z Running: tests/test_json_display_fix.py
2025-08-10T01:11:20.5662345Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.5673410Z ..WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.5677678Z ....WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:20.5682207Z ERROR:root:üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:20.5684841Z ...
2025-08-10T01:11:20.5685225Z ----------------------------------------------------------------------
2025-08-10T01:11:20.5685730Z Ran 9 tests in 0.002s
2025-08-10T01:11:20.5685952Z
2025-08-10T01:11:20.5686068Z OK
2025-08-10T01:11:20.5757573Z ‚úÖ PASS: tests/test_json_display_fix.py
2025-08-10T01:11:20.5758745Z ----------------------------------------
2025-08-10T01:11:20.5759691Z Running: tests/test_json_mode_constants.py
2025-08-10T01:11:20.6125533Z ..
2025-08-10T01:11:20.6126350Z ----------------------------------------------------------------------
2025-08-10T01:11:20.6127218Z Ran 2 tests in 0.000s
2025-08-10T01:11:20.6128247Z
2025-08-10T01:11:20.6129109Z OK
2025-08-10T01:11:20.6183681Z ‚úÖ PASS: tests/test_json_mode_constants.py
2025-08-10T01:11:20.6185023Z ----------------------------------------
2025-08-10T01:11:20.6185514Z Running: tests/test_json_mode_preference.py
2025-08-10T01:11:21.6128132Z 2025-08-10 01:11:21,612 - INFO - Extracted JSON from markdown code block
2025-08-10T01:11:21.6130702Z 2025-08-10 01:11:21,612 - INFO - Extracted JSON from generic code block
2025-08-10T01:11:21.6131724Z ....2025-08-10 01:11:21,612 - ERROR - ERROR: No structured response available for state updates. JSON mode is required.
2025-08-10T01:11:21.6136275Z ..
2025-08-10T01:11:21.6137335Z ----------------------------------------------------------------------
2025-08-10T01:11:21.6139044Z Ran 6 tests in 0.001s
2025-08-10T01:11:21.6139256Z
2025-08-10T01:11:21.6139369Z OK
2025-08-10T01:11:21.7577387Z ‚úÖ PASS: tests/test_json_mode_preference.py
2025-08-10T01:11:21.7579073Z ----------------------------------------
2025-08-10T01:11:21.7579636Z Running: tests/test_json_mode_state_updates.py
2025-08-10T01:11:21.8054188Z ...
2025-08-10T01:11:21.8055299Z ----------------------------------------------------------------------
2025-08-10T01:11:21.8055829Z Ran 3 tests in 0.001s
2025-08-10T01:11:21.8056038Z
2025-08-10T01:11:21.8056164Z OK
2025-08-10T01:11:21.8056741Z ‚úÖ Empty state updates handled correctly
2025-08-10T01:11:21.8057326Z ‚úÖ JSON response with state updates properly converted
2025-08-10T01:11:21.8058223Z ‚úÖ JSON response without state updates handled correctly
2025-08-10T01:11:21.8124429Z ‚úÖ PASS: tests/test_json_mode_state_updates.py
2025-08-10T01:11:21.8125680Z ----------------------------------------
2025-08-10T01:11:21.8126228Z Running: tests/test_json_only_comprehensive.py
2025-08-10T01:11:22.8603155Z ..2025-08-10 01:11:22,860 - INFO - Calling Gemini API with prompt: test logging...
2025-08-10T01:11:22.8604709Z 2025-08-10 01:11:22,860 - INFO - Calling Gemini API: 11 characters (~2 tokens)
2025-08-10T01:11:22.8610990Z 2025-08-10 01:11:22,860 - WARNING - ‚ö†Ô∏è Could not count tokens before API call: unsupported operand type(s) for +: 'Mock' and 'int'
2025-08-10T01:11:22.8612036Z 2025-08-10 01:11:22,860 - INFO - Using model: gemini-2.5-flash
2025-08-10T01:11:22.8614083Z ..2025-08-10 01:11:22,861 - ERROR - ERROR: No structured response available for state updates. JSON mode is required.
2025-08-10T01:11:22.8621088Z ....
2025-08-10T01:11:22.8622098Z ----------------------------------------------------------------------
2025-08-10T01:11:22.8622809Z Ran 8 tests in 0.003s
2025-08-10T01:11:22.8623236Z
2025-08-10T01:11:22.8623486Z OK
2025-08-10T01:11:23.0242756Z ‚úÖ PASS: tests/test_json_only_comprehensive.py
2025-08-10T01:11:23.0245979Z ----------------------------------------
2025-08-10T01:11:23.0246489Z Running: tests/test_json_only_mode.py
2025-08-10T01:11:24.0579617Z 2025-08-10 01:11:24,057 - WARNING - ‚ö†Ô∏è No specific system prompts selected for continue_story. Using none.
2025-08-10T01:11:24.0581217Z 2025-08-10 01:11:24,057 - INFO - Cache MISS for master_directive.md: loaded and cached 8299 characters (~2074 tokens)
2025-08-10T01:11:24.0584450Z 2025-08-10 01:11:24,058 - INFO - Cache MISS for game_state_instruction.md: loaded and cached 56680 characters (~14170 tokens)
2025-08-10T01:11:24.0586182Z 2025-08-10 01:11:24,058 - INFO - Cache MISS for dnd_srd_instruction.md: loaded and cached 1216 characters (~304 tokens)
2025-08-10T01:11:24.0591028Z 2025-08-10 01:11:24,058 - INFO - Prompt scaffold is 125 chars (~31 tokens). Remaining budget for story: 2999875 chars (~749968 tokens)
2025-08-10T01:11:24.0592070Z 2025-08-10 01:11:24,058 - INFO - Initial context stats: Turns: 0, Tokens: 0
2025-08-10T01:11:24.0599783Z 2025-08-10 01:11:24,059 - INFO - Context is within token budget. No truncation needed.
2025-08-10T01:11:24.0607364Z 2025-08-10 01:11:24,060 - INFO - Generated entity manifest for session 1, turn 1
2025-08-10T01:11:24.0611097Z 2025-08-10 01:11:24,060 - INFO - Calling Gemini API with prompt: GeminiRequest: test prompt......
2025-08-10T01:11:24.0612553Z 2025-08-10 01:11:24,061 - INFO - Calling Gemini API: 70065 characters (~17516 tokens)
2025-08-10T01:11:24.0619566Z 2025-08-10 01:11:24,061 - WARNING - ‚ö†Ô∏è Could not count tokens before API call: unsupported operand type(s) for +: 'Mock' and 'Mock'
2025-08-10T01:11:24.0620584Z 2025-08-10 01:11:24,061 - INFO - Using model: gemini-1.5-flash
2025-08-10T01:11:24.0623410Z 2025-08-10 01:11:24,062 - INFO - Successfully used GeminiRequest for structured JSON communication
2025-08-10T01:11:24.0632201Z 2025-08-10 01:11:24,063 - INFO - Comprehensive validation: 0/0 found, confidence: 1.00, warnings: 0
2025-08-10T01:11:24.0633429Z 2025-08-10 01:11:24,063 - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/1 found
2025-08-10T01:11:24.0636519Z 2025-08-10 01:11:24,063 - INFO - Comprehensive validation: 0/0 found, confidence: 1.00, warnings: 0
2025-08-10T01:11:24.0637551Z 2025-08-10 01:11:24,063 - INFO - NarrativeSyncValidator delegated to EntityValidator: 0/1 found
2025-08-10T01:11:24.0641343Z .2025-08-10 01:11:24,063 - ERROR - ERROR: No structured response available for state updates. JSON mode is required.
2025-08-10T01:11:24.0697587Z ..2025-08-10 01:11:24,069 - ERROR - üî•üî¥ --- EXCEPTION IN: continue_story ---
2025-08-10T01:11:24.0698963Z Args: ([], 'prompt', 'story', <game_state.GameState object at 0x7f24a666e690>)
2025-08-10T01:11:24.0699799Z Kwargs: {}
2025-08-10T01:11:24.0700438Z Error: expected string or bytes-like object, got 'list'
2025-08-10T01:11:24.0702336Z Traceback:
2025-08-10T01:11:24.0702689Z Traceback (most recent call last):
2025-08-10T01:11:24.0705638Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:24.0706596Z     return func(*args, **kwargs)
2025-08-10T01:11:24.0707013Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:24.0708136Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 2109, in continue_story
2025-08-10T01:11:24.0709168Z     think_matches: list[str] = re.findall(think_pattern, user_input, re.IGNORECASE)
2025-08-10T01:11:24.0709791Z                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:24.0710567Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/re/__init__.py", line 216, in findall
2025-08-10T01:11:24.0711313Z     return _compile(pattern, flags).findall(string)
2025-08-10T01:11:24.0711742Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:24.0712325Z TypeError: expected string or bytes-like object, got 'list'
2025-08-10T01:11:24.0712909Z --- END EXCEPTION ---
2025-08-10T01:11:24.0713458Z ....2025-08-10 01:11:24,070 - INFO - Extracted JSON from markdown code block
2025-08-10T01:11:24.0714644Z 2025-08-10 01:11:24,070 - INFO - Successfully completed incomplete JSON
2025-08-10T01:11:24.0715697Z 2025-08-10 01:11:24,070 - INFO - Recovered from incomplete JSON response. Narrative length: 4 characters (~1 tokens)
2025-08-10T01:11:24.0716512Z ..
2025-08-10T01:11:24.0717054Z ----------------------------------------------------------------------
2025-08-10T01:11:24.0718084Z Ran 9 tests in 0.015s
2025-08-10T01:11:24.0718474Z
2025-08-10T01:11:24.0718734Z OK
2025-08-10T01:11:24.2204672Z ‚úÖ PASS: tests/test_json_only_mode.py
2025-08-10T01:11:24.2206110Z ----------------------------------------
2025-08-10T01:11:24.2206645Z Running: tests/test_json_state_updates_fix.py
2025-08-10T01:11:24.5489775Z 2025-08-10 01:11:24,548 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:24.5582652Z 2025-08-10 01:11:24,558 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:24.5592491Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:24.5594655Z   setup_file_logging()
2025-08-10T01:11:24.5595843Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:24.8211932Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:24.8215363Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:24.8420773Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:24.8423929Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:25.5408778Z 2025-08-10 01:11:25,540 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:25.5410067Z Args: ('mcp-json-state-test-user', 'mcp-json-test-campaign')
2025-08-10T01:11:25.5410988Z Kwargs: {}
2025-08-10T01:11:25.5412260Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5413493Z Traceback:
2025-08-10T01:11:25.5413819Z Traceback (most recent call last):
2025-08-10T01:11:25.5414675Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:25.5415469Z     asyncio.get_running_loop()
2025-08-10T01:11:25.5415894Z RuntimeError: no running event loop
2025-08-10T01:11:25.5416178Z
2025-08-10T01:11:25.5416463Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:25.5416900Z
2025-08-10T01:11:25.5417077Z Traceback (most recent call last):
2025-08-10T01:11:25.5418196Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:25.5418992Z     return func(*args, **kwargs)
2025-08-10T01:11:25.5419374Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5420364Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:25.5421316Z     db = get_db()
2025-08-10T01:11:25.5421601Z          ^^^^^^^^
2025-08-10T01:11:25.5422341Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:25.5423182Z     return firestore.client()
2025-08-10T01:11:25.5423564Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5424595Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:25.5425951Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:25.5426697Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5428096Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:25.5429452Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:25.5430080Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5431271Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:25.5432695Z     self._services[name] = initializer(self)
2025-08-10T01:11:25.5433148Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5434068Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:25.5435170Z     credentials = app.credential.get_credential()
2025-08-10T01:11:25.5435672Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5436901Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:25.5438533Z     self._load_credential()
2025-08-10T01:11:25.5439680Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:25.5440996Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:25.5441835Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5442932Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:25.5444245Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:25.5445980Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5447501Z --- END EXCEPTION ---
2025-08-10T01:11:25.5450115Z 2025-08-10 01:11:25,540 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5454388Z .2025-08-10 01:11:25,545 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:25.5456477Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:25.5458388Z   setup_file_logging()
2025-08-10T01:11:25.5458974Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:25.5563514Z 2025-08-10 01:11:25,556 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:25.5566750Z Args: ('mcp-json-state-test-user', 'mcp-json-test-campaign')
2025-08-10T01:11:25.5567358Z Kwargs: {}
2025-08-10T01:11:25.5568702Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5569978Z Traceback:
2025-08-10T01:11:25.5570325Z Traceback (most recent call last):
2025-08-10T01:11:25.5571226Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:25.5572108Z     asyncio.get_running_loop()
2025-08-10T01:11:25.5572537Z RuntimeError: no running event loop
2025-08-10T01:11:25.5572823Z
2025-08-10T01:11:25.5573116Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:25.5573569Z
2025-08-10T01:11:25.5573722Z Traceback (most recent call last):
2025-08-10T01:11:25.5574547Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:25.5575457Z     return func(*args, **kwargs)
2025-08-10T01:11:25.5575919Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5576905Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:25.5578159Z     db = get_db()
2025-08-10T01:11:25.5578492Z          ^^^^^^^^
2025-08-10T01:11:25.5579291Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:25.5580172Z     return firestore.client()
2025-08-10T01:11:25.5580554Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5581603Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:25.5582937Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:25.5583662Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5585090Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:25.5586431Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:25.5587075Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5588649Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:25.5589833Z     self._services[name] = initializer(self)
2025-08-10T01:11:25.5590321Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5591490Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:25.5592720Z     credentials = app.credential.get_credential()
2025-08-10T01:11:25.5593247Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5594542Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:25.5595769Z     self._load_credential()
2025-08-10T01:11:25.5596987Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:25.5598645Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:25.5599322Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5600514Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:25.5601963Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:25.5603819Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5605431Z --- END EXCEPTION ---
2025-08-10T01:11:25.5607323Z 2025-08-10 01:11:25,556 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5609554Z .2025-08-10 01:11:25,559 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:25.5611186Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:25.5612601Z   setup_file_logging()
2025-08-10T01:11:25.5613226Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:25.5691433Z 2025-08-10 01:11:25,568 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:25.5693298Z Args: ('mcp-json-state-test-user', 'mcp-json-test-campaign')
2025-08-10T01:11:25.5693833Z Kwargs: {}
2025-08-10T01:11:25.5694923Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5696138Z Traceback:
2025-08-10T01:11:25.5696492Z Traceback (most recent call last):
2025-08-10T01:11:25.5697399Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:25.5698600Z     asyncio.get_running_loop()
2025-08-10T01:11:25.5699067Z RuntimeError: no running event loop
2025-08-10T01:11:25.5699379Z
2025-08-10T01:11:25.5699699Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:25.5700185Z
2025-08-10T01:11:25.5700360Z Traceback (most recent call last):
2025-08-10T01:11:25.5701719Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:25.5702649Z     return func(*args, **kwargs)
2025-08-10T01:11:25.5703065Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5704138Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:25.5705380Z     db = get_db()
2025-08-10T01:11:25.5705751Z          ^^^^^^^^
2025-08-10T01:11:25.5706657Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:25.5707558Z     return firestore.client()
2025-08-10T01:11:25.5708134Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5709218Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:25.5710552Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:25.5711307Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5712508Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:25.5713852Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:25.5714528Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5715682Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:25.5716840Z     self._services[name] = initializer(self)
2025-08-10T01:11:25.5717290Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5718560Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:25.5719727Z     credentials = app.credential.get_credential()
2025-08-10T01:11:25.5720254Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5721512Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:25.5723196Z     self._load_credential()
2025-08-10T01:11:25.5724348Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:25.5725676Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:25.5726594Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5727872Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:25.5729206Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:25.5731024Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5732679Z --- END EXCEPTION ---
2025-08-10T01:11:25.5734572Z 2025-08-10 01:11:25,569 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5736477Z .2025-08-10 01:11:25,572 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:25.5738586Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:25.5740311Z   setup_file_logging()
2025-08-10T01:11:25.5740928Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:25.5822083Z 2025-08-10 01:11:25,582 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:25.5823963Z Args: ('mcp-json-state-test-user', 'mcp-json-test-campaign')
2025-08-10T01:11:25.5824705Z Kwargs: {}
2025-08-10T01:11:25.5825793Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5827010Z Traceback:
2025-08-10T01:11:25.5827371Z Traceback (most recent call last):
2025-08-10T01:11:25.5828545Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:25.5829453Z     asyncio.get_running_loop()
2025-08-10T01:11:25.5829912Z RuntimeError: no running event loop
2025-08-10T01:11:25.5830223Z
2025-08-10T01:11:25.5830567Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:25.5831041Z
2025-08-10T01:11:25.5831212Z Traceback (most recent call last):
2025-08-10T01:11:25.5832298Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:25.5833236Z     return func(*args, **kwargs)
2025-08-10T01:11:25.5833681Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5834680Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:25.5835630Z     db = get_db()
2025-08-10T01:11:25.5835953Z          ^^^^^^^^
2025-08-10T01:11:25.5836774Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:25.5837891Z     return firestore.client()
2025-08-10T01:11:25.5838295Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5848791Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:25.5850202Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:25.5850960Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5852226Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:25.5853674Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:25.5854376Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5855608Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:25.5856824Z     self._services[name] = initializer(self)
2025-08-10T01:11:25.5857315Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5864941Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:25.5866186Z     credentials = app.credential.get_credential()
2025-08-10T01:11:25.5866711Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5868188Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:25.5869426Z     self._load_credential()
2025-08-10T01:11:25.5870677Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:25.5872099Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:25.5872794Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5874264Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:25.5875715Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:25.5877626Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5879825Z --- END EXCEPTION ---
2025-08-10T01:11:25.5881695Z 2025-08-10 01:11:25,582 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5883651Z .2025-08-10 01:11:25,585 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:25.5885438Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:25.5886960Z   setup_file_logging()
2025-08-10T01:11:25.5887568Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:25.5953065Z 2025-08-10 01:11:25,595 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:25.5959185Z Args: ('mcp-json-state-test-user', 'mcp-json-test-campaign')
2025-08-10T01:11:25.5959818Z Kwargs: {}
2025-08-10T01:11:25.5960931Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5962269Z Traceback:
2025-08-10T01:11:25.5962607Z Traceback (most recent call last):
2025-08-10T01:11:25.5963458Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:25.5964307Z     asyncio.get_running_loop()
2025-08-10T01:11:25.5964741Z RuntimeError: no running event loop
2025-08-10T01:11:25.5965035Z
2025-08-10T01:11:25.5965340Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:25.5965828Z
2025-08-10T01:11:25.5966008Z Traceback (most recent call last):
2025-08-10T01:11:25.5966874Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:25.5967995Z     return func(*args, **kwargs)
2025-08-10T01:11:25.5968404Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5969417Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:25.5970400Z     db = get_db()
2025-08-10T01:11:25.5970718Z          ^^^^^^^^
2025-08-10T01:11:25.5971521Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:25.5972428Z     return firestore.client()
2025-08-10T01:11:25.5972824Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5973894Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:25.5975284Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:25.5976064Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5977340Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:25.5978961Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:25.5979663Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5980908Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:25.5982420Z     self._services[name] = initializer(self)
2025-08-10T01:11:25.5982903Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5984130Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:25.5985355Z     credentials = app.credential.get_credential()
2025-08-10T01:11:25.5986135Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5987433Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:25.5988926Z     self._load_credential()
2025-08-10T01:11:25.5990094Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:25.5991441Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:25.5992116Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.5993329Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:25.5994790Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:25.5996478Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.5998096Z --- END EXCEPTION ---
2025-08-10T01:11:25.5999766Z 2025-08-10 01:11:25,595 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.6001594Z .2025-08-10 01:11:25,597 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:25.6003272Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:25.6004617Z   setup_file_logging()
2025-08-10T01:11:25.6005101Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:25.6085964Z 2025-08-10 01:11:25,608 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:25.6095647Z Args: ('mcp-json-state-test-user', 'mcp-json-test-campaign')
2025-08-10T01:11:25.6096187Z Kwargs: {}
2025-08-10T01:11:25.6097262Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.6098699Z Traceback:
2025-08-10T01:11:25.6099028Z Traceback (most recent call last):
2025-08-10T01:11:25.6099807Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:25.6100561Z     asyncio.get_running_loop()
2025-08-10T01:11:25.6100946Z RuntimeError: no running event loop
2025-08-10T01:11:25.6101214Z
2025-08-10T01:11:25.6101491Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:25.6101934Z
2025-08-10T01:11:25.6102086Z Traceback (most recent call last):
2025-08-10T01:11:25.6102862Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:25.6103627Z     return func(*args, **kwargs)
2025-08-10T01:11:25.6103969Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.6104848Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:25.6105704Z     db = get_db()
2025-08-10T01:11:25.6105982Z          ^^^^^^^^
2025-08-10T01:11:25.6106896Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:25.6107697Z     return firestore.client()
2025-08-10T01:11:25.6109759Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.6110802Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:25.6112275Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:25.6112900Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.6114003Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:25.6115207Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:25.6115789Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.6116826Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:25.6118052Z     self._services[name] = initializer(self)
2025-08-10T01:11:25.6118451Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.6119472Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:25.6120507Z     credentials = app.credential.get_credential()
2025-08-10T01:11:25.6120955Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.6122033Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:25.6123071Z     self._load_credential()
2025-08-10T01:11:25.6124117Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:25.6125342Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:25.6125925Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:25.6126903Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:25.6128273Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:25.6129861Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.6131273Z --- END EXCEPTION ---
2025-08-10T01:11:25.6132912Z 2025-08-10 01:11:25,608 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:25.6134276Z .
2025-08-10T01:11:25.6134609Z ----------------------------------------------------------------------
2025-08-10T01:11:25.6135074Z Ran 6 tests in 1.053s
2025-08-10T01:11:25.6135271Z
2025-08-10T01:11:25.6135374Z OK
2025-08-10T01:11:25.8312493Z ‚úÖ PASS: tests/test_json_state_updates_fix.py
2025-08-10T01:11:25.8313933Z ----------------------------------------
2025-08-10T01:11:25.8314371Z Running: tests/test_json_utils.py
2025-08-10T01:11:25.8789666Z ........................................................
2025-08-10T01:11:25.8791204Z ----------------------------------------------------------------------
2025-08-10T01:11:25.8791713Z Ran 56 tests in 0.004s
2025-08-10T01:11:25.8791934Z
2025-08-10T01:11:25.8792048Z OK
2025-08-10T01:11:25.8853384Z ‚úÖ PASS: tests/test_json_utils.py
2025-08-10T01:11:25.8854588Z ----------------------------------------
2025-08-10T01:11:25.8855464Z Running: tests/test_loading_messages.py
2025-08-10T01:11:25.9225803Z .....
2025-08-10T01:11:25.9227047Z ----------------------------------------------------------------------
2025-08-10T01:11:25.9227580Z Ran 5 tests in 0.001s
2025-08-10T01:11:25.9228125Z
2025-08-10T01:11:25.9228245Z OK
2025-08-10T01:11:25.9281076Z ‚úÖ PASS: tests/test_loading_messages.py
2025-08-10T01:11:25.9282641Z ----------------------------------------
2025-08-10T01:11:25.9283167Z Running: tests/test_luke_campaign_god_mode_json_bug.py
2025-08-10T01:11:25.9760171Z ....
2025-08-10T01:11:25.9761564Z ----------------------------------------------------------------------
2025-08-10T01:11:25.9762090Z Ran 4 tests in 0.001s
2025-08-10T01:11:25.9762308Z
2025-08-10T01:11:25.9762419Z OK
2025-08-10T01:11:25.9833024Z ‚úÖ PASS: tests/test_luke_campaign_god_mode_json_bug.py
2025-08-10T01:11:25.9834333Z ----------------------------------------
2025-08-10T01:11:25.9834901Z Running: tests/test_luke_campaign_jedi_master_gender_fix.py
2025-08-10T01:11:26.2095705Z ...
2025-08-10T01:11:26.2097176Z ----------------------------------------------------------------------
2025-08-10T01:11:26.2097688Z Ran 3 tests in 0.000s
2025-08-10T01:11:26.2098094Z
2025-08-10T01:11:26.2098218Z OK
2025-08-10T01:11:26.2433930Z ‚úÖ PASS: tests/test_luke_campaign_jedi_master_gender_fix.py
2025-08-10T01:11:26.2435396Z ----------------------------------------
2025-08-10T01:11:26.2435904Z Running: tests/test_main.py
2025-08-10T01:11:26.5728279Z 2025-08-10 01:11:26,572 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:27.4729310Z 2025-08-10 01:11:27,472 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:27.4734371Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:27.4736382Z   setup_file_logging()
2025-08-10T01:11:27.4737512Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:27.4862361Z 2025-08-10 01:11:27,486 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:27.4863512Z Args: ('mcp-main-test-user', 'mcp-test-campaign')
2025-08-10T01:11:27.4864389Z Kwargs: {}
2025-08-10T01:11:27.4865697Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.4866915Z Traceback:
2025-08-10T01:11:27.4867228Z Traceback (most recent call last):
2025-08-10T01:11:27.4868326Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:27.4869129Z     asyncio.get_running_loop()
2025-08-10T01:11:27.4869540Z RuntimeError: no running event loop
2025-08-10T01:11:27.4869833Z
2025-08-10T01:11:27.4870124Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:27.4870584Z
2025-08-10T01:11:27.4870737Z Traceback (most recent call last):
2025-08-10T01:11:27.4871585Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:27.4872537Z     return func(*args, **kwargs)
2025-08-10T01:11:27.4872930Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.4873973Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:27.4874922Z     db = get_db()
2025-08-10T01:11:27.4875221Z          ^^^^^^^^
2025-08-10T01:11:27.4876001Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:27.4876890Z     return firestore.client()
2025-08-10T01:11:27.4877283Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.4878539Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:27.4880222Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:27.4880980Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.4882207Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:27.4884044Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:27.4884666Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.4885786Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:27.4887054Z     self._services[name] = initializer(self)
2025-08-10T01:11:27.4887515Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.4889534Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:27.4890756Z     credentials = app.credential.get_credential()
2025-08-10T01:11:27.4891253Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.4892447Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:27.4893633Z     self._load_credential()
2025-08-10T01:11:27.4894800Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:27.4896194Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:27.4896859Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.4898208Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:27.4899598Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:27.4901738Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.4903340Z --- END EXCEPTION ---
2025-08-10T01:11:27.4905143Z 2025-08-10 01:11:27,486 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.4906957Z .2025-08-10 01:11:27,490 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:27.4908959Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:27.4910468Z   setup_file_logging()
2025-08-10T01:11:27.4911080Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:27.4999175Z 2025-08-10 01:11:27,499 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:27.5004598Z Args: ('mcp-main-test-user', 'mcp-test-campaign')
2025-08-10T01:11:27.5005779Z Kwargs: {}
2025-08-10T01:11:27.5006934Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5008501Z Traceback:
2025-08-10T01:11:27.5008845Z Traceback (most recent call last):
2025-08-10T01:11:27.5009706Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:27.5010534Z     asyncio.get_running_loop()
2025-08-10T01:11:27.5011211Z RuntimeError: no running event loop
2025-08-10T01:11:27.5011512Z
2025-08-10T01:11:27.5011811Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:27.5012266Z
2025-08-10T01:11:27.5012427Z Traceback (most recent call last):
2025-08-10T01:11:27.5013297Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:27.5014395Z     return func(*args, **kwargs)
2025-08-10T01:11:27.5014802Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5015822Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:27.5016812Z     db = get_db()
2025-08-10T01:11:27.5017129Z          ^^^^^^^^
2025-08-10T01:11:27.5018113Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:27.5019043Z     return firestore.client()
2025-08-10T01:11:27.5019427Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5020509Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:27.5021924Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:27.5022695Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5023963Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:27.5025398Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:27.5026096Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5027340Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:27.5028791Z     self._services[name] = initializer(self)
2025-08-10T01:11:27.5029313Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5030513Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:27.5031702Z     credentials = app.credential.get_credential()
2025-08-10T01:11:27.5032227Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5033516Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:27.5034751Z     self._load_credential()
2025-08-10T01:11:27.5036002Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:27.5037433Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:27.5038408Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5039637Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:27.5041108Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:27.5042999Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5044648Z --- END EXCEPTION ---
2025-08-10T01:11:27.5046534Z 2025-08-10 01:11:27,499 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5048847Z .2025-08-10 01:11:27,502 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:27.5051071Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:27.5052753Z   setup_file_logging()
2025-08-10T01:11:27.5053489Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:27.5127389Z 2025-08-10 01:11:27,512 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:27.5134964Z Args: ('mcp-main-test-user', 'mcp-test-campaign')
2025-08-10T01:11:27.5135477Z Kwargs: {}
2025-08-10T01:11:27.5136705Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5138112Z Traceback:
2025-08-10T01:11:27.5138457Z Traceback (most recent call last):
2025-08-10T01:11:27.5139299Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:27.5140153Z     asyncio.get_running_loop()
2025-08-10T01:11:27.5140577Z RuntimeError: no running event loop
2025-08-10T01:11:27.5140871Z
2025-08-10T01:11:27.5141175Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:27.5141619Z
2025-08-10T01:11:27.5141780Z Traceback (most recent call last):
2025-08-10T01:11:27.5142651Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:27.5143505Z     return func(*args, **kwargs)
2025-08-10T01:11:27.5143907Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5144894Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:27.5145858Z     db = get_db()
2025-08-10T01:11:27.5146176Z          ^^^^^^^^
2025-08-10T01:11:27.5147003Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:27.5148132Z     return firestore.client()
2025-08-10T01:11:27.5148520Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5149553Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:27.5150835Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:27.5151615Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5152881Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:27.5154275Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:27.5154963Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5156161Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:27.5157416Z     self._services[name] = initializer(self)
2025-08-10T01:11:27.5158101Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5159288Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:27.5160535Z     credentials = app.credential.get_credential()
2025-08-10T01:11:27.5161031Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5162291Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:27.5163523Z     self._load_credential()
2025-08-10T01:11:27.5164727Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:27.5166425Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:27.5167100Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5168546Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:27.5170107Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:27.5171838Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5173417Z --- END EXCEPTION ---
2025-08-10T01:11:27.5175276Z 2025-08-10 01:11:27,512 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5177197Z .2025-08-10 01:11:27,515 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:27.5179179Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:27.5180673Z   setup_file_logging()
2025-08-10T01:11:27.5181255Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:27.5253404Z 2025-08-10 01:11:27,525 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:27.5255312Z Args: ('mcp-main-test-user', 'mcp-test-campaign')
2025-08-10T01:11:27.5255806Z Kwargs: {}
2025-08-10T01:11:27.5256905Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5258422Z Traceback:
2025-08-10T01:11:27.5258794Z Traceback (most recent call last):
2025-08-10T01:11:27.5259702Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:27.5260587Z     asyncio.get_running_loop()
2025-08-10T01:11:27.5261051Z RuntimeError: no running event loop
2025-08-10T01:11:27.5261393Z
2025-08-10T01:11:27.5261726Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:27.5262204Z
2025-08-10T01:11:27.5262379Z Traceback (most recent call last):
2025-08-10T01:11:27.5263493Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:27.5264425Z     return func(*args, **kwargs)
2025-08-10T01:11:27.5264834Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5265840Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:27.5266866Z     db = get_db()
2025-08-10T01:11:27.5267183Z          ^^^^^^^^
2025-08-10T01:11:27.5268284Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:27.5269222Z     return firestore.client()
2025-08-10T01:11:27.5269623Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5270727Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:27.5272106Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:27.5272835Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5274086Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:27.5275467Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:27.5276360Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5277557Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:27.5278929Z     self._services[name] = initializer(self)
2025-08-10T01:11:27.5279396Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5280737Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:27.5281993Z     credentials = app.credential.get_credential()
2025-08-10T01:11:27.5290349Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5291730Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:27.5293000Z     self._load_credential()
2025-08-10T01:11:27.5294251Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:27.5295717Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:27.5296397Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5297623Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:27.5299923Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:27.5301799Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5303441Z --- END EXCEPTION ---
2025-08-10T01:11:27.5305322Z 2025-08-10 01:11:27,525 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5307242Z .2025-08-10 01:11:27,528 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:27.5309221Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:27.5310751Z   setup_file_logging()
2025-08-10T01:11:27.5311326Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:27.5389835Z 2025-08-10 01:11:27,538 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:27.5396949Z Args: ('mcp-main-test-user', 'mcp-test-campaign')
2025-08-10T01:11:27.5397464Z Kwargs: {}
2025-08-10T01:11:27.5398768Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5400261Z Traceback:
2025-08-10T01:11:27.5400615Z Traceback (most recent call last):
2025-08-10T01:11:27.5401486Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:27.5402352Z     asyncio.get_running_loop()
2025-08-10T01:11:27.5402792Z RuntimeError: no running event loop
2025-08-10T01:11:27.5403084Z
2025-08-10T01:11:27.5403397Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:27.5403847Z
2025-08-10T01:11:27.5404015Z Traceback (most recent call last):
2025-08-10T01:11:27.5404878Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:27.5405739Z     return func(*args, **kwargs)
2025-08-10T01:11:27.5406147Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5407381Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:27.5408621Z     db = get_db()
2025-08-10T01:11:27.5408948Z          ^^^^^^^^
2025-08-10T01:11:27.5409769Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:27.5410887Z     return firestore.client()
2025-08-10T01:11:27.5411283Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5412365Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:27.5413764Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:27.5414544Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5415814Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:27.5417259Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:27.5418181Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5419482Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:27.5420761Z     self._services[name] = initializer(self)
2025-08-10T01:11:27.5421242Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5422445Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:27.5423652Z     credentials = app.credential.get_credential()
2025-08-10T01:11:27.5424178Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5425438Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:27.5426708Z     self._load_credential()
2025-08-10T01:11:27.5429403Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:27.5430909Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:27.5431614Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5432837Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:27.5434365Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:27.5436268Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5438144Z --- END EXCEPTION ---
2025-08-10T01:11:27.5440041Z 2025-08-10 01:11:27,538 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5441992Z .2025-08-10 01:11:27,541 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:27.5443828Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:27.5445329Z   setup_file_logging()
2025-08-10T01:11:27.5445933Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:27.5513898Z 2025-08-10 01:11:27,551 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:27.5516725Z Args: ('mcp-auth-test-user',)
2025-08-10T01:11:27.5517164Z Kwargs: {}
2025-08-10T01:11:27.5526257Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5527552Z Traceback:
2025-08-10T01:11:27.5528085Z Traceback (most recent call last):
2025-08-10T01:11:27.5529199Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:27.5530021Z     asyncio.get_running_loop()
2025-08-10T01:11:27.5530441Z RuntimeError: no running event loop
2025-08-10T01:11:27.5530742Z
2025-08-10T01:11:27.5531040Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:27.5531504Z
2025-08-10T01:11:27.5531674Z Traceback (most recent call last):
2025-08-10T01:11:27.5532576Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:27.5533514Z     return func(*args, **kwargs)
2025-08-10T01:11:27.5533923Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5534946Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:27.5535975Z     db = get_db()
2025-08-10T01:11:27.5536309Z          ^^^^^^^^
2025-08-10T01:11:27.5537151Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:27.5538302Z     return firestore.client()
2025-08-10T01:11:27.5538710Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5539814Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:27.5541220Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:27.5541976Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5543240Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:27.5544645Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:27.5545315Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5546590Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:27.5548277Z     self._services[name] = initializer(self)
2025-08-10T01:11:27.5548781Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5549971Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:27.5551187Z     credentials = app.credential.get_credential()
2025-08-10T01:11:27.5551680Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5552929Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:27.5554166Z     self._load_credential()
2025-08-10T01:11:27.5555383Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:27.5556814Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:27.5557502Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:27.5558858Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:27.5560284Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:27.5562110Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5563950Z --- END EXCEPTION ---
2025-08-10T01:11:27.5565775Z 2025-08-10 01:11:27,551 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:27.5579555Z ........2025-08-10 01:11:27,552 - root - WARNING - ‚ö†Ô∏è Skipping line in SET command due to invalid JSON value: player.data = {invalid json}
2025-08-10T01:11:27.5580395Z .......
2025-08-10T01:11:27.5580750Z ----------------------------------------------------------------------
2025-08-10T01:11:27.5581221Z Ran 20 tests in 0.086s
2025-08-10T01:11:27.5581443Z
2025-08-10T01:11:27.5581560Z OK
2025-08-10T01:11:27.7798515Z ‚úÖ PASS: tests/test_main.py
2025-08-10T01:11:27.7799845Z ----------------------------------------
2025-08-10T01:11:27.7800329Z Running: tests/test_main_auth.py
2025-08-10T01:11:28.1112045Z 2025-08-10 01:11:28,110 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:28.1207921Z 2025-08-10 01:11:28,120 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:28.1216953Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:28.1219669Z   setup_file_logging()
2025-08-10T01:11:28.1220299Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:28.3878454Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:28.3881702Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:28.4089230Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:28.4092641Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:29.1006303Z 2025-08-10 01:11:29,100 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:29.1008480Z Args: ('mcp-auth-test-user',)
2025-08-10T01:11:29.1008902Z Kwargs: {}
2025-08-10T01:11:29.1010053Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1011235Z Traceback:
2025-08-10T01:11:29.1011558Z Traceback (most recent call last):
2025-08-10T01:11:29.1012429Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:29.1013203Z     asyncio.get_running_loop()
2025-08-10T01:11:29.1013629Z RuntimeError: no running event loop
2025-08-10T01:11:29.1013903Z
2025-08-10T01:11:29.1014191Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:29.1014616Z
2025-08-10T01:11:29.1014767Z Traceback (most recent call last):
2025-08-10T01:11:29.1015606Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:29.1016420Z     return func(*args, **kwargs)
2025-08-10T01:11:29.1016774Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1017931Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:29.1019236Z     db = get_db()
2025-08-10T01:11:29.1019607Z          ^^^^^^^^
2025-08-10T01:11:29.1020421Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:29.1021301Z     return firestore.client()
2025-08-10T01:11:29.1022219Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1023276Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:29.1024598Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:29.1025313Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1026424Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:29.1027613Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:29.1028437Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1029684Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:29.1030823Z     self._services[name] = initializer(self)
2025-08-10T01:11:29.1031278Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1032360Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:29.1033470Z     credentials = app.credential.get_credential()
2025-08-10T01:11:29.1033940Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1035048Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:29.1036175Z     self._load_credential()
2025-08-10T01:11:29.1037319Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:29.1038850Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:29.1039526Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1040656Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:29.1042011Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:29.1043741Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1045274Z --- END EXCEPTION ---
2025-08-10T01:11:29.1047055Z 2025-08-10 01:11:29,100 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1050238Z .2025-08-10 01:11:29,104 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:29.1051979Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:29.1053448Z   setup_file_logging()
2025-08-10T01:11:29.1054061Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:29.1152104Z 2025-08-10 01:11:29,115 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:29.1155019Z Args: ('mcp-auth-test-user',)
2025-08-10T01:11:29.1156737Z Kwargs: {}
2025-08-10T01:11:29.1158119Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1162517Z Traceback:
2025-08-10T01:11:29.1162858Z Traceback (most recent call last):
2025-08-10T01:11:29.1163717Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:29.1164944Z     asyncio.get_running_loop()
2025-08-10T01:11:29.1165381Z RuntimeError: no running event loop
2025-08-10T01:11:29.1165668Z
2025-08-10T01:11:29.1165972Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:29.1166416Z
2025-08-10T01:11:29.1166580Z Traceback (most recent call last):
2025-08-10T01:11:29.1167456Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:29.1168548Z     return func(*args, **kwargs)
2025-08-10T01:11:29.1168948Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1169902Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:29.1170855Z     db = get_db()
2025-08-10T01:11:29.1171145Z          ^^^^^^^^
2025-08-10T01:11:29.1171899Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:29.1172793Z     return firestore.client()
2025-08-10T01:11:29.1173188Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1174250Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:29.1175612Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:29.1176331Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1177508Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:29.1179656Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:29.1180690Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1181916Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:29.1191172Z     self._services[name] = initializer(self)
2025-08-10T01:11:29.1191703Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1192910Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:29.1194153Z     credentials = app.credential.get_credential()
2025-08-10T01:11:29.1194658Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1195955Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:29.1197180Z     self._load_credential()
2025-08-10T01:11:29.1198777Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:29.1200276Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:29.1200995Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1202205Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:29.1203630Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:29.1205525Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1207410Z --- END EXCEPTION ---
2025-08-10T01:11:29.1213156Z 2025-08-10 01:11:29,115 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1215317Z .2025-08-10 01:11:29,118 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:29.1217105Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:29.1218930Z   setup_file_logging()
2025-08-10T01:11:29.1219552Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:29.1265385Z 2025-08-10 01:11:29,126 - root - INFO - üéÆ LOADING GAME PAGE: user=mcp-auth-test-user, campaign=mcp-test-campaign
2025-08-10T01:11:29.1306872Z 2025-08-10 01:11:29,130 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_by_id ---
2025-08-10T01:11:29.1307637Z Args: ('mcp-auth-test-user', 'mcp-test-campaign')
2025-08-10T01:11:29.1311178Z Kwargs: {}
2025-08-10T01:11:29.1315646Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1318593Z Traceback:
2025-08-10T01:11:29.1320110Z Traceback (most recent call last):
2025-08-10T01:11:29.1321864Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:29.1323795Z     asyncio.get_running_loop()
2025-08-10T01:11:29.1324216Z RuntimeError: no running event loop
2025-08-10T01:11:29.1324505Z
2025-08-10T01:11:29.1324804Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:29.1325638Z
2025-08-10T01:11:29.1325827Z Traceback (most recent call last):
2025-08-10T01:11:29.1326760Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:29.1327548Z     return func(*args, **kwargs)
2025-08-10T01:11:29.1328174Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1329255Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 470, in get_campaign_by_id
2025-08-10T01:11:29.1330203Z     db = get_db()
2025-08-10T01:11:29.1330523Z          ^^^^^^^^
2025-08-10T01:11:29.1331327Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:29.1332198Z     return firestore.client()
2025-08-10T01:11:29.1332576Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1333593Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:29.1334877Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:29.1335590Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1336790Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:29.1340507Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:29.1341199Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1342353Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:29.1343496Z     self._services[name] = initializer(self)
2025-08-10T01:11:29.1343957Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1345016Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:29.1351642Z     credentials = app.credential.get_credential()
2025-08-10T01:11:29.1352172Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1353476Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:29.1354975Z     self._load_credential()
2025-08-10T01:11:29.1356188Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:29.1357663Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:29.1358571Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1359777Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:29.1361223Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:29.1363068Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1364705Z --- END EXCEPTION ---
2025-08-10T01:11:29.1366641Z 2025-08-10 01:11:29,130 - root - ERROR - üî•üî¥ Failed to get campaign state: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1368819Z .2025-08-10 01:11:29,134 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:29.1370618Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:29.1372090Z   setup_file_logging()
2025-08-10T01:11:29.1372708Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:29.1452368Z 2025-08-10 01:11:29,144 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:29.1459798Z Args: ('mcp-auth-test-user',)
2025-08-10T01:11:29.1460235Z Kwargs: {}
2025-08-10T01:11:29.1461369Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1462568Z Traceback:
2025-08-10T01:11:29.1462901Z Traceback (most recent call last):
2025-08-10T01:11:29.1463637Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:29.1464403Z     asyncio.get_running_loop()
2025-08-10T01:11:29.1464817Z RuntimeError: no running event loop
2025-08-10T01:11:29.1465132Z
2025-08-10T01:11:29.1465483Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:29.1465978Z
2025-08-10T01:11:29.1466146Z Traceback (most recent call last):
2025-08-10T01:11:29.1466994Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:29.1468146Z     return func(*args, **kwargs)
2025-08-10T01:11:29.1468564Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1469554Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:29.1470500Z     db = get_db()
2025-08-10T01:11:29.1470779Z          ^^^^^^^^
2025-08-10T01:11:29.1471556Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:29.1472431Z     return firestore.client()
2025-08-10T01:11:29.1472825Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1474123Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:29.1475441Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:29.1476161Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1477587Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:29.1479089Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:29.1479736Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1480900Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:29.1482027Z     self._services[name] = initializer(self)
2025-08-10T01:11:29.1482502Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1483648Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:29.1484836Z     credentials = app.credential.get_credential()
2025-08-10T01:11:29.1485370Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1486654Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:29.1488620Z     self._load_credential()
2025-08-10T01:11:29.1489903Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:29.1491328Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:29.1492018Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1493251Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:29.1494679Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:29.1496562Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1498492Z --- END EXCEPTION ---
2025-08-10T01:11:29.1500303Z 2025-08-10 01:11:29,145 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1502221Z .2025-08-10 01:11:29,148 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:29.1504051Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:29.1505492Z   setup_file_logging()
2025-08-10T01:11:29.1506118Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:29.1585225Z 2025-08-10 01:11:29,158 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:29.1592105Z Args: ('mcp-user-1',)
2025-08-10T01:11:29.1592505Z Kwargs: {}
2025-08-10T01:11:29.1593669Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1594903Z Traceback:
2025-08-10T01:11:29.1595255Z Traceback (most recent call last):
2025-08-10T01:11:29.1596122Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:29.1597270Z     asyncio.get_running_loop()
2025-08-10T01:11:29.1597627Z RuntimeError: no running event loop
2025-08-10T01:11:29.1598047Z
2025-08-10T01:11:29.1598228Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:29.1598502Z
2025-08-10T01:11:29.1598597Z Traceback (most recent call last):
2025-08-10T01:11:29.1599345Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:29.1599878Z     return func(*args, **kwargs)
2025-08-10T01:11:29.1600101Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1600662Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:29.1601528Z     db = get_db()
2025-08-10T01:11:29.1601856Z          ^^^^^^^^
2025-08-10T01:11:29.1602474Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:29.1602992Z     return firestore.client()
2025-08-10T01:11:29.1603218Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1603805Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:29.1604550Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:29.1604966Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1605645Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:29.1606393Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:29.1606770Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1607426Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:29.1608277Z     self._services[name] = initializer(self)
2025-08-10T01:11:29.1608542Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1609158Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:29.1609811Z     credentials = app.credential.get_credential()
2025-08-10T01:11:29.1610091Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1610759Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:29.1611409Z     self._load_credential()
2025-08-10T01:11:29.1612044Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:29.1612800Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:29.1613180Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1613807Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:29.1615026Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:29.1616863Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1618663Z --- END EXCEPTION ---
2025-08-10T01:11:29.1620480Z 2025-08-10 01:11:29,158 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1625722Z 2025-08-10 01:11:29,162 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:29.1628928Z Args: ('mcp-user-2',)
2025-08-10T01:11:29.1629321Z Kwargs: {}
2025-08-10T01:11:29.1630505Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1632161Z Traceback:
2025-08-10T01:11:29.1632512Z Traceback (most recent call last):
2025-08-10T01:11:29.1634444Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:29.1635280Z     asyncio.get_running_loop()
2025-08-10T01:11:29.1635670Z RuntimeError: no running event loop
2025-08-10T01:11:29.1635905Z
2025-08-10T01:11:29.1636745Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:29.1637217Z
2025-08-10T01:11:29.1637382Z Traceback (most recent call last):
2025-08-10T01:11:29.1638558Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:29.1639421Z     return func(*args, **kwargs)
2025-08-10T01:11:29.1639819Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1640799Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:29.1641773Z     db = get_db()
2025-08-10T01:11:29.1642091Z          ^^^^^^^^
2025-08-10T01:11:29.1642860Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:29.1643704Z     return firestore.client()
2025-08-10T01:11:29.1644088Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1645122Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:29.1646459Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:29.1647194Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1648644Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:29.1649980Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:29.1650697Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1651858Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:29.1653046Z     self._services[name] = initializer(self)
2025-08-10T01:11:29.1653548Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1654674Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:29.1655841Z     credentials = app.credential.get_credential()
2025-08-10T01:11:29.1656534Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1657923Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:29.1659240Z     self._load_credential()
2025-08-10T01:11:29.1660494Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:29.1661913Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:29.1662600Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1673585Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:29.1674871Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:29.1676651Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1678747Z --- END EXCEPTION ---
2025-08-10T01:11:29.1680381Z 2025-08-10 01:11:29,162 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1682170Z .2025-08-10 01:11:29,165 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:29.1683716Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:29.1684984Z   setup_file_logging()
2025-08-10T01:11:29.1685460Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:29.1780908Z 2025-08-10 01:11:29,177 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:29.1781899Z Args: ('mcp-auth-test-user', 'mcp-test-campaign')
2025-08-10T01:11:29.1782406Z Kwargs: {}
2025-08-10T01:11:29.1783569Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1784774Z Traceback:
2025-08-10T01:11:29.1785094Z Traceback (most recent call last):
2025-08-10T01:11:29.1785866Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:29.1786557Z     asyncio.get_running_loop()
2025-08-10T01:11:29.1786979Z RuntimeError: no running event loop
2025-08-10T01:11:29.1787265Z
2025-08-10T01:11:29.1787561Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:29.1788273Z
2025-08-10T01:11:29.1788449Z Traceback (most recent call last):
2025-08-10T01:11:29.1789433Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:29.1790268Z     return func(*args, **kwargs)
2025-08-10T01:11:29.1790650Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1791626Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:29.1792578Z     db = get_db()
2025-08-10T01:11:29.1792887Z          ^^^^^^^^
2025-08-10T01:11:29.1793657Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:29.1794496Z     return firestore.client()
2025-08-10T01:11:29.1794874Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1795888Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:29.1797236Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:29.1798145Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1799349Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:29.1800667Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:29.1801318Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1802475Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:29.1803605Z     self._services[name] = initializer(self)
2025-08-10T01:11:29.1804076Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1805460Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:29.1819627Z     credentials = app.credential.get_credential()
2025-08-10T01:11:29.1820174Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1821420Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:29.1822957Z     self._load_credential()
2025-08-10T01:11:29.1824189Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:29.1825650Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:29.1826323Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.1827487Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:29.1829229Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:29.1831099Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1832748Z --- END EXCEPTION ---
2025-08-10T01:11:29.1834623Z 2025-08-10 01:11:29,177 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.1836532Z .2025-08-10 01:11:29,180 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:29.1838448Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:29.1839936Z   setup_file_logging()
2025-08-10T01:11:29.1840539Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:29.1903270Z .2025-08-10 01:11:29,190 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:29.1906441Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:29.1908196Z   setup_file_logging()
2025-08-10T01:11:29.1908805Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:29.1996605Z 2025-08-10 01:11:29,199 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:29.2002971Z Args: ('mcp-very-long-user-id-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',)
2025-08-10T01:11:29.2004280Z Kwargs: {}
2025-08-10T01:11:29.2005396Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.2006432Z Traceback:
2025-08-10T01:11:29.2006769Z Traceback (most recent call last):
2025-08-10T01:11:29.2007655Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:29.2008799Z     asyncio.get_running_loop()
2025-08-10T01:11:29.2009244Z RuntimeError: no running event loop
2025-08-10T01:11:29.2009535Z
2025-08-10T01:11:29.2009832Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:29.2010285Z
2025-08-10T01:11:29.2010446Z Traceback (most recent call last):
2025-08-10T01:11:29.2011310Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:29.2012428Z     return func(*args, **kwargs)
2025-08-10T01:11:29.2012812Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.2013734Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:29.2014683Z     db = get_db()
2025-08-10T01:11:29.2014995Z          ^^^^^^^^
2025-08-10T01:11:29.2015993Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:29.2016884Z     return firestore.client()
2025-08-10T01:11:29.2017271Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.2018507Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:29.2019861Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:29.2020586Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.2021794Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:29.2023133Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:29.2023785Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.2025493Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:29.2028042Z     self._services[name] = initializer(self)
2025-08-10T01:11:29.2028566Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.2029785Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:29.2031012Z     credentials = app.credential.get_credential()
2025-08-10T01:11:29.2031555Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.2032853Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:29.2034072Z     self._load_credential()
2025-08-10T01:11:29.2035332Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:29.2036825Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:29.2037540Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:29.2038969Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:29.2040399Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:29.2042291Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.2043956Z --- END EXCEPTION ---
2025-08-10T01:11:29.2045828Z 2025-08-10 01:11:29,199 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.2047965Z .2025-08-10 01:11:29,202 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:29.2049767Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:29.2051262Z   setup_file_logging()
2025-08-10T01:11:29.2051882Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:29.2124629Z 2025-08-10 01:11:29,212 - root - ERROR - üî•üî¥ Failed to get user settings for user_690516: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:29.2146938Z .2025-08-10 01:11:29,214 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:29.2152003Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:29.2153453Z   setup_file_logging()
2025-08-10T01:11:29.2154086Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:29.2212985Z .
2025-08-10T01:11:29.2215101Z ----------------------------------------------------------------------
2025-08-10T01:11:29.2218108Z Ran 10 tests in 1.102s
2025-08-10T01:11:29.2218359Z
2025-08-10T01:11:29.2218467Z OK
2025-08-10T01:11:29.4691278Z ‚úÖ PASS: tests/test_main_auth.py
2025-08-10T01:11:29.4694764Z ----------------------------------------
2025-08-10T01:11:29.4695281Z Running: tests/test_main_auth_state_phase2.py
2025-08-10T01:11:29.8117531Z 2025-08-10 01:11:29,811 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.7456097Z 2025-08-10 01:11:30,745 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.7461147Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:30.7463193Z   setup_file_logging()
2025-08-10T01:11:30.7464311Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:30.7615530Z 2025-08-10 01:11:30,761 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:30.7616931Z Args: ('mcp-concurrent-user-0',)
2025-08-10T01:11:30.7617567Z Kwargs: {}
2025-08-10T01:11:30.7619384Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7620852Z Traceback:
2025-08-10T01:11:30.7622986Z Traceback (most recent call last):
2025-08-10T01:11:30.7623838Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.7624641Z     asyncio.get_running_loop()
2025-08-10T01:11:30.7625134Z RuntimeError: no running event loop
2025-08-10T01:11:30.7625419Z
2025-08-10T01:11:30.7625713Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.7626156Z
2025-08-10T01:11:30.7626312Z Traceback (most recent call last):
2025-08-10T01:11:30.7627195Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.7631176Z     return func(*args, **kwargs)
2025-08-10T01:11:30.7631613Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7632649Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:30.7633748Z     db = get_db()
2025-08-10T01:11:30.7634182Z          ^^^^^^^^
2025-08-10T01:11:30.7635045Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.7635949Z     return firestore.client()
2025-08-10T01:11:30.7636346Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7637450Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.7639043Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.7639800Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7641436Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.7642862Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.7643556Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7645037Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.7646262Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.7646745Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7648124Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.7649335Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.7649872Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7651097Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.7653930Z     self._load_credential()
2025-08-10T01:11:30.7655101Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.7655941Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.7656319Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7656969Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.7657941Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.7658940Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7659797Z --- END EXCEPTION ---
2025-08-10T01:11:30.7660889Z 2025-08-10 01:11:30,761 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7661981Z 2025-08-10 01:11:30,764 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:30.7662384Z Args: ('mcp-concurrent-user-1',)
2025-08-10T01:11:30.7662611Z Kwargs: {}
2025-08-10T01:11:30.7663237Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7663934Z Traceback:
2025-08-10T01:11:30.7664123Z Traceback (most recent call last):
2025-08-10T01:11:30.7664601Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.7665062Z     asyncio.get_running_loop()
2025-08-10T01:11:30.7665299Z RuntimeError: no running event loop
2025-08-10T01:11:30.7665463Z
2025-08-10T01:11:30.7665628Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.7665895Z
2025-08-10T01:11:30.7665984Z Traceback (most recent call last):
2025-08-10T01:11:30.7666465Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.7666953Z     return func(*args, **kwargs)
2025-08-10T01:11:30.7667169Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7668266Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:30.7669317Z     db = get_db()
2025-08-10T01:11:30.7669924Z          ^^^^^^^^
2025-08-10T01:11:30.7670872Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.7672136Z     return firestore.client()
2025-08-10T01:11:30.7672625Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7673753Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.7675445Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.7676207Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7677482Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.7679098Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.7679809Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7681020Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.7682242Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.7682731Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7683929Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.7685143Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.7685631Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7686868Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.7688741Z     self._load_credential()
2025-08-10T01:11:30.7693178Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.7695342Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.7696012Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7697132Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.7698849Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.7700541Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7701985Z --- END EXCEPTION ---
2025-08-10T01:11:30.7703744Z 2025-08-10 01:11:30,764 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7705660Z 2025-08-10 01:11:30,767 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:30.7706364Z Args: ('mcp-concurrent-user-2',)
2025-08-10T01:11:30.7706750Z Kwargs: {}
2025-08-10T01:11:30.7708297Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7709497Z Traceback:
2025-08-10T01:11:30.7709801Z Traceback (most recent call last):
2025-08-10T01:11:30.7711014Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.7711853Z     asyncio.get_running_loop()
2025-08-10T01:11:30.7712224Z RuntimeError: no running event loop
2025-08-10T01:11:30.7712482Z
2025-08-10T01:11:30.7712789Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.7721556Z
2025-08-10T01:11:30.7721739Z Traceback (most recent call last):
2025-08-10T01:11:30.7722654Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.7723565Z     return func(*args, **kwargs)
2025-08-10T01:11:30.7723981Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7725128Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:30.7726141Z     db = get_db()
2025-08-10T01:11:30.7726477Z          ^^^^^^^^
2025-08-10T01:11:30.7727330Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.7728589Z     return firestore.client()
2025-08-10T01:11:30.7728990Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7730119Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.7731550Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.7732310Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7733602Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.7734986Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.7735686Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7736912Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.7738401Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.7738885Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7740074Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.7741305Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.7741818Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7743091Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.7744320Z     self._load_credential()
2025-08-10T01:11:30.7745546Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.7746992Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.7747690Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7749202Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.7750664Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.7752516Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7754424Z --- END EXCEPTION ---
2025-08-10T01:11:30.7756327Z 2025-08-10 01:11:30,767 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7758446Z .2025-08-10 01:11:30,771 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.7760245Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:30.7761955Z   setup_file_logging()
2025-08-10T01:11:30.7762572Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:30.7821913Z 2025-08-10 01:11:30,782 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:30.7823751Z Args: ('mcp-auth-test-user',)
2025-08-10T01:11:30.7824186Z Kwargs: {}
2025-08-10T01:11:30.7825339Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7826607Z Traceback:
2025-08-10T01:11:30.7826956Z Traceback (most recent call last):
2025-08-10T01:11:30.7828018Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.7828913Z     asyncio.get_running_loop()
2025-08-10T01:11:30.7829392Z RuntimeError: no running event loop
2025-08-10T01:11:30.7829709Z
2025-08-10T01:11:30.7830029Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.7830504Z
2025-08-10T01:11:30.7830672Z Traceback (most recent call last):
2025-08-10T01:11:30.7831591Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.7832510Z     return func(*args, **kwargs)
2025-08-10T01:11:30.7832931Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7833960Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:30.7834607Z     db = get_db()
2025-08-10T01:11:30.7834880Z          ^^^^^^^^
2025-08-10T01:11:30.7835367Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.7836560Z     return firestore.client()
2025-08-10T01:11:30.7836817Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7837429Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.7838422Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.7838835Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7839559Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.7840357Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.7840744Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7841398Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.7842056Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.7842322Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7842943Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.7843581Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.7844067Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7844745Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.7845406Z     self._load_credential()
2025-08-10T01:11:30.7846060Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.7846809Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.7847303Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.7848112Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.7848870Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.7849861Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7851761Z --- END EXCEPTION ---
2025-08-10T01:11:30.7854619Z 2025-08-10 01:11:30,782 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7858460Z 2025-08-10 01:11:30,785 - root - ERROR - üî•üî¥ Failed to get user settings for user_035097: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.7878435Z .2025-08-10 01:11:30,787 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.7881121Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:30.7882628Z   setup_file_logging()
2025-08-10T01:11:30.7883258Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:30.7961125Z .2025-08-10 01:11:30,795 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.7963831Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:30.7965349Z   setup_file_logging()
2025-08-10T01:11:30.7965976Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:30.8054723Z .2025-08-10 01:11:30,805 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.8057503Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:30.8059212Z   setup_file_logging()
2025-08-10T01:11:30.8059832Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:30.8138280Z .2025-08-10 01:11:30,813 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.8141103Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:30.8142628Z   setup_file_logging()
2025-08-10T01:11:30.8143247Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:30.8234827Z 2025-08-10 01:11:30,823 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:30.8236870Z Args: ('mcp-auth-test-user',)
2025-08-10T01:11:30.8237288Z Kwargs: {}
2025-08-10T01:11:30.8238741Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8240033Z Traceback:
2025-08-10T01:11:30.8240547Z Traceback (most recent call last):
2025-08-10T01:11:30.8241432Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.8242304Z     asyncio.get_running_loop()
2025-08-10T01:11:30.8242743Z RuntimeError: no running event loop
2025-08-10T01:11:30.8243292Z
2025-08-10T01:11:30.8243590Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.8244037Z
2025-08-10T01:11:30.8244184Z Traceback (most recent call last):
2025-08-10T01:11:30.8244928Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.8245771Z     return func(*args, **kwargs)
2025-08-10T01:11:30.8246165Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8247244Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:30.8248404Z     db = get_db()
2025-08-10T01:11:30.8248720Z          ^^^^^^^^
2025-08-10T01:11:30.8249521Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.8250409Z     return firestore.client()
2025-08-10T01:11:30.8250792Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8251826Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.8253142Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.8253861Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8255072Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.8256400Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.8257055Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8258398Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.8259582Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.8260045Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8261144Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.8262341Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.8262781Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8264467Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.8265683Z     self._load_credential()
2025-08-10T01:11:30.8266946Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.8268620Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.8269332Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8270557Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.8271964Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.8273800Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8275750Z --- END EXCEPTION ---
2025-08-10T01:11:30.8277693Z 2025-08-10 01:11:30,823 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8280542Z .2025-08-10 01:11:30,826 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.8282610Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:30.8284093Z   setup_file_logging()
2025-08-10T01:11:30.8284694Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:30.8334990Z 2025-08-10 01:11:30,833 - main - INFO - Received campaign creation request:
2025-08-10T01:11:30.8336700Z 2025-08-10 01:11:30,833 - main - INFO -   Character: Test Hero
2025-08-10T01:11:30.8337690Z 2025-08-10 01:11:30,833 - main - INFO -   Setting: Test World
2025-08-10T01:11:30.8338699Z 2025-08-10 01:11:30,833 - main - INFO -   Description:
2025-08-10T01:11:30.8339279Z 2025-08-10 01:11:30,833 - main - INFO -   Custom options: []
2025-08-10T01:11:30.8340419Z 2025-08-10 01:11:30,833 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:30.8361242Z 2025-08-10 01:11:30,835 - root - ERROR - üî•üî¥ Failed to get user settings for user_035097: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8364044Z 2025-08-10 01:11:30,835 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:30.8364913Z 2025-08-10 01:11:30,836 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:30.8397276Z 2025-08-10 01:11:30,839 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:30.8403309Z Args: ('mcp-auth-test-user', 'MCP Auth Test Campaign', 'Character: Test Hero | Setting: Test World', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 30, 835961, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-auth-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:30.8407410Z Kwargs: {}
2025-08-10T01:11:30.8408761Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8410068Z Traceback:
2025-08-10T01:11:30.8410399Z Traceback (most recent call last):
2025-08-10T01:11:30.8411239Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.8412064Z     asyncio.get_running_loop()
2025-08-10T01:11:30.8412504Z RuntimeError: no running event loop
2025-08-10T01:11:30.8412791Z
2025-08-10T01:11:30.8413085Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.8413519Z
2025-08-10T01:11:30.8413682Z Traceback (most recent call last):
2025-08-10T01:11:30.8414528Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.8415620Z     return func(*args, **kwargs)
2025-08-10T01:11:30.8416020Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8416956Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:30.8418159Z     db = get_db()
2025-08-10T01:11:30.8418478Z          ^^^^^^^^
2025-08-10T01:11:30.8419305Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.8420208Z     return firestore.client()
2025-08-10T01:11:30.8420602Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8421860Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.8423162Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.8423892Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8425145Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.8426929Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.8427613Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8429024Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.8430261Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.8430755Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8431939Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.8433196Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.8433694Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8434959Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.8436211Z     self._load_credential()
2025-08-10T01:11:30.8437433Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.8439202Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.8439878Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8441095Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.8442532Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.8444404Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8446039Z --- END EXCEPTION ---
2025-08-10T01:11:30.8448152Z 2025-08-10 01:11:30,839 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8450420Z .2025-08-10 01:11:30,842 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.8453151Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:30.8454654Z   setup_file_logging()
2025-08-10T01:11:30.8455246Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:30.8526371Z 2025-08-10 01:11:30,852 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:30.8528509Z Args: ('mcp-state-test-user', 'mcp-test-campaign')
2025-08-10T01:11:30.8529043Z Kwargs: {}
2025-08-10T01:11:30.8530229Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8531502Z Traceback:
2025-08-10T01:11:30.8532017Z Traceback (most recent call last):
2025-08-10T01:11:30.8532903Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.8534008Z     asyncio.get_running_loop()
2025-08-10T01:11:30.8534431Z RuntimeError: no running event loop
2025-08-10T01:11:30.8534721Z
2025-08-10T01:11:30.8535010Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.8535376Z
2025-08-10T01:11:30.8535505Z Traceback (most recent call last):
2025-08-10T01:11:30.8536383Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.8537330Z     return func(*args, **kwargs)
2025-08-10T01:11:30.8537885Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8538926Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:30.8539925Z     db = get_db()
2025-08-10T01:11:30.8540249Z          ^^^^^^^^
2025-08-10T01:11:30.8541050Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.8541945Z     return firestore.client()
2025-08-10T01:11:30.8542322Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8543389Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.8544754Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.8545506Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8546728Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.8548393Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.8549072Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8550240Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.8551419Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.8551907Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8553027Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.8554716Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.8555247Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8556551Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.8558022Z     self._load_credential()
2025-08-10T01:11:30.8559305Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.8560762Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.8561456Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8562677Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.8564424Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.8566337Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8568276Z --- END EXCEPTION ---
2025-08-10T01:11:30.8570214Z 2025-08-10 01:11:30,852 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8573024Z .2025-08-10 01:11:30,855 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.8574817Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:30.8576340Z   setup_file_logging()
2025-08-10T01:11:30.8576974Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:30.8652365Z 2025-08-10 01:11:30,865 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:30.8654239Z Args: ('mcp-state-test-user', 'mcp-test-campaign')
2025-08-10T01:11:30.8654761Z Kwargs: {}
2025-08-10T01:11:30.8655956Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8657259Z Traceback:
2025-08-10T01:11:30.8657636Z Traceback (most recent call last):
2025-08-10T01:11:30.8658868Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.8659768Z     asyncio.get_running_loop()
2025-08-10T01:11:30.8660231Z RuntimeError: no running event loop
2025-08-10T01:11:30.8660539Z
2025-08-10T01:11:30.8660888Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.8661363Z
2025-08-10T01:11:30.8661539Z Traceback (most recent call last):
2025-08-10T01:11:30.8662455Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.8663372Z     return func(*args, **kwargs)
2025-08-10T01:11:30.8663651Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8664219Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:30.8664782Z     db = get_db()
2025-08-10T01:11:30.8664963Z          ^^^^^^^^
2025-08-10T01:11:30.8665484Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.8666416Z     return firestore.client()
2025-08-10T01:11:30.8666837Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8667513Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.8668522Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.8668931Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8669626Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.8670403Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.8670785Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8671439Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.8672082Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.8672341Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8673167Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.8673818Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.8674102Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8674777Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.8675427Z     self._load_credential()
2025-08-10T01:11:30.8676070Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.8676945Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.8677320Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8678129Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.8679811Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.8681956Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8683568Z --- END EXCEPTION ---
2025-08-10T01:11:30.8685457Z 2025-08-10 01:11:30,865 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8689473Z 2025-08-10 01:11:30,868 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:30.8691343Z Args: ('mcp-state-test-user', 'mcp-test-campaign')
2025-08-10T01:11:30.8691896Z Kwargs: {}
2025-08-10T01:11:30.8693073Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8694353Z Traceback:
2025-08-10T01:11:30.8694715Z Traceback (most recent call last):
2025-08-10T01:11:30.8695604Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.8696493Z     asyncio.get_running_loop()
2025-08-10T01:11:30.8696947Z RuntimeError: no running event loop
2025-08-10T01:11:30.8697274Z
2025-08-10T01:11:30.8697600Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.8698301Z
2025-08-10T01:11:30.8698481Z Traceback (most recent call last):
2025-08-10T01:11:30.8699385Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.8700307Z     return func(*args, **kwargs)
2025-08-10T01:11:30.8700640Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8701306Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:30.8701870Z     db = get_db()
2025-08-10T01:11:30.8702441Z          ^^^^^^^^
2025-08-10T01:11:30.8703148Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.8703667Z     return firestore.client()
2025-08-10T01:11:30.8703894Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8704497Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.8705254Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.8705656Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8706533Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.8707284Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.8707660Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8708557Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.8709206Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.8709618Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8710251Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.8710907Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.8711185Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8711876Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.8712542Z     self._load_credential()
2025-08-10T01:11:30.8713186Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.8713947Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.8714318Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8714994Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.8715748Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.8716735Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8718492Z --- END EXCEPTION ---
2025-08-10T01:11:30.8720802Z 2025-08-10 01:11:30,868 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8727115Z 2025-08-10 01:11:30,872 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:30.8729280Z Args: ('mcp-state-test-user', 'mcp-test-campaign')
2025-08-10T01:11:30.8729841Z Kwargs: {}
2025-08-10T01:11:30.8731021Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8732446Z Traceback:
2025-08-10T01:11:30.8732804Z Traceback (most recent call last):
2025-08-10T01:11:30.8733717Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.8734538Z     asyncio.get_running_loop()
2025-08-10T01:11:30.8734945Z RuntimeError: no running event loop
2025-08-10T01:11:30.8735230Z
2025-08-10T01:11:30.8735505Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.8735863Z
2025-08-10T01:11:30.8735998Z Traceback (most recent call last):
2025-08-10T01:11:30.8736821Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.8737697Z     return func(*args, **kwargs)
2025-08-10T01:11:30.8738345Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8739331Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:30.8740304Z     db = get_db()
2025-08-10T01:11:30.8740628Z          ^^^^^^^^
2025-08-10T01:11:30.8741663Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.8742543Z     return firestore.client()
2025-08-10T01:11:30.8742899Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8743918Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.8745232Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.8745952Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8747436Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.8748984Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.8749645Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8750832Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.8751973Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.8752422Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8753570Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.8754696Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.8755749Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8757005Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.8758424Z     self._load_credential()
2025-08-10T01:11:30.8759657Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.8761103Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.8761785Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8762956Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.8764393Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.8766264Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8768174Z --- END EXCEPTION ---
2025-08-10T01:11:30.8770017Z 2025-08-10 01:11:30,872 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8772631Z .2025-08-10 01:11:30,875 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.8774446Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:30.8775896Z   setup_file_logging()
2025-08-10T01:11:30.8776511Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:30.8853716Z 2025-08-10 01:11:30,885 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:30.8855824Z Args: ('mcp-state-test-user', 'nonexistent-campaign')
2025-08-10T01:11:30.8856367Z Kwargs: {}
2025-08-10T01:11:30.8857511Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8859595Z Traceback:
2025-08-10T01:11:30.8859942Z Traceback (most recent call last):
2025-08-10T01:11:30.8860848Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.8861642Z     asyncio.get_running_loop()
2025-08-10T01:11:30.8862061Z RuntimeError: no running event loop
2025-08-10T01:11:30.8862346Z
2025-08-10T01:11:30.8862630Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.8863057Z
2025-08-10T01:11:30.8863192Z Traceback (most recent call last):
2025-08-10T01:11:30.8864193Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.8865014Z     return func(*args, **kwargs)
2025-08-10T01:11:30.8865400Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8866454Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:30.8867412Z     db = get_db()
2025-08-10T01:11:30.8867899Z          ^^^^^^^^
2025-08-10T01:11:30.8868736Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.8869616Z     return firestore.client()
2025-08-10T01:11:30.8869984Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8871019Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.8872287Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.8872993Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8874163Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.8875499Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.8876140Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8877298Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.8878625Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.8879086Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8880210Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.8881351Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.8881835Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8883002Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.8884119Z     self._load_credential()
2025-08-10T01:11:30.8885819Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.8887223Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.8888132Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.8889321Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.8890751Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.8892584Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8894151Z --- END EXCEPTION ---
2025-08-10T01:11:30.8896349Z 2025-08-10 01:11:30,885 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8899238Z .2025-08-10 01:11:30,888 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:30.8901065Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:30.8902804Z   setup_file_logging()
2025-08-10T01:11:30.8903438Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:30.8956341Z 2025-08-10 01:11:30,895 - main - INFO - Received campaign creation request:
2025-08-10T01:11:30.8958327Z 2025-08-10 01:11:30,895 - main - INFO -   Character: State Test Hero
2025-08-10T01:11:30.8959382Z 2025-08-10 01:11:30,895 - main - INFO -   Setting: State Test World
2025-08-10T01:11:30.8960008Z 2025-08-10 01:11:30,895 - main - INFO -   Description:
2025-08-10T01:11:30.8960606Z 2025-08-10 01:11:30,895 - main - INFO -   Custom options: []
2025-08-10T01:11:30.8961300Z 2025-08-10 01:11:30,895 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:30.8982663Z 2025-08-10 01:11:30,898 - root - ERROR - üî•üî¥ Failed to get user settings for user_533315: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.8985463Z 2025-08-10 01:11:30,898 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:30.8986258Z 2025-08-10 01:11:30,898 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:30.9009684Z 2025-08-10 01:11:30,900 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:30.9015626Z Args: ('mcp-state-test-user', 'MCP State Test Campaign', 'Character: State Test Hero | Setting: State Test World', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 30, 898096, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-state-test-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:30.9021192Z Kwargs: {}
2025-08-10T01:11:30.9022284Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.9023532Z Traceback:
2025-08-10T01:11:30.9023823Z Traceback (most recent call last):
2025-08-10T01:11:30.9024617Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:30.9025359Z     asyncio.get_running_loop()
2025-08-10T01:11:30.9025737Z RuntimeError: no running event loop
2025-08-10T01:11:30.9025997Z
2025-08-10T01:11:30.9026263Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:30.9026670Z
2025-08-10T01:11:30.9026818Z Traceback (most recent call last):
2025-08-10T01:11:30.9027605Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:30.9028569Z     return func(*args, **kwargs)
2025-08-10T01:11:30.9028914Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.9029735Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:30.9030812Z     db = get_db()
2025-08-10T01:11:30.9031086Z          ^^^^^^^^
2025-08-10T01:11:30.9031779Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:30.9032560Z     return firestore.client()
2025-08-10T01:11:30.9032914Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.9033843Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:30.9035262Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:30.9035884Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.9036975Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:30.9038329Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:30.9038918Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.9039927Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:30.9040988Z     self._services[name] = initializer(self)
2025-08-10T01:11:30.9041391Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.9042387Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:30.9043435Z     credentials = app.credential.get_credential()
2025-08-10T01:11:30.9043871Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.9044951Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:30.9045989Z     self._load_credential()
2025-08-10T01:11:30.9047011Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:30.9048641Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:30.9049225Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:30.9050221Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:30.9051432Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:30.9053055Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.9054486Z --- END EXCEPTION ---
2025-08-10T01:11:30.9056134Z 2025-08-10 01:11:30,900 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:30.9058182Z .........
2025-08-10T01:11:30.9058536Z ----------------------------------------------------------------------
2025-08-10T01:11:30.9058990Z Ran 19 tests in 0.159s
2025-08-10T01:11:30.9059190Z
2025-08-10T01:11:30.9059300Z OK
2025-08-10T01:11:31.1464982Z ‚úÖ PASS: tests/test_main_auth_state_phase2.py
2025-08-10T01:11:31.1466489Z ----------------------------------------
2025-08-10T01:11:31.1467012Z Running: tests/test_main_authentication_advanced.py
2025-08-10T01:11:31.4858370Z 2025-08-10 01:11:31,485 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:31.4957540Z 2025-08-10 01:11:31,495 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:31.4967147Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:31.4969836Z   setup_file_logging()
2025-08-10T01:11:31.4979800Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:31.7719965Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:31.7723674Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:31.7934266Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:31.7937345Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:32.5023965Z 2025-08-10 01:11:32,502 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:32.5025174Z Args: ('mcp-auth-test-user',)
2025-08-10T01:11:32.5028211Z Kwargs: {}
2025-08-10T01:11:32.5029346Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:32.5030831Z Traceback:
2025-08-10T01:11:32.5032798Z Traceback (most recent call last):
2025-08-10T01:11:32.5033676Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:32.5034485Z     asyncio.get_running_loop()
2025-08-10T01:11:32.5034885Z RuntimeError: no running event loop
2025-08-10T01:11:32.5035176Z
2025-08-10T01:11:32.5035476Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:32.5035919Z
2025-08-10T01:11:32.5036077Z Traceback (most recent call last):
2025-08-10T01:11:32.5036941Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:32.5037982Z     return func(*args, **kwargs)
2025-08-10T01:11:32.5038370Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5039343Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:32.5040293Z     db = get_db()
2025-08-10T01:11:32.5040597Z          ^^^^^^^^
2025-08-10T01:11:32.5044294Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:32.5045268Z     return firestore.client()
2025-08-10T01:11:32.5045630Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5046524Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:32.5048028Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:32.5048851Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5050012Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:32.5051316Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:32.5051930Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5053059Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:32.5054439Z     self._services[name] = initializer(self)
2025-08-10T01:11:32.5054871Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5055943Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:32.5057064Z     credentials = app.credential.get_credential()
2025-08-10T01:11:32.5057545Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5058903Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:32.5060340Z     self._load_credential()
2025-08-10T01:11:32.5061481Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:32.5062816Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:32.5063467Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5064636Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:32.5065996Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:32.5067701Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:32.5069437Z --- END EXCEPTION ---
2025-08-10T01:11:32.5071263Z 2025-08-10 01:11:32,502 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:32.5073242Z .2025-08-10 01:11:32,506 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:32.5076441Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:32.5081945Z   setup_file_logging()
2025-08-10T01:11:32.5086604Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:32.5168788Z .2025-08-10 01:11:32,516 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:32.5175026Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:32.5176499Z   setup_file_logging()
2025-08-10T01:11:32.5177134Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:32.5268998Z 2025-08-10 01:11:32,526 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:32.5270006Z Args: ('mcp-auth-test-user',)
2025-08-10T01:11:32.5271724Z Kwargs: {}
2025-08-10T01:11:32.5273927Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:32.5275218Z Traceback:
2025-08-10T01:11:32.5275572Z Traceback (most recent call last):
2025-08-10T01:11:32.5276458Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:32.5277326Z     asyncio.get_running_loop()
2025-08-10T01:11:32.5277946Z RuntimeError: no running event loop
2025-08-10T01:11:32.5278259Z
2025-08-10T01:11:32.5278577Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:32.5279053Z
2025-08-10T01:11:32.5279222Z Traceback (most recent call last):
2025-08-10T01:11:32.5280434Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:32.5281326Z     return func(*args, **kwargs)
2025-08-10T01:11:32.5281943Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5282891Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:32.5283492Z     db = get_db()
2025-08-10T01:11:32.5284051Z          ^^^^^^^^
2025-08-10T01:11:32.5284803Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:32.5285578Z     return firestore.client()
2025-08-10T01:11:32.5285815Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5286432Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:32.5287189Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:32.5287603Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5288480Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:32.5289236Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:32.5289643Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5290303Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:32.5290945Z     self._services[name] = initializer(self)
2025-08-10T01:11:32.5291202Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5291833Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:32.5292480Z     credentials = app.credential.get_credential()
2025-08-10T01:11:32.5292753Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5293413Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:32.5294057Z     self._load_credential()
2025-08-10T01:11:32.5294700Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:32.5295704Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:32.5296406Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:32.5297578Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:32.5301355Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:32.5303266Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:32.5304899Z --- END EXCEPTION ---
2025-08-10T01:11:32.5306809Z 2025-08-10 01:11:32,526 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:32.5310202Z 2025-08-10 01:11:32,529 - root - ERROR - üî•üî¥ Failed to get user settings for user_038416: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:32.5344559Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/case.py:579: ResourceWarning: unclosed file <_io.BufferedReader name='/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/frontend_v1/index.html'>
2025-08-10T01:11:32.5346296Z   if method() is not None:
2025-08-10T01:11:32.5346994Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:32.5362004Z .2025-08-10 01:11:32,536 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:32.5364031Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:32.5366094Z   setup_file_logging()
2025-08-10T01:11:32.5367204Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:32.5460997Z .2025-08-10 01:11:32,545 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:32.5463155Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:32.5465005Z   setup_file_logging()
2025-08-10T01:11:32.5465982Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:32.5554706Z 2025-08-10 01:11:32,555 - root - ERROR - üî•üî¥ Failed to get user settings for user_038416: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:32.5560408Z .
2025-08-10T01:11:32.5562509Z ----------------------------------------------------------------------
2025-08-10T01:11:32.5564550Z Ran 5 tests in 1.062s
2025-08-10T01:11:32.5564768Z
2025-08-10T01:11:32.5564880Z OK
2025-08-10T01:11:32.7909640Z ‚úÖ PASS: tests/test_main_authentication_advanced.py
2025-08-10T01:11:32.7910536Z ----------------------------------------
2025-08-10T01:11:32.7911082Z Running: tests/test_main_error_handling_final.py
2025-08-10T01:11:33.9196278Z 2025-08-10 01:11:33,919 - INFO - Skipping Firebase initialization in testing mode
2025-08-10T01:11:33.9212987Z test_arrays_and_objects (__main__.TestParseSetCommandErrorHandling.test_arrays_and_objects)
2025-08-10T01:11:33.9214160Z Test complex JSON structures ... ok
2025-08-10T01:11:33.9215106Z test_edge_cases (__main__.TestParseSetCommandErrorHandling.test_edge_cases)
2025-08-10T01:11:33.9223302Z Test various edge cases ... ok
2025-08-10T01:11:33.9224527Z test_empty_values_and_whitespace (__main__.TestParseSetCommandErrorHandling.test_empty_values_and_whitespace)
2025-08-10T01:11:33.9225890Z Test handling of empty values and whitespace ... ok
2025-08-10T01:11:33.9227036Z test_escaped_characters (__main__.TestParseSetCommandErrorHandling.test_escaped_characters)
2025-08-10T01:11:33.9228517Z Test escaped characters in JSON strings ... ok
2025-08-10T01:11:33.9229662Z test_json_decode_errors (__main__.TestParseSetCommandErrorHandling.test_json_decode_errors)
2025-08-10T01:11:33.9234146Z Test handling of invalid JSON values ... ok
2025-08-10T01:11:33.9238582Z test_lines_without_equals (__main__.TestParseSetCommandErrorHandling.test_lines_without_equals)
2025-08-10T01:11:33.9239460Z Test lines that don't contain equals sign are ignored ... ok
2025-08-10T01:11:33.9240336Z test_numeric_boolean_null_values (__main__.TestParseSetCommandErrorHandling.test_numeric_boolean_null_values)
2025-08-10T01:11:33.9241138Z Test various value types ... ok
2025-08-10T01:11:33.9241929Z test_special_characters_in_values (__main__.TestParseSetCommandErrorHandling.test_special_characters_in_values)
2025-08-10T01:11:33.9242790Z Test values containing special characters ... ok
2025-08-10T01:11:33.9243486Z test_unicode_and_emoji (__main__.TestParseSetCommandErrorHandling.test_unicode_and_emoji)
2025-08-10T01:11:33.9244155Z Test unicode characters and emoji ... ok
2025-08-10T01:11:33.9244783Z test_very_long_values (__main__.TestParseSetCommandErrorHandling.test_very_long_values)
2025-08-10T01:11:33.9245867Z Test handling of very long values ... ok
2025-08-10T01:11:33.9246152Z
2025-08-10T01:11:33.9246362Z ----------------------------------------------------------------------
2025-08-10T01:11:33.9246834Z Ran 10 tests in 0.003s
2025-08-10T01:11:33.9247024Z
2025-08-10T01:11:33.9247128Z OK
2025-08-10T01:11:34.1108274Z ‚úÖ PASS: tests/test_main_error_handling_final.py
2025-08-10T01:11:34.1114023Z ----------------------------------------
2025-08-10T01:11:34.1114511Z Running: tests/test_main_god_mode.py
2025-08-10T01:11:34.4434106Z 2025-08-10 01:11:34,443 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:34.4534921Z 2025-08-10 01:11:34,453 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:34.4545064Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:34.4547232Z   setup_file_logging()
2025-08-10T01:11:34.4548679Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:34.7184683Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:34.7188145Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:34.7396937Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:34.7401580Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:35.4317563Z 2025-08-10 01:11:35,431 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.4322228Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.4322756Z Kwargs: {}
2025-08-10T01:11:35.4323850Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4325050Z Traceback:
2025-08-10T01:11:35.4325359Z Traceback (most recent call last):
2025-08-10T01:11:35.4326203Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.4327035Z     asyncio.get_running_loop()
2025-08-10T01:11:35.4327484Z RuntimeError: no running event loop
2025-08-10T01:11:35.4327982Z
2025-08-10T01:11:35.4328330Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.4328785Z
2025-08-10T01:11:35.4328961Z Traceback (most recent call last):
2025-08-10T01:11:35.4329839Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.4330680Z     return func(*args, **kwargs)
2025-08-10T01:11:35.4331118Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4332309Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.4333302Z     db = get_db()
2025-08-10T01:11:35.4333698Z          ^^^^^^^^
2025-08-10T01:11:35.4334511Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.4335573Z     return firestore.client()
2025-08-10T01:11:35.4335959Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4336906Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.4338671Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.4339503Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4340674Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.4341989Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.4342853Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4343986Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.4345065Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.4345499Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4346577Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.4347698Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.4348459Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4349639Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.4350780Z     self._load_credential()
2025-08-10T01:11:35.4351919Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.4353296Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.4354000Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4355124Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.4356501Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.4358452Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4359980Z --- END EXCEPTION ---
2025-08-10T01:11:35.4361782Z 2025-08-10 01:11:35,431 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4365086Z .2025-08-10 01:11:35,435 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.4367951Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.4369371Z   setup_file_logging()
2025-08-10T01:11:35.4369937Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.4459377Z 2025-08-10 01:11:35,445 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.4476522Z Args: ('test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.4477007Z Kwargs: {}
2025-08-10T01:11:35.4478290Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4481824Z Traceback:
2025-08-10T01:11:35.4482176Z Traceback (most recent call last):
2025-08-10T01:11:35.4482943Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.4483987Z     asyncio.get_running_loop()
2025-08-10T01:11:35.4484407Z RuntimeError: no running event loop
2025-08-10T01:11:35.4484695Z
2025-08-10T01:11:35.4485060Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.4485549Z
2025-08-10T01:11:35.4485709Z Traceback (most recent call last):
2025-08-10T01:11:35.4486568Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.4487413Z     return func(*args, **kwargs)
2025-08-10T01:11:35.4488033Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4489001Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.4490397Z     db = get_db()
2025-08-10T01:11:35.4490700Z          ^^^^^^^^
2025-08-10T01:11:35.4491473Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.4492328Z     return firestore.client()
2025-08-10T01:11:35.4492699Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4493911Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.4495432Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.4496154Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4497347Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.4499508Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.4500177Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4501324Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.4502493Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.4502940Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4504627Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.4505821Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.4506335Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4512898Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.4514199Z     self._load_credential()
2025-08-10T01:11:35.4515462Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.4516879Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.4517600Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4519146Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.4520616Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.4522506Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4524139Z --- END EXCEPTION ---
2025-08-10T01:11:35.4526020Z 2025-08-10 01:11:35,446 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4530401Z .2025-08-10 01:11:35,450 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.4532503Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.4533972Z   setup_file_logging()
2025-08-10T01:11:35.4534567Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.4633223Z 2025-08-10 01:11:35,463 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.4635647Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.4637260Z Kwargs: {}
2025-08-10T01:11:35.4638761Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4640076Z Traceback:
2025-08-10T01:11:35.4640431Z Traceback (most recent call last):
2025-08-10T01:11:35.4641218Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.4641709Z     asyncio.get_running_loop()
2025-08-10T01:11:35.4641977Z RuntimeError: no running event loop
2025-08-10T01:11:35.4642146Z
2025-08-10T01:11:35.4642325Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.4642585Z
2025-08-10T01:11:35.4642678Z Traceback (most recent call last):
2025-08-10T01:11:35.4643172Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.4643660Z     return func(*args, **kwargs)
2025-08-10T01:11:35.4643885Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4644448Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.4645006Z     db = get_db()
2025-08-10T01:11:35.4645193Z          ^^^^^^^^
2025-08-10T01:11:35.4645655Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.4646167Z     return firestore.client()
2025-08-10T01:11:35.4646393Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4646996Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.4647969Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.4648388Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4649059Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.4649809Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.4650618Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4651926Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.4653742Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.4654224Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4655368Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.4656586Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.4657099Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4658567Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.4659797Z     self._load_credential()
2025-08-10T01:11:35.4661002Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.4662709Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.4663412Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4664621Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.4666076Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.4668148Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4669826Z --- END EXCEPTION ---
2025-08-10T01:11:35.4670909Z 2025-08-10 01:11:35,463 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4672501Z 2025-08-10 01:11:35,466 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.4673504Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.4674054Z Kwargs: {}
2025-08-10T01:11:35.4674976Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4675780Z Traceback:
2025-08-10T01:11:35.4676190Z Traceback (most recent call last):
2025-08-10T01:11:35.4676952Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.4677543Z     asyncio.get_running_loop()
2025-08-10T01:11:35.4678254Z RuntimeError: no running event loop
2025-08-10T01:11:35.4678572Z
2025-08-10T01:11:35.4678935Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.4679212Z
2025-08-10T01:11:35.4679313Z Traceback (most recent call last):
2025-08-10T01:11:35.4679807Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.4680281Z     return func(*args, **kwargs)
2025-08-10T01:11:35.4680505Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4681047Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.4681586Z     db = get_db()
2025-08-10T01:11:35.4681762Z          ^^^^^^^^
2025-08-10T01:11:35.4682462Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.4682979Z     return firestore.client()
2025-08-10T01:11:35.4683323Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4684214Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.4685171Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.4685707Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4687090Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.4688902Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.4690737Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4692807Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.4694114Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.4694601Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4695783Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.4697239Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.4698003Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4699326Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.4700596Z     self._load_credential()
2025-08-10T01:11:35.4701860Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.4703520Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.4704201Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4705377Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.4706796Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.4708776Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4710164Z --- END EXCEPTION ---
2025-08-10T01:11:35.4712039Z 2025-08-10 01:11:35,466 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4714163Z 2025-08-10 01:11:35,469 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.4722076Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.4722733Z Kwargs: {}
2025-08-10T01:11:35.4723965Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4725322Z Traceback:
2025-08-10T01:11:35.4725757Z Traceback (most recent call last):
2025-08-10T01:11:35.4726703Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.4727671Z     asyncio.get_running_loop()
2025-08-10T01:11:35.4728354Z RuntimeError: no running event loop
2025-08-10T01:11:35.4728729Z
2025-08-10T01:11:35.4729155Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.4729634Z
2025-08-10T01:11:35.4729891Z Traceback (most recent call last):
2025-08-10T01:11:35.4730833Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.4732605Z     return func(*args, **kwargs)
2025-08-10T01:11:35.4732991Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4734395Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.4735385Z     db = get_db()
2025-08-10T01:11:35.4735726Z          ^^^^^^^^
2025-08-10T01:11:35.4736561Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.4737493Z     return firestore.client()
2025-08-10T01:11:35.4738256Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4739379Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.4740829Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.4741576Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4742813Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.4744497Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.4745276Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4746484Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.4747696Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.4748837Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4750272Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.4751511Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.4752031Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4753315Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.4754560Z     self._load_credential()
2025-08-10T01:11:35.4755790Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.4757256Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.4758240Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4759434Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.4760929Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.4762877Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4764550Z --- END EXCEPTION ---
2025-08-10T01:11:35.4766440Z 2025-08-10 01:11:35,469 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4769232Z .2025-08-10 01:11:35,473 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.4771071Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.4773424Z   setup_file_logging()
2025-08-10T01:11:35.4774073Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.4841469Z 2025-08-10 01:11:35,483 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.4843430Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.4843983Z Kwargs: {}
2025-08-10T01:11:35.4845157Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4846444Z Traceback:
2025-08-10T01:11:35.4846800Z Traceback (most recent call last):
2025-08-10T01:11:35.4847897Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.4848812Z     asyncio.get_running_loop()
2025-08-10T01:11:35.4849263Z RuntimeError: no running event loop
2025-08-10T01:11:35.4849575Z
2025-08-10T01:11:35.4849912Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.4850392Z
2025-08-10T01:11:35.4850576Z Traceback (most recent call last):
2025-08-10T01:11:35.4851496Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.4852685Z     return func(*args, **kwargs)
2025-08-10T01:11:35.4853040Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4853636Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.4854261Z     db = get_db()
2025-08-10T01:11:35.4854456Z          ^^^^^^^^
2025-08-10T01:11:35.4854976Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.4855845Z     return firestore.client()
2025-08-10T01:11:35.4856343Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4856960Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.4857902Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.4858383Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4859054Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.4859808Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.4860191Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4860843Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.4861481Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.4861741Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4862359Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.4862998Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.4863277Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4863935Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.4864576Z     self._load_credential()
2025-08-10T01:11:35.4865216Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.4865963Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.4866331Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4866954Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.4867697Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.4868851Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4869706Z --- END EXCEPTION ---
2025-08-10T01:11:35.4871116Z 2025-08-10 01:11:35,484 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4879672Z 2025-08-10 01:11:35,487 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.4881560Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.4882109Z Kwargs: {}
2025-08-10T01:11:35.4883299Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4884851Z Traceback:
2025-08-10T01:11:35.4885208Z Traceback (most recent call last):
2025-08-10T01:11:35.4886103Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.4886964Z     asyncio.get_running_loop()
2025-08-10T01:11:35.4887412Z RuntimeError: no running event loop
2025-08-10T01:11:35.4888014Z
2025-08-10T01:11:35.4888343Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.4888816Z
2025-08-10T01:11:35.4888994Z Traceback (most recent call last):
2025-08-10T01:11:35.4889901Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.4891061Z     return func(*args, **kwargs)
2025-08-10T01:11:35.4891444Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4892041Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.4892678Z     db = get_db()
2025-08-10T01:11:35.4892864Z          ^^^^^^^^
2025-08-10T01:11:35.4893326Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.4894496Z     return firestore.client()
2025-08-10T01:11:35.4894735Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4895362Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.4896121Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.4896538Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4897210Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.4898188Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.4898571Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4899222Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.4899867Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.4900120Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4900737Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.4901383Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.4901669Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4902333Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.4902978Z     self._load_credential()
2025-08-10T01:11:35.4903639Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.4904395Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.4904769Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4905393Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.4906152Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.4907981Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4909962Z --- END EXCEPTION ---
2025-08-10T01:11:35.4911877Z 2025-08-10 01:11:35,487 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4917331Z 2025-08-10 01:11:35,491 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.4919480Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.4920043Z Kwargs: {}
2025-08-10T01:11:35.4921228Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4922762Z Traceback:
2025-08-10T01:11:35.4923121Z Traceback (most recent call last):
2025-08-10T01:11:35.4924020Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.4924903Z     asyncio.get_running_loop()
2025-08-10T01:11:35.4925355Z RuntimeError: no running event loop
2025-08-10T01:11:35.4925698Z
2025-08-10T01:11:35.4926023Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.4926511Z
2025-08-10T01:11:35.4926695Z Traceback (most recent call last):
2025-08-10T01:11:35.4927623Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.4928486Z     return func(*args, **kwargs)
2025-08-10T01:11:35.4928725Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4929367Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.4929924Z     db = get_db()
2025-08-10T01:11:35.4930096Z          ^^^^^^^^
2025-08-10T01:11:35.4930801Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.4931554Z     return firestore.client()
2025-08-10T01:11:35.4931779Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4932385Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.4933126Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.4933539Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4934205Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.4934937Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.4935315Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4935952Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.4936588Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.4936844Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4937454Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.4938318Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.4938602Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4939256Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.4939893Z     self._load_credential()
2025-08-10T01:11:35.4940546Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.4941294Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.4941663Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4942470Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.4943217Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.4944474Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4946263Z --- END EXCEPTION ---
2025-08-10T01:11:35.4948636Z 2025-08-10 01:11:35,491 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4954184Z 2025-08-10 01:11:35,495 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.4956052Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.4956598Z Kwargs: {}
2025-08-10T01:11:35.4958031Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4959341Z Traceback:
2025-08-10T01:11:35.4959699Z Traceback (most recent call last):
2025-08-10T01:11:35.4960592Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.4961468Z     asyncio.get_running_loop()
2025-08-10T01:11:35.4961935Z RuntimeError: no running event loop
2025-08-10T01:11:35.4962254Z
2025-08-10T01:11:35.4962571Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.4963059Z
2025-08-10T01:11:35.4963234Z Traceback (most recent call last):
2025-08-10T01:11:35.4964150Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.4964853Z     return func(*args, **kwargs)
2025-08-10T01:11:35.4965095Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4965687Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.4966328Z     db = get_db()
2025-08-10T01:11:35.4966503Z          ^^^^^^^^
2025-08-10T01:11:35.4967275Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.4968096Z     return firestore.client()
2025-08-10T01:11:35.4968328Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4968941Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.4969693Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.4970102Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4970802Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.4971560Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.4971934Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4972602Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.4973249Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.4973511Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4974148Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.4974802Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.4975270Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4975938Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.4976581Z     self._load_credential()
2025-08-10T01:11:35.4977235Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.4978276Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.4978654Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.4979442Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.4980195Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.4981203Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4982437Z --- END EXCEPTION ---
2025-08-10T01:11:35.4984349Z 2025-08-10 01:11:35,495 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4991807Z 2025-08-10 01:11:35,499 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.4993118Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.4993649Z Kwargs: {}
2025-08-10T01:11:35.4994746Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.4996007Z Traceback:
2025-08-10T01:11:35.4996382Z Traceback (most recent call last):
2025-08-10T01:11:35.4997279Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.4998370Z     asyncio.get_running_loop()
2025-08-10T01:11:35.4998819Z RuntimeError: no running event loop
2025-08-10T01:11:35.4999136Z
2025-08-10T01:11:35.4999458Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.4999941Z
2025-08-10T01:11:35.5000123Z Traceback (most recent call last):
2025-08-10T01:11:35.5001048Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5001993Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5002420Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5003478Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5004431Z     db = get_db()
2025-08-10T01:11:35.5004646Z          ^^^^^^^^
2025-08-10T01:11:35.5005117Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5005698Z     return firestore.client()
2025-08-10T01:11:35.5005916Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5006863Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5008141Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5008604Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5009306Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5010050Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5010689Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5011343Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5011986Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5012239Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5012869Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5013515Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5013908Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5014570Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5015213Z     self._load_credential()
2025-08-10T01:11:35.5015856Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5016613Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5016985Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5017613Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5018564Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5019554Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5020411Z --- END EXCEPTION ---
2025-08-10T01:11:35.5022367Z 2025-08-10 01:11:35,499 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5030315Z 2025-08-10 01:11:35,502 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.5035134Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.5035691Z Kwargs: {}
2025-08-10T01:11:35.5036877Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5038486Z Traceback:
2025-08-10T01:11:35.5038997Z Traceback (most recent call last):
2025-08-10T01:11:35.5039901Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.5040784Z     asyncio.get_running_loop()
2025-08-10T01:11:35.5041180Z RuntimeError: no running event loop
2025-08-10T01:11:35.5041445Z
2025-08-10T01:11:35.5042125Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.5042630Z
2025-08-10T01:11:35.5042810Z Traceback (most recent call last):
2025-08-10T01:11:35.5043455Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5044004Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5044239Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5044809Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5045367Z     db = get_db()
2025-08-10T01:11:35.5045544Z          ^^^^^^^^
2025-08-10T01:11:35.5046001Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5046503Z     return firestore.client()
2025-08-10T01:11:35.5046730Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5047322Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5048481Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5048890Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5049559Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5050297Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5050801Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5051442Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5052074Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5052329Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5052972Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5053626Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5053911Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5054573Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5055222Z     self._load_credential()
2025-08-10T01:11:35.5055862Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5056668Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5057362Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5058949Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5060394Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5062307Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5063922Z --- END EXCEPTION ---
2025-08-10T01:11:35.5065786Z 2025-08-10 01:11:35,502 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5068917Z 2025-08-10 01:11:35,506 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.5070921Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.5071481Z Kwargs: {}
2025-08-10T01:11:35.5072666Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5073977Z Traceback:
2025-08-10T01:11:35.5074323Z Traceback (most recent call last):
2025-08-10T01:11:35.5075216Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.5076104Z     asyncio.get_running_loop()
2025-08-10T01:11:35.5076563Z RuntimeError: no running event loop
2025-08-10T01:11:35.5076893Z
2025-08-10T01:11:35.5077212Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.5077697Z
2025-08-10T01:11:35.5078145Z Traceback (most recent call last):
2025-08-10T01:11:35.5079118Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5080293Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5080619Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5081208Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5081826Z     db = get_db()
2025-08-10T01:11:35.5081999Z          ^^^^^^^^
2025-08-10T01:11:35.5082447Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5083237Z     return firestore.client()
2025-08-10T01:11:35.5083663Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5084580Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5085326Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5085731Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5086403Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5087144Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5087514Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5088382Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5089036Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5089304Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5089919Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5090565Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5090848Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5091521Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5092162Z     self._load_credential()
2025-08-10T01:11:35.5092794Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5093541Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5093911Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5094539Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5095285Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5096254Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5097116Z --- END EXCEPTION ---
2025-08-10T01:11:35.5098940Z 2025-08-10 01:11:35,506 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5107469Z 2025-08-10 01:11:35,510 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.5109097Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.5110244Z Kwargs: {}
2025-08-10T01:11:35.5111521Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5112696Z Traceback:
2025-08-10T01:11:35.5113013Z Traceback (most recent call last):
2025-08-10T01:11:35.5114095Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.5114881Z     asyncio.get_running_loop()
2025-08-10T01:11:35.5115288Z RuntimeError: no running event loop
2025-08-10T01:11:35.5115581Z
2025-08-10T01:11:35.5115903Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.5116378Z
2025-08-10T01:11:35.5116555Z Traceback (most recent call last):
2025-08-10T01:11:35.5117471Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5118834Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5119269Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5120316Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5121346Z     db = get_db()
2025-08-10T01:11:35.5121682Z          ^^^^^^^^
2025-08-10T01:11:35.5122572Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5123299Z     return firestore.client()
2025-08-10T01:11:35.5123537Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5124233Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5125605Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5126074Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5126768Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5127529Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5128117Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5128777Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5129417Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5129668Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5130283Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5130927Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5131204Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5131880Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5132544Z     self._load_credential()
2025-08-10T01:11:35.5133193Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5133959Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5134324Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5134951Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5135698Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5136681Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5137533Z --- END EXCEPTION ---
2025-08-10T01:11:35.5139139Z 2025-08-10 01:11:35,510 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5154042Z 2025-08-10 01:11:35,514 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.5156023Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.5156524Z Kwargs: {}
2025-08-10T01:11:35.5157611Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5158998Z Traceback:
2025-08-10T01:11:35.5159546Z Traceback (most recent call last):
2025-08-10T01:11:35.5160354Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.5161022Z     asyncio.get_running_loop()
2025-08-10T01:11:35.5161388Z RuntimeError: no running event loop
2025-08-10T01:11:35.5161671Z
2025-08-10T01:11:35.5161961Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.5162406Z
2025-08-10T01:11:35.5162564Z Traceback (most recent call last):
2025-08-10T01:11:35.5163523Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5164346Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5164742Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5165704Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5166638Z     db = get_db()
2025-08-10T01:11:35.5166948Z          ^^^^^^^^
2025-08-10T01:11:35.5167919Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5168899Z     return firestore.client()
2025-08-10T01:11:35.5169279Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5170317Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5171650Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5172355Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5173527Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5174822Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5175485Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5176618Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5177934Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5178446Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5179583Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5181456Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5181988Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5184337Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5185557Z     self._load_credential()
2025-08-10T01:11:35.5186795Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5188541Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5189227Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5190380Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5192054Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5193924Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5195560Z --- END EXCEPTION ---
2025-08-10T01:11:35.5197387Z 2025-08-10 01:11:35,514 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5199712Z .2025-08-10 01:11:35,518 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.5201492Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.5202949Z   setup_file_logging()
2025-08-10T01:11:35.5203556Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.5299186Z 2025-08-10 01:11:35,529 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.5300098Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.5300648Z Kwargs: {}
2025-08-10T01:11:35.5301835Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5303141Z Traceback:
2025-08-10T01:11:35.5303498Z Traceback (most recent call last):
2025-08-10T01:11:35.5304390Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.5305275Z     asyncio.get_running_loop()
2025-08-10T01:11:35.5305739Z RuntimeError: no running event loop
2025-08-10T01:11:35.5306057Z
2025-08-10T01:11:35.5306369Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.5306852Z
2025-08-10T01:11:35.5307024Z Traceback (most recent call last):
2025-08-10T01:11:35.5308148Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5309049Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5309457Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5310129Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5310689Z     db = get_db()
2025-08-10T01:11:35.5310865Z          ^^^^^^^^
2025-08-10T01:11:35.5311362Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5311932Z     return firestore.client()
2025-08-10T01:11:35.5312292Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5313205Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5313969Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5314379Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5315058Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5315810Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5316183Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5316848Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5317685Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5318147Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5318777Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5319428Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5319709Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5320367Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5321142Z     self._load_credential()
2025-08-10T01:11:35.5321783Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5322530Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5322908Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5323534Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5324272Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5325248Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5326103Z --- END EXCEPTION ---
2025-08-10T01:11:35.5327126Z 2025-08-10 01:11:35,529 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5350498Z 2025-08-10 01:11:35,534 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.5352471Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.5352968Z Kwargs: {}
2025-08-10T01:11:35.5354132Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5355435Z Traceback:
2025-08-10T01:11:35.5355779Z Traceback (most recent call last):
2025-08-10T01:11:35.5356671Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.5357565Z     asyncio.get_running_loop()
2025-08-10T01:11:35.5358245Z RuntimeError: no running event loop
2025-08-10T01:11:35.5358567Z
2025-08-10T01:11:35.5358886Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.5359367Z
2025-08-10T01:11:35.5359538Z Traceback (most recent call last):
2025-08-10T01:11:35.5360467Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5361406Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5361824Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5362591Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5363162Z     db = get_db()
2025-08-10T01:11:35.5363416Z          ^^^^^^^^
2025-08-10T01:11:35.5363884Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5364966Z     return firestore.client()
2025-08-10T01:11:35.5365213Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5365888Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5366662Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5367259Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5368136Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5368908Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5369279Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5369931Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5370704Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5370961Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5371568Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5372210Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5372502Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5373159Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5373798Z     self._load_credential()
2025-08-10T01:11:35.5374464Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5375227Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5375605Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5376236Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5376981Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5378886Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5380937Z --- END EXCEPTION ---
2025-08-10T01:11:35.5382767Z 2025-08-10 01:11:35,535 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5387873Z 2025-08-10 01:11:35,538 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.5389363Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.5391295Z Kwargs: {}
2025-08-10T01:11:35.5392410Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5393717Z Traceback:
2025-08-10T01:11:35.5394083Z Traceback (most recent call last):
2025-08-10T01:11:35.5395012Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.5395937Z     asyncio.get_running_loop()
2025-08-10T01:11:35.5396392Z RuntimeError: no running event loop
2025-08-10T01:11:35.5396701Z
2025-08-10T01:11:35.5397031Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.5397485Z
2025-08-10T01:11:35.5397657Z Traceback (most recent call last):
2025-08-10T01:11:35.5398788Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5399684Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5400081Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5401065Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5402279Z     db = get_db()
2025-08-10T01:11:35.5402582Z          ^^^^^^^^
2025-08-10T01:11:35.5403371Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5404244Z     return firestore.client()
2025-08-10T01:11:35.5404573Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5405551Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5406996Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5408169Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5409374Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5410714Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5411359Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5412483Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5413633Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5414139Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5415258Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5416418Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5416907Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5418263Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5419427Z     self._load_credential()
2025-08-10T01:11:35.5420584Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5421999Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5422615Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5423795Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5425193Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5427089Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5428923Z --- END EXCEPTION ---
2025-08-10T01:11:35.5430802Z 2025-08-10 01:11:35,539 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5433977Z .2025-08-10 01:11:35,542 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.5436692Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.5439337Z   setup_file_logging()
2025-08-10T01:11:35.5439961Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.5520380Z 2025-08-10 01:11:35,551 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.5525263Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.5525816Z Kwargs: {}
2025-08-10T01:11:35.5527271Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5528976Z Traceback:
2025-08-10T01:11:35.5529337Z Traceback (most recent call last):
2025-08-10T01:11:35.5530237Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.5531138Z     asyncio.get_running_loop()
2025-08-10T01:11:35.5531559Z RuntimeError: no running event loop
2025-08-10T01:11:35.5531846Z
2025-08-10T01:11:35.5532101Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.5532787Z
2025-08-10T01:11:35.5532954Z Traceback (most recent call last):
2025-08-10T01:11:35.5533935Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5534795Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5535183Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5536203Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5537195Z     db = get_db()
2025-08-10T01:11:35.5537510Z          ^^^^^^^^
2025-08-10T01:11:35.5538511Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5539407Z     return firestore.client()
2025-08-10T01:11:35.5539802Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5540873Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5542243Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5542971Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5544185Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5545542Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5546182Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5547356Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5548765Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5549255Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5550434Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5551668Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5552196Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5553471Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5554724Z     self._load_credential()
2025-08-10T01:11:35.5555977Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5557393Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5563025Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5564260Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5565752Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5567606Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5569711Z --- END EXCEPTION ---
2025-08-10T01:11:35.5571643Z 2025-08-10 01:11:35,552 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5573543Z .2025-08-10 01:11:35,554 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.5575322Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.5577046Z   setup_file_logging()
2025-08-10T01:11:35.5577662Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.5653897Z 2025-08-10 01:11:35,565 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.5658962Z Args: ('mcp-god-mode-test-user', 'mcp-nonexistent-campaign')
2025-08-10T01:11:35.5659525Z Kwargs: {}
2025-08-10T01:11:35.5661280Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5662439Z Traceback:
2025-08-10T01:11:35.5662762Z Traceback (most recent call last):
2025-08-10T01:11:35.5663597Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.5664535Z     asyncio.get_running_loop()
2025-08-10T01:11:35.5664965Z RuntimeError: no running event loop
2025-08-10T01:11:35.5665252Z
2025-08-10T01:11:35.5665546Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.5665997Z
2025-08-10T01:11:35.5666157Z Traceback (most recent call last):
2025-08-10T01:11:35.5667026Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5668146Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5668538Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5669518Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5670477Z     db = get_db()
2025-08-10T01:11:35.5670797Z          ^^^^^^^^
2025-08-10T01:11:35.5671589Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5672478Z     return firestore.client()
2025-08-10T01:11:35.5672873Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5673941Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5675288Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5676009Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5677194Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5678777Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5679440Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5680591Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5681801Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5682281Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5683465Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5684693Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5685466Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5686759Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5688197Z     self._load_credential()
2025-08-10T01:11:35.5689411Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5690841Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5691713Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5692871Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5694313Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5696144Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5702302Z --- END EXCEPTION ---
2025-08-10T01:11:35.5704245Z 2025-08-10 01:11:35,565 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5706167Z .2025-08-10 01:11:35,567 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.5708171Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.5709625Z   setup_file_logging()
2025-08-10T01:11:35.5710239Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.5783701Z 2025-08-10 01:11:35,578 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.5789491Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.5790003Z Kwargs: {}
2025-08-10T01:11:35.5791095Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5792429Z Traceback:
2025-08-10T01:11:35.5792772Z Traceback (most recent call last):
2025-08-10T01:11:35.5793632Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.5794462Z     asyncio.get_running_loop()
2025-08-10T01:11:35.5794894Z RuntimeError: no running event loop
2025-08-10T01:11:35.5795189Z
2025-08-10T01:11:35.5795495Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.5795958Z
2025-08-10T01:11:35.5796116Z Traceback (most recent call last):
2025-08-10T01:11:35.5796978Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5798097Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5798493Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5799461Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5800447Z     db = get_db()
2025-08-10T01:11:35.5800764Z          ^^^^^^^^
2025-08-10T01:11:35.5801582Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5802476Z     return firestore.client()
2025-08-10T01:11:35.5802868Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5803930Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5805508Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5806219Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5807525Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5809499Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5810183Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5811537Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5812660Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5813372Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5814514Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5815654Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5816149Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5817413Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5818854Z     self._load_credential()
2025-08-10T01:11:35.5820068Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5821531Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5822189Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5823364Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5824832Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5826689Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5828490Z --- END EXCEPTION ---
2025-08-10T01:11:35.5830374Z 2025-08-10 01:11:35,578 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5832319Z .2025-08-10 01:11:35,580 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.5834085Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.5835553Z   setup_file_logging()
2025-08-10T01:11:35.5836155Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.5913091Z 2025-08-10 01:11:35,591 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.5914910Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.5915419Z Kwargs: {}
2025-08-10T01:11:35.5916512Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5918088Z Traceback:
2025-08-10T01:11:35.5918477Z Traceback (most recent call last):
2025-08-10T01:11:35.5919383Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.5920261Z     asyncio.get_running_loop()
2025-08-10T01:11:35.5920712Z RuntimeError: no running event loop
2025-08-10T01:11:35.5921279Z
2025-08-10T01:11:35.5921771Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.5922260Z
2025-08-10T01:11:35.5922433Z Traceback (most recent call last):
2025-08-10T01:11:35.5923351Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.5924220Z     return func(*args, **kwargs)
2025-08-10T01:11:35.5924593Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5925598Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.5926912Z     db = get_db()
2025-08-10T01:11:35.5927236Z          ^^^^^^^^
2025-08-10T01:11:35.5928232Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.5929165Z     return firestore.client()
2025-08-10T01:11:35.5929560Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5930656Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.5932029Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.5932771Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5934006Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.5935382Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.5936055Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5937247Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.5938589Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.5939076Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5940275Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.5942079Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.5942695Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5944153Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.5945353Z     self._load_credential()
2025-08-10T01:11:35.5946524Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.5948178Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.5948890Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.5950138Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.5951590Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.5953445Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5955101Z --- END EXCEPTION ---
2025-08-10T01:11:35.5956978Z 2025-08-10 01:11:35,591 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.5959209Z .2025-08-10 01:11:35,594 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.5961309Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.5962832Z   setup_file_logging()
2025-08-10T01:11:35.5963451Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.6043092Z 2025-08-10 01:11:35,604 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.6044975Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.6045792Z Kwargs: {}
2025-08-10T01:11:35.6046975Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6048698Z Traceback:
2025-08-10T01:11:35.6049076Z Traceback (most recent call last):
2025-08-10T01:11:35.6049986Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.6050838Z     asyncio.get_running_loop()
2025-08-10T01:11:35.6051248Z RuntimeError: no running event loop
2025-08-10T01:11:35.6051530Z
2025-08-10T01:11:35.6051823Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.6052272Z
2025-08-10T01:11:35.6052431Z Traceback (most recent call last):
2025-08-10T01:11:35.6053286Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.6054129Z     return func(*args, **kwargs)
2025-08-10T01:11:35.6054546Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6055647Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.6056643Z     db = get_db()
2025-08-10T01:11:35.6056963Z          ^^^^^^^^
2025-08-10T01:11:35.6057948Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.6058901Z     return firestore.client()
2025-08-10T01:11:35.6059282Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6060357Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.6061708Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.6062447Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6063663Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.6065015Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.6065681Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6066845Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.6068204Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.6068691Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6069874Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.6071703Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.6072251Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6073533Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.6074791Z     self._load_credential()
2025-08-10T01:11:35.6076047Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.6077702Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.6078631Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6079853Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.6081316Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.6083207Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6085049Z --- END EXCEPTION ---
2025-08-10T01:11:35.6086928Z 2025-08-10 01:11:35,604 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6089270Z .2025-08-10 01:11:35,606 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.6090925Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.6092319Z   setup_file_logging()
2025-08-10T01:11:35.6092906Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.6172216Z 2025-08-10 01:11:35,617 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.6181467Z Args: ('mcp-god-mode-test-user', 'mcp-nonexistent-campaign')
2025-08-10T01:11:35.6182023Z Kwargs: {}
2025-08-10T01:11:35.6183144Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6184482Z Traceback:
2025-08-10T01:11:35.6184818Z Traceback (most recent call last):
2025-08-10T01:11:35.6185662Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.6186497Z     asyncio.get_running_loop()
2025-08-10T01:11:35.6186921Z RuntimeError: no running event loop
2025-08-10T01:11:35.6187213Z
2025-08-10T01:11:35.6187506Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.6188177Z
2025-08-10T01:11:35.6188343Z Traceback (most recent call last):
2025-08-10T01:11:35.6189171Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.6190038Z     return func(*args, **kwargs)
2025-08-10T01:11:35.6190439Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6191431Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.6192421Z     db = get_db()
2025-08-10T01:11:35.6192731Z          ^^^^^^^^
2025-08-10T01:11:35.6193546Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.6194454Z     return firestore.client()
2025-08-10T01:11:35.6194840Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6195905Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.6197228Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.6198186Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6199447Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.6200840Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.6201779Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6203037Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.6204265Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.6204739Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6205918Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.6207346Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.6208127Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6209306Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.6210420Z     self._load_credential()
2025-08-10T01:11:35.6211553Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.6212870Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.6213562Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6214750Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.6216237Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.6218451Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6220051Z --- END EXCEPTION ---
2025-08-10T01:11:35.6221925Z 2025-08-10 01:11:35,617 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6223852Z .2025-08-10 01:11:35,619 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.6225581Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.6227057Z   setup_file_logging()
2025-08-10T01:11:35.6227678Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.6307165Z 2025-08-10 01:11:35,630 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.6316015Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.6316557Z Kwargs: {}
2025-08-10T01:11:35.6317686Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6319125Z Traceback:
2025-08-10T01:11:35.6319459Z Traceback (most recent call last):
2025-08-10T01:11:35.6320315Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.6321131Z     asyncio.get_running_loop()
2025-08-10T01:11:35.6321549Z RuntimeError: no running event loop
2025-08-10T01:11:35.6321847Z
2025-08-10T01:11:35.6322144Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.6322612Z
2025-08-10T01:11:35.6322780Z Traceback (most recent call last):
2025-08-10T01:11:35.6323651Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.6324497Z     return func(*args, **kwargs)
2025-08-10T01:11:35.6324885Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6326083Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.6327054Z     db = get_db()
2025-08-10T01:11:35.6327352Z          ^^^^^^^^
2025-08-10T01:11:35.6329485Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.6330418Z     return firestore.client()
2025-08-10T01:11:35.6330828Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6331864Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.6333892Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.6334681Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6337087Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.6338734Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.6339433Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6340647Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.6341867Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.6342319Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6343488Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.6344733Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.6345259Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6346511Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.6348008Z     self._load_credential()
2025-08-10T01:11:35.6349236Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.6350674Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.6351363Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6352532Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.6353988Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.6355809Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6357449Z --- END EXCEPTION ---
2025-08-10T01:11:35.6359502Z 2025-08-10 01:11:35,630 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6361393Z .2025-08-10 01:11:35,633 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.6363170Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.6364675Z   setup_file_logging()
2025-08-10T01:11:35.6365257Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.6442356Z 2025-08-10 01:11:35,643 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.6444680Z Args: ('mcp-god-mode-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.6445232Z Kwargs: {}
2025-08-10T01:11:35.6446531Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6448001Z Traceback:
2025-08-10T01:11:35.6448339Z Traceback (most recent call last):
2025-08-10T01:11:35.6449176Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.6450011Z     asyncio.get_running_loop()
2025-08-10T01:11:35.6450711Z RuntimeError: no running event loop
2025-08-10T01:11:35.6451047Z
2025-08-10T01:11:35.6451352Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.6451813Z
2025-08-10T01:11:35.6451973Z Traceback (most recent call last):
2025-08-10T01:11:35.6452835Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.6453706Z     return func(*args, **kwargs)
2025-08-10T01:11:35.6454104Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6455098Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.6456115Z     db = get_db()
2025-08-10T01:11:35.6456430Z          ^^^^^^^^
2025-08-10T01:11:35.6457231Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.6458306Z     return firestore.client()
2025-08-10T01:11:35.6458732Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6459807Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.6461167Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.6461892Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6463076Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.6464436Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.6465106Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6466778Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.6468232Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.6468723Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6469900Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.6471110Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.6471645Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6472891Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.6474109Z     self._load_credential()
2025-08-10T01:11:35.6475346Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.6476789Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.6477489Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6478979Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.6480377Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.6482253Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6484138Z --- END EXCEPTION ---
2025-08-10T01:11:35.6485988Z 2025-08-10 01:11:35,644 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6488794Z .2025-08-10 01:11:35,646 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.6490782Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.6492254Z   setup_file_logging()
2025-08-10T01:11:35.6492846Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.6574002Z 2025-08-10 01:11:35,657 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.6575868Z Args: ('mcp-helper-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.6576417Z Kwargs: {}
2025-08-10T01:11:35.6577611Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6579119Z Traceback:
2025-08-10T01:11:35.6579481Z Traceback (most recent call last):
2025-08-10T01:11:35.6580379Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.6581290Z     asyncio.get_running_loop()
2025-08-10T01:11:35.6581752Z RuntimeError: no running event loop
2025-08-10T01:11:35.6582068Z
2025-08-10T01:11:35.6582384Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.6582876Z
2025-08-10T01:11:35.6583066Z Traceback (most recent call last):
2025-08-10T01:11:35.6584000Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.6584593Z     return func(*args, **kwargs)
2025-08-10T01:11:35.6584826Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6585477Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.6586135Z     db = get_db()
2025-08-10T01:11:35.6586460Z          ^^^^^^^^
2025-08-10T01:11:35.6587123Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.6587642Z     return firestore.client()
2025-08-10T01:11:35.6588093Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6588708Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.6589457Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.6589862Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6590521Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.6591258Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.6591627Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6592284Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.6592941Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.6593213Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6593845Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.6594695Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.6594980Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6595650Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.6596293Z     self._load_credential()
2025-08-10T01:11:35.6596938Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.6597987Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.6598367Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6598999Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.6599895Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.6601916Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6603638Z --- END EXCEPTION ---
2025-08-10T01:11:35.6605449Z 2025-08-10 01:11:35,657 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6611066Z 2025-08-10 01:11:35,660 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.6612932Z Args: ('mcp-helper-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.6613456Z Kwargs: {}
2025-08-10T01:11:35.6614657Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6615977Z Traceback:
2025-08-10T01:11:35.6616325Z Traceback (most recent call last):
2025-08-10T01:11:35.6617266Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.6618363Z     asyncio.get_running_loop()
2025-08-10T01:11:35.6618816Z RuntimeError: no running event loop
2025-08-10T01:11:35.6619130Z
2025-08-10T01:11:35.6619451Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.6619954Z
2025-08-10T01:11:35.6620128Z Traceback (most recent call last):
2025-08-10T01:11:35.6621055Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.6621722Z     return func(*args, **kwargs)
2025-08-10T01:11:35.6621954Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6622625Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.6623537Z     db = get_db()
2025-08-10T01:11:35.6623768Z          ^^^^^^^^
2025-08-10T01:11:35.6624238Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.6624736Z     return firestore.client()
2025-08-10T01:11:35.6625040Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6625654Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.6626398Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.6626803Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6627466Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.6628606Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.6628979Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6629636Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.6630276Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.6630534Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6631152Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.6631917Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.6632201Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6632861Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.6633518Z     self._load_credential()
2025-08-10T01:11:35.6634153Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.6634899Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.6635268Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6635896Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.6636645Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.6637619Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6639502Z --- END EXCEPTION ---
2025-08-10T01:11:35.6641567Z 2025-08-10 01:11:35,661 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6647892Z 2025-08-10 01:11:35,664 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.6649775Z Args: ('mcp-helper-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.6650306Z Kwargs: {}
2025-08-10T01:11:35.6651503Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6652959Z Traceback:
2025-08-10T01:11:35.6653323Z Traceback (most recent call last):
2025-08-10T01:11:35.6654195Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.6655043Z     asyncio.get_running_loop()
2025-08-10T01:11:35.6655462Z RuntimeError: no running event loop
2025-08-10T01:11:35.6655723Z
2025-08-10T01:11:35.6656021Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.6656481Z
2025-08-10T01:11:35.6656642Z Traceback (most recent call last):
2025-08-10T01:11:35.6657612Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.6658652Z     return func(*args, **kwargs)
2025-08-10T01:11:35.6659054Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6660054Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.6661038Z     db = get_db()
2025-08-10T01:11:35.6661160Z          ^^^^^^^^
2025-08-10T01:11:35.6661796Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.6662161Z     return firestore.client()
2025-08-10T01:11:35.6662295Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6663130Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.6663553Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.6663730Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6664606Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.6665180Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.6665332Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6666218Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.6666410Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.6666553Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6667394Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.6667607Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.6667969Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6668899Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.6669075Z     self._load_credential()
2025-08-10T01:11:35.6669980Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.6670330Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.6670506Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6671369Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.6671841Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.6673628Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6673824Z --- END EXCEPTION ---
2025-08-10T01:11:35.6675457Z 2025-08-10 01:11:35,664 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6676495Z .2025-08-10 01:11:35,667 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.6678690Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.6678870Z   setup_file_logging()
2025-08-10T01:11:35.6679248Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.6764846Z 2025-08-10 01:11:35,676 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.6766201Z Args: ('mcp-helper-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.6766346Z Kwargs: {}
2025-08-10T01:11:35.6767364Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6767518Z Traceback:
2025-08-10T01:11:35.6768272Z Traceback (most recent call last):
2025-08-10T01:11:35.6768885Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.6769064Z     asyncio.get_running_loop()
2025-08-10T01:11:35.6769245Z RuntimeError: no running event loop
2025-08-10T01:11:35.6769257Z
2025-08-10T01:11:35.6769576Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.6769589Z
2025-08-10T01:11:35.6769904Z Traceback (most recent call last):
2025-08-10T01:11:35.6770548Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.6770958Z     return func(*args, **kwargs)
2025-08-10T01:11:35.6771101Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6771853Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.6771993Z     db = get_db()
2025-08-10T01:11:35.6772108Z          ^^^^^^^^
2025-08-10T01:11:35.6772725Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.6772875Z     return firestore.client()
2025-08-10T01:11:35.6772997Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6773821Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.6774240Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.6774474Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6775371Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.6775739Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.6775892Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6776750Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.6776946Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.6777084Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6778091Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.6778317Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.6778464Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6779372Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.6779528Z     self._load_credential()
2025-08-10T01:11:35.6780429Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.6780786Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.6780953Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6781759Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.6782194Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.6783459Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6783616Z --- END EXCEPTION ---
2025-08-10T01:11:35.6785203Z 2025-08-10 01:11:35,676 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6789664Z .2025-08-10 01:11:35,678 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.6791779Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.6791951Z   setup_file_logging()
2025-08-10T01:11:35.6792327Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.6878571Z 2025-08-10 01:11:35,687 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.6879510Z Args: ('mcp-helper-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.6879663Z Kwargs: {}
2025-08-10T01:11:35.6880675Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6880847Z Traceback:
2025-08-10T01:11:35.6881031Z Traceback (most recent call last):
2025-08-10T01:11:35.6881628Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.6881817Z     asyncio.get_running_loop()
2025-08-10T01:11:35.6881988Z RuntimeError: no running event loop
2025-08-10T01:11:35.6882001Z
2025-08-10T01:11:35.6882324Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.6882345Z
2025-08-10T01:11:35.6882527Z Traceback (most recent call last):
2025-08-10T01:11:35.6883155Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.6883338Z     return func(*args, **kwargs)
2025-08-10T01:11:35.6883474Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6884248Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.6884404Z     db = get_db()
2025-08-10T01:11:35.6884526Z          ^^^^^^^^
2025-08-10T01:11:35.6885142Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.6885301Z     return firestore.client()
2025-08-10T01:11:35.6885430Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6886221Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.6886645Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.6886817Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6887949Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.6888342Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.6888490Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6889357Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.6889542Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.6889684Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6890527Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.6890746Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.6890896Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6891786Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.6892148Z     self._load_credential()
2025-08-10T01:11:35.6893052Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.6893408Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.6893647Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.6894456Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.6895092Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.6896360Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6896527Z --- END EXCEPTION ---
2025-08-10T01:11:35.6898375Z 2025-08-10 01:11:35,687 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6902990Z .2025-08-10 01:11:35,690 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.6905091Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.6905281Z   setup_file_logging()
2025-08-10T01:11:35.6905668Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.6995405Z 2025-08-10 01:11:35,699 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.6996696Z Args: ('mcp-helper-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.6996863Z Kwargs: {}
2025-08-10T01:11:35.6998346Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.6998508Z Traceback:
2025-08-10T01:11:35.6998679Z Traceback (most recent call last):
2025-08-10T01:11:35.6999283Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.6999462Z     asyncio.get_running_loop()
2025-08-10T01:11:35.6999638Z RuntimeError: no running event loop
2025-08-10T01:11:35.6999666Z
2025-08-10T01:11:35.7000144Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.7000165Z
2025-08-10T01:11:35.7000343Z Traceback (most recent call last):
2025-08-10T01:11:35.7000970Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.7001144Z     return func(*args, **kwargs)
2025-08-10T01:11:35.7001291Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7002045Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.7002189Z     db = get_db()
2025-08-10T01:11:35.7002308Z          ^^^^^^^^
2025-08-10T01:11:35.7002932Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.7003086Z     return firestore.client()
2025-08-10T01:11:35.7003209Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7004055Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.7004466Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.7004686Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7005814Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.7006189Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.7006345Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7007197Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.7007396Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.7007887Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7008873Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.7009094Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.7009233Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7010144Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.7010300Z     self._load_credential()
2025-08-10T01:11:35.7011207Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.7011559Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.7011728Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7012554Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.7012999Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.7014235Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.7014396Z --- END EXCEPTION ---
2025-08-10T01:11:35.7029786Z 2025-08-10 01:11:35,699 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.7030860Z .2025-08-10 01:11:35,701 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.7032021Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.7032204Z   setup_file_logging()
2025-08-10T01:11:35.7032580Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.7114506Z 2025-08-10 01:11:35,711 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.7115787Z Args: ('mcp-helper-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.7115931Z Kwargs: {}
2025-08-10T01:11:35.7116949Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.7117097Z Traceback:
2025-08-10T01:11:35.7117272Z Traceback (most recent call last):
2025-08-10T01:11:35.7118168Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.7118377Z     asyncio.get_running_loop()
2025-08-10T01:11:35.7118554Z RuntimeError: no running event loop
2025-08-10T01:11:35.7118566Z
2025-08-10T01:11:35.7118892Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.7118906Z
2025-08-10T01:11:35.7119071Z Traceback (most recent call last):
2025-08-10T01:11:35.7120106Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.7120289Z     return func(*args, **kwargs)
2025-08-10T01:11:35.7120438Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7121219Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.7121362Z     db = get_db()
2025-08-10T01:11:35.7121477Z          ^^^^^^^^
2025-08-10T01:11:35.7122083Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.7122434Z     return firestore.client()
2025-08-10T01:11:35.7122551Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7123386Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.7123794Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.7123994Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7124959Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.7125330Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.7125487Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7126342Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.7126549Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.7126687Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7127562Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.7127964Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.7128110Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7129058Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.7129214Z     self._load_credential()
2025-08-10T01:11:35.7130151Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.7130510Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.7130692Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7131524Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.7131968Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.7133268Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.7133426Z --- END EXCEPTION ---
2025-08-10T01:11:35.7135094Z 2025-08-10 01:11:35,711 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.7139355Z .2025-08-10 01:11:35,713 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.7141460Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.7141628Z   setup_file_logging()
2025-08-10T01:11:35.7142255Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.7230884Z 2025-08-10 01:11:35,722 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.7232178Z Args: ('mcp-helper-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.7232330Z Kwargs: {}
2025-08-10T01:11:35.7233335Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.7233492Z Traceback:
2025-08-10T01:11:35.7233931Z Traceback (most recent call last):
2025-08-10T01:11:35.7234537Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.7234731Z     asyncio.get_running_loop()
2025-08-10T01:11:35.7234903Z RuntimeError: no running event loop
2025-08-10T01:11:35.7234915Z
2025-08-10T01:11:35.7235247Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.7235281Z
2025-08-10T01:11:35.7235612Z Traceback (most recent call last):
2025-08-10T01:11:35.7236231Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.7236414Z     return func(*args, **kwargs)
2025-08-10T01:11:35.7236551Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7237333Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.7237472Z     db = get_db()
2025-08-10T01:11:35.7237604Z          ^^^^^^^^
2025-08-10T01:11:35.7238503Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.7238671Z     return firestore.client()
2025-08-10T01:11:35.7238788Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7239566Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.7239995Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.7240163Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7241147Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.7241527Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.7241675Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7242564Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.7242756Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.7242897Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7243774Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.7243985Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.7244131Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7245038Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.7245194Z     self._load_credential()
2025-08-10T01:11:35.7246106Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.7246475Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.7246642Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7247453Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.7248313Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.7249597Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.7249755Z --- END EXCEPTION ---
2025-08-10T01:11:35.7251391Z 2025-08-10 01:11:35,723 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.7258848Z .2025-08-10 01:11:35,725 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:35.7260850Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:35.7261033Z   setup_file_logging()
2025-08-10T01:11:35.7261420Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:35.7349244Z 2025-08-10 01:11:35,734 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:35.7350525Z Args: ('mcp-helper-test-user', 'mcp-test-campaign')
2025-08-10T01:11:35.7350670Z Kwargs: {}
2025-08-10T01:11:35.7351698Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.7351862Z Traceback:
2025-08-10T01:11:35.7352040Z Traceback (most recent call last):
2025-08-10T01:11:35.7352643Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:35.7352820Z     asyncio.get_running_loop()
2025-08-10T01:11:35.7353015Z RuntimeError: no running event loop
2025-08-10T01:11:35.7353027Z
2025-08-10T01:11:35.7353351Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:35.7353364Z
2025-08-10T01:11:35.7353526Z Traceback (most recent call last):
2025-08-10T01:11:35.7354290Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:35.7354463Z     return func(*args, **kwargs)
2025-08-10T01:11:35.7354596Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7355291Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:35.7355435Z     db = get_db()
2025-08-10T01:11:35.7355557Z          ^^^^^^^^
2025-08-10T01:11:35.7356160Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:35.7356325Z     return firestore.client()
2025-08-10T01:11:35.7356444Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7357285Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:35.7357695Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:35.7358107Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7358945Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:35.7359284Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:35.7359415Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7360213Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:35.7360604Z     self._services[name] = initializer(self)
2025-08-10T01:11:35.7360721Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7361505Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:35.7361707Z     credentials = app.credential.get_credential()
2025-08-10T01:11:35.7361826Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7362672Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:35.7362986Z     self._load_credential()
2025-08-10T01:11:35.7363844Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:35.7364159Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:35.7364317Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:35.7365059Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:35.7365440Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:35.7366593Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.7366736Z --- END EXCEPTION ---
2025-08-10T01:11:35.7369801Z 2025-08-10 01:11:35,734 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:35.7369944Z .
2025-08-10T01:11:35.7370146Z ----------------------------------------------------------------------
2025-08-10T01:11:35.7370286Z Ran 20 tests in 1.284s
2025-08-10T01:11:35.7370294Z
2025-08-10T01:11:35.7370392Z OK
2025-08-10T01:11:35.7370734Z üîµ Running god mode command tests through MCP architecture
2025-08-10T01:11:35.7371073Z üìù NOTE: Tests validate MCP gateway handling of god mode commands
2025-08-10T01:11:35.9513194Z ‚úÖ PASS: tests/test_main_god_mode.py
2025-08-10T01:11:35.9514293Z ----------------------------------------
2025-08-10T01:11:35.9514574Z Running: tests/test_main_interaction_structured_fields.py
2025-08-10T01:11:36.2873124Z 2025-08-10 01:11:36,287 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:36.2966851Z 2025-08-10 01:11:36,296 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:36.2976326Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:36.2979016Z   setup_file_logging()
2025-08-10T01:11:36.2979655Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:36.5650368Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:36.5653595Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:36.5860313Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:36.5864414Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:37.2779996Z 2025-08-10 01:11:37,277 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:37.2783307Z Args: ('mcp-structured-fields-test-user', 'mcp-structured-test-campaign')
2025-08-10T01:11:37.2783932Z Kwargs: {}
2025-08-10T01:11:37.2785035Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.2786528Z Traceback:
2025-08-10T01:11:37.2786848Z Traceback (most recent call last):
2025-08-10T01:11:37.2787876Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py", line 314, in wrapper
2025-08-10T01:11:37.2788792Z     asyncio.get_running_loop()
2025-08-10T01:11:37.2789215Z RuntimeError: no running event loop
2025-08-10T01:11:37.2789514Z
2025-08-10T01:11:37.2789787Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:37.2790198Z
2025-08-10T01:11:37.2790355Z Traceback (most recent call last):
2025-08-10T01:11:37.2791265Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../decorators.py", line 62, in wrapper
2025-08-10T01:11:37.2792175Z     return func(*args, **kwargs)
2025-08-10T01:11:37.2792564Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2793563Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:37.2794577Z     db = get_db()
2025-08-10T01:11:37.2794890Z          ^^^^^^^^
2025-08-10T01:11:37.2796904Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 433, in get_db
2025-08-10T01:11:37.2798007Z     return firestore.client()
2025-08-10T01:11:37.2798393Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2799438Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:37.2800532Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:37.2801226Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2802492Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:37.2803800Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:37.2804453Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2805558Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:37.2806663Z     self._services[name] = initializer(self)
2025-08-10T01:11:37.2807092Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2808423Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:37.2809552Z     credentials = app.credential.get_credential()
2025-08-10T01:11:37.2810035Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2811217Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:37.2812350Z     self._load_credential()
2025-08-10T01:11:37.2813499Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:37.2814817Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:37.2815462Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2816803Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:37.2818319Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:37.2820030Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.2826448Z --- END EXCEPTION ---
2025-08-10T01:11:37.2828966Z 2025-08-10 01:11:37,277 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.2830872Z .2025-08-10 01:11:37,282 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:37.2832708Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:37.2834237Z   setup_file_logging()
2025-08-10T01:11:37.2834853Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:37.2921416Z 2025-08-10 01:11:37,291 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:37.2927150Z Args: ('mcp-structured-fields-test-user', 'mcp-structured-test-campaign')
2025-08-10T01:11:37.2928032Z Kwargs: {}
2025-08-10T01:11:37.2929190Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.2930431Z Traceback:
2025-08-10T01:11:37.2930759Z Traceback (most recent call last):
2025-08-10T01:11:37.2931560Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py", line 314, in wrapper
2025-08-10T01:11:37.2932383Z     asyncio.get_running_loop()
2025-08-10T01:11:37.2932804Z RuntimeError: no running event loop
2025-08-10T01:11:37.2933090Z
2025-08-10T01:11:37.2933439Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:37.2933943Z
2025-08-10T01:11:37.2934105Z Traceback (most recent call last):
2025-08-10T01:11:37.2935007Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../decorators.py", line 62, in wrapper
2025-08-10T01:11:37.2935896Z     return func(*args, **kwargs)
2025-08-10T01:11:37.2936302Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2937310Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:37.2938556Z     db = get_db()
2025-08-10T01:11:37.2938862Z          ^^^^^^^^
2025-08-10T01:11:37.2939694Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 433, in get_db
2025-08-10T01:11:37.2940639Z     return firestore.client()
2025-08-10T01:11:37.2941034Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2942091Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:37.2943418Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:37.2944139Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2945366Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:37.2946664Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:37.2947313Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2948686Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:37.2950106Z     self._services[name] = initializer(self)
2025-08-10T01:11:37.2950598Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2951747Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:37.2952964Z     credentials = app.credential.get_credential()
2025-08-10T01:11:37.2953489Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2955011Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:37.2956256Z     self._load_credential()
2025-08-10T01:11:37.2957477Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:37.2959125Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:37.2959826Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.2961033Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:37.2962472Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:37.2964317Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.2965949Z --- END EXCEPTION ---
2025-08-10T01:11:37.2968021Z 2025-08-10 01:11:37,291 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.2970532Z .2025-08-10 01:11:37,294 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:37.2972361Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:37.2973877Z   setup_file_logging()
2025-08-10T01:11:37.2974463Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:37.3080016Z 2025-08-10 01:11:37,307 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:37.3084204Z Args: ('mcp-structured-fields-test-user', 'mcp-structured-test-campaign')
2025-08-10T01:11:37.3084864Z Kwargs: {}
2025-08-10T01:11:37.3086038Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3087353Z Traceback:
2025-08-10T01:11:37.3087910Z Traceback (most recent call last):
2025-08-10T01:11:37.3088861Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py", line 314, in wrapper
2025-08-10T01:11:37.3089783Z     asyncio.get_running_loop()
2025-08-10T01:11:37.3090547Z RuntimeError: no running event loop
2025-08-10T01:11:37.3090799Z
2025-08-10T01:11:37.3091094Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:37.3091566Z
2025-08-10T01:11:37.3091748Z Traceback (most recent call last):
2025-08-10T01:11:37.3092409Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../decorators.py", line 62, in wrapper
2025-08-10T01:11:37.3093019Z     return func(*args, **kwargs)
2025-08-10T01:11:37.3093249Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3093842Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:37.3094623Z     db = get_db()
2025-08-10T01:11:37.3094804Z          ^^^^^^^^
2025-08-10T01:11:37.3095302Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 433, in get_db
2025-08-10T01:11:37.3095832Z     return firestore.client()
2025-08-10T01:11:37.3096048Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3096632Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:37.3097502Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:37.3098189Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3098855Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:37.3099612Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:37.3099983Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3100639Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:37.3101274Z     self._services[name] = initializer(self)
2025-08-10T01:11:37.3101524Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3102135Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:37.3102782Z     credentials = app.credential.get_credential()
2025-08-10T01:11:37.3103055Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3103711Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:37.3104359Z     self._load_credential()
2025-08-10T01:11:37.3105010Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:37.3105825Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:37.3106500Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3107695Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:37.3109363Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:37.3111207Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3112854Z --- END EXCEPTION ---
2025-08-10T01:11:37.3114723Z 2025-08-10 01:11:37,308 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3118925Z 2025-08-10 01:11:37,311 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:37.3119907Z Args: ('mcp-structured-fields-test-user', 'mcp-structured-test-campaign')
2025-08-10T01:11:37.3120583Z Kwargs: {}
2025-08-10T01:11:37.3121747Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3123056Z Traceback:
2025-08-10T01:11:37.3123415Z Traceback (most recent call last):
2025-08-10T01:11:37.3124371Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py", line 314, in wrapper
2025-08-10T01:11:37.3126536Z     asyncio.get_running_loop()
2025-08-10T01:11:37.3126800Z RuntimeError: no running event loop
2025-08-10T01:11:37.3126978Z
2025-08-10T01:11:37.3127149Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:37.3127403Z
2025-08-10T01:11:37.3127499Z Traceback (most recent call last):
2025-08-10T01:11:37.3128351Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../decorators.py", line 62, in wrapper
2025-08-10T01:11:37.3129258Z     return func(*args, **kwargs)
2025-08-10T01:11:37.3129496Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3130355Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:37.3130943Z     db = get_db()
2025-08-10T01:11:37.3131123Z          ^^^^^^^^
2025-08-10T01:11:37.3131609Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 433, in get_db
2025-08-10T01:11:37.3132141Z     return firestore.client()
2025-08-10T01:11:37.3132355Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3132946Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:37.3133680Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:37.3134080Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3134737Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:37.3135476Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:37.3135846Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3136503Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:37.3137148Z     self._services[name] = initializer(self)
2025-08-10T01:11:37.3137401Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3138296Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:37.3138950Z     credentials = app.credential.get_credential()
2025-08-10T01:11:37.3139229Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3139895Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:37.3140557Z     self._load_credential()
2025-08-10T01:11:37.3141194Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:37.3141945Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:37.3142314Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3142950Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:37.3144385Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:37.3146287Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3148110Z --- END EXCEPTION ---
2025-08-10T01:11:37.3149982Z 2025-08-10 01:11:37,311 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3154756Z 2025-08-10 01:11:37,315 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:37.3158072Z Args: ('mcp-structured-fields-test-user', 'mcp-structured-test-campaign')
2025-08-10T01:11:37.3158768Z Kwargs: {}
2025-08-10T01:11:37.3160896Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3162151Z Traceback:
2025-08-10T01:11:37.3162499Z Traceback (most recent call last):
2025-08-10T01:11:37.3163420Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py", line 314, in wrapper
2025-08-10T01:11:37.3164628Z     asyncio.get_running_loop()
2025-08-10T01:11:37.3165078Z RuntimeError: no running event loop
2025-08-10T01:11:37.3165387Z
2025-08-10T01:11:37.3165690Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:37.3166128Z
2025-08-10T01:11:37.3166320Z Traceback (most recent call last):
2025-08-10T01:11:37.3167129Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../decorators.py", line 62, in wrapper
2025-08-10T01:11:37.3168169Z     return func(*args, **kwargs)
2025-08-10T01:11:37.3168569Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3169730Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:37.3170745Z     db = get_db()
2025-08-10T01:11:37.3171060Z          ^^^^^^^^
2025-08-10T01:11:37.3171912Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 433, in get_db
2025-08-10T01:11:37.3172880Z     return firestore.client()
2025-08-10T01:11:37.3173263Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3174271Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:37.3175602Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:37.3176326Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3177527Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:37.3179144Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:37.3179793Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3180998Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:37.3182138Z     self._services[name] = initializer(self)
2025-08-10T01:11:37.3182591Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3183728Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:37.3184898Z     credentials = app.credential.get_credential()
2025-08-10T01:11:37.3185421Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3187856Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:37.3189134Z     self._load_credential()
2025-08-10T01:11:37.3190366Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:37.3191785Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:37.3192492Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3193702Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:37.3195414Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:37.3197250Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3199196Z --- END EXCEPTION ---
2025-08-10T01:11:37.3201079Z 2025-08-10 01:11:37,315 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3203249Z .2025-08-10 01:11:37,318 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:37.3205084Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:37.3206610Z   setup_file_logging()
2025-08-10T01:11:37.3207232Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:37.3285460Z 2025-08-10 01:11:37,328 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:37.3287581Z Args: ('mcp-structured-fields-test-user', 'mcp-structured-test-campaign')
2025-08-10T01:11:37.3288483Z Kwargs: {}
2025-08-10T01:11:37.3289666Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3290975Z Traceback:
2025-08-10T01:11:37.3291340Z Traceback (most recent call last):
2025-08-10T01:11:37.3292262Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py", line 314, in wrapper
2025-08-10T01:11:37.3293189Z     asyncio.get_running_loop()
2025-08-10T01:11:37.3293654Z RuntimeError: no running event loop
2025-08-10T01:11:37.3293957Z
2025-08-10T01:11:37.3294266Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:37.3294703Z
2025-08-10T01:11:37.3294860Z Traceback (most recent call last):
2025-08-10T01:11:37.3295717Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../decorators.py", line 62, in wrapper
2025-08-10T01:11:37.3296541Z     return func(*args, **kwargs)
2025-08-10T01:11:37.3296963Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3298199Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:37.3299343Z     db = get_db()
2025-08-10T01:11:37.3299662Z          ^^^^^^^^
2025-08-10T01:11:37.3300526Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 433, in get_db
2025-08-10T01:11:37.3301459Z     return firestore.client()
2025-08-10T01:11:37.3301859Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3302905Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:37.3304218Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:37.3304939Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3306148Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:37.3307511Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:37.3308345Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3309520Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:37.3310848Z     self._services[name] = initializer(self)
2025-08-10T01:11:37.3311304Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3312445Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:37.3313602Z     credentials = app.credential.get_credential()
2025-08-10T01:11:37.3314118Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3315339Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:37.3316822Z     self._load_credential()
2025-08-10T01:11:37.3318275Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:37.3319732Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:37.3320446Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3321616Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:37.3323066Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:37.3324949Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3326585Z --- END EXCEPTION ---
2025-08-10T01:11:37.3328661Z 2025-08-10 01:11:37,328 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3330435Z .2025-08-10 01:11:37,331 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:37.3332131Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:37.3333637Z   setup_file_logging()
2025-08-10T01:11:37.3334235Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:37.3424413Z 2025-08-10 01:11:37,342 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:37.3427413Z Args: ('mcp-structured-fields-test-user', 'mcp-structured-test-campaign')
2025-08-10T01:11:37.3428333Z Kwargs: {}
2025-08-10T01:11:37.3429495Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3430793Z Traceback:
2025-08-10T01:11:37.3431152Z Traceback (most recent call last):
2025-08-10T01:11:37.3432130Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py", line 314, in wrapper
2025-08-10T01:11:37.3433049Z     asyncio.get_running_loop()
2025-08-10T01:11:37.3433500Z RuntimeError: no running event loop
2025-08-10T01:11:37.3433812Z
2025-08-10T01:11:37.3434136Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:37.3434619Z
2025-08-10T01:11:37.3434796Z Traceback (most recent call last):
2025-08-10T01:11:37.3435761Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../decorators.py", line 62, in wrapper
2025-08-10T01:11:37.3436736Z     return func(*args, **kwargs)
2025-08-10T01:11:37.3437158Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3438443Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:37.3439516Z     db = get_db()
2025-08-10T01:11:37.3440101Z          ^^^^^^^^
2025-08-10T01:11:37.3440970Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 433, in get_db
2025-08-10T01:11:37.3441543Z     return firestore.client()
2025-08-10T01:11:37.3441769Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3442457Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:37.3443501Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:37.3444125Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3445077Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:37.3445833Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:37.3446209Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3446853Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:37.3447490Z     self._services[name] = initializer(self)
2025-08-10T01:11:37.3447927Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3448596Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:37.3449236Z     credentials = app.credential.get_credential()
2025-08-10T01:11:37.3449520Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3450170Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:37.3450804Z     self._load_credential()
2025-08-10T01:11:37.3451443Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:37.3452192Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:37.3452559Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3453183Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:37.3453923Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:37.3454905Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3455764Z --- END EXCEPTION ---
2025-08-10T01:11:37.3456785Z 2025-08-10 01:11:37,342 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3466513Z 2025-08-10 01:11:37,346 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:37.3469648Z Args: ('mcp-structured-fields-test-user', 'mcp-structured-test-campaign')
2025-08-10T01:11:37.3470298Z Kwargs: {}
2025-08-10T01:11:37.3471459Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3472774Z Traceback:
2025-08-10T01:11:37.3473142Z Traceback (most recent call last):
2025-08-10T01:11:37.3474095Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py", line 314, in wrapper
2025-08-10T01:11:37.3475023Z     asyncio.get_running_loop()
2025-08-10T01:11:37.3475475Z RuntimeError: no running event loop
2025-08-10T01:11:37.3476068Z
2025-08-10T01:11:37.3476388Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:37.3476876Z
2025-08-10T01:11:37.3477060Z Traceback (most recent call last):
2025-08-10T01:11:37.3478240Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../decorators.py", line 62, in wrapper
2025-08-10T01:11:37.3479218Z     return func(*args, **kwargs)
2025-08-10T01:11:37.3479644Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3480738Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:37.3481706Z     db = get_db()
2025-08-10T01:11:37.3481899Z          ^^^^^^^^
2025-08-10T01:11:37.3482481Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 433, in get_db
2025-08-10T01:11:37.3483240Z     return firestore.client()
2025-08-10T01:11:37.3483634Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3484340Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:37.3485098Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:37.3485504Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3486193Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:37.3486935Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:37.3487317Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3488226Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:37.3488878Z     self._services[name] = initializer(self)
2025-08-10T01:11:37.3489139Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3489760Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:37.3490400Z     credentials = app.credential.get_credential()
2025-08-10T01:11:37.3490681Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3491362Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:37.3492012Z     self._load_credential()
2025-08-10T01:11:37.3492659Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:37.3493411Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:37.3493780Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3494408Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:37.3495149Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:37.3496131Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3497696Z --- END EXCEPTION ---
2025-08-10T01:11:37.3499736Z 2025-08-10 01:11:37,346 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3506284Z 2025-08-10 01:11:37,350 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:37.3521027Z Args: ('mcp-structured-fields-test-user', 'mcp-structured-test-campaign')
2025-08-10T01:11:37.3521715Z Kwargs: {}
2025-08-10T01:11:37.3522856Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3524108Z Traceback:
2025-08-10T01:11:37.3524444Z Traceback (most recent call last):
2025-08-10T01:11:37.3525345Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py", line 314, in wrapper
2025-08-10T01:11:37.3526235Z     asyncio.get_running_loop()
2025-08-10T01:11:37.3526901Z RuntimeError: no running event loop
2025-08-10T01:11:37.3527216Z
2025-08-10T01:11:37.3527521Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:37.3528199Z
2025-08-10T01:11:37.3528375Z Traceback (most recent call last):
2025-08-10T01:11:37.3529318Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../decorators.py", line 62, in wrapper
2025-08-10T01:11:37.3530255Z     return func(*args, **kwargs)
2025-08-10T01:11:37.3530658Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3531722Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:37.3532767Z     db = get_db()
2025-08-10T01:11:37.3533077Z          ^^^^^^^^
2025-08-10T01:11:37.3533923Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 433, in get_db
2025-08-10T01:11:37.3534897Z     return firestore.client()
2025-08-10T01:11:37.3535333Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3536387Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:37.3538066Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:37.3538881Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3540175Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:37.3541597Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:37.3542290Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3543514Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:37.3544727Z     self._services[name] = initializer(self)
2025-08-10T01:11:37.3545222Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3546412Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:37.3547638Z     credentials = app.credential.get_credential()
2025-08-10T01:11:37.3548393Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3549680Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:37.3550888Z     self._load_credential()
2025-08-10T01:11:37.3552129Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:37.3553579Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:37.3554287Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3555461Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:37.3556889Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:37.3559303Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3560925Z --- END EXCEPTION ---
2025-08-10T01:11:37.3562804Z 2025-08-10 01:11:37,350 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3564754Z .2025-08-10 01:11:37,353 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:37.3566867Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:37.3568599Z   setup_file_logging()
2025-08-10T01:11:37.3569232Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:37.3638272Z 2025-08-10 01:11:37,363 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:37.3639254Z Args: ('mcp-structured-fields-test-user', 'mcp-structured-test-campaign')
2025-08-10T01:11:37.3639937Z Kwargs: {}
2025-08-10T01:11:37.3641127Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3642420Z Traceback:
2025-08-10T01:11:37.3642789Z Traceback (most recent call last):
2025-08-10T01:11:37.3643723Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py", line 314, in wrapper
2025-08-10T01:11:37.3644635Z     asyncio.get_running_loop()
2025-08-10T01:11:37.3645084Z RuntimeError: no running event loop
2025-08-10T01:11:37.3645400Z
2025-08-10T01:11:37.3645704Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:37.3646171Z
2025-08-10T01:11:37.3646333Z Traceback (most recent call last):
2025-08-10T01:11:37.3647177Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../decorators.py", line 62, in wrapper
2025-08-10T01:11:37.3648240Z     return func(*args, **kwargs)
2025-08-10T01:11:37.3648643Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3649803Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:37.3651506Z     db = get_db()
2025-08-10T01:11:37.3651855Z          ^^^^^^^^
2025-08-10T01:11:37.3652725Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 433, in get_db
2025-08-10T01:11:37.3653666Z     return firestore.client()
2025-08-10T01:11:37.3654084Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3655151Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:37.3656512Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:37.3657246Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3658679Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:37.3660051Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:37.3660723Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3661895Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:37.3663088Z     self._services[name] = initializer(self)
2025-08-10T01:11:37.3663580Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3664977Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:37.3666182Z     credentials = app.credential.get_credential()
2025-08-10T01:11:37.3666702Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3668173Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:37.3669425Z     self._load_credential()
2025-08-10T01:11:37.3670639Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:37.3672359Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:37.3673041Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3674250Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:37.3675805Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:37.3677674Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3679571Z --- END EXCEPTION ---
2025-08-10T01:11:37.3681466Z 2025-08-10 01:11:37,363 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3683616Z .2025-08-10 01:11:37,366 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:37.3685578Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:37.3687275Z   setup_file_logging()
2025-08-10T01:11:37.3688167Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:37.3762985Z 2025-08-10 01:11:37,376 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:37.3763986Z Args: ('mcp-structured-fields-test-user', 'mcp-structured-test-campaign')
2025-08-10T01:11:37.3764659Z Kwargs: {}
2025-08-10T01:11:37.3765851Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3767163Z Traceback:
2025-08-10T01:11:37.3767524Z Traceback (most recent call last):
2025-08-10T01:11:37.3768870Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../main.py", line 314, in wrapper
2025-08-10T01:11:37.3769941Z     asyncio.get_running_loop()
2025-08-10T01:11:37.3770480Z RuntimeError: no running event loop
2025-08-10T01:11:37.3770875Z
2025-08-10T01:11:37.3771239Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:37.3771670Z
2025-08-10T01:11:37.3771833Z Traceback (most recent call last):
2025-08-10T01:11:37.3772928Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../decorators.py", line 62, in wrapper
2025-08-10T01:11:37.3773836Z     return func(*args, **kwargs)
2025-08-10T01:11:37.3774348Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3775443Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:37.3776487Z     db = get_db()
2025-08-10T01:11:37.3776873Z          ^^^^^^^^
2025-08-10T01:11:37.3777959Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/../firestore_service.py", line 433, in get_db
2025-08-10T01:11:37.3779239Z     return firestore.client()
2025-08-10T01:11:37.3779726Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3780805Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:37.3782138Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:37.3782892Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3784081Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:37.3785622Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:37.3786322Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3787486Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:37.3788851Z     self._services[name] = initializer(self)
2025-08-10T01:11:37.3789380Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3790512Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:37.3791717Z     credentials = app.credential.get_credential()
2025-08-10T01:11:37.3792282Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3793477Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:37.3794650Z     self._load_credential()
2025-08-10T01:11:37.3795801Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:37.3797140Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:37.3798021Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:37.3799160Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:37.3800516Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:37.3802226Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3803761Z --- END EXCEPTION ---
2025-08-10T01:11:37.3805504Z 2025-08-10 01:11:37,376 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:37.3806983Z .
2025-08-10T01:11:37.3807435Z ----------------------------------------------------------------------
2025-08-10T01:11:37.3808144Z Ran 7 tests in 1.082s
2025-08-10T01:11:37.3808440Z
2025-08-10T01:11:37.3808598Z OK
2025-08-10T01:11:37.5981210Z ‚úÖ PASS: tests/test_main_interaction_structured_fields.py
2025-08-10T01:11:37.5982621Z ----------------------------------------
2025-08-10T01:11:37.5983075Z Running: tests/test_main_route_edge_cases.py
2025-08-10T01:11:37.9270842Z 2025-08-10 01:11:37,926 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:37.9364732Z 2025-08-10 01:11:37,936 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:37.9373918Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:37.9376385Z   setup_file_logging()
2025-08-10T01:11:37.9377369Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:38.1973671Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:38.1977234Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:38.2188503Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:38.2192628Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:38.9121186Z 2025-08-10 01:11:38,911 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:38.9124171Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:38.9124687Z Kwargs: {}
2025-08-10T01:11:38.9125874Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9127249Z Traceback:
2025-08-10T01:11:38.9127576Z Traceback (most recent call last):
2025-08-10T01:11:38.9128654Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:38.9129482Z     asyncio.get_running_loop()
2025-08-10T01:11:38.9129931Z RuntimeError: no running event loop
2025-08-10T01:11:38.9130223Z
2025-08-10T01:11:38.9130499Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:38.9130960Z
2025-08-10T01:11:38.9131108Z Traceback (most recent call last):
2025-08-10T01:11:38.9131928Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:38.9132753Z     return func(*args, **kwargs)
2025-08-10T01:11:38.9133149Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9134121Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:38.9135105Z     db = get_db()
2025-08-10T01:11:38.9135423Z          ^^^^^^^^
2025-08-10T01:11:38.9136238Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:38.9137115Z     return firestore.client()
2025-08-10T01:11:38.9137500Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9139113Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:38.9140560Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:38.9141320Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9142590Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:38.9143983Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:38.9144659Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9145880Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:38.9147097Z     self._services[name] = initializer(self)
2025-08-10T01:11:38.9147584Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9149047Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:38.9150567Z     credentials = app.credential.get_credential()
2025-08-10T01:11:38.9151099Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9152377Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:38.9153574Z     self._load_credential()
2025-08-10T01:11:38.9154728Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:38.9156411Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:38.9157070Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9158342Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:38.9159694Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:38.9161461Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9162990Z --- END EXCEPTION ---
2025-08-10T01:11:38.9164798Z 2025-08-10 01:11:38,912 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9166925Z 2025-08-10 01:11:38,914 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:38.9168031Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:38.9168576Z Kwargs: {}
2025-08-10T01:11:38.9169765Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9171089Z Traceback:
2025-08-10T01:11:38.9171442Z Traceback (most recent call last):
2025-08-10T01:11:38.9172328Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:38.9173219Z     asyncio.get_running_loop()
2025-08-10T01:11:38.9173650Z RuntimeError: no running event loop
2025-08-10T01:11:38.9173945Z
2025-08-10T01:11:38.9174240Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:38.9174713Z
2025-08-10T01:11:38.9174869Z Traceback (most recent call last):
2025-08-10T01:11:38.9175771Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:38.9176680Z     return func(*args, **kwargs)
2025-08-10T01:11:38.9177092Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9178355Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:38.9179394Z     db = get_db()
2025-08-10T01:11:38.9179724Z          ^^^^^^^^
2025-08-10T01:11:38.9180553Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:38.9181490Z     return firestore.client()
2025-08-10T01:11:38.9181912Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9183033Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:38.9184481Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:38.9185259Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9186541Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:38.9188413Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:38.9189046Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9190164Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:38.9191267Z     self._services[name] = initializer(self)
2025-08-10T01:11:38.9191699Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9192801Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:38.9194270Z     credentials = app.credential.get_credential()
2025-08-10T01:11:38.9194822Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9195552Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:38.9196219Z     self._load_credential()
2025-08-10T01:11:38.9196968Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:38.9197900Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:38.9198877Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9199647Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:38.9200424Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:38.9201408Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9202260Z --- END EXCEPTION ---
2025-08-10T01:11:38.9203289Z 2025-08-10 01:11:38,916 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9204359Z 2025-08-10 01:11:38,918 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:38.9204799Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:38.9211701Z Kwargs: {}
2025-08-10T01:11:38.9213055Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9214329Z Traceback:
2025-08-10T01:11:38.9214688Z Traceback (most recent call last):
2025-08-10T01:11:38.9215918Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:38.9216788Z     asyncio.get_running_loop()
2025-08-10T01:11:38.9217324Z RuntimeError: no running event loop
2025-08-10T01:11:38.9217652Z
2025-08-10T01:11:38.9218131Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:38.9218622Z
2025-08-10T01:11:38.9218804Z Traceback (most recent call last):
2025-08-10T01:11:38.9219722Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:38.9220620Z     return func(*args, **kwargs)
2025-08-10T01:11:38.9221034Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9222077Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:38.9223089Z     db = get_db()
2025-08-10T01:11:38.9223418Z          ^^^^^^^^
2025-08-10T01:11:38.9224274Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:38.9225428Z     return firestore.client()
2025-08-10T01:11:38.9225811Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9227158Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:38.9228658Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:38.9229362Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9230604Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:38.9232121Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:38.9232753Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9233893Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:38.9235122Z     self._services[name] = initializer(self)
2025-08-10T01:11:38.9235609Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9236794Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:38.9238256Z     credentials = app.credential.get_credential()
2025-08-10T01:11:38.9238792Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9239624Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:38.9240298Z     self._load_credential()
2025-08-10T01:11:38.9240967Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:38.9242292Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:38.9242994Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9244473Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:38.9245903Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:38.9247916Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9249574Z --- END EXCEPTION ---
2025-08-10T01:11:38.9251442Z 2025-08-10 01:11:38,918 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9253426Z 2025-08-10 01:11:38,922 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:38.9254178Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:38.9254663Z Kwargs: {}
2025-08-10T01:11:38.9255781Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9257062Z Traceback:
2025-08-10T01:11:38.9257424Z Traceback (most recent call last):
2025-08-10T01:11:38.9258572Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:38.9259421Z     asyncio.get_running_loop()
2025-08-10T01:11:38.9259842Z RuntimeError: no running event loop
2025-08-10T01:11:38.9260135Z
2025-08-10T01:11:38.9260417Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:38.9260858Z
2025-08-10T01:11:38.9261232Z Traceback (most recent call last):
2025-08-10T01:11:38.9262075Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:38.9262886Z     return func(*args, **kwargs)
2025-08-10T01:11:38.9263262Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9264237Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:38.9265260Z     db = get_db()
2025-08-10T01:11:38.9265589Z          ^^^^^^^^
2025-08-10T01:11:38.9266437Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:38.9267602Z     return firestore.client()
2025-08-10T01:11:38.9268162Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9269222Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:38.9270564Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:38.9271296Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9272452Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:38.9273777Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:38.9275769Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9276844Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:38.9278225Z     self._services[name] = initializer(self)
2025-08-10T01:11:38.9278700Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9279899Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:38.9281060Z     credentials = app.credential.get_credential()
2025-08-10T01:11:38.9281544Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9282714Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:38.9283839Z     self._load_credential()
2025-08-10T01:11:38.9284911Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:38.9286231Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:38.9286874Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9288169Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:38.9289532Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:38.9291287Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9292843Z --- END EXCEPTION ---
2025-08-10T01:11:38.9294638Z 2025-08-10 01:11:38,922 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9296561Z 2025-08-10 01:11:38,925 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:38.9297362Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:38.9298109Z Kwargs: {}
2025-08-10T01:11:38.9299209Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9300668Z Traceback:
2025-08-10T01:11:38.9301012Z Traceback (most recent call last):
2025-08-10T01:11:38.9301991Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:38.9302795Z     asyncio.get_running_loop()
2025-08-10T01:11:38.9303196Z RuntimeError: no running event loop
2025-08-10T01:11:38.9303482Z
2025-08-10T01:11:38.9303769Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:38.9304432Z
2025-08-10T01:11:38.9304589Z Traceback (most recent call last):
2025-08-10T01:11:38.9305434Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:38.9306270Z     return func(*args, **kwargs)
2025-08-10T01:11:38.9306662Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9307679Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:38.9308937Z     db = get_db()
2025-08-10T01:11:38.9309248Z          ^^^^^^^^
2025-08-10T01:11:38.9310087Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:38.9311031Z     return firestore.client()
2025-08-10T01:11:38.9311433Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9312511Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:38.9313930Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:38.9314714Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9316066Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:38.9317513Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:38.9318495Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9319703Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:38.9320930Z     self._services[name] = initializer(self)
2025-08-10T01:11:38.9321412Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9322575Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:38.9323850Z     credentials = app.credential.get_credential()
2025-08-10T01:11:38.9324347Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9325611Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:38.9326868Z     self._load_credential()
2025-08-10T01:11:38.9328781Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:38.9330275Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:38.9330970Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9332169Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:38.9333647Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:38.9335504Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9337404Z --- END EXCEPTION ---
2025-08-10T01:11:38.9339600Z 2025-08-10 01:11:38,925 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9341539Z .2025-08-10 01:11:38,929 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:38.9343373Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:38.9345072Z   setup_file_logging()
2025-08-10T01:11:38.9345692Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:38.9430516Z 2025-08-10 01:11:38,942 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:38.9432603Z Args: ('user-0', 'mcp-campaign-0')
2025-08-10T01:11:38.9433217Z Kwargs: {}
2025-08-10T01:11:38.9434472Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9435803Z Traceback:
2025-08-10T01:11:38.9439559Z Traceback (most recent call last):
2025-08-10T01:11:38.9440453Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:38.9441238Z     asyncio.get_running_loop()
2025-08-10T01:11:38.9441507Z RuntimeError: no running event loop
2025-08-10T01:11:38.9441718Z
2025-08-10T01:11:38.9441896Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:38.9442523Z
2025-08-10T01:11:38.9442711Z Traceback (most recent call last):
2025-08-10T01:11:38.9443709Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:38.9444620Z     return func(*args, **kwargs)
2025-08-10T01:11:38.9445060Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9446182Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:38.9447590Z     db = get_db()
2025-08-10T01:11:38.9448180Z          ^^^^^^^^
2025-08-10T01:11:38.9449083Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:38.9450046Z     return firestore.client()
2025-08-10T01:11:38.9450455Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9451606Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:38.9453128Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:38.9453903Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9455229Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:38.9456689Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:38.9457399Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9465864Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:38.9466612Z     self._services[name] = initializer(self)
2025-08-10T01:11:38.9466895Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9467547Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:38.9468408Z     credentials = app.credential.get_credential()
2025-08-10T01:11:38.9468693Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9469576Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:38.9470221Z     self._load_credential()
2025-08-10T01:11:38.9470896Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:38.9471656Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:38.9472029Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9472775Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:38.9473523Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:38.9474510Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9475369Z --- END EXCEPTION ---
2025-08-10T01:11:38.9476401Z 2025-08-10 01:11:38,943 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9477671Z 2025-08-10 01:11:38,945 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:38.9478800Z Args: ('user-2', 'mcp-campaign-2')
2025-08-10T01:11:38.9479248Z Kwargs: {}
2025-08-10T01:11:38.9480513Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9481885Z Traceback:
2025-08-10T01:11:38.9482210Z Traceback (most recent call last):
2025-08-10T01:11:38.9483103Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:38.9483997Z     asyncio.get_running_loop()
2025-08-10T01:11:38.9484438Z RuntimeError: no running event loop
2025-08-10T01:11:38.9484763Z
2025-08-10T01:11:38.9485079Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:38.9485552Z
2025-08-10T01:11:38.9485729Z Traceback (most recent call last):
2025-08-10T01:11:38.9486653Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:38.9487561Z     return func(*args, **kwargs)
2025-08-10T01:11:38.9488305Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9490444Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:38.9492646Z     db = get_db()
2025-08-10T01:11:38.9493067Z          ^^^^^^^^
2025-08-10T01:11:38.9493938Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:38.9494921Z     return firestore.client()
2025-08-10T01:11:38.9495347Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9496465Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:38.9498060Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:38.9498828Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9500070Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:38.9501475Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:38.9502138Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9503391Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:38.9504554Z     self._services[name] = initializer(self)
2025-08-10T01:11:38.9505163Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9506284Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:38.9507455Z     credentials = app.credential.get_credential()
2025-08-10T01:11:38.9508260Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9509672Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:38.9510818Z     self._load_credential()
2025-08-10T01:11:38.9511998Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:38.9513424Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:38.9514086Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9515246Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:38.9516629Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:38.9518614Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9520255Z --- END EXCEPTION ---
2025-08-10T01:11:38.9524112Z 2025-08-10 01:11:38,945 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9526253Z 2025-08-10 01:11:38,948 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:38.9527015Z Args: ('user-1', 'mcp-campaign-1')
2025-08-10T01:11:38.9527457Z Kwargs: {}
2025-08-10T01:11:38.9528978Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9530235Z Traceback:
2025-08-10T01:11:38.9530585Z Traceback (most recent call last):
2025-08-10T01:11:38.9531557Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:38.9532443Z     asyncio.get_running_loop()
2025-08-10T01:11:38.9532880Z RuntimeError: no running event loop
2025-08-10T01:11:38.9533187Z
2025-08-10T01:11:38.9533500Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:38.9534012Z
2025-08-10T01:11:38.9534183Z Traceback (most recent call last):
2025-08-10T01:11:38.9535105Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:38.9535972Z     return func(*args, **kwargs)
2025-08-10T01:11:38.9536372Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9537445Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:38.9538660Z     db = get_db()
2025-08-10T01:11:38.9538992Z          ^^^^^^^^
2025-08-10T01:11:38.9539828Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:38.9540776Z     return firestore.client()
2025-08-10T01:11:38.9541184Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9542275Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:38.9543953Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:38.9544729Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9546023Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:38.9547439Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:38.9548332Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9549820Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:38.9551054Z     self._services[name] = initializer(self)
2025-08-10T01:11:38.9551534Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9552684Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:38.9553934Z     credentials = app.credential.get_credential()
2025-08-10T01:11:38.9554471Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9555765Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:38.9557007Z     self._load_credential()
2025-08-10T01:11:38.9558435Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:38.9559939Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:38.9560654Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9561860Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:38.9563300Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:38.9565183Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9566835Z --- END EXCEPTION ---
2025-08-10T01:11:38.9568926Z 2025-08-10 01:11:38,949 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9570863Z .2025-08-10 01:11:38,952 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:38.9572579Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:38.9574063Z   setup_file_logging()
2025-08-10T01:11:38.9574666Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:38.9618595Z 2025-08-10 01:11:38,961 - root - INFO - üéÆ LOADING GAME PAGE: user=mcp-edge-test-user, campaign=mcp-edge-test-campaign
2025-08-10T01:11:38.9646649Z 2025-08-10 01:11:38,964 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:38.9648374Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:38.9648805Z Kwargs: {}
2025-08-10T01:11:38.9649903Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9651065Z Traceback:
2025-08-10T01:11:38.9651384Z Traceback (most recent call last):
2025-08-10T01:11:38.9652226Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:38.9653346Z     asyncio.get_running_loop()
2025-08-10T01:11:38.9653801Z RuntimeError: no running event loop
2025-08-10T01:11:38.9654158Z
2025-08-10T01:11:38.9654493Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:38.9654978Z
2025-08-10T01:11:38.9655173Z Traceback (most recent call last):
2025-08-10T01:11:38.9656098Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:38.9656996Z     return func(*args, **kwargs)
2025-08-10T01:11:38.9657335Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9658318Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:38.9658866Z     db = get_db()
2025-08-10T01:11:38.9659050Z          ^^^^^^^^
2025-08-10T01:11:38.9659511Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:38.9660022Z     return firestore.client()
2025-08-10T01:11:38.9660239Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9660845Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:38.9661604Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:38.9662005Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9662666Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:38.9663416Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:38.9663785Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9664707Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:38.9666017Z     self._services[name] = initializer(self)
2025-08-10T01:11:38.9666499Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9668239Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:38.9669617Z     credentials = app.credential.get_credential()
2025-08-10T01:11:38.9670151Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9671425Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:38.9672634Z     self._load_credential()
2025-08-10T01:11:38.9673796Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:38.9675137Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:38.9675835Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9676895Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:38.9677687Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:38.9679168Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9680307Z --- END EXCEPTION ---
2025-08-10T01:11:38.9681353Z 2025-08-10 01:11:38,964 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9683223Z 2025-08-10 01:11:38,966 - root - ERROR - üî•üî¥ Failed to get user settings for user_979535: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9699782Z 2025-08-10 01:11:38,969 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_by_id ---
2025-08-10T01:11:38.9702022Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:38.9702582Z Kwargs: {}
2025-08-10T01:11:38.9703769Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9705246Z Traceback:
2025-08-10T01:11:38.9705597Z Traceback (most recent call last):
2025-08-10T01:11:38.9706477Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:38.9708630Z     asyncio.get_running_loop()
2025-08-10T01:11:38.9709090Z RuntimeError: no running event loop
2025-08-10T01:11:38.9709388Z
2025-08-10T01:11:38.9709702Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:38.9710150Z
2025-08-10T01:11:38.9710315Z Traceback (most recent call last):
2025-08-10T01:11:38.9711148Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:38.9711970Z     return func(*args, **kwargs)
2025-08-10T01:11:38.9712381Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9713376Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 470, in get_campaign_by_id
2025-08-10T01:11:38.9714409Z     db = get_db()
2025-08-10T01:11:38.9714727Z          ^^^^^^^^
2025-08-10T01:11:38.9715528Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:38.9716417Z     return firestore.client()
2025-08-10T01:11:38.9716811Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9718032Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:38.9719353Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:38.9720073Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9721264Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:38.9722609Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:38.9723256Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9724400Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:38.9725549Z     self._services[name] = initializer(self)
2025-08-10T01:11:38.9725990Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9727110Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:38.9728555Z     credentials = app.credential.get_credential()
2025-08-10T01:11:38.9729091Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9731484Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:38.9732742Z     self._load_credential()
2025-08-10T01:11:38.9734003Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:38.9735457Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:38.9736382Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9737554Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:38.9739196Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:38.9741062Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9742950Z --- END EXCEPTION ---
2025-08-10T01:11:38.9744830Z 2025-08-10 01:11:38,969 - root - ERROR - üî•üî¥ Failed to get campaign state: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9746771Z .2025-08-10 01:11:38,972 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:38.9751634Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:38.9753186Z   setup_file_logging()
2025-08-10T01:11:38.9753809Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:38.9827154Z .2025-08-10 01:11:38,982 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:38.9832992Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:38.9834502Z   setup_file_logging()
2025-08-10T01:11:38.9835131Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:38.9936894Z 2025-08-10 01:11:38,993 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:38.9942051Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:38.9942493Z Kwargs: {}
2025-08-10T01:11:38.9943629Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9944801Z Traceback:
2025-08-10T01:11:38.9945137Z Traceback (most recent call last):
2025-08-10T01:11:38.9946062Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:38.9946938Z     asyncio.get_running_loop()
2025-08-10T01:11:38.9947359Z RuntimeError: no running event loop
2025-08-10T01:11:38.9947657Z
2025-08-10T01:11:38.9948135Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:38.9948597Z
2025-08-10T01:11:38.9948762Z Traceback (most recent call last):
2025-08-10T01:11:38.9949632Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:38.9950475Z     return func(*args, **kwargs)
2025-08-10T01:11:38.9950868Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9951837Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:38.9952813Z     db = get_db()
2025-08-10T01:11:38.9953120Z          ^^^^^^^^
2025-08-10T01:11:38.9953933Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:38.9954842Z     return firestore.client()
2025-08-10T01:11:38.9955235Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9956300Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:38.9957651Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:38.9958746Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9959961Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:38.9961360Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:38.9962264Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9963495Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:38.9964969Z     self._services[name] = initializer(self)
2025-08-10T01:11:38.9965463Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9966656Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:38.9968122Z     credentials = app.credential.get_credential()
2025-08-10T01:11:38.9968640Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9969871Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:38.9971112Z     self._load_credential()
2025-08-10T01:11:38.9972358Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:38.9973805Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:38.9974525Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:38.9975756Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:38.9977189Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:38.9980252Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9981904Z --- END EXCEPTION ---
2025-08-10T01:11:38.9983779Z 2025-08-10 01:11:38,993 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:38.9985704Z .2025-08-10 01:11:38,996 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:38.9987463Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:38.9989097Z   setup_file_logging()
2025-08-10T01:11:38.9989720Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.0063453Z 2025-08-10 01:11:39,006 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.0070194Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.0070615Z Kwargs: {}
2025-08-10T01:11:39.0071703Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0073034Z Traceback:
2025-08-10T01:11:39.0073372Z Traceback (most recent call last):
2025-08-10T01:11:39.0074237Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.0075065Z     asyncio.get_running_loop()
2025-08-10T01:11:39.0075495Z RuntimeError: no running event loop
2025-08-10T01:11:39.0075791Z
2025-08-10T01:11:39.0076098Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.0076765Z
2025-08-10T01:11:39.0076926Z Traceback (most recent call last):
2025-08-10T01:11:39.0078004Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.0078889Z     return func(*args, **kwargs)
2025-08-10T01:11:39.0079287Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0080310Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.0081294Z     db = get_db()
2025-08-10T01:11:39.0081603Z          ^^^^^^^^
2025-08-10T01:11:39.0082636Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.0083544Z     return firestore.client()
2025-08-10T01:11:39.0083928Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0084971Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.0087458Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.0088429Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0089643Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.0091032Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.0091723Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0092976Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.0094278Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.0094766Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0095958Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.0097174Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.0097686Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0100448Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.0101707Z     self._load_credential()
2025-08-10T01:11:39.0102972Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.0104418Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.0105120Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0106346Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.0108189Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.0110078Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0111751Z --- END EXCEPTION ---
2025-08-10T01:11:39.0113640Z 2025-08-10 01:11:39,006 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0115597Z .2025-08-10 01:11:39,008 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.0117407Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.0119430Z   setup_file_logging()
2025-08-10T01:11:39.0120056Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.0189283Z 2025-08-10 01:11:39,018 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:39.0195363Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:39.0195898Z Kwargs: {}
2025-08-10T01:11:39.0197023Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0198796Z Traceback:
2025-08-10T01:11:39.0199140Z Traceback (most recent call last):
2025-08-10T01:11:39.0199991Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.0200839Z     asyncio.get_running_loop()
2025-08-10T01:11:39.0201287Z RuntimeError: no running event loop
2025-08-10T01:11:39.0201575Z
2025-08-10T01:11:39.0201869Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.0202332Z
2025-08-10T01:11:39.0202490Z Traceback (most recent call last):
2025-08-10T01:11:39.0203361Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.0204222Z     return func(*args, **kwargs)
2025-08-10T01:11:39.0204612Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0205594Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:39.0206576Z     db = get_db()
2025-08-10T01:11:39.0206892Z          ^^^^^^^^
2025-08-10T01:11:39.0207693Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.0208839Z     return firestore.client()
2025-08-10T01:11:39.0209223Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0210297Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.0211760Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.0212536Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0213787Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.0217264Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.0218170Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0219417Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.0220641Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.0221152Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0222345Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.0223566Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.0224095Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0225382Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.0226623Z     self._load_credential()
2025-08-10T01:11:39.0228113Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.0229549Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.0230245Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0231715Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.0233156Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.0234994Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0236639Z --- END EXCEPTION ---
2025-08-10T01:11:39.0238939Z 2025-08-10 01:11:39,018 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0240866Z .2025-08-10 01:11:39,021 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.0242660Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.0244177Z   setup_file_logging()
2025-08-10T01:11:39.0244772Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.0316336Z 2025-08-10 01:11:39,031 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_by_id ---
2025-08-10T01:11:39.0324465Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:39.0325004Z Kwargs: {}
2025-08-10T01:11:39.0326139Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0327550Z Traceback:
2025-08-10T01:11:39.0328073Z Traceback (most recent call last):
2025-08-10T01:11:39.0328927Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.0329780Z     asyncio.get_running_loop()
2025-08-10T01:11:39.0330204Z RuntimeError: no running event loop
2025-08-10T01:11:39.0330494Z
2025-08-10T01:11:39.0330790Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.0331244Z
2025-08-10T01:11:39.0331402Z Traceback (most recent call last):
2025-08-10T01:11:39.0332259Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.0333121Z     return func(*args, **kwargs)
2025-08-10T01:11:39.0333530Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0334515Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 470, in get_campaign_by_id
2025-08-10T01:11:39.0335465Z     db = get_db()
2025-08-10T01:11:39.0335784Z          ^^^^^^^^
2025-08-10T01:11:39.0336604Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.0337528Z     return firestore.client()
2025-08-10T01:11:39.0338168Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0339223Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.0340511Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.0341206Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0342407Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.0343820Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.0344545Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0345744Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.0347113Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.0347555Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0348833Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.0350032Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.0350511Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0351678Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.0352997Z     self._load_credential()
2025-08-10T01:11:39.0354121Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.0355438Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.0356072Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0357171Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.0358681Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.0360428Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0362080Z --- END EXCEPTION ---
2025-08-10T01:11:39.0363984Z 2025-08-10 01:11:39,031 - root - ERROR - üî•üî¥ Failed to export campaign: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0365932Z .2025-08-10 01:11:39,034 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.0367702Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.0369402Z   setup_file_logging()
2025-08-10T01:11:39.0369983Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.0443941Z .2025-08-10 01:11:39,044 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.0450299Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.0451799Z   setup_file_logging()
2025-08-10T01:11:39.0452435Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.0537168Z 2025-08-10 01:11:39,053 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_by_id ---
2025-08-10T01:11:39.0540132Z Args: ('mcp-edge-test-user', 'nonexistent-campaign')
2025-08-10T01:11:39.0540634Z Kwargs: {}
2025-08-10T01:11:39.0541738Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0543019Z Traceback:
2025-08-10T01:11:39.0543387Z Traceback (most recent call last):
2025-08-10T01:11:39.0544299Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.0545182Z     asyncio.get_running_loop()
2025-08-10T01:11:39.0545641Z RuntimeError: no running event loop
2025-08-10T01:11:39.0545954Z
2025-08-10T01:11:39.0546350Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.0547083Z
2025-08-10T01:11:39.0547249Z Traceback (most recent call last):
2025-08-10T01:11:39.0548308Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.0549182Z     return func(*args, **kwargs)
2025-08-10T01:11:39.0549573Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0550619Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 470, in get_campaign_by_id
2025-08-10T01:11:39.0551578Z     db = get_db()
2025-08-10T01:11:39.0551905Z          ^^^^^^^^
2025-08-10T01:11:39.0552742Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.0553851Z     return firestore.client()
2025-08-10T01:11:39.0554241Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0555307Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.0556679Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.0557414Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0558907Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.0560260Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.0560919Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0562084Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.0563253Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.0563745Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0564937Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.0566114Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.0566583Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0567931Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.0569097Z     self._load_credential()
2025-08-10T01:11:39.0570323Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.0571801Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.0572491Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0573699Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.0575166Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.0577025Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0578997Z --- END EXCEPTION ---
2025-08-10T01:11:39.0580944Z 2025-08-10 01:11:39,053 - root - ERROR - üî•üî¥ Failed to export campaign: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0582885Z .2025-08-10 01:11:39,056 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.0586034Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.0588849Z   setup_file_logging()
2025-08-10T01:11:39.0589426Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.0673171Z 2025-08-10 01:11:39,067 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:39.0675094Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:39.0675655Z Kwargs: {}
2025-08-10T01:11:39.0676834Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0678678Z Traceback:
2025-08-10T01:11:39.0679016Z Traceback (most recent call last):
2025-08-10T01:11:39.0679853Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.0680644Z     asyncio.get_running_loop()
2025-08-10T01:11:39.0681057Z RuntimeError: no running event loop
2025-08-10T01:11:39.0681362Z
2025-08-10T01:11:39.0681670Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.0682143Z
2025-08-10T01:11:39.0682328Z Traceback (most recent call last):
2025-08-10T01:11:39.0683245Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.0684106Z     return func(*args, **kwargs)
2025-08-10T01:11:39.0684485Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0685479Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:39.0686583Z     db = get_db()
2025-08-10T01:11:39.0686902Z          ^^^^^^^^
2025-08-10T01:11:39.0687888Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.0688810Z     return firestore.client()
2025-08-10T01:11:39.0689200Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0690271Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.0691611Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.0692334Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0693549Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.0694897Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.0695564Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0696764Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.0698120Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.0698575Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0699718Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.0700947Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.0701470Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0702649Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.0703776Z     self._load_credential()
2025-08-10T01:11:39.0704991Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.0706455Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.0707153Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0708878Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.0710350Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.0712222Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0713898Z --- END EXCEPTION ---
2025-08-10T01:11:39.0716018Z 2025-08-10 01:11:39,067 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.0718119Z .2025-08-10 01:11:39,070 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.0720279Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.0721693Z   setup_file_logging()
2025-08-10T01:11:39.0722300Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.0790355Z .2025-08-10 01:11:39,078 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.0795263Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.0796796Z   setup_file_logging()
2025-08-10T01:11:39.0797425Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.0854840Z 2025-08-10 01:11:39,085 - root - ERROR - üî•üî¥ Critical error in handle_interaction for campaign mcp-edge-test-campaign: 400 Bad Request: The browser (or proxy) sent a request that this server could not understand.
2025-08-10T01:11:39.0856716Z 2025-08-10 01:11:39,085 - root - ERROR - üî•üî¥ User input: N/A
2025-08-10T01:11:39.0970625Z 2025-08-10 01:11:39,096 - root - ERROR - üî•üî¥ Traceback (most recent call last):
2025-08-10T01:11:39.0972637Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/werkzeug/wrappers/request.py", line 611, in get_json
2025-08-10T01:11:39.0974216Z     rv = self.json_module.loads(data)
2025-08-10T01:11:39.0974779Z          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0976640Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/flask/json/provider.py", line 188, in loads
2025-08-10T01:11:39.0977676Z     return json.loads(s, **kwargs)
2025-08-10T01:11:39.0978237Z            ^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0978960Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/__init__.py", line 346, in loads
2025-08-10T01:11:39.0979790Z     return _default_decoder.decode(s)
2025-08-10T01:11:39.0980226Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0981842Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/decoder.py", line 337, in decode
2025-08-10T01:11:39.0982715Z     obj, end = self.raw_decode(s, idx=_w(s, 0).end())
2025-08-10T01:11:39.0983228Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0984132Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/decoder.py", line 355, in raw_decode
2025-08-10T01:11:39.0985405Z     raise JSONDecodeError("Expecting value", s, err.value) from None
2025-08-10T01:11:39.0986218Z json.decoder.JSONDecodeError: Expecting value: line 1 column 54 (char 53)
2025-08-10T01:11:39.0986727Z
2025-08-10T01:11:39.0987036Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.0987486Z
2025-08-10T01:11:39.0987647Z Traceback (most recent call last):
2025-08-10T01:11:39.0989270Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/flask/wrappers.py", line 130, in on_json_loading_failed
2025-08-10T01:11:39.0990478Z     return super().on_json_loading_failed(e)
2025-08-10T01:11:39.0990944Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.0992225Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/werkzeug/wrappers/request.py", line 645, in on_json_loading_failed
2025-08-10T01:11:39.0993602Z     raise BadRequest(f"Failed to decode JSON object: {e}")
2025-08-10T01:11:39.0994605Z werkzeug.exceptions.BadRequest: 400 Bad Request: Failed to decode JSON object: Expecting value: line 1 column 54 (char 53)
2025-08-10T01:11:39.0995362Z
2025-08-10T01:11:39.0995659Z The above exception was the direct cause of the following exception:
2025-08-10T01:11:39.0996116Z
2025-08-10T01:11:39.0996295Z Traceback (most recent call last):
2025-08-10T01:11:39.0997237Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 518, in handle_interaction
2025-08-10T01:11:39.0998503Z     data = request.get_json()
2025-08-10T01:11:39.0998929Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1000092Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/werkzeug/wrappers/request.py", line 620, in get_json
2025-08-10T01:11:39.1001314Z     rv = self.on_json_loading_failed(e)
2025-08-10T01:11:39.1001766Z          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1002985Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/flask/wrappers.py", line 135, in on_json_loading_failed
2025-08-10T01:11:39.1004239Z     raise BadRequest() from e
2025-08-10T01:11:39.1005136Z werkzeug.exceptions.BadRequest: 400 Bad Request: The browser (or proxy) sent a request that this server could not understand.
2025-08-10T01:11:39.1005912Z
2025-08-10T01:11:39.1008020Z .2025-08-10 01:11:39,099 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.1010171Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.1011987Z   setup_file_logging()
2025-08-10T01:11:39.1013417Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.1082525Z .2025-08-10 01:11:39,108 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.1084732Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.1086583Z   setup_file_logging()
2025-08-10T01:11:39.1087560Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.1177510Z 2025-08-10 01:11:39,117 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.1181241Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.1181679Z Kwargs: {}
2025-08-10T01:11:39.1182881Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1184187Z Traceback:
2025-08-10T01:11:39.1184544Z Traceback (most recent call last):
2025-08-10T01:11:39.1185445Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1186619Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1187074Z RuntimeError: no running event loop
2025-08-10T01:11:39.1187389Z
2025-08-10T01:11:39.1187693Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1188337Z
2025-08-10T01:11:39.1188504Z Traceback (most recent call last):
2025-08-10T01:11:39.1189419Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1190511Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1190837Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1191407Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.1191963Z     db = get_db()
2025-08-10T01:11:39.1192140Z          ^^^^^^^^
2025-08-10T01:11:39.1192596Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1193113Z     return firestore.client()
2025-08-10T01:11:39.1193332Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1193946Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.1194703Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.1195122Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1195785Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.1196514Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.1196891Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1197529Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.1198374Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.1198629Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1199267Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.1199916Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.1200201Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1200868Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.1201502Z     self._load_credential()
2025-08-10T01:11:39.1218864Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.1220381Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.1221106Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1222333Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.1223827Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.1225127Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1226113Z --- END EXCEPTION ---
2025-08-10T01:11:39.1228020Z 2025-08-10 01:11:39,117 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1268954Z 2025-08-10 01:11:39,121 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:39.1271209Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:39.1271767Z Kwargs: {}
2025-08-10T01:11:39.1272969Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1274484Z Traceback:
2025-08-10T01:11:39.1274853Z Traceback (most recent call last):
2025-08-10T01:11:39.1275758Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1276634Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1277082Z RuntimeError: no running event loop
2025-08-10T01:11:39.1277390Z
2025-08-10T01:11:39.1277976Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1278478Z
2025-08-10T01:11:39.1278654Z Traceback (most recent call last):
2025-08-10T01:11:39.1279572Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1280452Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1280882Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1281954Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:39.1282985Z     db = get_db()
2025-08-10T01:11:39.1283313Z          ^^^^^^^^
2025-08-10T01:11:39.1284137Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1285093Z     return firestore.client()
2025-08-10T01:11:39.1285501Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1286645Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.1288445Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.1289226Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1290465Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.1291914Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.1292628Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1293855Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.1295094Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.1295578Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1296780Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.1298262Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.1298783Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1300010Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.1301265Z     self._load_credential()
2025-08-10T01:11:39.1302535Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.1304012Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.1304701Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1305869Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.1307322Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.1309630Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1311276Z --- END EXCEPTION ---
2025-08-10T01:11:39.1313152Z 2025-08-10 01:11:39,121 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1316557Z 2025-08-10 01:11:39,124 - root - ERROR - üî•üî¥ Failed to get user settings for user_979535: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1318742Z .2025-08-10 01:11:39,126 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.1320512Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.1322004Z   setup_file_logging()
2025-08-10T01:11:39.1322608Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.1345183Z 2025-08-10 01:11:39,134 - root - ERROR - üî•üî¥ Critical error in handle_interaction for campaign mcp-edge-test-campaign: 400 Bad Request: The browser (or proxy) sent a request that this server could not understand.
2025-08-10T01:11:39.1347628Z 2025-08-10 01:11:39,134 - root - ERROR - üî•üî¥ User input: N/A
2025-08-10T01:11:39.1353049Z 2025-08-10 01:11:39,135 - root - ERROR - üî•üî¥ Traceback (most recent call last):
2025-08-10T01:11:39.1355182Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1356112Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1356565Z RuntimeError: no running event loop
2025-08-10T01:11:39.1356881Z
2025-08-10T01:11:39.1357214Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1357695Z
2025-08-10T01:11:39.1358185Z Traceback (most recent call last):
2025-08-10T01:11:39.1359420Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/werkzeug/wrappers/request.py", line 611, in get_json
2025-08-10T01:11:39.1360693Z     rv = self.json_module.loads(data)
2025-08-10T01:11:39.1361170Z          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1362315Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/flask/json/provider.py", line 188, in loads
2025-08-10T01:11:39.1363458Z     return json.loads(s, **kwargs)
2025-08-10T01:11:39.1363908Z            ^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1364733Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/__init__.py", line 346, in loads
2025-08-10T01:11:39.1365607Z     return _default_decoder.decode(s)
2025-08-10T01:11:39.1366065Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1366895Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/decoder.py", line 337, in decode
2025-08-10T01:11:39.1368035Z     obj, end = self.raw_decode(s, idx=_w(s, 0).end())
2025-08-10T01:11:39.1368581Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1369465Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/json/decoder.py", line 353, in raw_decode
2025-08-10T01:11:39.1369964Z     obj, end = self.scan_once(s, idx)
2025-08-10T01:11:39.1370205Z                ^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1370580Z json.decoder.JSONDecodeError: Expecting ',' delimiter: line 1 column 28 (char 27)
2025-08-10T01:11:39.1370962Z
2025-08-10T01:11:39.1371141Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1371404Z
2025-08-10T01:11:39.1371681Z Traceback (most recent call last):
2025-08-10T01:11:39.1372591Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/flask/wrappers.py", line 130, in on_json_loading_failed
2025-08-10T01:11:39.1373440Z     return super().on_json_loading_failed(e)
2025-08-10T01:11:39.1373759Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1374627Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/werkzeug/wrappers/request.py", line 645, in on_json_loading_failed
2025-08-10T01:11:39.1375387Z     raise BadRequest(f"Failed to decode JSON object: {e}")
2025-08-10T01:11:39.1375960Z werkzeug.exceptions.BadRequest: 400 Bad Request: Failed to decode JSON object: Expecting ',' delimiter: line 1 column 28 (char 27)
2025-08-10T01:11:39.1376395Z
2025-08-10T01:11:39.1376572Z The above exception was the direct cause of the following exception:
2025-08-10T01:11:39.1376827Z
2025-08-10T01:11:39.1376918Z Traceback (most recent call last):
2025-08-10T01:11:39.1377595Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 518, in handle_interaction
2025-08-10T01:11:39.1378559Z     data = request.get_json()
2025-08-10T01:11:39.1378906Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1379516Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/werkzeug/wrappers/request.py", line 620, in get_json
2025-08-10T01:11:39.1380161Z     rv = self.on_json_loading_failed(e)
2025-08-10T01:11:39.1380405Z          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1381033Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/flask/wrappers.py", line 135, in on_json_loading_failed
2025-08-10T01:11:39.1381663Z     raise BadRequest() from e
2025-08-10T01:11:39.1382144Z werkzeug.exceptions.BadRequest: 400 Bad Request: The browser (or proxy) sent a request that this server could not understand.
2025-08-10T01:11:39.1382569Z
2025-08-10T01:11:39.1398076Z 2025-08-10 01:11:39,139 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:39.1399967Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:39.1400530Z Kwargs: {}
2025-08-10T01:11:39.1401731Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1403043Z Traceback:
2025-08-10T01:11:39.1403401Z Traceback (most recent call last):
2025-08-10T01:11:39.1404279Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1405093Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1405494Z RuntimeError: no running event loop
2025-08-10T01:11:39.1405774Z
2025-08-10T01:11:39.1406084Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1406530Z
2025-08-10T01:11:39.1406685Z Traceback (most recent call last):
2025-08-10T01:11:39.1407669Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1408801Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1409215Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1410224Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:39.1411216Z     db = get_db()
2025-08-10T01:11:39.1411528Z          ^^^^^^^^
2025-08-10T01:11:39.1412339Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1413224Z     return firestore.client()
2025-08-10T01:11:39.1413620Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1414685Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.1416040Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.1416978Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1418399Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.1419784Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.1420621Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1421832Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.1423025Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.1423508Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1424691Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.1425939Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.1426456Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1427953Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.1429223Z     self._load_credential()
2025-08-10T01:11:39.1430463Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.1431898Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.1432594Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1433807Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.1435267Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.1437125Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1438936Z --- END EXCEPTION ---
2025-08-10T01:11:39.1440807Z 2025-08-10 01:11:39,139 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1442973Z .2025-08-10 01:11:39,142 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.1444765Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.1447479Z   setup_file_logging()
2025-08-10T01:11:39.1449138Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.1602764Z 2025-08-10 01:11:39,160 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaign_game_state ---
2025-08-10T01:11:39.1604714Z Args: ('mcp-edge-test-user', 'mcp-edge-test-campaign')
2025-08-10T01:11:39.1605263Z Kwargs: {}
2025-08-10T01:11:39.1606462Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1607892Z Traceback:
2025-08-10T01:11:39.1608334Z Traceback (most recent call last):
2025-08-10T01:11:39.1609189Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1610032Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1610452Z RuntimeError: no running event loop
2025-08-10T01:11:39.1610762Z
2025-08-10T01:11:39.1611346Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1611792Z
2025-08-10T01:11:39.1611956Z Traceback (most recent call last):
2025-08-10T01:11:39.1612802Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1613646Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1614278Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1615320Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 939, in get_campaign_game_state
2025-08-10T01:11:39.1616294Z     db = get_db()
2025-08-10T01:11:39.1616600Z          ^^^^^^^^
2025-08-10T01:11:39.1617290Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1618353Z     return firestore.client()
2025-08-10T01:11:39.1618731Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1619880Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.1621214Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.1621931Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1623120Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.1624444Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.1625077Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1626206Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.1627355Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.1627987Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1629141Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.1630297Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.1630788Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1631971Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.1633143Z     self._load_credential()
2025-08-10T01:11:39.1634315Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.1635680Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.1636346Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1637489Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.1639138Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.1640994Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1642881Z --- END EXCEPTION ---
2025-08-10T01:11:39.1644727Z 2025-08-10 01:11:39,160 - root - ERROR - üî•üî¥ Process action failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1646924Z .2025-08-10 01:11:39,163 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.1648914Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.1651924Z   setup_file_logging()
2025-08-10T01:11:39.1653355Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.1731066Z 2025-08-10 01:11:39,172 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.1733087Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.1733516Z Kwargs: {}
2025-08-10T01:11:39.1734718Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1736020Z Traceback:
2025-08-10T01:11:39.1736380Z Traceback (most recent call last):
2025-08-10T01:11:39.1737288Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1738424Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1738892Z RuntimeError: no running event loop
2025-08-10T01:11:39.1739210Z
2025-08-10T01:11:39.1739532Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1740019Z
2025-08-10T01:11:39.1740206Z Traceback (most recent call last):
2025-08-10T01:11:39.1740808Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1741330Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1741564Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1742209Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.1743008Z     db = get_db()
2025-08-10T01:11:39.1743323Z          ^^^^^^^^
2025-08-10T01:11:39.1743800Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1744346Z     return firestore.client()
2025-08-10T01:11:39.1744598Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1745191Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.1745935Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.1746341Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1747021Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.1747953Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.1748333Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1748977Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.1749624Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.1749874Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1750488Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.1751123Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.1751403Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1752052Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.1752696Z     self._load_credential()
2025-08-10T01:11:39.1753333Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.1754080Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.1754647Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1755318Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.1756065Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.1757308Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1759145Z --- END EXCEPTION ---
2025-08-10T01:11:39.1761033Z 2025-08-10 01:11:39,173 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1767181Z 2025-08-10 01:11:39,176 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.1769242Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.1769678Z Kwargs: {}
2025-08-10T01:11:39.1770869Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1772213Z Traceback:
2025-08-10T01:11:39.1772565Z Traceback (most recent call last):
2025-08-10T01:11:39.1773472Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1774364Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1774815Z RuntimeError: no running event loop
2025-08-10T01:11:39.1775143Z
2025-08-10T01:11:39.1775467Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1775960Z
2025-08-10T01:11:39.1776137Z Traceback (most recent call last):
2025-08-10T01:11:39.1776748Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1777247Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1777552Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1778307Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.1779249Z     db = get_db()
2025-08-10T01:11:39.1779519Z          ^^^^^^^^
2025-08-10T01:11:39.1779986Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1780487Z     return firestore.client()
2025-08-10T01:11:39.1780708Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1781291Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.1782034Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.1782439Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1783109Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.1783847Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.1784215Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1784851Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.1785479Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.1785731Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1786331Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.1786973Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.1787437Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1788328Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.1788975Z     self._load_credential()
2025-08-10T01:11:39.1789609Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.1790542Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.1790909Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1791535Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.1792270Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.1793256Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1794115Z --- END EXCEPTION ---
2025-08-10T01:11:39.1795962Z 2025-08-10 01:11:39,176 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1803791Z 2025-08-10 01:11:39,180 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.1805560Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.1805998Z Kwargs: {}
2025-08-10T01:11:39.1807190Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1808769Z Traceback:
2025-08-10T01:11:39.1809127Z Traceback (most recent call last):
2025-08-10T01:11:39.1810036Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1810918Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1811375Z RuntimeError: no running event loop
2025-08-10T01:11:39.1811690Z
2025-08-10T01:11:39.1812026Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1812520Z
2025-08-10T01:11:39.1812701Z Traceback (most recent call last):
2025-08-10T01:11:39.1813314Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1813816Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1814108Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1815227Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.1815875Z     db = get_db()
2025-08-10T01:11:39.1816068Z          ^^^^^^^^
2025-08-10T01:11:39.1816523Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1817039Z     return firestore.client()
2025-08-10T01:11:39.1817266Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1818060Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.1818824Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.1819226Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1819893Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.1820633Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.1821181Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1821820Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.1822456Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.1822716Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1823464Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.1824101Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.1824377Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1825026Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.1825662Z     self._load_credential()
2025-08-10T01:11:39.1826285Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.1827030Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.1827394Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1828267Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.1829024Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.1830003Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1830849Z --- END EXCEPTION ---
2025-08-10T01:11:39.1832249Z 2025-08-10 01:11:39,180 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1840990Z 2025-08-10 01:11:39,183 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.1842772Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.1843220Z Kwargs: {}
2025-08-10T01:11:39.1844415Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1845684Z Traceback:
2025-08-10T01:11:39.1846034Z Traceback (most recent call last):
2025-08-10T01:11:39.1846938Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1847992Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1848454Z RuntimeError: no running event loop
2025-08-10T01:11:39.1848900Z
2025-08-10T01:11:39.1849241Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1849739Z
2025-08-10T01:11:39.1849918Z Traceback (most recent call last):
2025-08-10T01:11:39.1851138Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1851695Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1851935Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1852563Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.1853545Z     db = get_db()
2025-08-10T01:11:39.1853747Z          ^^^^^^^^
2025-08-10T01:11:39.1854301Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1854803Z     return firestore.client()
2025-08-10T01:11:39.1855023Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1855616Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.1856549Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.1856967Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1857622Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.1858739Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.1859109Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1859761Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.1860396Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.1860649Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1861267Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.1861896Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.1862171Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1862822Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.1863464Z     self._load_credential()
2025-08-10T01:11:39.1864112Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.1864861Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.1865225Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1865855Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.1866995Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.1869157Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1870916Z --- END EXCEPTION ---
2025-08-10T01:11:39.1872773Z 2025-08-10 01:11:39,184 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1877029Z 2025-08-10 01:11:39,187 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.1879038Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.1879484Z Kwargs: {}
2025-08-10T01:11:39.1880675Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1881983Z Traceback:
2025-08-10T01:11:39.1882336Z Traceback (most recent call last):
2025-08-10T01:11:39.1883240Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1884142Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1884595Z RuntimeError: no running event loop
2025-08-10T01:11:39.1884914Z
2025-08-10T01:11:39.1885237Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1885730Z
2025-08-10T01:11:39.1885904Z Traceback (most recent call last):
2025-08-10T01:11:39.1886506Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1886991Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1887459Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1888472Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.1889190Z     db = get_db()
2025-08-10T01:11:39.1889437Z          ^^^^^^^^
2025-08-10T01:11:39.1889893Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1890587Z     return firestore.client()
2025-08-10T01:11:39.1890808Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1891406Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.1892148Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.1892544Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1893203Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.1893936Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.1894312Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1894947Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.1895587Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.1895841Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1896447Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.1897075Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.1897349Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1898281Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.1898934Z     self._load_credential()
2025-08-10T01:11:39.1899576Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.1900331Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.1900695Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1901350Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.1902100Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.1903473Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1905138Z --- END EXCEPTION ---
2025-08-10T01:11:39.1906999Z 2025-08-10 01:11:39,187 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1912944Z 2025-08-10 01:11:39,191 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.1914712Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.1915134Z Kwargs: {}
2025-08-10T01:11:39.1916324Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1917610Z Traceback:
2025-08-10T01:11:39.1918185Z Traceback (most recent call last):
2025-08-10T01:11:39.1919360Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1920251Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1920714Z RuntimeError: no running event loop
2025-08-10T01:11:39.1921027Z
2025-08-10T01:11:39.1921361Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1921846Z
2025-08-10T01:11:39.1922208Z Traceback (most recent call last):
2025-08-10T01:11:39.1922739Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1923345Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1923572Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1924261Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.1925186Z     db = get_db()
2025-08-10T01:11:39.1925372Z          ^^^^^^^^
2025-08-10T01:11:39.1925825Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1926325Z     return firestore.client()
2025-08-10T01:11:39.1926549Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1927131Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.1928103Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.1928512Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1929173Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.1929923Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.1930291Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1930932Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.1931576Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.1931834Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1932445Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.1933086Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.1933359Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1934008Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.1934647Z     self._load_credential()
2025-08-10T01:11:39.1935296Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.1936042Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.1936405Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1937025Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.1937950Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.1939036Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1940657Z --- END EXCEPTION ---
2025-08-10T01:11:39.1942725Z 2025-08-10 01:11:39,191 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1949230Z 2025-08-10 01:11:39,194 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.1951061Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.1951500Z Kwargs: {}
2025-08-10T01:11:39.1952698Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1954276Z Traceback:
2025-08-10T01:11:39.1954636Z Traceback (most recent call last):
2025-08-10T01:11:39.1955528Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1956420Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1956878Z RuntimeError: no running event loop
2025-08-10T01:11:39.1957198Z
2025-08-10T01:11:39.1957526Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1958306Z
2025-08-10T01:11:39.1958487Z Traceback (most recent call last):
2025-08-10T01:11:39.1959196Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1959700Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1959936Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1960578Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.1961279Z     db = get_db()
2025-08-10T01:11:39.1961601Z          ^^^^^^^^
2025-08-10T01:11:39.1962227Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1962718Z     return firestore.client()
2025-08-10T01:11:39.1962947Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1963535Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.1964279Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.1964675Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1965332Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.1966066Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.1966433Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1967077Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.1967880Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.1968170Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1968783Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.1969439Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.1969705Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1970351Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.1970996Z     self._load_credential()
2025-08-10T01:11:39.1971661Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.1972407Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.1972771Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1973393Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.1974695Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.1976773Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1978825Z --- END EXCEPTION ---
2025-08-10T01:11:39.1980698Z 2025-08-10 01:11:39,194 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1985074Z 2025-08-10 01:11:39,198 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.1986837Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.1987272Z Kwargs: {}
2025-08-10T01:11:39.1988659Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.1990003Z Traceback:
2025-08-10T01:11:39.1990362Z Traceback (most recent call last):
2025-08-10T01:11:39.1991262Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.1992158Z     asyncio.get_running_loop()
2025-08-10T01:11:39.1992616Z RuntimeError: no running event loop
2025-08-10T01:11:39.1992930Z
2025-08-10T01:11:39.1993256Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.1993744Z
2025-08-10T01:11:39.1993926Z Traceback (most recent call last):
2025-08-10T01:11:39.1994523Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.1995111Z     return func(*args, **kwargs)
2025-08-10T01:11:39.1995342Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1996313Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.1997071Z     db = get_db()
2025-08-10T01:11:39.1997249Z          ^^^^^^^^
2025-08-10T01:11:39.1997694Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.1998455Z     return firestore.client()
2025-08-10T01:11:39.1998681Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.1999265Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.2000011Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.2000415Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2001068Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.2001807Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.2002177Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2002831Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.2003466Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.2003723Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2004334Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.2004971Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.2005252Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2005930Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.2006770Z     self._load_credential()
2025-08-10T01:11:39.2007411Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.2008337Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.2008822Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2009752Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.2011301Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.2013529Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.2015173Z --- END EXCEPTION ---
2025-08-10T01:11:39.2017030Z 2025-08-10 01:11:39,198 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.2019852Z 2025-08-10 01:11:39,201 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.2020623Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.2021044Z Kwargs: {}
2025-08-10T01:11:39.2022233Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.2023602Z Traceback:
2025-08-10T01:11:39.2023964Z Traceback (most recent call last):
2025-08-10T01:11:39.2024865Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.2025767Z     asyncio.get_running_loop()
2025-08-10T01:11:39.2026229Z RuntimeError: no running event loop
2025-08-10T01:11:39.2026546Z
2025-08-10T01:11:39.2026868Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.2027346Z
2025-08-10T01:11:39.2027526Z Traceback (most recent call last):
2025-08-10T01:11:39.2028646Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.2029555Z     return func(*args, **kwargs)
2025-08-10T01:11:39.2030035Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2030741Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.2031495Z     db = get_db()
2025-08-10T01:11:39.2032218Z          ^^^^^^^^
2025-08-10T01:11:39.2033147Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.2033681Z     return firestore.client()
2025-08-10T01:11:39.2033917Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2034534Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.2035310Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.2035723Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2036413Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.2037167Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.2037545Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2038472Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.2039548Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.2040020Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2040922Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.2041711Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.2042330Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2043294Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.2044055Z     self._load_credential()
2025-08-10T01:11:39.2044969Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.2045919Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.2046430Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2047947Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.2049558Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.2052940Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.2055447Z --- END EXCEPTION ---
2025-08-10T01:11:39.2057332Z 2025-08-10 01:11:39,202 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.2059762Z 2025-08-10 01:11:39,205 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.2060710Z Args: ('mcp-edge-test-user',)
2025-08-10T01:11:39.2061239Z Kwargs: {}
2025-08-10T01:11:39.2062503Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.2064008Z Traceback:
2025-08-10T01:11:39.2064473Z Traceback (most recent call last):
2025-08-10T01:11:39.2065372Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.2067445Z     asyncio.get_running_loop()
2025-08-10T01:11:39.2068144Z RuntimeError: no running event loop
2025-08-10T01:11:39.2069431Z
2025-08-10T01:11:39.2069784Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.2071043Z
2025-08-10T01:11:39.2071225Z Traceback (most recent call last):
2025-08-10T01:11:39.2072213Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.2073081Z     return func(*args, **kwargs)
2025-08-10T01:11:39.2073465Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2074445Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.2075429Z     db = get_db()
2025-08-10T01:11:39.2075738Z          ^^^^^^^^
2025-08-10T01:11:39.2076525Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.2077380Z     return firestore.client()
2025-08-10T01:11:39.2078017Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2079104Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.2080443Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.2081386Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2082594Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.2083916Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.2084767Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2085939Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.2087090Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.2087560Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2088835Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.2090032Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.2090539Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2091749Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.2092967Z     self._load_credential()
2025-08-10T01:11:39.2094177Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.2095628Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.2096307Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2097449Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.2099062Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.2100952Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.2102592Z --- END EXCEPTION ---
2025-08-10T01:11:39.2104438Z 2025-08-10 01:11:39,205 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.2106477Z .2025-08-10 01:11:39,208 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:39.2109272Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:39.2110758Z   setup_file_logging()
2025-08-10T01:11:39.2111374Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:39.2215554Z 2025-08-10 01:11:39,221 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:39.2217403Z Args: ('user-with-special-chars!@#$%^&*()',)
2025-08-10T01:11:39.2218119Z Kwargs: {}
2025-08-10T01:11:39.2219327Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.2220632Z Traceback:
2025-08-10T01:11:39.2220969Z Traceback (most recent call last):
2025-08-10T01:11:39.2221786Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:39.2222566Z     asyncio.get_running_loop()
2025-08-10T01:11:39.2222960Z RuntimeError: no running event loop
2025-08-10T01:11:39.2223257Z
2025-08-10T01:11:39.2223568Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:39.2224280Z
2025-08-10T01:11:39.2224431Z Traceback (most recent call last):
2025-08-10T01:11:39.2225222Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:39.2225983Z     return func(*args, **kwargs)
2025-08-10T01:11:39.2226331Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2227221Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:39.2228496Z     db = get_db()
2025-08-10T01:11:39.2228771Z          ^^^^^^^^
2025-08-10T01:11:39.2229485Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:39.2230295Z     return firestore.client()
2025-08-10T01:11:39.2230637Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2231579Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:39.2232780Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:39.2233432Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2234500Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:39.2235756Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:39.2236325Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2237365Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:39.2238616Z     self._services[name] = initializer(self)
2025-08-10T01:11:39.2239016Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2240004Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:39.2241063Z     credentials = app.credential.get_credential()
2025-08-10T01:11:39.2241498Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2242554Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:39.2243589Z     self._load_credential()
2025-08-10T01:11:39.2244623Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:39.2245884Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:39.2246470Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:39.2247453Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:39.2248832Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:39.2250443Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.2251834Z --- END EXCEPTION ---
2025-08-10T01:11:39.2253402Z 2025-08-10 01:11:39,221 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:39.2254970Z .
2025-08-10T01:11:39.2255362Z ----------------------------------------------------------------------
2025-08-10T01:11:39.2256541Z Ran 19 tests in 1.287s
2025-08-10T01:11:39.2256750Z
2025-08-10T01:11:39.2256941Z OK
2025-08-10T01:11:39.4384732Z ‚úÖ PASS: tests/test_main_route_edge_cases.py
2025-08-10T01:11:39.4385932Z ----------------------------------------
2025-08-10T01:11:39.4386158Z Running: tests/test_main_security_validation.py
2025-08-10T01:11:39.5887965Z .........../opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/zipfile.py:1567: UserWarning: Duplicate name: 'file1.txt'
2025-08-10T01:11:39.5890334Z   return self._open_to_write(zinfo, force_zip64=force_zip64)
2025-08-10T01:11:39.5981584Z .................
2025-08-10T01:11:39.5983046Z ----------------------------------------------------------------------
2025-08-10T01:11:39.5983560Z Ran 28 tests in 0.024s
2025-08-10T01:11:39.5983769Z
2025-08-10T01:11:39.5983885Z OK
2025-08-10T01:11:39.6238971Z ‚úÖ PASS: tests/test_main_security_validation.py
2025-08-10T01:11:39.6240436Z ----------------------------------------
2025-08-10T01:11:39.6240919Z Running: tests/test_main_state_helper.py
2025-08-10T01:11:39.9586975Z 2025-08-10 01:11:39,958 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:40.8832325Z 2025-08-10 01:11:40,883 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:40.8837126Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:40.8839392Z   setup_file_logging()
2025-08-10T01:11:40.8840514Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:40.8917026Z .2025-08-10 01:11:40,891 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:40.8919510Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:40.8921365Z   setup_file_logging()
2025-08-10T01:11:40.8922265Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:40.8996997Z .2025-08-10 01:11:40,899 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:40.8999064Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:40.9000572Z   setup_file_logging()
2025-08-10T01:11:40.9001200Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:40.9075555Z .2025-08-10 01:11:40,907 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:40.9083097Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:40.9084623Z   setup_file_logging()
2025-08-10T01:11:40.9085247Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:40.9154332Z .2025-08-10 01:11:40,915 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:40.9160045Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:40.9161576Z   setup_file_logging()
2025-08-10T01:11:40.9162210Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:40.9225144Z .....s.......
2025-08-10T01:11:40.9227277Z ----------------------------------------------------------------------
2025-08-10T01:11:40.9230421Z Ran 17 tests in 0.041s
2025-08-10T01:11:40.9230644Z
2025-08-10T01:11:40.9238979Z OK (skipped=1)
2025-08-10T01:11:41.1381147Z ‚úÖ PASS: tests/test_main_state_helper.py
2025-08-10T01:11:41.1382613Z ----------------------------------------
2025-08-10T01:11:41.1383169Z Running: tests/test_main_structured_response_building.py
2025-08-10T01:11:41.2046801Z .......
2025-08-10T01:11:41.2047951Z ----------------------------------------------------------------------
2025-08-10T01:11:41.2048684Z Ran 7 tests in 0.003s
2025-08-10T01:11:41.2048910Z
2025-08-10T01:11:41.2049037Z OK
2025-08-10T01:11:41.2157662Z ‚úÖ PASS: tests/test_main_structured_response_building.py
2025-08-10T01:11:41.2160106Z ----------------------------------------
2025-08-10T01:11:41.2160589Z Running: tests/test_memory_integration.py
2025-08-10T01:11:41.2823140Z .Memory MCP search error: MCP unavailable
2025-08-10T01:11:41.2832093Z .....Attempted to search Memory MCP for 'test' - This is not possible from Python runtime. See CLAUDE_MD_MEMORY_ENHANCEMENT.md for the correct approach.
2025-08-10T01:11:41.2833993Z Attempted to search Memory MCP for 'pattern' - This is not possible from Python runtime. See CLAUDE_MD_MEMORY_ENHANCEMENT.md for the correct approach.
2025-08-10T01:11:41.2835288Z .
2025-08-10T01:11:41.2835780Z ----------------------------------------------------------------------
2025-08-10T01:11:41.2836336Z Ran 7 tests in 0.002s
2025-08-10T01:11:41.2836551Z
2025-08-10T01:11:41.2836666Z OK
2025-08-10T01:11:41.2935883Z ‚úÖ PASS: tests/test_memory_integration.py
2025-08-10T01:11:41.2937176Z ----------------------------------------
2025-08-10T01:11:41.2938059Z Running: tests/test_memory_leak_fixes_verification.py
2025-08-10T01:11:41.3103027Z ============================================================
2025-08-10T01:11:41.3103819Z CAMPAIGNCREATIONV2 MEMORY LEAK FIXES VERIFICATION
2025-08-10T01:11:41.3105579Z ============================================================
2025-08-10T01:11:41.3105916Z
2025-08-10T01:11:41.3106288Z üîç Verifying component structure...
2025-08-10T01:11:41.3106791Z ‚úÖ useState imported correctly
2025-08-10T01:11:41.3107254Z ‚úÖ useEffect imported correctly
2025-08-10T01:11:41.3107696Z ‚úÖ useRef imported correctly
2025-08-10T01:11:41.3111270Z ‚úÖ Component properly exported
2025-08-10T01:11:41.3111868Z üîç Verifying memory leak fixes in CampaignCreationV2...
2025-08-10T01:11:41.3112517Z ‚úÖ 1. progressIntervalRef properly declared
2025-08-10T01:11:41.3113090Z ‚úÖ 2. completionTimeoutRef properly declared
2025-08-10T01:11:41.3113624Z ‚úÖ 3. clearAllTimers helper function exists
2025-08-10T01:11:41.3114132Z ‚úÖ 4. useEffect cleanup calls clearAllTimers
2025-08-10T01:11:41.3114694Z ‚úÖ 5. progressInterval stored in ref for cleanup
2025-08-10T01:11:41.3115351Z ‚úÖ 6. timeout properly cleared in error handling using ref
2025-08-10T01:11:41.3115971Z ‚úÖ 7. progressInterval cleared on error
2025-08-10T01:11:41.3116546Z ‚úÖ 8. Completion message improved for better UX
2025-08-10T01:11:41.3117269Z ‚úÖ 9. Auto-retry timeout properly cleaned up before setting new one
2025-08-10T01:11:41.3118206Z ‚úÖ 10. Promise-based completion timeout with proper tracking
2025-08-10T01:11:41.3118610Z
2025-08-10T01:11:41.3118885Z üéâ All memory leak fixes verified successfully!
2025-08-10T01:11:41.3119230Z
2025-08-10T01:11:41.3119395Z Summary of fixes implemented:
2025-08-10T01:11:41.3119931Z - Added refs for all timer types (timeout, interval, completion)
2025-08-10T01:11:41.3120520Z - Created clearAllTimers helper function
2025-08-10T01:11:41.3120997Z - Added comprehensive cleanup in useEffect
2025-08-10T01:11:41.3121523Z - Fixed timeout scope and cleanup in error handling
2025-08-10T01:11:41.3122185Z - Improved completion flow to prevent component unmount interruption
2025-08-10T01:11:41.3122884Z - Added auto-retry timeout cleanup before setting new one
2025-08-10T01:11:41.3123504Z - Enhanced completion message for better user experience
2025-08-10T01:11:41.3123876Z
2025-08-10T01:11:41.3124028Z ============================================================
2025-08-10T01:11:41.3124664Z ‚úÖ ALL TESTS PASSED - MEMORY LEAKS SUCCESSFULLY FIXED!
2025-08-10T01:11:41.3125180Z ============================================================
2025-08-10T01:11:41.3137136Z ‚úÖ PASS: tests/test_memory_leak_fixes_verification.py
2025-08-10T01:11:41.3138242Z ----------------------------------------
2025-08-10T01:11:41.3139472Z Running: tests/test_milestone_4_interactive_features.py
2025-08-10T01:11:41.3545471Z üöÄ Starting Milestone 4: Interactive Features Test Suite
2025-08-10T01:11:41.3546668Z ============================================================
2025-08-10T01:11:41.3548002Z üß™ Testing Milestone 4: Interactive Features
2025-08-10T01:11:41.3548742Z ============================================================
2025-08-10T01:11:41.3550154Z test_accessibility_features (__main__.TestMilestone4InteractiveFeatures.test_accessibility_features)
2025-08-10T01:11:41.3556502Z Test that interactive features maintain accessibility ... ‚úÖ Interactive features maintain accessibility standards
2025-08-10T01:11:41.3557379Z ok
2025-08-10T01:11:41.3558445Z test_backward_compatibility (__main__.TestMilestone4InteractiveFeatures.test_backward_compatibility)
2025-08-10T01:11:41.3566565Z Test that features maintain backward compatibility ... ‚úÖ All features maintain backward compatibility
2025-08-10T01:11:41.3570648Z ok
2025-08-10T01:11:41.3571479Z test_campaign_wizard_html_structure (__main__.TestMilestone4InteractiveFeatures.test_campaign_wizard_html_structure)
2025-08-10T01:11:41.3573010Z Test campaign wizard generates proper HTML structure ... ‚úÖ Campaign wizard generates proper HTML structure
2025-08-10T01:11:41.3573794Z ok
2025-08-10T01:11:41.3574668Z test_campaign_wizard_js_exists (__main__.TestMilestone4InteractiveFeatures.test_campaign_wizard_js_exists)
2025-08-10T01:11:41.3579812Z Test that campaign wizard JavaScript file exists ... ‚úÖ Campaign Wizard JavaScript file exists and contains core functionality
2025-08-10T01:11:41.3582969Z ok
2025-08-10T01:11:41.3585600Z test_css_modern_mode_selectors (__main__.TestMilestone4InteractiveFeatures.test_css_modern_mode_selectors)
2025-08-10T01:11:41.3589172Z Test CSS has proper modern mode selectors ... ‚úÖ CSS has proper modern mode selectors and responsive design
2025-08-10T01:11:41.3589961Z ok
2025-08-10T01:11:41.3590646Z test_css_theme_integration (__main__.TestMilestone4InteractiveFeatures.test_css_theme_integration)
2025-08-10T01:11:41.3592080Z Test CSS integrates properly with existing theme system ... ‚úÖ CSS integrates properly with existing theme system
2025-08-10T01:11:41.3592945Z ok
2025-08-10T01:11:41.3593662Z test_enhanced_search_features (__main__.TestMilestone4InteractiveFeatures.test_enhanced_search_features)
2025-08-10T01:11:41.3594927Z Test enhanced search has all required features ... ‚úÖ Enhanced search has all required features
2025-08-10T01:11:41.3595657Z ok
2025-08-10T01:11:41.3596349Z test_enhanced_search_js_exists (__main__.TestMilestone4InteractiveFeatures.test_enhanced_search_js_exists)
2025-08-10T01:11:41.3600633Z Test that enhanced search JavaScript file exists ... ‚úÖ Enhanced Search JavaScript file exists and contains core functionality
2025-08-10T01:11:41.3601579Z ok
2025-08-10T01:11:41.3604379Z test_error_handling (__main__.TestMilestone4InteractiveFeatures.test_error_handling)
2025-08-10T01:11:41.3612686Z Test that features handle errors gracefully ... ‚úÖ Features include proper error handling
2025-08-10T01:11:41.3613448Z ok
2025-08-10T01:11:41.3614144Z test_file_integration_order (__main__.TestMilestone4InteractiveFeatures.test_file_integration_order)
2025-08-10T01:11:41.3615560Z Test that files are loaded in the correct order ... ‚úÖ JavaScript files are loaded in correct dependency order
2025-08-10T01:11:41.3616371Z ok
2025-08-10T01:11:41.3617202Z test_index_html_has_modern_interface (__main__.TestMilestone4InteractiveFeatures.test_index_html_has_modern_interface)
2025-08-10T01:11:41.3618931Z Test that index.html supports modern interface system ... ‚úÖ index.html supports modern interface system
2025-08-10T01:11:41.3619696Z ok
2025-08-10T01:11:41.3620396Z test_index_html_includes_scripts (__main__.TestMilestone4InteractiveFeatures.test_index_html_includes_scripts)
2025-08-10T01:11:41.3621911Z Test that index.html includes all necessary script files ... ‚úÖ index.html includes all interactive features scripts and CSS
2025-08-10T01:11:41.3622814Z ok
2025-08-10T01:11:41.3623898Z test_interactive_features_css_exists (__main__.TestMilestone4InteractiveFeatures.test_interactive_features_css_exists)
2025-08-10T01:11:41.3626959Z Test that interactive features CSS file exists ... ‚úÖ Interactive Features CSS file exists and contains styling rules
2025-08-10T01:11:41.3628162Z ok
2025-08-10T01:11:41.3629121Z test_interface_manager_feature_control (__main__.TestMilestone4InteractiveFeatures.test_interface_manager_feature_control)
2025-08-10T01:11:41.3631263Z Test interface manager can control features ... ‚úÖ Interface manager has proper feature control methods
2025-08-10T01:11:41.3632255Z ok
2025-08-10T01:11:41.3633137Z test_interface_manager_js_exists (__main__.TestMilestone4InteractiveFeatures.test_interface_manager_js_exists)
2025-08-10T01:11:41.3635010Z Test that interface manager JavaScript file exists ... ‚úÖ Interface Manager JavaScript file exists and contains core functionality
2025-08-10T01:11:41.3636380Z ok
2025-08-10T01:11:41.3637483Z test_javascript_file_structure (__main__.TestMilestone4InteractiveFeatures.test_javascript_file_structure)
2025-08-10T01:11:41.3642045Z Test JavaScript files have proper structure ... ‚úÖ All JavaScript files have proper structure and integration
2025-08-10T01:11:41.3642754Z ok
2025-08-10T01:11:41.3643438Z test_performance_considerations (__main__.TestMilestone4InteractiveFeatures.test_performance_considerations)
2025-08-10T01:11:41.3644663Z Test that features are optimized for performance ... ‚úÖ Features include performance optimizations
2025-08-10T01:11:41.3645323Z ok
2025-08-10T01:11:41.3645965Z test_progressive_enhancement (__main__.TestMilestone4InteractiveFeatures.test_progressive_enhancement)
2025-08-10T01:11:41.3647308Z Test that features use progressive enhancement ... ‚úÖ Features use progressive enhancement and modern interface system
2025-08-10T01:11:41.3648253Z ok
2025-08-10T01:11:41.3648403Z
2025-08-10T01:11:41.3648613Z ----------------------------------------------------------------------
2025-08-10T01:11:41.3649076Z Ran 18 tests in 0.009s
2025-08-10T01:11:41.3649299Z
2025-08-10T01:11:41.3649409Z OK
2025-08-10T01:11:41.3649564Z
2025-08-10T01:11:41.3649707Z ============================================================
2025-08-10T01:11:41.3650208Z üéØ MILESTONE 4 TEST SUMMARY
2025-08-10T01:11:41.3650565Z ============================================================
2025-08-10T01:11:41.3651030Z ‚úÖ Passed: 18/18
2025-08-10T01:11:41.3651226Z
2025-08-10T01:11:41.3651580Z üéâ MILESTONE 4: INTERACTIVE FEATURES - ALL TESTS PASSED!
2025-08-10T01:11:41.3652104Z üìã Features Ready:
2025-08-10T01:11:41.3652478Z    ‚Ä¢ Modern Interface System
2025-08-10T01:11:41.3652943Z    ‚Ä¢ Campaign Wizard (Multi-step Creation)
2025-08-10T01:11:41.3653402Z    ‚Ä¢ Enhanced Search & Filter
2025-08-10T01:11:41.3653791Z    ‚Ä¢ Enhanced Modals
2025-08-10T01:11:41.3654178Z    ‚Ä¢ Backward Compatibility
2025-08-10T01:11:41.3654588Z    ‚Ä¢ Progressive Enhancement
2025-08-10T01:11:41.3715325Z ‚úÖ PASS: tests/test_milestone_4_interactive_features.py
2025-08-10T01:11:41.3721027Z ----------------------------------------
2025-08-10T01:11:41.3721558Z Running: tests/test_mission_conversion_helpers.py
2025-08-10T01:11:41.6372575Z .........
2025-08-10T01:11:41.6382484Z ----------------------------------------------------------------------
2025-08-10T01:11:41.6383016Z Ran 9 tests in 0.003s
2025-08-10T01:11:41.6383215Z
2025-08-10T01:11:41.6383327Z OK
2025-08-10T01:11:41.6869661Z ‚úÖ PASS: tests/test_mission_conversion_helpers.py
2025-08-10T01:11:41.6871181Z ----------------------------------------
2025-08-10T01:11:41.6871652Z Running: tests/test_mission_handling.py
2025-08-10T01:11:41.9472920Z WARNING:root:‚ö†Ô∏è SMART CONVERSION: AI attempted to set 'active_missions' as dict. Converting to list append.
2025-08-10T01:11:41.9475690Z ..WARNING:root:‚ö†Ô∏è SMART CONVERSION: AI attempted to set 'active_missions' as dict. Converting to list append.
2025-08-10T01:11:41.9476658Z .
2025-08-10T01:11:41.9477176Z ----------------------------------------------------------------------
2025-08-10T01:11:41.9478426Z Ran 3 tests in 0.001s
2025-08-10T01:11:41.9483037Z
2025-08-10T01:11:41.9483600Z OK
2025-08-10T01:11:41.9910193Z ‚úÖ PASS: tests/test_mission_handling.py
2025-08-10T01:11:41.9913967Z ----------------------------------------
2025-08-10T01:11:41.9914374Z Running: tests/test_mock_services.py
2025-08-10T01:11:42.3249523Z 2025-08-10 01:11:42,324 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:42.3367483Z 2025-08-10 01:11:42,336 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:42.3377397Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:42.3380538Z   setup_file_logging()
2025-08-10T01:11:42.3381182Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:42.6013690Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:42.6016960Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:42.6242994Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:42.6245678Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:43.3161666Z 2025-08-10 01:11:43,315 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: get_campaigns_for_user ---
2025-08-10T01:11:43.3162905Z Args: ('test-mock-user',)
2025-08-10T01:11:43.3165084Z Kwargs: {}
2025-08-10T01:11:43.3166506Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:43.3170284Z Traceback:
2025-08-10T01:11:43.3171096Z Traceback (most recent call last):
2025-08-10T01:11:43.3173476Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:43.3177092Z     asyncio.get_running_loop()
2025-08-10T01:11:43.3177550Z RuntimeError: no running event loop
2025-08-10T01:11:43.3180160Z
2025-08-10T01:11:43.3180492Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:43.3180935Z
2025-08-10T01:11:43.3181069Z Traceback (most recent call last):
2025-08-10T01:11:43.3181829Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:43.3182690Z     return func(*args, **kwargs)
2025-08-10T01:11:43.3183077Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3184139Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 439, in get_campaigns_for_user
2025-08-10T01:11:43.3185088Z     db = get_db()
2025-08-10T01:11:43.3185402Z          ^^^^^^^^
2025-08-10T01:11:43.3186190Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:43.3187064Z     return firestore.client()
2025-08-10T01:11:43.3187443Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3188701Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:43.3189992Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:43.3190700Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3192196Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:43.3193520Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:43.3194157Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3195562Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:43.3196750Z     self._services[name] = initializer(self)
2025-08-10T01:11:43.3197207Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3199591Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:43.3200794Z     credentials = app.credential.get_credential()
2025-08-10T01:11:43.3201248Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3202497Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:43.3203643Z     self._load_credential()
2025-08-10T01:11:43.3204782Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:43.3206191Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:43.3206892Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3208273Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:43.3209717Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:43.3211485Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:43.3213106Z --- END EXCEPTION ---
2025-08-10T01:11:43.3215011Z 2025-08-10 01:11:43,316 - root - ERROR - üî•üî¥ Failed to get campaigns: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:43.3222888Z .2025-08-10 01:11:43,320 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:43.3224698Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:43.3226185Z   setup_file_logging()
2025-08-10T01:11:43.3226784Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:43.3277649Z 2025-08-10 01:11:43,327 - main - INFO - Received campaign creation request:
2025-08-10T01:11:43.3279597Z 2025-08-10 01:11:43,327 - main - INFO -   Character:
2025-08-10T01:11:43.3280189Z 2025-08-10 01:11:43,327 - main - INFO -   Setting:
2025-08-10T01:11:43.3280752Z 2025-08-10 01:11:43,327 - main - INFO -   Description:
2025-08-10T01:11:43.3281340Z 2025-08-10 01:11:43,327 - main - INFO -   Custom options: []
2025-08-10T01:11:43.3282012Z 2025-08-10 01:11:43,327 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:43.3303614Z 2025-08-10 01:11:43,330 - root - ERROR - üî•üî¥ Failed to get user settings for user_085210: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:43.3306595Z 2025-08-10 01:11:43,330 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:43.3307471Z 2025-08-10 01:11:43,330 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:43.3336077Z 2025-08-10 01:11:43,333 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:43.3341751Z Args: ('test-mock-user', 'MCP Test Campaign', 'Create a fantasy adventure', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 43, 330160, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'test-mock-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:43.3346270Z Kwargs: {}
2025-08-10T01:11:43.3347387Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:43.3348996Z Traceback:
2025-08-10T01:11:43.3349337Z Traceback (most recent call last):
2025-08-10T01:11:43.3350193Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:43.3351005Z     asyncio.get_running_loop()
2025-08-10T01:11:43.3351435Z RuntimeError: no running event loop
2025-08-10T01:11:43.3351727Z
2025-08-10T01:11:43.3352031Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:43.3352476Z
2025-08-10T01:11:43.3352640Z Traceback (most recent call last):
2025-08-10T01:11:43.3353439Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:43.3354265Z     return func(*args, **kwargs)
2025-08-10T01:11:43.3354676Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3355602Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:43.3356522Z     db = get_db()
2025-08-10T01:11:43.3356837Z          ^^^^^^^^
2025-08-10T01:11:43.3357636Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:43.3358717Z     return firestore.client()
2025-08-10T01:11:43.3359101Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3360182Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:43.3361484Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:43.3362192Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3363422Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:43.3365209Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:43.3365908Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3367105Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:43.3368664Z     self._services[name] = initializer(self)
2025-08-10T01:11:43.3369169Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3370336Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:43.3371586Z     credentials = app.credential.get_credential()
2025-08-10T01:11:43.3372090Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3373563Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:43.3374789Z     self._load_credential()
2025-08-10T01:11:43.3376025Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:43.3377931Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:43.3378630Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:43.3379821Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:43.3381292Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:43.3383169Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:43.3384815Z --- END EXCEPTION ---
2025-08-10T01:11:43.3386710Z 2025-08-10 01:11:43,333 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:43.3389252Z .2025-08-10 01:11:43,336 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:43.3391965Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:43.3393457Z   setup_file_logging()
2025-08-10T01:11:43.3394043Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:43.3450670Z s2025-08-10 01:11:43,344 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:43.3453442Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:43.3454973Z   setup_file_logging()
2025-08-10T01:11:43.3455623Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:43.3527998Z s2025-08-10 01:11:43,352 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:43.3530795Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:43.3532292Z   setup_file_logging()
2025-08-10T01:11:43.3532915Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:43.3613588Z .2025-08-10 01:11:43,361 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:43.3616406Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:43.3618146Z   setup_file_logging()
2025-08-10T01:11:43.3618809Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:43.3674132Z .
2025-08-10T01:11:43.3675207Z ----------------------------------------------------------------------
2025-08-10T01:11:43.3676512Z Ran 6 tests in 1.033s
2025-08-10T01:11:43.3676732Z
2025-08-10T01:11:43.3676855Z OK (skipped=2)
2025-08-10T01:11:43.5759205Z ‚úÖ PASS: tests/test_mock_services.py
2025-08-10T01:11:43.5760561Z ----------------------------------------
2025-08-10T01:11:43.5761036Z Running: tests/test_narrative_cutoff_bug.py
2025-08-10T01:11:43.6169684Z test_complex_nested_quotes (__main__.TestNarrativeCutoffBug.test_complex_nested_quotes)
2025-08-10T01:11:43.6172354Z Test extraction with complex nested quotes and escape sequences. ... ok
2025-08-10T01:11:43.6173482Z test_extraction_performance (__main__.TestNarrativeCutoffBug.test_extraction_performance)
2025-08-10T01:11:43.6191420Z Test that the fix handles very long narratives efficiently. ... ok
2025-08-10T01:11:43.6193571Z test_incomplete_json_narrative (__main__.TestNarrativeCutoffBug.test_incomplete_json_narrative)
2025-08-10T01:11:43.6194641Z Test that incomplete JSON (cut off mid-narrative) still extracts what's available. ... ok
2025-08-10T01:11:43.6195947Z test_narrative_extraction_with_quotes_GREEN_phase (__main__.TestNarrativeCutoffBug.test_narrative_extraction_with_quotes_GREEN_phase)
2025-08-10T01:11:43.6197591Z GREEN PHASE: Demonstrate that the fixed implementation works correctly. ... ok
2025-08-10T01:11:43.6199221Z test_narrative_extraction_with_quotes_RED_phase (__main__.TestNarrativeCutoffBug.test_narrative_extraction_with_quotes_RED_phase)
2025-08-10T01:11:43.6201688Z RED PHASE: Demonstrate that a naive regex approach would fail. ... ok
2025-08-10T01:11:43.6203509Z test_narrative_with_json_special_chars (__main__.TestNarrativeCutoffBug.test_narrative_with_json_special_chars)
2025-08-10T01:11:43.6204427Z Test narratives containing JSON special characters. ... ok
2025-08-10T01:11:43.6204818Z
2025-08-10T01:11:43.6205039Z ----------------------------------------------------------------------
2025-08-10T01:11:43.6205510Z Ran 6 tests in 0.003s
2025-08-10T01:11:43.6205706Z
2025-08-10T01:11:43.6205811Z OK
2025-08-10T01:11:43.6205961Z
2025-08-10T01:11:43.6207985Z Actual result: 'The wizard says, "The ancient tome reads: \'Beware the curse of the shadow realm, for it whispers \\"death\\" to all who enter.\' We must be careful."\n\nHe continues, "I\'ve studied these texts for years. The curse can only be broken by someone who truly understands the meaning of sacrifice."\n\nOptions:\n1. Ask about the curse\n2. "Tell me more about this \'sacrifice\' you mentioned"\n3. Leave immediately'
2025-08-10T01:11:43.6210112Z
2025-08-10T01:11:43.6212105Z Expected result: 'The wizard says, "The ancient tome reads: \'Beware the curse of the shadow realm, for it whispers \\"death\\" to all who enter.\' We must be careful."\n\nHe continues, "I\'ve studied these texts for years. The curse can only be broken by someone who truly understands the meaning of sacrifice."\n\nOptions:\n1. Ask about the curse\n2. "Tell me more about this \'sacrifice\' you mentioned"\n3. Leave immediately'
2025-08-10T01:11:43.6214259Z
2025-08-10T01:11:43.6214828Z üü¢ GREEN PHASE: Fixed extraction successfully got all 691 chars
2025-08-10T01:11:43.6215609Z Narrative ends correctly with: ...g presence to get him to spill everything quickly.
2025-08-10T01:11:43.6216126Z
2025-08-10T01:11:43.6216478Z üî¥ RED PHASE: Buggy extraction got only 177 chars instead of 691
2025-08-10T01:11:43.6217103Z Cutoff happened at: ...proaches you, his eyes gleaming with urgency.\n\n\
2025-08-10T01:11:43.6270116Z ‚úÖ PASS: tests/test_narrative_cutoff_bug.py
2025-08-10T01:11:43.6271303Z ----------------------------------------
2025-08-10T01:11:43.6272124Z Running: tests/test_narrative_field_clean.py
2025-08-10T01:11:43.6639337Z ...
2025-08-10T01:11:43.6644787Z ----------------------------------------------------------------------
2025-08-10T01:11:43.6645322Z Ran 3 tests in 0.000s
2025-08-10T01:11:43.6650361Z
2025-08-10T01:11:43.6650488Z OK
2025-08-10T01:11:43.6695870Z ‚úÖ PASS: tests/test_narrative_field_clean.py
2025-08-10T01:11:43.6697172Z ----------------------------------------
2025-08-10T01:11:43.6697858Z Running: tests/test_narrative_response_error_handling.py
2025-08-10T01:11:43.7355891Z ..WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:43.7374305Z ...WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:43.7378694Z .WARNING:root:‚ö†Ô∏è Choice 'choice1' missing required text or description, skipping
2025-08-10T01:11:43.7389335Z ..........
2025-08-10T01:11:43.7390033Z ----------------------------------------------------------------------
2025-08-10T01:11:43.7392180Z Ran 16 tests in 0.004s
2025-08-10T01:11:43.7392661Z
2025-08-10T01:11:43.7393807Z OK
2025-08-10T01:11:43.7497263Z ‚úÖ PASS: tests/test_narrative_response_error_handling.py
2025-08-10T01:11:43.7499794Z ----------------------------------------
2025-08-10T01:11:43.7501536Z Running: tests/test_narrative_response_extraction.py
2025-08-10T01:11:43.7978603Z ...WARNING:root:‚ö†Ô∏è Choice 'test' missing required text or description, skipping
2025-08-10T01:11:43.7990227Z ......WARNING:root:‚ö†Ô∏è Invalid debug_info type: str, expected dict. Using empty dict instead.
2025-08-10T01:11:43.7991670Z .WARNING:root:‚ö†Ô∏è Invalid dice_rolls type: str, expected list. Using empty list.
2025-08-10T01:11:43.7993531Z .
2025-08-10T01:11:43.7994955Z ----------------------------------------------------------------------
2025-08-10T01:11:43.7997281Z Ran 11 tests in 0.002s
2025-08-10T01:11:43.7997559Z
2025-08-10T01:11:43.7997675Z OK
2025-08-10T01:11:43.8064871Z ‚úÖ PASS: tests/test_narrative_response_extraction.py
2025-08-10T01:11:43.8066324Z ----------------------------------------
2025-08-10T01:11:43.8066888Z Running: tests/test_narrative_response_legacy_fallback.py
2025-08-10T01:11:43.8529999Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:43.8541076Z ERROR:root:üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:43.8544567Z .WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:43.8546351Z ..WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:43.8548832Z ERROR:root:üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:43.8551378Z .WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:43.8552615Z .WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:43.8555077Z ...WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:43.8557987Z .WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:43.8560906Z .WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:43.8565610Z ...WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:43.8566294Z .
2025-08-10T01:11:43.8566966Z ----------------------------------------------------------------------
2025-08-10T01:11:43.8567925Z Ran 14 tests in 0.004s
2025-08-10T01:11:43.8569453Z
2025-08-10T01:11:43.8569703Z OK
2025-08-10T01:11:43.8636232Z ‚úÖ PASS: tests/test_narrative_response_legacy_fallback.py
2025-08-10T01:11:43.8637625Z ----------------------------------------
2025-08-10T01:11:43.8638302Z Running: tests/test_npc_data_handling.py
2025-08-10T01:11:44.1223882Z .....
2025-08-10T01:11:44.1227044Z ----------------------------------------------------------------------
2025-08-10T01:11:44.1227557Z Ran 5 tests in 0.001s
2025-08-10T01:11:44.1227959Z
2025-08-10T01:11:44.1228073Z OK
2025-08-10T01:11:44.1620124Z ‚úÖ PASS: tests/test_npc_data_handling.py
2025-08-10T01:11:44.1620979Z ----------------------------------------
2025-08-10T01:11:44.1621877Z Running: tests/test_npc_gender_consistency_red_green.py
2025-08-10T01:11:44.3861865Z .....
2025-08-10T01:11:44.3862811Z ----------------------------------------------------------------------
2025-08-10T01:11:44.3865159Z Ran 5 tests in 0.001s
2025-08-10T01:11:44.3866673Z
2025-08-10T01:11:44.3866942Z OK
2025-08-10T01:11:44.4151771Z ‚úÖ PASS: tests/test_npc_gender_consistency_red_green.py
2025-08-10T01:11:44.4152733Z ----------------------------------------
2025-08-10T01:11:44.4153447Z Running: tests/test_null_narrative_bug_fix.py
2025-08-10T01:11:44.4621190Z ....ERROR:root:üî•üî¥ ‚ùå STRING PLANNING BLOCKS NO LONGER SUPPORTED: String planning blocks are deprecated. Only JSON format is allowed. Received: ...
2025-08-10T01:11:44.4623026Z .
2025-08-10T01:11:44.4623652Z ----------------------------------------------------------------------
2025-08-10T01:11:44.4624382Z Ran 5 tests in 0.000s
2025-08-10T01:11:44.4624752Z
2025-08-10T01:11:44.4625124Z OK
2025-08-10T01:11:44.4696057Z ‚úÖ PASS: tests/test_null_narrative_bug_fix.py
2025-08-10T01:11:44.4697690Z ----------------------------------------
2025-08-10T01:11:44.4698384Z Running: tests/test_numeric_field_converter.py
2025-08-10T01:11:44.5099799Z ...........
2025-08-10T01:11:44.5101857Z ----------------------------------------------------------------------
2025-08-10T01:11:44.5102396Z Ran 11 tests in 0.001s
2025-08-10T01:11:44.5102622Z
2025-08-10T01:11:44.5102739Z OK
2025-08-10T01:11:44.5160899Z ‚úÖ PASS: tests/test_numeric_field_converter.py
2025-08-10T01:11:44.5162184Z ----------------------------------------
2025-08-10T01:11:44.5162655Z Running: tests/test_old_tag_detection.py
2025-08-10T01:11:44.5841226Z .ERROR:root:DEPRECATED TAGS DETECTED: Found 2 deprecated tags in response. Update prompts to use proper JSON format. Details: {'debug_blocks': 2}
2025-08-10T01:11:44.5853397Z ..ERROR:root:üî•üî¥ ‚ùå STRING PLANNING BLOCKS NO LONGER SUPPORTED: String planning blocks are deprecated. Only JSON format is allowed. Received: What next?...
2025-08-10T01:11:44.5858084Z ERROR:root:DEPRECATED TAGS DETECTED: Found 2 deprecated tags in response. Update prompts to use proper JSON format. Details: {'state_updates_proposed': 2}
2025-08-10T01:11:44.5860187Z .WARNING:root:Deprecated tag found in narrative: \[STATE_UPDATES_PROPOSED\] (found 1 times). These should not appear in narrative field.
2025-08-10T01:11:44.5862044Z WARNING:root:Deprecated tag found in narrative: \[END_STATE_UPDATES_PROPOSED\] (found 1 times). These should not appear in narrative field.
2025-08-10T01:11:44.5863828Z WARNING:root:Deprecated tag found in narrative: S?TATE_UPDATES_PROPOSED\] (found 2 times). These should not appear in narrative field.
2025-08-10T01:11:44.5865356Z WARNING:root:Deprecated tag found in narrative: \[DEBUG_STATE_START\] (found 1 times). These should not appear in narrative field.
2025-08-10T01:11:44.5866812Z WARNING:root:Deprecated tag found in narrative: \[DEBUG_STATE_END\] (found 1 times). These should not appear in narrative field.
2025-08-10T01:11:44.5869507Z ERROR:root:DEPRECATED TAGS DETECTED: Found 6 deprecated tags in response. Update prompts to use proper JSON format. Details: {'state_updates_proposed': 4, 'debug_blocks': 2}
2025-08-10T01:11:44.5870539Z .
2025-08-10T01:11:44.5870864Z ----------------------------------------------------------------------
2025-08-10T01:11:44.5871320Z Ran 5 tests in 0.004s
2025-08-10T01:11:44.5871516Z
2025-08-10T01:11:44.5871620Z OK
2025-08-10T01:11:44.5977566Z ‚úÖ PASS: tests/test_old_tag_detection.py
2025-08-10T01:11:44.5979027Z ----------------------------------------
2025-08-10T01:11:44.5979519Z Running: tests/test_planning_block_analysis.py
2025-08-10T01:11:44.6644799Z .....
2025-08-10T01:11:44.6645739Z ----------------------------------------------------------------------
2025-08-10T01:11:44.6646556Z Ran 5 tests in 0.002s
2025-08-10T01:11:44.6647081Z
2025-08-10T01:11:44.6647463Z OK
2025-08-10T01:11:44.6751532Z ‚úÖ PASS: tests/test_planning_block_analysis.py
2025-08-10T01:11:44.6752934Z ----------------------------------------
2025-08-10T01:11:44.6753416Z Running: tests/test_planning_block_json.py
2025-08-10T01:11:45.6751085Z test_api_failure_fallback (__main__.TestPlanningBlockJSON.test_api_failure_fallback)
2025-08-10T01:11:45.6759192Z Test fallback behavior when API fails ... 2025-08-10 01:11:45,675 - WARNING - ‚ö†Ô∏è ‚ö†Ô∏è PLANNING_BLOCK_MISSING: Story mode response missing required planning block
2025-08-10T01:11:45.6761226Z 2025-08-10 01:11:45,675 - INFO - üîç PLANNING_BLOCK_REGENERATION: Sending prompt to API
2025-08-10T01:11:45.6762594Z 2025-08-10 01:11:45,675 - INFO - üîç PLANNING_BLOCK_PROMPT:
2025-08-10T01:11:45.6764332Z CRITICAL: Generate planning options ONLY for Test Hero in Test Location.
2025-08-10T01:11:45.6765592Z DO NOT reference other characters, campaigns, or unrelated narrative elements.
2025-08-10T01:11:45.6766105Z
2025-08-10T01:11:45.6766320Z The player just said: "I want to think about m...
2025-08-10T01:11:45.6767302Z 2025-08-10 01:11:45,675 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Failed to generate planning block: API Error
2025-08-10T01:11:45.6768633Z 2025-08-10 01:11:45,675 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Exception type: <class 'Exception'>
2025-08-10T01:11:45.6769735Z 2025-08-10 01:11:45,675 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Exception details: Exception('API Error')
2025-08-10T01:11:45.6780714Z 2025-08-10 01:11:45,677 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Traceback: Traceback (most recent call last):
2025-08-10T01:11:45.6789186Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 1908, in _validate_and_enforce_planning_block
2025-08-10T01:11:45.6790330Z     planning_response = _call_gemini_api(
2025-08-10T01:11:45.6790830Z                         ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:45.6791700Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1124, in __call__
2025-08-10T01:11:45.6792582Z     return self._mock_call(*args, **kwargs)
2025-08-10T01:11:45.6793061Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:45.6793936Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1128, in _mock_call
2025-08-10T01:11:45.6794905Z     return self._execute_mock_call(*args, **kwargs)
2025-08-10T01:11:45.6795416Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:45.6796384Z   File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/mock.py", line 1183, in _execute_mock_call
2025-08-10T01:11:45.6797291Z     raise effect
2025-08-10T01:11:45.6797644Z Exception: API Error
2025-08-10T01:11:45.6798065Z
2025-08-10T01:11:45.6798193Z ok
2025-08-10T01:11:45.6798782Z test_api_response_structure (__main__.TestPlanningBlockJSON.test_api_response_structure)
2025-08-10T01:11:45.6799678Z Test that API response has planning block in correct field ... ok
2025-08-10T01:11:45.6800644Z test_empty_planning_block_handling (__main__.TestPlanningBlockJSON.test_empty_planning_block_handling)
2025-08-10T01:11:45.6802745Z Test handling of empty or null planning blocks ... 2025-08-10 01:11:45,678 - ERROR - üî•üî¥ ‚ùå STRING PLANNING BLOCKS NO LONGER SUPPORTED: String planning blocks are deprecated. Only JSON format is allowed. Received: ...
2025-08-10T01:11:45.6804111Z ok
2025-08-10T01:11:45.6804705Z test_json_response_parsing (__main__.TestPlanningBlockJSON.test_json_response_parsing)
2025-08-10T01:11:45.6807109Z Test that JSON responses from Gemini are parsed correctly ... 2025-08-10 01:11:45,679 - WARNING - ‚ö†Ô∏è ‚ö†Ô∏è PLANNING_BLOCK_MISSING: Story mode response missing required planning block
2025-08-10T01:11:45.6809423Z 2025-08-10 01:11:45,679 - INFO - üîç PLANNING_BLOCK_REGENERATION: Sending prompt to API
2025-08-10T01:11:45.6812274Z 2025-08-10 01:11:45,679 - INFO - üîç PLANNING_BLOCK_PROMPT:
2025-08-10T01:11:45.6813052Z CRITICAL: Generate planning options ONLY for Test Hero in Test Location.
2025-08-10T01:11:45.6813940Z DO NOT reference other characters, campaigns, or unrelated narrative elements.
2025-08-10T01:11:45.6814496Z
2025-08-10T01:11:45.6814716Z The player just said: "I want to think about m...
2025-08-10T01:11:45.6816088Z 2025-08-10 01:11:45,679 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_RESPONSE): Length: 266 chars
2025-08-10T01:11:45.6817245Z 2025-08-10 01:11:45,679 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_RESPONSE): Content: {
2025-08-10T01:11:45.6821688Z             "narrative": "What would you like to do next?\n1. **Investigate** - Look around\n2. **Proceed** - Move forward\n3. **Cast spell** - Use magic",
2025-08-10T01:11:45.6822739Z             "entities_mentioned": ["Test Hero"],
2025-08-10T01:11:45.6823265Z             "location_confirmed": "Test Location"
2025-08-10T01:11:45.6823729Z         }
2025-08-10T01:11:45.6824711Z 2025-08-10 01:11:45,679 - INFO - üîç PLANNING_BLOCK_PARSING: Attempting to parse response
2025-08-10T01:11:45.6825784Z 2025-08-10 01:11:45,679 - INFO - üîç PLANNING_BLOCK_PARSING_RESULT: planning_text length: 124
2025-08-10T01:11:45.6826899Z 2025-08-10 01:11:45,679 - INFO - üîç PLANNING_BLOCK_PARSING_RESULT: structured_response exists: True
2025-08-10T01:11:45.6828231Z 2025-08-10 01:11:45,679 - INFO - üîç PLANNING_BLOCK_SOURCE: Using raw planning_text (length: 124)
2025-08-10T01:11:45.6829389Z 2025-08-10 01:11:45,679 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_CONTENT): Length: 124 chars
2025-08-10T01:11:45.6830704Z 2025-08-10 01:11:45,679 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_CONTENT): Content: What would you like to do next?
2025-08-10T01:11:45.6831586Z 1. **Investigate** - Look around
2025-08-10T01:11:45.6832021Z 2. **Proceed** - Move forward
2025-08-10T01:11:45.6832435Z 3. **Cast spell** - Use magic
2025-08-10T01:11:45.6832962Z 2025-08-10 01:11:45,679 - INFO - Added LLM-generated deep think planning block
2025-08-10T01:11:45.6833540Z ok
2025-08-10T01:11:45.6834165Z test_no_narrative_markers_in_json (__main__.TestPlanningBlockJSON.test_no_narrative_markers_in_json)
2025-08-10T01:11:45.6836191Z Test that planning blocks in JSON don't have narrative markers ... 2025-08-10 01:11:45,679 - ERROR - üî•üî¥ ‚ùå STRING PLANNING BLOCKS NO LONGER SUPPORTED: String planning blocks are deprecated. Only JSON format is allowed. Received: What would you like to do?
2025-08-10T01:11:45.6837597Z 1. **Option1**
2025-08-10T01:11:45.6842969Z 2. **Option2**...
2025-08-10T01:11:45.6843265Z ok
2025-08-10T01:11:45.6843842Z test_plain_text_response_handling (__main__.TestPlanningBlockJSON.test_plain_text_response_handling)
2025-08-10T01:11:45.6845320Z Test that plain text responses still work correctly ... 2025-08-10 01:11:45,680 - WARNING - ‚ö†Ô∏è ‚ö†Ô∏è PLANNING_BLOCK_MISSING: Story mode response missing required planning block
2025-08-10T01:11:45.6846559Z 2025-08-10 01:11:45,680 - INFO - üîç PLANNING_BLOCK_REGENERATION: Sending prompt to API
2025-08-10T01:11:45.6847281Z 2025-08-10 01:11:45,680 - INFO - üîç PLANNING_BLOCK_PROMPT:
2025-08-10T01:11:45.6848055Z CRITICAL: Generate planning options ONLY for Test Hero in Test Location.
2025-08-10T01:11:45.6848800Z DO NOT reference other characters, campaigns, or unrelated narrative elements.
2025-08-10T01:11:45.6849259Z
2025-08-10T01:11:45.6849448Z The player just said: "I want to think about m...
2025-08-10T01:11:45.6850234Z 2025-08-10 01:11:45,680 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_RESPONSE): Length: 161 chars
2025-08-10T01:11:45.6851331Z 2025-08-10 01:11:45,680 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_RESPONSE): Content: What would you like to do next?
2025-08-10T01:11:45.6852069Z 1. **Investigate** - Look around for clues
2025-08-10T01:11:45.6852491Z 2. **Proceed** - Move forward carefully
2025-08-10T01:11:45.6852905Z 3. **Cast spell** - Use magic to sense dangers
2025-08-10T01:11:45.6853589Z 2025-08-10 01:11:45,680 - INFO - üîç PLANNING_BLOCK_PARSING: Attempting to parse response
2025-08-10T01:11:45.6854580Z 2025-08-10 01:11:45,680 - WARNING - ‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:45.6855486Z 2025-08-10 01:11:45,682 - ERROR - üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:45.6856160Z 2025-08-10 01:11:45,682 - INFO - No JSON found in response, treating as plain text narrative
2025-08-10T01:11:45.6857275Z 2025-08-10 01:11:45,682 - INFO - Recovered from incomplete JSON response. Narrative length: 161 characters (~40 tokens)
2025-08-10T01:11:45.6858406Z 2025-08-10 01:11:45,682 - INFO - üîç PLANNING_BLOCK_PARSING_RESULT: planning_text length: 161
2025-08-10T01:11:45.6859309Z 2025-08-10 01:11:45,682 - INFO - üîç PLANNING_BLOCK_PARSING_RESULT: structured_response exists: True
2025-08-10T01:11:45.6860203Z 2025-08-10 01:11:45,682 - INFO - üîç PLANNING_BLOCK_SOURCE: Using raw planning_text (length: 161)
2025-08-10T01:11:45.6861159Z 2025-08-10 01:11:45,682 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_CONTENT): Length: 161 chars
2025-08-10T01:11:45.6862514Z 2025-08-10 01:11:45,682 - INFO - üîç API_RESPONSE_DEBUG (PLANNING_BLOCK_RAW_CONTENT): Content: What would you like to do next?
2025-08-10T01:11:45.6863252Z 1. **Investigate** - Look around for clues
2025-08-10T01:11:45.6863667Z 2. **Proceed** - Move forward carefully
2025-08-10T01:11:45.6864075Z 3. **Cast spell** - Use magic to sense dangers
2025-08-10T01:11:45.6864640Z 2025-08-10 01:11:45,682 - INFO - Added LLM-generated deep think planning block
2025-08-10T01:11:45.6865141Z ok
2025-08-10T01:11:45.6865742Z test_planning_block_in_json_field_only (__main__.TestPlanningBlockJSON.test_planning_block_in_json_field_only)
2025-08-10T01:11:45.6866673Z Test that planning blocks should only be in JSON field, not narrative ... ok
2025-08-10T01:11:45.6867135Z
2025-08-10T01:11:45.6867333Z ----------------------------------------------------------------------
2025-08-10T01:11:45.6867921Z Ran 7 tests in 0.008s
2025-08-10T01:11:45.6868131Z
2025-08-10T01:11:45.6868229Z OK
2025-08-10T01:11:45.8332785Z ‚úÖ PASS: tests/test_planning_block_json.py
2025-08-10T01:11:45.8334219Z ----------------------------------------
2025-08-10T01:11:45.8334736Z Running: tests/test_planning_block_json_format.py
2025-08-10T01:11:45.8810467Z ERROR:root:üî•üî¥ ‚ùå STRING PLANNING BLOCKS NO LONGER SUPPORTED: String planning blocks are deprecated. Only JSON format is allowed. Received: The player must choose their approach:
2025-08-10T01:11:45.8812543Z
2025-08-10T01:11:45.8812881Z 1. **Examine Door** - Look carefully for traps or mechanisms...
2025-08-10T01:11:45.8829745Z .....WARNING:root:‚ö†Ô∏è Choice 'invalid_choice' missing required text or description, skipping
2025-08-10T01:11:45.8832752Z ..
2025-08-10T01:11:45.8833817Z ----------------------------------------------------------------------
2025-08-10T01:11:45.8834996Z Ran 7 tests in 0.003s
2025-08-10T01:11:45.8835231Z
2025-08-10T01:11:45.8835344Z OK
2025-08-10T01:11:45.8903092Z ‚úÖ PASS: tests/test_planning_block_json_format.py
2025-08-10T01:11:45.8904384Z ----------------------------------------
2025-08-10T01:11:45.8904899Z Running: tests/test_planning_block_robustness.py
2025-08-10T01:11:45.9650878Z ......WARNING:root:‚ö†Ô∏è Invalid dice_rolls type: str, expected list. Using empty list.
2025-08-10T01:11:45.9652675Z ..WARNING:root:‚ö†Ô∏è Invalid state_updates type: str, expected dict. Using empty dict instead.
2025-08-10T01:11:45.9654051Z WARNING:root:‚ö†Ô∏è Invalid debug_info type: int, expected dict. Using empty dict instead.
2025-08-10T01:11:45.9657521Z ...
2025-08-10T01:11:45.9658995Z ----------------------------------------------------------------------
2025-08-10T01:11:45.9659495Z Ran 11 tests in 0.028s
2025-08-10T01:11:45.9659708Z
2025-08-10T01:11:45.9659815Z OK
2025-08-10T01:11:45.9734951Z ‚úÖ PASS: tests/test_planning_block_robustness.py
2025-08-10T01:11:45.9736229Z ----------------------------------------
2025-08-10T01:11:45.9736787Z Running: tests/test_planning_block_validation_integration.py
2025-08-10T01:11:46.9660417Z .2025-08-10 01:11:46,965 - WARNING - ‚ö†Ô∏è üîç VALIDATION_INPUT: Response text is None, returning empty string
2025-08-10T01:11:46.9662960Z 2025-08-10 01:11:46,966 - WARNING - ‚ö†Ô∏è ‚ö†Ô∏è PLANNING_BLOCK_MISSING: Story mode response missing required planning block
2025-08-10T01:11:46.9671839Z 2025-08-10 01:11:46,967 - INFO - üîç PLANNING_BLOCK_REGENERATION: Sending prompt to API
2025-08-10T01:11:46.9674086Z 2025-08-10 01:11:46,967 - INFO - üîç PLANNING_BLOCK_PROMPT:
2025-08-10T01:11:46.9675499Z CRITICAL: Generate planning options ONLY for the character in <MagicMock name='mock.world_data.get()' id='139797188490832'>.
2025-08-10T01:11:46.9676662Z DO NOT reference other characters, campaigns, or unrelated narrative eleme...
2025-08-10T01:11:46.9677440Z 2025-08-10 01:11:46,967 - INFO - Initializing Gemini Client
2025-08-10T01:11:46.9679093Z 2025-08-10 01:11:46,967 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Failed to generate planning block: CRITICAL: GEMINI_API_KEY environment variable not found!
2025-08-10T01:11:46.9680614Z 2025-08-10 01:11:46,967 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Exception type: <class 'ValueError'>
2025-08-10T01:11:46.9682879Z 2025-08-10 01:11:46,967 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Exception details: ValueError('CRITICAL: GEMINI_API_KEY environment variable not found!')
2025-08-10T01:11:46.9685356Z 2025-08-10 01:11:46,967 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Traceback: Traceback (most recent call last):
2025-08-10T01:11:46.9686895Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 1908, in _validate_and_enforce_planning_block
2025-08-10T01:11:46.9688200Z     planning_response = _call_gemini_api(
2025-08-10T01:11:46.9688682Z                         ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:46.9689700Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 1251, in _call_gemini_api
2025-08-10T01:11:46.9690703Z     return _call_gemini_api_with_model_cycling(
2025-08-10T01:11:46.9691371Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:46.9692550Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 919, in _call_gemini_api_with_model_cycling
2025-08-10T01:11:46.9693623Z     client = get_client()
2025-08-10T01:11:46.9693997Z              ^^^^^^^^^^^^
2025-08-10T01:11:46.9694890Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 240, in get_client
2025-08-10T01:11:46.9696114Z     raise ValueError("CRITICAL: GEMINI_API_KEY environment variable not found!")
2025-08-10T01:11:46.9696965Z ValueError: CRITICAL: GEMINI_API_KEY environment variable not found!
2025-08-10T01:11:46.9697453Z
2025-08-10T01:11:46.9698511Z 2025-08-10 01:11:46,967 - INFO - üîç FALLBACK_USED: Updated structured_response.planning_block with fallback JSON content due to exception
2025-08-10T01:11:46.9838353Z .........2025-08-10 01:11:46,983 - WARNING - ‚ö†Ô∏è ‚ö†Ô∏è PLANNING_BLOCK_MISSING: Story mode response missing required planning block
2025-08-10T01:11:46.9839807Z 2025-08-10 01:11:46,983 - INFO - üîç PLANNING_BLOCK_REGENERATION: Sending prompt to API
2025-08-10T01:11:46.9840880Z 2025-08-10 01:11:46,983 - INFO - üîç PLANNING_BLOCK_PROMPT:
2025-08-10T01:11:46.9841863Z CRITICAL: Generate planning options ONLY for Test Hero in current location.
2025-08-10T01:11:46.9842685Z DO NOT reference other characters, campaigns, or unrelated narrative elements.
2025-08-10T01:11:46.9843192Z
2025-08-10T01:11:46.9843390Z Generate ONLY a planning block using the st...
2025-08-10T01:11:46.9843985Z 2025-08-10 01:11:46,983 - INFO - Initializing Gemini Client
2025-08-10T01:11:46.9845367Z 2025-08-10 01:11:46,983 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Failed to generate planning block: CRITICAL: GEMINI_API_KEY environment variable not found!
2025-08-10T01:11:46.9846786Z 2025-08-10 01:11:46,983 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Exception type: <class 'ValueError'>
2025-08-10T01:11:46.9848489Z 2025-08-10 01:11:46,983 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Exception details: ValueError('CRITICAL: GEMINI_API_KEY environment variable not found!')
2025-08-10T01:11:46.9850006Z 2025-08-10 01:11:46,984 - ERROR - üî•üî¥ üîç PLANNING_BLOCK_EXCEPTION: Traceback: Traceback (most recent call last):
2025-08-10T01:11:46.9851385Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 1908, in _validate_and_enforce_planning_block
2025-08-10T01:11:46.9852705Z     planning_response = _call_gemini_api(
2025-08-10T01:11:46.9853136Z                         ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:46.9854097Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 1251, in _call_gemini_api
2025-08-10T01:11:46.9855027Z     return _call_gemini_api_with_model_cycling(
2025-08-10T01:11:46.9855446Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:46.9856440Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 919, in _call_gemini_api_with_model_cycling
2025-08-10T01:11:46.9857623Z     client = get_client()
2025-08-10T01:11:46.9858128Z              ^^^^^^^^^^^^
2025-08-10T01:11:46.9858872Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/gemini_service.py", line 240, in get_client
2025-08-10T01:11:46.9859924Z     raise ValueError("CRITICAL: GEMINI_API_KEY environment variable not found!")
2025-08-10T01:11:46.9860650Z ValueError: CRITICAL: GEMINI_API_KEY environment variable not found!
2025-08-10T01:11:46.9861081Z
2025-08-10T01:11:46.9861843Z 2025-08-10 01:11:46,984 - INFO - üîç FALLBACK_USED: Updated structured_response.planning_block with fallback JSON content due to exception
2025-08-10T01:11:46.9863994Z .
2025-08-10T01:11:46.9865478Z ----------------------------------------------------------------------
2025-08-10T01:11:46.9866134Z Ran 11 tests in 0.023s
2025-08-10T01:11:46.9867291Z
2025-08-10T01:11:46.9867414Z OK
2025-08-10T01:11:47.1243881Z ‚úÖ PASS: tests/test_planning_block_validation_integration.py
2025-08-10T01:11:47.1245496Z ----------------------------------------
2025-08-10T01:11:47.1246013Z Running: tests/test_planning_blocks_ui.py
2025-08-10T01:11:47.1608807Z ....
2025-08-10T01:11:47.1609392Z ----------------------------------------------------------------------
2025-08-10T01:11:47.1609923Z Ran 4 tests in 0.000s
2025-08-10T01:11:47.1610145Z
2025-08-10T01:11:47.1610447Z OK
2025-08-10T01:11:47.1667380Z ‚úÖ PASS: tests/test_planning_blocks_ui.py
2025-08-10T01:11:47.1669157Z ----------------------------------------
2025-08-10T01:11:47.1669628Z Running: tests/test_pr_changes_runner.py
2025-08-10T01:11:47.3349363Z
2025-08-10T01:11:47.3350438Z === Testing Debug Mode Default Change ===
2025-08-10T01:11:47.3351518Z ‚úì GameState defaults to debug_mode=True
2025-08-10T01:11:47.3352202Z ‚úì GameState can be set to debug_mode=False
2025-08-10T01:11:47.3378838Z ‚úì debug_mode is included in serialization
2025-08-10T01:11:47.3379452Z ‚úì debug_mode is preserved in deserialization
2025-08-10T01:11:47.3380112Z ‚úì debug_mode defaults to True when missing from deserialization
2025-08-10T01:11:47.3380540Z
2025-08-10T01:11:47.3380696Z === Testing Entity Schema Constant ===
2025-08-10T01:11:47.3381341Z ‚úì Entity schema has been properly integrated into game_state instructions
2025-08-10T01:11:47.3381780Z
2025-08-10T01:11:47.3381928Z === Testing Manifest Cache Exclusion ===
2025-08-10T01:11:47.3382572Z ‚úì Internal attributes starting with _ are excluded from serialization
2025-08-10T01:11:47.3389756Z
2025-08-10T01:11:47.3393022Z === Testing Entity ID Format ===
2025-08-10T01:11:47.3396709Z ‚úì PC entity ID format correct: pc_test_hero_001
2025-08-10T01:11:47.3400736Z ‚úì NPC entity ID format correct: npc_guard_captain_001
2025-08-10T01:11:47.3404163Z
2025-08-10T01:11:47.3407449Z === All PR Change Tests Passed! ===
2025-08-10T01:11:47.3574145Z ‚úÖ PASS: tests/test_pr_changes_runner.py
2025-08-10T01:11:47.3576707Z ----------------------------------------
2025-08-10T01:11:47.3579119Z Running: tests/test_production_parity.py
2025-08-10T01:11:47.6844340Z 2025-08-10 01:11:47,684 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:47.6974222Z ss
2025-08-10T01:11:47.6974932Z ----------------------------------------------------------------------
2025-08-10T01:11:47.6976776Z Ran 2 tests in 0.000s
2025-08-10T01:11:47.6978365Z
2025-08-10T01:11:47.6979139Z OK (skipped=2)
2025-08-10T01:11:47.7509267Z ‚úÖ PASS: tests/test_production_parity.py
2025-08-10T01:11:47.7514739Z ----------------------------------------
2025-08-10T01:11:47.7515277Z Running: tests/test_prompt_mission_examples.py
2025-08-10T01:11:47.7883950Z ....
2025-08-10T01:11:47.7887456Z ----------------------------------------------------------------------
2025-08-10T01:11:47.7888954Z Ran 4 tests in 0.001s
2025-08-10T01:11:47.7889180Z
2025-08-10T01:11:47.7889306Z OK
2025-08-10T01:11:47.7940095Z ‚úÖ PASS: tests/test_prompt_mission_examples.py
2025-08-10T01:11:47.7941099Z ----------------------------------------
2025-08-10T01:11:47.7942939Z Running: tests/test_prompt_npc_examples.py
2025-08-10T01:11:47.8307467Z ....
2025-08-10T01:11:47.8309436Z ----------------------------------------------------------------------
2025-08-10T01:11:47.8310844Z Ran 4 tests in 0.001s
2025-08-10T01:11:47.8311079Z
2025-08-10T01:11:47.8311202Z OK
2025-08-10T01:11:47.8365651Z ‚úÖ PASS: tests/test_prompt_npc_examples.py
2025-08-10T01:11:47.8367009Z ----------------------------------------
2025-08-10T01:11:47.8367499Z Running: tests/test_prompts.py
2025-08-10T01:11:48.8792048Z 2025-08-10 01:11:48,878 - INFO - --- Running Test: test_all_prompt_files_are_registered_in_service ---
2025-08-10T01:11:48.8793653Z .2025-08-10 01:11:48,879 - INFO - --- Running Test: test_all_prompts_are_loadable_via_service ---
2025-08-10T01:11:48.8797124Z 2025-08-10 01:11:48,879 - INFO - Cache MISS for narrative_system_instruction.md: loaded and cached 40868 characters (~10217 tokens)
2025-08-10T01:11:48.8801490Z 2025-08-10 01:11:48,879 - INFO - Cache MISS for mechanics_system_instruction.md: loaded and cached 51025 characters (~12756 tokens)
2025-08-10T01:11:48.8805842Z 2025-08-10 01:11:48,880 - INFO - Cache MISS for game_state_instruction.md: loaded and cached 56680 characters (~14170 tokens)
2025-08-10T01:11:48.8809896Z 2025-08-10 01:11:48,880 - INFO - Cache MISS for character_template.md: loaded and cached 6696 characters (~1674 tokens)
2025-08-10T01:11:48.8813248Z 2025-08-10 01:11:48,880 - INFO - Cache MISS for master_directive.md: loaded and cached 8299 characters (~2074 tokens)
2025-08-10T01:11:48.8814465Z 2025-08-10 01:11:48,880 - INFO - Cache MISS for dnd_srd_instruction.md: loaded and cached 1216 characters (~304 tokens)
2025-08-10T01:11:48.8815523Z .2025-08-10 01:11:48,881 - INFO - --- Running Test: test_all_registered_prompts_are_actually_used ---
2025-08-10T01:11:48.8992732Z .2025-08-10 01:11:48,899 - INFO - --- Running Test: test_loading_unknown_prompt_raises_error ---
2025-08-10T01:11:48.8997270Z ‚úì Always-loaded prompts: 3/3 verified
2025-08-10T01:11:48.8998390Z 2025-08-10 01:11:48,899 - ERROR - üî•üî¥ FATAL: Unknown instruction type requested: this_is_not_a_real_prompt_type
2025-08-10T01:11:48.8999080Z .
2025-08-10T01:11:48.8999414Z ----------------------------------------------------------------------
2025-08-10T01:11:48.8999866Z Ran 4 tests in 0.020s
2025-08-10T01:11:48.9000068Z
2025-08-10T01:11:48.9000172Z OK
2025-08-10T01:11:48.9000560Z ‚úì Conditional prompts: 3/3 properly referenced
2025-08-10T01:11:49.0545464Z ‚úÖ PASS: tests/test_prompts.py
2025-08-10T01:11:49.0547064Z ----------------------------------------
2025-08-10T01:11:49.0547605Z Running: tests/test_random_campaign_generation.py
2025-08-10T01:11:50.1647694Z 2025-08-10 01:11:50,164 - INFO - Skipping Firebase initialization in testing mode
2025-08-10T01:11:50.1665090Z test_build_campaign_prompt_partial_inputs (__main__.TestRandomCampaignGeneration.test_build_campaign_prompt_partial_inputs)
2025-08-10T01:11:50.1666600Z Test campaign prompt building with partial inputs. ... ok
2025-08-10T01:11:50.1668328Z test_build_campaign_prompt_random_arrays_not_empty (__main__.TestRandomCampaignGeneration.test_build_campaign_prompt_random_arrays_not_empty)
2025-08-10T01:11:50.1670009Z Test that our random arrays are properly defined and not empty. ... ok
2025-08-10T01:11:50.1671377Z test_build_campaign_prompt_random_generation (__main__.TestRandomCampaignGeneration.test_build_campaign_prompt_random_generation)
2025-08-10T01:11:50.1674058Z Test that empty inputs trigger random campaign generation using predefined arrays. ... 2025-08-10 01:11:50,166 - INFO - Generated random campaign: character='A skilled ranger who knows the wilderness like no other', setting='The jungle continent of Chult, where ancient ruins hide deadly secrets and treasures'
2025-08-10T01:11:50.1676936Z ok
2025-08-10T01:11:50.1678389Z test_build_campaign_prompt_random_generation_deterministic (__main__.TestRandomCampaignGeneration.test_build_campaign_prompt_random_generation_deterministic)
2025-08-10T01:11:50.1681257Z Test random generation with mocked random choice for deterministic testing. ... 2025-08-10 01:11:50,167 - INFO - Generated random campaign: character='A brave warrior seeking to prove their worth in battle', setting='The bustling city of Waterdeep, where intrigue and adventure await around every corner'
2025-08-10T01:11:50.1683621Z ok
2025-08-10T01:11:50.1684852Z test_build_campaign_prompt_random_generation_variability (__main__.TestRandomCampaignGeneration.test_build_campaign_prompt_random_generation_variability)
2025-08-10T01:11:50.1686610Z üé≤ Random Campaign Generation Test
2025-08-10T01:11:50.1691389Z Test that random generation produces different results on multiple calls. ... 2025-08-10 01:11:50,167 - INFO - Generated random campaign: character='A stealthy monk trained in martial arts and inner discipline', setting='The haunted moors of Barovia, trapped in eternal mist and ruled by dark powers'
2025-08-10T01:11:50.1693860Z 2025-08-10 01:11:50,167 - INFO - Generated random campaign: character='A cunning rogue with a mysterious past and hidden agenda', setting='The war-torn kingdom of Cyre, struggling to rebuild after magical devastation'
2025-08-10T01:11:50.1695909Z 2025-08-10 01:11:50,167 - INFO - Generated random campaign: character='A nature-loving druid who can shapeshift and command beasts', setting='The war-torn kingdom of Cyre, struggling to rebuild after magical devastation'
2025-08-10T01:11:50.1698119Z 2025-08-10 01:11:50,167 - INFO - Generated random campaign: character='A devout cleric blessed with divine power to heal and smite', setting='The mystical Feywild, a realm where magic runs wild and reality bends to emotion'
2025-08-10T01:11:50.1700199Z 2025-08-10 01:11:50,167 - INFO - Generated random campaign: character='A cunning rogue with a mysterious past and hidden agenda', setting='The frozen lands of Icewind Dale, where survival means everything in the harsh tundra'
2025-08-10T01:11:50.1702267Z 2025-08-10 01:11:50,167 - INFO - Generated random campaign: character='A wise wizard devoted to uncovering ancient magical secrets', setting='The mystical Feywild, a realm where magic runs wild and reality bends to emotion'
2025-08-10T01:11:50.1704296Z 2025-08-10 01:11:50,167 - INFO - Generated random campaign: character='A skilled ranger who knows the wilderness like no other', setting='The jungle continent of Chult, where ancient ruins hide deadly secrets and treasures'
2025-08-10T01:11:50.1706411Z 2025-08-10 01:11:50,167 - INFO - Generated random campaign: character='A nature-loving druid who can shapeshift and command beasts', setting='The mystical Feywild, a realm where magic runs wild and reality bends to emotion'
2025-08-10T01:11:50.1708557Z 2025-08-10 01:11:50,168 - INFO - Generated random campaign: character='A skilled ranger who knows the wilderness like no other', setting='The floating city of Sharn, where magic and technology create vertical neighborhoods'
2025-08-10T01:11:50.1710558Z 2025-08-10 01:11:50,168 - INFO - Generated random campaign: character='A brave warrior seeking to prove their worth in battle', setting='The jungle continent of Chult, where ancient ruins hide deadly secrets and treasures'
2025-08-10T01:11:50.1711730Z ok
2025-08-10T01:11:50.1712457Z test_build_campaign_prompt_uses_old_prompt (__main__.TestRandomCampaignGeneration.test_build_campaign_prompt_uses_old_prompt)
2025-08-10T01:11:50.1713363Z Test that old_prompt is used when provided. ... ok
2025-08-10T01:11:50.1714298Z test_build_campaign_prompt_whitespace_handling (__main__.TestRandomCampaignGeneration.test_build_campaign_prompt_whitespace_handling)
2025-08-10T01:11:50.1716746Z Test that whitespace-only inputs are treated as empty and trigger random generation. ... 2025-08-10 01:11:50,168 - INFO - Generated random campaign: character='A fierce barbarian driven by primal instincts and tribal honor', setting='The bustling city of Waterdeep, where intrigue and adventure await around every corner'
2025-08-10T01:11:50.1718568Z ok
2025-08-10T01:11:50.1719272Z test_build_campaign_prompt_with_all_inputs (__main__.TestRandomCampaignGeneration.test_build_campaign_prompt_with_all_inputs)
2025-08-10T01:11:50.1720258Z Test normal campaign prompt building with all inputs provided. ... ok
2025-08-10T01:11:50.1720873Z
2025-08-10T01:11:50.1721078Z ----------------------------------------------------------------------
2025-08-10T01:11:50.1721548Z Ran 8 tests in 0.002s
2025-08-10T01:11:50.1721739Z
2025-08-10T01:11:50.1721842Z OK
2025-08-10T01:11:50.1722335Z Testing that _build_campaign_prompt uses RANDOM_CHARACTERS and RANDOM_SETTINGS arrays
2025-08-10T01:11:50.1722995Z ================================================================================
2025-08-10T01:11:50.3535164Z ‚úÖ PASS: tests/test_random_campaign_generation.py
2025-08-10T01:11:50.3536667Z ----------------------------------------
2025-08-10T01:11:50.3537202Z Running: tests/test_raw_json_display_bug_reproduction.py
2025-08-10T01:11:50.3999382Z ..
2025-08-10T01:11:50.4000979Z ----------------------------------------------------------------------
2025-08-10T01:11:50.4001531Z Ran 2 tests in 0.000s
2025-08-10T01:11:50.4001761Z
2025-08-10T01:11:50.4001881Z OK
2025-08-10T01:11:50.4069308Z ‚úÖ PASS: tests/test_raw_json_display_bug_reproduction.py
2025-08-10T01:11:50.4070370Z ----------------------------------------
2025-08-10T01:11:50.4071348Z Running: tests/test_react_v2_tdd_critical_issues.py
2025-08-10T01:11:50.5323387Z test_campaign_creation_uses_user_input_green (__main__.ReactV2CriticalIssuesTDD.test_campaign_creation_uses_user_input_green)
2025-08-10T01:11:50.5346906Z üü¢ GREEN TEST: Campaign creation should use actual user input, not hardcoded values ... ok
2025-08-10T01:11:50.5349121Z test_campaign_id_routing_implemented_red (__main__.ReactV2CriticalIssuesTDD.test_campaign_id_routing_implemented_red)
2025-08-10T01:11:50.5351474Z üî¥ RED TEST: /campaign/:id URLs should route properly ... ok
2025-08-10T01:11:50.5352440Z test_clean_campaign_card_display_green (__main__.ReactV2CriticalIssuesTDD.test_clean_campaign_card_display_green)
2025-08-10T01:11:50.5355473Z üü¢ GREEN TEST: Campaign cards should display clean, user-friendly information ... ok
2025-08-10T01:11:50.5357068Z test_full_campaign_creation_workflow_integration (__main__.ReactV2CriticalIssuesTDD.test_full_campaign_creation_workflow_integration)
2025-08-10T01:11:50.5360101Z üü¢ INTEGRATION: Complete campaign creation workflow without hardcoded interference ... ok
2025-08-10T01:11:50.5363379Z test_gameplay_view_no_infinite_renders_red (__main__.ReactV2CriticalIssuesTDD.test_gameplay_view_no_infinite_renders_red)
2025-08-10T01:11:50.5371016Z üî¥ RED TEST: GamePlayView component should not cause infinite re-render loops ... ok
2025-08-10T01:11:50.5372229Z test_gameplay_view_stable_useeffect_green (__main__.ReactV2CriticalIssuesTDD.test_gameplay_view_stable_useeffect_green)
2025-08-10T01:11:50.5378159Z üü¢ GREEN TEST: GamePlayView useEffect should have stable dependencies ... ok
2025-08-10T01:11:50.5379231Z test_hardcoded_ser_arion_removed_from_tsx_red (__main__.ReactV2CriticalIssuesTDD.test_hardcoded_ser_arion_removed_from_tsx_red)
2025-08-10T01:11:50.5380438Z üî¥ RED TEST: CampaignCreationV2.tsx should not contain hardcoded "Ser Arion" ... ok
2025-08-10T01:11:50.5381539Z test_intermediate_fantasy_text_removed_red (__main__.ReactV2CriticalIssuesTDD.test_intermediate_fantasy_text_removed_red)
2025-08-10T01:11:50.5382671Z üî¥ RED TEST: Campaign cards should not show "intermediate ‚Ä¢ fantasy" clutter ... ok
2025-08-10T01:11:50.5383532Z test_settings_button_exists_red (__main__.ReactV2CriticalIssuesTDD.test_settings_button_exists_red)
2025-08-10T01:11:50.5384775Z üî¥ RED TEST: Settings button should exist beside "Create Campaign" ... ok
2025-08-10T01:11:50.5385651Z test_sign_out_functionality_exists_red (__main__.ReactV2CriticalIssuesTDD.test_sign_out_functionality_exists_red)
2025-08-10T01:11:50.5386591Z üî¥ RED TEST: Sign out functionality should be accessible ... ok
2025-08-10T01:11:50.5386936Z
2025-08-10T01:11:50.5396544Z ----------------------------------------------------------------------
2025-08-10T01:11:50.5397109Z Ran 10 tests in 0.005s
2025-08-10T01:11:50.5397338Z
2025-08-10T01:11:50.5397452Z OK
2025-08-10T01:11:50.5397607Z
2025-08-10T01:11:50.5398228Z ======================================================================
2025-08-10T01:11:50.5398867Z üß™ REACT V2 CRITICAL ISSUES: TDD RED/GREEN TEST SUITE
2025-08-10T01:11:50.5399341Z ======================================================================
2025-08-10T01:11:50.5399633Z
2025-08-10T01:11:50.5399801Z üéØ TESTING STRATEGY:
2025-08-10T01:11:50.5400295Z    üî¥ RED TESTS: Should FAIL initially, driving implementation
2025-08-10T01:11:50.5400948Z    üü¢ GREEN TESTS: Should PASS after fixes are implemented
2025-08-10T01:11:50.5401593Z    üîÑ REFACTOR: Code improvements while maintaining GREEN state
2025-08-10T01:11:50.5402232Z üü¢ GREEN TEST: Validating campaign creation uses user input
2025-08-10T01:11:50.5402896Z ‚ö†Ô∏è Backend not running, but hardcoding validation still applies
2025-08-10T01:11:50.5403551Z ‚úÖ Frontend should use user input regardless of backend state
2025-08-10T01:11:50.5404137Z üî¥ RED TEST: Testing /campaign/:id URL routing
2025-08-10T01:11:50.5404651Z ‚úÖ Campaign ID routing properly configured
2025-08-10T01:11:50.5405220Z üü¢ GREEN TEST: Validating clean campaign card display
2025-08-10T01:11:50.5405837Z ‚úÖ Campaign cards display user-meaningful information
2025-08-10T01:11:50.5406430Z ‚úÖ Clean presentation without technical clutter text
2025-08-10T01:11:50.5407053Z üü¢ INTEGRATION: Testing complete campaign creation workflow
2025-08-10T01:11:50.5407614Z    Testing scenario: Lady Elara in Enchanted Woods
2025-08-10T01:11:50.5408319Z    Testing scenario: Sir Marcus in Ancient Ruins
2025-08-10T01:11:50.5408847Z    Testing scenario: Wizard Thorin in Dwarven Halls
2025-08-10T01:11:50.5409505Z ‚úÖ All test scenarios use custom character names, no hardcoding
2025-08-10T01:11:50.5410278Z ‚úÖ Integration workflow preserves user input throughout the process
2025-08-10T01:11:50.5411122Z üî¥ RED TEST: Checking GamePlayView.tsx for infinite render loop patterns
2025-08-10T01:11:50.5411861Z ‚úÖ GamePlayView has no infinite render loop patterns
2025-08-10T01:11:50.5412601Z üü¢ GREEN TEST: Validating GamePlayView has stable useEffect dependencies
2025-08-10T01:11:50.5413280Z ‚úÖ GamePlayView useEffect has stable dependencies
2025-08-10T01:11:50.5413820Z ‚úÖ Mode changes don't trigger infinite API calls
2025-08-10T01:11:50.5414436Z üî¥ RED TEST: Checking for hardcoded 'Ser Arion' in React components
2025-08-10T01:11:50.5415108Z ‚úÖ No hardcoded character names found in React components
2025-08-10T01:11:50.5415793Z üî¥ RED TEST: Checking for 'intermediate ‚Ä¢ fantasy' text clutter
2025-08-10T01:11:50.5416396Z ‚úÖ No 'intermediate ‚Ä¢ fantasy' text clutter found
2025-08-10T01:11:50.5416985Z üî¥ RED TEST: Testing for settings button in campaigns page
2025-08-10T01:11:50.5417553Z ‚úÖ Settings button found in campaigns page
2025-08-10T01:11:50.5418264Z üî¥ RED TEST: Testing for sign-out functionality
2025-08-10T01:11:50.5418770Z ‚úÖ Sign-out functionality found
2025-08-10T01:11:50.5419021Z
2025-08-10T01:11:50.5419171Z ======================================================================
2025-08-10T01:11:50.5419732Z üü¢ GREEN STATE ACHIEVED: All React V2 critical issues fixed!
2025-08-10T01:11:50.5420209Z ‚úÖ 10 tests passed
2025-08-10T01:11:50.5420377Z
2025-08-10T01:11:50.5420524Z üéØ VERIFIED FIXES:
2025-08-10T01:11:50.5420877Z    ‚Ä¢ Hardcoded character names removed ‚úÖ
2025-08-10T01:11:50.5421295Z    ‚Ä¢ Text clutter eliminated ‚úÖ
2025-08-10T01:11:50.5421679Z    ‚Ä¢ URL routing implemented ‚úÖ
2025-08-10T01:11:50.5422149Z    ‚Ä¢ Settings functionality added ‚úÖ
2025-08-10T01:11:50.5422902Z    ‚Ä¢ Sign-out feature accessible ‚úÖ
2025-08-10T01:11:50.5423408Z    ‚Ä¢ User input preserved throughout workflow ‚úÖ
2025-08-10T01:11:50.5423719Z
2025-08-10T01:11:50.5423928Z üöÄ REACT V2 READY FOR PRODUCTION!
2025-08-10T01:11:50.5424318Z ======================================================================
2025-08-10T01:11:50.5552255Z ‚úÖ PASS: tests/test_react_v2_tdd_critical_issues.py
2025-08-10T01:11:50.5553507Z ----------------------------------------
2025-08-10T01:11:50.5553984Z Running: tests/test_real_api_integration.py
2025-08-10T01:11:50.6797147Z test_api_service_no_test_bypass_green (__main__.RealAPIIntegrationTest.test_api_service_no_test_bypass_green)
2025-08-10T01:11:50.6803116Z üü¢ GREEN TEST: Verify that api.service.ts has test mode disabled ... FAIL
2025-08-10T01:11:50.6805280Z test_campaign_creation_api_integration (__main__.RealAPIIntegrationTest.test_campaign_creation_api_integration)
2025-08-10T01:11:50.6806888Z üü¢ GREEN TEST: Integration test - Campaign creation makes real API call ... skipped 'Skipping API integration test in CI environment'
2025-08-10T01:11:50.6808373Z test_flask_backend_reachable (__main__.RealAPIIntegrationTest.test_flask_backend_reachable)
2025-08-10T01:11:50.6809793Z üü¢ GREEN TEST: Verify Flask backend is running and reachable ... skipped 'Skipping backend connectivity test in CI environment'
2025-08-10T01:11:50.6810998Z test_mock_mode_disabled_red (__main__.RealAPIIntegrationTest.test_mock_mode_disabled_red)
2025-08-10T01:11:50.6814859Z üî¥ RED TEST: Verify that mock mode was returning fake data ... skipped 'Mock service not found - this means mock mode is properly disabled'
2025-08-10T01:11:50.6817112Z test_mock_toggle_removed_green (__main__.RealAPIIntegrationTest.test_mock_toggle_removed_green)
2025-08-10T01:11:50.6818396Z üü¢ GREEN TEST: Verify MockModeToggle is removed from UI ... ok
2025-08-10T01:11:50.6819398Z test_no_mock_service_in_production_path (__main__.RealAPIIntegrationTest.test_no_mock_service_in_production_path)
2025-08-10T01:11:50.6820542Z üü¢ GREEN TEST: Verify mock service is not in production import path ... ok
2025-08-10T01:11:50.6821794Z test_real_api_service_export_green (__main__.RealAPIIntegrationTest.test_real_api_service_export_green)
2025-08-10T01:11:50.6822434Z
2025-08-10T01:11:50.6822920Z üü¢ GREEN TEST: Verify that services/index.ts exports real API service ... ok
2025-08-10T01:11:50.6823508Z ============================================================
2025-08-10T01:11:50.6824372Z üß™ REAL API INTEGRATION: RED/GREEN TEST SUITE
2025-08-10T01:11:50.6824801Z
2025-08-10T01:11:50.6824973Z ======================================================================
2025-08-10T01:11:50.6825818Z FAIL: test_api_service_no_test_bypass_green (__main__.RealAPIIntegrationTest.test_api_service_no_test_bypass_green)
2025-08-10T01:11:50.6826791Z üü¢ GREEN TEST: Verify that api.service.ts has test mode disabled
2025-08-10T01:11:50.6827385Z ----------------------------------------------------------------------
2025-08-10T01:11:50.6828069Z Traceback (most recent call last):
2025-08-10T01:11:50.6829191Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/test_real_api_integration.py", line 99, in test_api_service_no_test_bypass_green
2025-08-10T01:11:50.6830289Z     assert "this.testAuthBypass = null;" in content
2025-08-10T01:11:50.6830729Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:50.6831106Z AssertionError
2025-08-10T01:11:50.6831275Z
2025-08-10T01:11:50.6831478Z ----------------------------------------------------------------------
2025-08-10T01:11:50.6831943Z Ran 7 tests in 0.002s
2025-08-10T01:11:50.6832158Z
2025-08-10T01:11:50.6832307Z FAILED (failures=1, skipped=3)
2025-08-10T01:11:50.6832667Z ============================================================
2025-08-10T01:11:50.6833459Z üü¢ GREEN TEST: Verifying test mode is disabled in API service
2025-08-10T01:11:50.6834124Z üü¢ GREEN TEST: Testing full campaign creation API integration
2025-08-10T01:11:50.6835707Z üü¢ GREEN TEST: Testing Flask backend connectivity
2025-08-10T01:11:50.6837187Z üî¥ RED TEST: Testing that mock mode is disabled
2025-08-10T01:11:50.6837872Z üü¢ GREEN TEST: Verifying MockModeToggle is removed
2025-08-10T01:11:50.6838413Z ‚úÖ MockModeToggle component is removed from UI
2025-08-10T01:11:50.6838934Z üü¢ GREEN TEST: Checking production import paths
2025-08-10T01:11:50.6839438Z ‚úÖ CampaignCreationPage uses real API service
2025-08-10T01:11:50.6839957Z üü¢ GREEN TEST: Verifying real API service export
2025-08-10T01:11:50.6840486Z ‚úÖ Services index correctly exports real API service
2025-08-10T01:11:50.6840802Z
2025-08-10T01:11:50.6841160Z ============================================================
2025-08-10T01:11:50.6841676Z üî¥ RED STATE: Real API integration not working!
2025-08-10T01:11:50.6842131Z ‚ùå 1 test failures
2025-08-10T01:11:50.6842452Z ‚ùå 0 test errors
2025-08-10T01:11:50.6842608Z
2025-08-10T01:11:50.6842747Z üîç FAILURES:
2025-08-10T01:11:50.6843688Z    ‚Ä¢ test_api_service_no_test_bypass_green (__main__.RealAPIIntegrationTest.test_api_service_no_test_bypass_green): Traceback (most recent call last):
2025-08-10T01:11:50.6845305Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/tests/test_real_api_integration.py", line 99, in test_api_service_no_test_bypass_green
2025-08-10T01:11:50.6846372Z     assert "this.testAuthBypass = null;" in content
2025-08-10T01:11:50.6846790Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:50.6847153Z AssertionError
2025-08-10T01:11:50.6847458Z ============================================================
2025-08-10T01:11:50.7009103Z ‚ùå FAIL: tests/test_real_api_integration.py
2025-08-10T01:11:50.7010400Z ----------------------------------------
2025-08-10T01:11:50.7010920Z Running: tests/test_real_json_bug_reproduction.py
2025-08-10T01:11:50.7472088Z ..
2025-08-10T01:11:50.7472737Z \nTesting exact user JSON structure...
2025-08-10T01:11:50.7474490Z ----------------------------------------------------------------------
2025-08-10T01:11:50.7475050Z Ran 2 tests in 0.000s
2025-08-10T01:11:50.7475260Z
2025-08-10T01:11:50.7475374Z OK
2025-08-10T01:11:50.7476788Z Input length: 5399
2025-08-10T01:11:50.7478291Z Input preview: {
2025-08-10T01:11:50.7479700Z     "narrative": "[Mode: STORY MODE]\n[CHARACTER CREATION - Step 2 of 7]\n\n\"Understood,\" the voice echoes, a comforting presence as you consider your newfound destiny. \"Allow me to craft an iden...
2025-08-10T01:11:50.7481604Z \nResult length: 4239
2025-08-10T01:11:50.7481981Z Result preview: [Mode: STORY MODE]
2025-08-10T01:11:50.7482429Z [CHARACTER CREATION - Step 2 of 7]
2025-08-10T01:11:50.7482712Z
2025-08-10T01:11:50.7483446Z "Understood," the voice echoes, a comforting presence as you consider your newfound destiny. "Allow me to craft an identity that truly reflects t...
2025-08-10T01:11:50.7544572Z ‚úÖ PASS: tests/test_real_json_bug_reproduction.py
2025-08-10T01:11:50.7545836Z ----------------------------------------
2025-08-10T01:11:50.7546340Z Running: tests/test_red_green_demonstration.py
2025-08-10T01:11:50.8169344Z GeminiResponse Integration Bug Fix - TDD Demonstration
2025-08-10T01:11:50.8171010Z ============================================================
2025-08-10T01:11:50.8171327Z
2025-08-10T01:11:50.8171745Z üß™ TEST-DRIVEN DEVELOPMENT CYCLE
2025-08-10T01:11:50.8172155Z ============================================================
2025-08-10T01:11:50.8172449Z
2025-08-10T01:11:50.8172665Z 1. üî¥ RED: Write failing test
2025-08-10T01:11:50.8173203Z    ‚Ä¢ Test expects GeminiResponse integration to work
2025-08-10T01:11:50.8173874Z    ‚Ä¢ Test fails because firestore can't encode GeminiResponse
2025-08-10T01:11:50.8174619Z    ‚Ä¢ Error: 'GeminiResponse' object has no attribute 'encode'
2025-08-10T01:11:50.8175013Z
2025-08-10T01:11:50.8175230Z 2. üü¢ GREEN: Make test pass
2025-08-10T01:11:50.8175741Z    ‚Ä¢ Extract .narrative_text from GeminiResponse
2025-08-10T01:11:50.8176333Z    ‚Ä¢ Pass string to firestore instead of object
2025-08-10T01:11:50.8176840Z    ‚Ä¢ Test now passes
2025-08-10T01:11:50.8177431Z
2025-08-10T01:11:50.8177640Z 3. üîÑ REFACTOR: Clean up
2025-08-10T01:11:50.8178985Z    ‚Ä¢ Update all test mocks to return GeminiResponse
2025-08-10T01:11:50.8179558Z    ‚Ä¢ Ensure consistent interface
2025-08-10T01:11:50.8180045Z    ‚Ä¢ Maintain backward compatibility
2025-08-10T01:11:50.8180330Z
2025-08-10T01:11:50.8180553Z üî¥ RED PHASE: Demonstrating the bug
2025-08-10T01:11:50.8180981Z ==================================================
2025-08-10T01:11:50.8181543Z ‚úÖ get_initial_story() returns: GeminiResponse
2025-08-10T01:11:50.8182380Z ‚úÖ GeminiResponse.narrative_text: 'Your adventure begins in a bustling tavern......'
2025-08-10T01:11:50.8183194Z
2025-08-10T01:11:50.8183568Z ‚ùå BEFORE FIX: firestore_service.add_story_entry() tries to call:
2025-08-10T01:11:50.8184122Z    text.encode('utf-8')
2025-08-10T01:11:50.8184494Z    where text = gemini_response_object
2025-08-10T01:11:50.8184787Z
2025-08-10T01:11:50.8185201Z    ‚ùå AttributeError: 'GeminiResponse' object has no attribute 'encode'
2025-08-10T01:11:50.8185856Z    ‚ùå Campaign creation fails!
2025-08-10T01:11:50.8186096Z
2025-08-10T01:11:50.8186318Z üü¢ GREEN PHASE: Demonstrating the fix
2025-08-10T01:11:50.8186716Z ==================================================
2025-08-10T01:11:50.8187246Z ‚úÖ get_initial_story() returns: GeminiResponse
2025-08-10T01:11:50.8187567Z
2025-08-10T01:11:50.8188079Z ‚úÖ AFTER FIX: main.py extracts narrative_text:
2025-08-10T01:11:50.8188666Z    opening_story_response = gemini_service.get_initial_story(...)
2025-08-10T01:11:50.8189359Z    create_campaign(..., opening_story_response.narrative_text, ...)
2025-08-10T01:11:50.8189753Z
2025-08-10T01:11:50.8189959Z ‚úÖ Extracted narrative_text: str
2025-08-10T01:11:50.8190456Z ‚úÖ Content: 'Your adventure begins in a bustling tavern......'
2025-08-10T01:11:50.8190981Z ‚úÖ Successfully encoded: 45 bytes
2025-08-10T01:11:50.8191456Z ‚úÖ Campaign creation succeeds!
2025-08-10T01:11:50.8191721Z
2025-08-10T01:11:50.8191934Z üîÑ REFACTOR PHASE: Clean architecture
2025-08-10T01:11:50.8192333Z ==================================================
2025-08-10T01:11:50.8192817Z ‚úÖ Clean separation of concerns:
2025-08-10T01:11:50.8193377Z    ‚Ä¢ GeminiResponse: Encapsulates AI service response
2025-08-10T01:11:50.8194003Z    ‚Ä¢ .narrative_text: Clean narrative for users
2025-08-10T01:11:50.8194619Z    ‚Ä¢ .structured_response: State updates and entities
2025-08-10T01:11:50.8195208Z    ‚Ä¢ .debug_tags_present: Debug monitoring
2025-08-10T01:11:50.8195528Z
2025-08-10T01:11:50.8195756Z ‚úÖ Backward compatibility maintained:
2025-08-10T01:11:50.8196282Z    ‚Ä¢ All existing functionality preserved
2025-08-10T01:11:50.8196807Z    ‚Ä¢ Tests updated to use new interface
2025-08-10T01:11:50.8197304Z    ‚Ä¢ No breaking changes
2025-08-10T01:11:50.8197532Z
2025-08-10T01:11:50.8197909Z ‚úÖ Benefits achieved:
2025-08-10T01:11:50.8198374Z    ‚Ä¢ Type safety with GeminiResponse objects
2025-08-10T01:11:50.8198910Z    ‚Ä¢ Clear interface between services
2025-08-10T01:11:50.8199414Z    ‚Ä¢ Debug monitoring capabilities
2025-08-10T01:11:50.8199931Z    ‚Ä¢ Consistent JSON response handling
2025-08-10T01:11:50.8200234Z
2025-08-10T01:11:50.8200437Z üéâ SUMMARY: TDD cycle complete!
2025-08-10T01:11:50.8200894Z    ‚Ä¢ Bug identified and reproduced (RED)
2025-08-10T01:11:50.8201397Z    ‚Ä¢ Fix implemented and tested (GREEN)
2025-08-10T01:11:50.8201910Z    ‚Ä¢ Architecture improved (REFACTOR)
2025-08-10T01:11:50.8202399Z    ‚Ä¢ All 67 tests passing ‚úÖ
2025-08-10T01:11:50.8271614Z ‚úÖ PASS: tests/test_red_green_demonstration.py
2025-08-10T01:11:50.8272855Z ----------------------------------------
2025-08-10T01:11:50.8273333Z Running: tests/test_red_green_json_fix.py
2025-08-10T01:11:50.8707531Z test_green_state_comprehensive_fix (__main__.TestRedGreenJSONFix.test_green_state_comprehensive_fix)
2025-08-10T01:11:50.8711743Z GREEN TEST: Demonstrates the complete fix working ... WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:50.8720272Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:50.8722353Z ok
2025-08-10T01:11:50.8723038Z test_red_state_escaped_characters (__main__.TestRedGreenJSONFix.test_red_state_escaped_characters)
2025-08-10T01:11:50.8723998Z RED TEST: JSON with escaped characters like \n and \" ... ok
2025-08-10T01:11:50.8724985Z test_red_state_markdown_wrapped_json (__main__.TestRedGreenJSONFix.test_red_state_markdown_wrapped_json)
2025-08-10T01:11:50.8726187Z RED TEST: AI returns JSON wrapped in markdown code blocks ... ok
2025-08-10T01:11:50.8727294Z test_red_state_partial_json_fallback (__main__.TestRedGreenJSONFix.test_red_state_partial_json_fallback)
2025-08-10T01:11:50.8729532Z RED TEST: Partial JSON that can't be parsed ... WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:50.8730444Z ok
2025-08-10T01:11:50.8730730Z ============================================================
2025-08-10T01:11:50.8732374Z RED/GREEN TESTING: JSON Display Bug Fix
2025-08-10T01:11:50.8733621Z ============================================================
2025-08-10T01:11:50.8733959Z
2025-08-10T01:11:50.8734185Z This demonstrates how the bug manifested (red state)
2025-08-10T01:11:50.8734714Z and how the fix resolves it (green state).
2025-08-10T01:11:50.8735031Z
2025-08-10T01:11:50.8735039Z
2025-08-10T01:11:50.8735196Z === GREEN STATE TEST: Complete Fix ===
2025-08-10T01:11:50.8735768Z   ‚úì Plain JSON: Clean narrative extracted
2025-08-10T01:11:50.8736360Z   ‚úì Markdown-wrapped: Clean narrative extracted
2025-08-10T01:11:50.8736941Z   ‚úì Partial JSON: Clean narrative extracted
2025-08-10T01:11:50.8737508Z   ‚úì Escaped chars: Clean narrative extracted
2025-08-10T01:11:50.8738390Z   ‚úì Malformed: Clean narrative extracted
2025-08-10T01:11:50.8738938Z   ‚úì Invalid field: Clean narrative extracted
2025-08-10T01:11:50.8739255Z
2025-08-10T01:11:50.8739554Z ‚úì GREEN: All test cases pass - users never see JSON!
2025-08-10T01:11:50.8739922Z
2025-08-10T01:11:50.8740090Z === RED STATE TEST: Escaped Characters ===
2025-08-10T01:11:50.8740719Z Returned narrative: 'She said "Hello!"\nNew line here\nAnother line'...
2025-08-10T01:11:50.8741436Z ‚úì GREEN: Escape sequences properly converted
2025-08-10T01:11:50.8741747Z
2025-08-10T01:11:50.8741916Z === RED STATE TEST: Markdown-wrapped JSON ===
2025-08-10T01:11:50.8742582Z Returned narrative: [Mode: DM MODE] Understanding confirmed. Processing user request....
2025-08-10T01:11:50.8743386Z ‚úì GREEN: Markdown unwrapped, JSON parsed correctly
2025-08-10T01:11:50.8743732Z
2025-08-10T01:11:50.8743878Z === RED STATE TEST: Partial JSON ===
2025-08-10T01:11:50.8744293Z Returned narrative: The story continues...
2025-08-10T01:11:50.8744783Z ‚úì GREEN: Narrative extracted from partial JSON
2025-08-10T01:11:50.8745060Z
2025-08-10T01:11:50.8745211Z === RED STATE TEST: Raw JSON Bug ===
2025-08-10T01:11:50.8745970Z Returned narrative: Scene #14: [Mode: DM MODE] The party continues their journey through the mystical forest....
2025-08-10T01:11:50.8746899Z ‚úì GREEN: JSON properly parsed, narrative extracted
2025-08-10T01:11:50.8747271Z
2025-08-10T01:11:50.8747449Z === SIMULATING RED STATE (Bug Behavior) ===
2025-08-10T01:11:50.8747922Z
2025-08-10T01:11:50.8748070Z BUG OUTPUT (what users saw):
2025-08-10T01:11:50.8748443Z ```json
2025-08-10T01:11:50.8748710Z {
2025-08-10T01:11:50.8749193Z   "narrative": "[Mode: DM MODE] Understanding confirmed. Processing user request.",
2025-08-10T01:11:50.8749854Z   "entities_mentioned": ["Test Entity"],
2025-08-10T01:11:50.8750314Z   "location_confirmed": "Test Location",
2025-08-10T01:11:50.8750786Z   "state_updates": {}
2025-08-10T01:11:50.8751111Z }
2025-08-10T01:11:50.8751378Z ```
2025-08-10T01:11:50.8751525Z
2025-08-10T01:11:50.8751532Z
2025-08-10T01:11:50.8751690Z FIXED OUTPUT (what users see now):
2025-08-10T01:11:50.8752240Z [Mode: DM MODE] Understanding confirmed. Processing user request.
2025-08-10T01:11:50.8752652Z
2025-08-10T01:11:50.8752886Z ‚úì Bug fixed: Users only see narrative text!
2025-08-10T01:11:50.8753183Z
2025-08-10T01:11:50.8753334Z ============================================================
2025-08-10T01:11:50.8753986Z SUMMARY:
2025-08-10T01:11:50.8754271Z Tests run: 6
2025-08-10T01:11:50.8754568Z Failures: 0
2025-08-10T01:11:50.8754844Z Errors: 0
2025-08-10T01:11:50.8755015Z
2025-08-10T01:11:50.8755286Z ‚úÖ All tests GREEN - JSON display bug is FIXED!
2025-08-10T01:11:50.8755840Z Users will never see raw JSON in their game interface.
2025-08-10T01:11:50.8756323Z ============================================================
2025-08-10T01:11:50.8757297Z test_red_state_raw_json_displayed (__main__.TestRedGreenJSONFix.test_red_state_raw_json_displayed)
2025-08-10T01:11:50.8758639Z RED TEST: Demonstrates the bug where raw JSON is shown to users ... ok
2025-08-10T01:11:50.8759448Z test_simulate_red_state (__main__.TestRedGreenJSONFix.test_simulate_red_state)
2025-08-10T01:11:50.8760253Z SIMULATION: What the bug looked like before the fix ... ok
2025-08-10T01:11:50.8760748Z
2025-08-10T01:11:50.8761036Z ----------------------------------------------------------------------
2025-08-10T01:11:50.8761502Z Ran 6 tests in 0.002s
2025-08-10T01:11:50.8761717Z
2025-08-10T01:11:50.8803789Z OK
2025-08-10T01:11:50.8804273Z ‚úÖ PASS: tests/test_red_green_json_fix.py
2025-08-10T01:11:50.8805490Z ----------------------------------------
2025-08-10T01:11:50.8805965Z Running: tests/test_robust_json_parser.py
2025-08-10T01:11:50.9479788Z ....WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:50.9481918Z ERROR:root:üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:50.9489094Z ........WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:50.9500421Z .......WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:50.9502073Z ..
2025-08-10T01:11:50.9502458Z ----------------------------------------------------------------------
2025-08-10T01:11:50.9502941Z Ran 21 tests in 0.005s
2025-08-10T01:11:50.9503154Z
2025-08-10T01:11:50.9503289Z OK
2025-08-10T01:11:50.9604840Z ‚úÖ PASS: tests/test_robust_json_parser.py
2025-08-10T01:11:50.9606048Z ----------------------------------------
2025-08-10T01:11:50.9606518Z Running: tests/test_scene_numbering.py
2025-08-10T01:11:50.9987168Z .
2025-08-10T01:11:50.9988453Z ‚úì User scene numbers correctly increment only for AI responses
2025-08-10T01:11:50.9989586Z ----------------------------------------------------------------------
2025-08-10T01:11:50.9990113Z Ran 1 test in 0.000s
2025-08-10T01:11:50.9990330Z
2025-08-10T01:11:50.9990452Z OK
2025-08-10T01:11:50.9990860Z ‚úì Sequence IDs increment for all entries
2025-08-10T01:11:50.9992534Z ‚úì This fixes the increment-by-2 display issue
2025-08-10T01:11:51.0045219Z ‚úÖ PASS: tests/test_scene_numbering.py
2025-08-10T01:11:51.0046453Z ----------------------------------------
2025-08-10T01:11:51.0046947Z Running: tests/test_scene_prefix_json_bug.py
2025-08-10T01:11:51.0511525Z WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:51.0526217Z .....
2025-08-10T01:11:51.0527308Z ----------------------------------------------------------------------
2025-08-10T01:11:51.0528704Z Ran 5 tests in 0.002s
2025-08-10T01:11:51.0528942Z
2025-08-10T01:11:51.0529058Z OK
2025-08-10T01:11:51.0596277Z ‚úÖ PASS: tests/test_scene_prefix_json_bug.py
2025-08-10T01:11:51.0597506Z ----------------------------------------
2025-08-10T01:11:51.0598160Z Running: tests/test_settings_api.py
2025-08-10T01:11:51.3876386Z 2025-08-10 01:11:51,387 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:51.3970614Z 2025-08-10 01:11:51,396 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:51.3980602Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:51.3982352Z   setup_file_logging()
2025-08-10T01:11:51.3983538Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:51.6604327Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:51.6607327Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:51.6815176Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:51.6819833Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:52.3644196Z 2025-08-10 01:11:52,364 - root - ERROR - üî•üî¥ Failed to get user settings for user_549985: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:52.3675666Z .2025-08-10 01:11:52,367 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:52.3682455Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:52.3683954Z   setup_file_logging()
2025-08-10T01:11:52.3684577Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:52.3771802Z 2025-08-10 01:11:52,376 - root - ERROR - üî•üî¥ Failed to get user settings for user_549985: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:52.3792393Z .2025-08-10 01:11:52,378 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:52.3796310Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:52.3798048Z   setup_file_logging()
2025-08-10T01:11:52.3798663Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:52.3857019Z 2025-08-10 01:11:52,385 - root - INFO - User test-user-123 visited settings page
2025-08-10T01:11:52.3912706Z .2025-08-10 01:11:52,391 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:52.3916284Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:52.3918012Z   setup_file_logging()
2025-08-10T01:11:52.3918624Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:52.4011764Z 2025-08-10 01:11:52,399 - root - ERROR - üî•üî¥ Failed to update user settings for test-user-123: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:52.4015879Z Traceback (most recent call last):
2025-08-10T01:11:52.4017023Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:52.4018031Z     asyncio.get_running_loop()
2025-08-10T01:11:52.4018443Z RuntimeError: no running event loop
2025-08-10T01:11:52.4018728Z
2025-08-10T01:11:52.4019016Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:52.4019684Z
2025-08-10T01:11:52.4019839Z Traceback (most recent call last):
2025-08-10T01:11:52.4020598Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 1082, in update_user_settings
2025-08-10T01:11:52.4021165Z     db = get_db()
2025-08-10T01:11:52.4021349Z          ^^^^^^^^
2025-08-10T01:11:52.4021815Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:52.4022314Z     return firestore.client()
2025-08-10T01:11:52.4022535Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:52.4023122Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:52.4023874Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:52.4024281Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:52.4024964Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:52.4025715Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:52.4026088Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:52.4026730Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:52.4028169Z     self._services[name] = initializer(self)
2025-08-10T01:11:52.4028696Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:52.4029961Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:52.4031314Z     credentials = app.credential.get_credential()
2025-08-10T01:11:52.4031855Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:52.4033152Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:52.4034389Z     self._load_credential()
2025-08-10T01:11:52.4035632Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:52.4036988Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:52.4037665Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:52.4039026Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:52.4040261Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:52.4041912Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:52.4043743Z 2025-08-10 01:11:52,400 - root - INFO - Updated user settings for test-user-123: {'gemini_model': 'gemini-2.5-flash', 'debug_mode': True}
2025-08-10T01:11:52.4047137Z 2025-08-10 01:11:52,403 - root - ERROR - üî•üî¥ Failed to get user settings for user_549985: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:52.4049750Z .
2025-08-10T01:11:52.4050115Z ----------------------------------------------------------------------
2025-08-10T01:11:52.4050582Z Ran 4 tests in 1.008s
2025-08-10T01:11:52.4050771Z
2025-08-10T01:11:52.4050877Z OK
2025-08-10T01:11:52.6137074Z ‚úÖ PASS: tests/test_settings_api.py
2025-08-10T01:11:52.6138690Z ----------------------------------------
2025-08-10T01:11:52.6139095Z Running: tests/test_settings_auth_bypass.py
2025-08-10T01:11:52.9384300Z 2025-08-10 01:11:52,938 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:52.9462415Z test_mcp_settings_api_get_auth_bypass (__main__.TestMCPSettingsAuthBypass.test_mcp_settings_api_get_auth_bypass)
2025-08-10T01:11:52.9479272Z Test settings API GET with auth bypass through MCP. ... 2025-08-10 01:11:52,947 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:52.9489029Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:52.9491143Z   setup_file_logging()
2025-08-10T01:11:52.9492366Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:53.2087027Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:53.2093939Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:53.2298571Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:53.2301690Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:53.9153650Z 2025-08-10 01:11:53,914 - root - ERROR - üî•üî¥ Failed to get user settings for user_359435: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:53.9165010Z ok
2025-08-10T01:11:53.9167198Z test_mcp_settings_api_post_auth_bypass (__main__.TestMCPSettingsAuthBypass.test_mcp_settings_api_post_auth_bypass)
2025-08-10T01:11:53.9187287Z Test settings API POST with auth bypass through MCP. ... 2025-08-10 01:11:53,918 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:53.9190145Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:53.9193103Z   setup_file_logging()
2025-08-10T01:11:53.9193708Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:53.9291532Z 2025-08-10 01:11:53,927 - root - ERROR - üî•üî¥ Failed to update user settings for mcp-settings-auth-test-user: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:53.9293429Z Traceback (most recent call last):
2025-08-10T01:11:53.9295611Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:53.9296454Z     asyncio.get_running_loop()
2025-08-10T01:11:53.9296864Z RuntimeError: no running event loop
2025-08-10T01:11:53.9297155Z
2025-08-10T01:11:53.9297443Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:53.9297898Z
2025-08-10T01:11:53.9298250Z Traceback (most recent call last):
2025-08-10T01:11:53.9298863Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 1082, in update_user_settings
2025-08-10T01:11:53.9299405Z     db = get_db()
2025-08-10T01:11:53.9299587Z          ^^^^^^^^
2025-08-10T01:11:53.9300043Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:53.9300672Z     return firestore.client()
2025-08-10T01:11:53.9300895Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:53.9301490Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:53.9302238Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:53.9302642Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:53.9303306Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:53.9304059Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:53.9304430Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:53.9305074Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:53.9305722Z     self._services[name] = initializer(self)
2025-08-10T01:11:53.9305972Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:53.9306584Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:53.9308092Z     credentials = app.credential.get_credential()
2025-08-10T01:11:53.9308644Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:53.9309983Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:53.9311318Z     self._load_credential()
2025-08-10T01:11:53.9312539Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:53.9313981Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:53.9314662Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:53.9315843Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:53.9317223Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:53.9319273Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:53.9321222Z 2025-08-10 01:11:53,929 - root - INFO - Updated user settings for mcp-settings-auth-test-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:11:53.9323585Z 2025-08-10 01:11:53,931 - root - ERROR - üî•üî¥ Failed to get user settings for user_359435: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:53.9324994Z ok
2025-08-10T01:11:53.9325794Z test_mcp_settings_concurrent_auth_requests (__main__.TestMCPSettingsAuthBypass.test_mcp_settings_concurrent_auth_requests)
2025-08-10T01:11:53.9341109Z Test concurrent settings requests with auth bypass through MCP. ... 2025-08-10 01:11:53,933 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:53.9343654Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:53.9345693Z   setup_file_logging()
2025-08-10T01:11:53.9346587Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:53.9444716Z 2025-08-10 01:11:53,944 - root - ERROR - üî•üî¥ Failed to get user settings for user_789778: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:53.9472908Z 2025-08-10 01:11:53,946 - root - ERROR - üî•üî¥ Failed to get user settings for user_786085: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:53.9497594Z 2025-08-10 01:11:53,949 - root - ERROR - üî•üî¥ Failed to get user settings for user_004798: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:53.9503448Z ok
2025-08-10T01:11:53.9504257Z test_mcp_settings_invalid_auth_headers (__main__.TestMCPSettingsAuthBypass.test_mcp_settings_invalid_auth_headers)
2025-08-10T01:11:53.9522201Z Test settings with invalid auth headers through MCP. ... 2025-08-10 01:11:53,952 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:53.9525141Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:53.9526555Z   setup_file_logging()
2025-08-10T01:11:53.9527156Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:53.9589424Z ok
2025-08-10T01:11:53.9590337Z test_mcp_settings_page_auth_bypass (__main__.TestMCPSettingsAuthBypass.test_mcp_settings_page_auth_bypass)
2025-08-10T01:11:53.9611002Z Test settings page auth bypass through MCP. ... 2025-08-10 01:11:53,960 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:53.9614579Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:53.9616100Z   setup_file_logging()
2025-08-10T01:11:53.9616715Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:53.9674813Z 2025-08-10 01:11:53,967 - root - INFO - User mcp-settings-auth-test-user visited settings page
2025-08-10T01:11:53.9724717Z ok
2025-08-10T01:11:53.9725809Z test_mcp_settings_partial_auth_headers (__main__.TestMCPSettingsAuthBypass.test_mcp_settings_partial_auth_headers)
2025-08-10T01:11:53.9743658Z Test settings with partial auth headers through MCP. ... 2025-08-10 01:11:53,974 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:53.9746706Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:53.9748418Z   setup_file_logging()
2025-08-10T01:11:53.9749062Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:53.9808907Z ok
2025-08-10T01:11:53.9810049Z test_mcp_settings_without_auth_bypass (__main__.TestMCPSettingsAuthBypass.test_mcp_settings_without_auth_bypass)
2025-08-10T01:11:53.9828057Z Test settings without auth bypass through MCP. ... 2025-08-10 01:11:53,982 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:53.9831118Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:53.9832896Z   setup_file_logging()
2025-08-10T01:11:53.9833509Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:53.9896496Z ok
2025-08-10T01:11:53.9898762Z
2025-08-10T01:11:53.9899810Z ----------------------------------------------------------------------
2025-08-10T01:11:53.9900952Z Ran 7 tests in 1.044s
2025-08-10T01:11:53.9902628Z
2025-08-10T01:11:53.9902901Z OK
2025-08-10T01:11:54.1927155Z ‚úÖ PASS: tests/test_settings_auth_bypass.py
2025-08-10T01:11:54.1929831Z ----------------------------------------
2025-08-10T01:11:54.1930309Z Running: tests/test_settings_browser_mock.py
2025-08-10T01:11:54.5209376Z 2025-08-10 01:11:54,520 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:54.5302976Z 2025-08-10 01:11:54,530 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:54.5311503Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:54.5313375Z   setup_file_logging()
2025-08-10T01:11:54.5314347Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:54.5416233Z 2025-08-10 01:11:54,541 - main - INFO - Received campaign creation request:
2025-08-10T01:11:54.5418409Z 2025-08-10 01:11:54,541 - main - INFO -   Character: MCP Hero
2025-08-10T01:11:54.5419054Z 2025-08-10 01:11:54,541 - main - INFO -   Setting: MCP World
2025-08-10T01:11:54.5419872Z 2025-08-10 01:11:54,541 - main - INFO -   Description: Created via simulated browser flow through MCP
2025-08-10T01:11:54.5420916Z 2025-08-10 01:11:54,541 - main - INFO -   Custom options: []
2025-08-10T01:11:54.5421636Z 2025-08-10 01:11:54,541 - main - INFO -   Selected prompts: ['narrative']
2025-08-10T01:11:54.7925003Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:54.7929067Z   warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)
2025-08-10T01:11:54.8136426Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/pydantic/fields.py:1062: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
2025-08-10T01:11:54.8140017Z   warn('`min_items` is deprecated and will be removed, use `min_length` instead', DeprecationWarning)
2025-08-10T01:11:55.4904239Z 2025-08-10 01:11:55,490 - root - ERROR - üî•üî¥ Failed to get user settings for user_354819: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.4907246Z 2025-08-10 01:11:55,490 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:11:55.4908470Z 2025-08-10 01:11:55,490 - root - INFO - Mock mode: No companions requested
2025-08-10T01:11:55.4952565Z 2025-08-10 01:11:55,495 - decorators - ERROR - üî•üî¥ --- EXCEPTION IN: create_campaign ---
2025-08-10T01:11:55.4957303Z Args: ('mcp-browser-mock-user', 'MCP Browser Campaign', 'Character: MCP Hero | Setting: MCP World | Description: Created via simulated browser flow through MCP', 'Welcome to your adventure! You find yourself at the entrance of a mysterious dungeon, with stone walls covered in ancient runes. The air is thick with magic and possibility.', {'game_state_version': 1, 'player_character_data': {}, 'world_data': {}, 'npc_data': {}, 'custom_campaign_state': {'attribute_system': 'D&D'}, 'combat_state': {'in_combat': False}, 'last_state_update_timestamp': datetime.datetime(2025, 8, 10, 1, 11, 55, 490161, tzinfo=datetime.timezone.utc), 'time_sensitive_events': {}, 'npc_agendas': {}, 'world_resources': {}, 'time_pressure_warnings': {}, 'debug_mode': True, 'user_id': 'mcp-browser-mock-user'}, ['narrative'], False, {'session_header': '', 'planning_block': '', 'dice_rolls': [], 'resources': '', 'debug_info': {}, 'god_mode_response': ''})
2025-08-10T01:11:55.4962485Z Kwargs: {}
2025-08-10T01:11:55.4963648Z Error: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.4964870Z Traceback:
2025-08-10T01:11:55.4965209Z Traceback (most recent call last):
2025-08-10T01:11:55.4966070Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:55.4966877Z     asyncio.get_running_loop()
2025-08-10T01:11:55.4967315Z RuntimeError: no running event loop
2025-08-10T01:11:55.4967614Z
2025-08-10T01:11:55.4968135Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:55.4968582Z
2025-08-10T01:11:55.4968733Z Traceback (most recent call last):
2025-08-10T01:11:55.4969574Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/decorators.py", line 62, in wrapper
2025-08-10T01:11:55.4970375Z     return func(*args, **kwargs)
2025-08-10T01:11:55.4970688Z            ^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.4971482Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 896, in create_campaign
2025-08-10T01:11:55.4972370Z     db = get_db()
2025-08-10T01:11:55.4972678Z          ^^^^^^^^
2025-08-10T01:11:55.4973554Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:55.4974431Z     return firestore.client()
2025-08-10T01:11:55.4974816Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.4975853Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:55.4977154Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:55.4978036Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.4979420Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:55.4980712Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:55.4983197Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.4985200Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:55.4986390Z     self._services[name] = initializer(self)
2025-08-10T01:11:55.4986856Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.4988157Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:55.4989376Z     credentials = app.credential.get_credential()
2025-08-10T01:11:55.4989861Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.4991062Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:55.4992222Z     self._load_credential()
2025-08-10T01:11:55.4993382Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:55.4994783Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:55.4995474Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.4996894Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:55.4998964Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:55.5000783Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5002648Z --- END EXCEPTION ---
2025-08-10T01:11:55.5004549Z 2025-08-10 01:11:55,495 - root - ERROR - üî•üî¥ Campaign creation failed: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5007024Z .2025-08-10 01:11:55,499 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:55.5008978Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:55.5010473Z   setup_file_logging()
2025-08-10T01:11:55.5011062Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:55.5091867Z 2025-08-10 01:11:55,508 - root - ERROR - üî•üî¥ Failed to update user settings for mcp-browser-mock-user: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5093729Z Traceback (most recent call last):
2025-08-10T01:11:55.5094579Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:55.5095223Z     asyncio.get_running_loop()
2025-08-10T01:11:55.5095699Z RuntimeError: no running event loop
2025-08-10T01:11:55.5096098Z
2025-08-10T01:11:55.5096410Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:55.5096757Z
2025-08-10T01:11:55.5096858Z Traceback (most recent call last):
2025-08-10T01:11:55.5097436Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 1082, in update_user_settings
2025-08-10T01:11:55.5098278Z     db = get_db()
2025-08-10T01:11:55.5098466Z          ^^^^^^^^
2025-08-10T01:11:55.5098930Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:55.5099426Z     return firestore.client()
2025-08-10T01:11:55.5099649Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5100244Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:55.5100996Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:55.5101407Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5102080Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:55.5102815Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:55.5103191Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5103818Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:55.5104448Z     self._services[name] = initializer(self)
2025-08-10T01:11:55.5104705Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5105324Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:55.5106368Z     credentials = app.credential.get_credential()
2025-08-10T01:11:55.5106863Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5108024Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:55.5108835Z     self._load_credential()
2025-08-10T01:11:55.5110339Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:55.5113029Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:55.5114629Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5115855Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:55.5117300Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:55.5119420Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5121442Z 2025-08-10 01:11:55,509 - root - INFO - Updated user settings for mcp-browser-mock-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:11:55.5123933Z 2025-08-10 01:11:55,511 - root - ERROR - üî•üî¥ Failed to get user settings for user_354819: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5151009Z 2025-08-10 01:11:55,514 - root - ERROR - üî•üî¥ Failed to update user settings for mcp-browser-mock-user: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5152768Z Traceback (most recent call last):
2025-08-10T01:11:55.5153606Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:55.5154306Z     asyncio.get_running_loop()
2025-08-10T01:11:55.5155137Z RuntimeError: no running event loop
2025-08-10T01:11:55.5155506Z
2025-08-10T01:11:55.5155828Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:55.5156111Z
2025-08-10T01:11:55.5156217Z Traceback (most recent call last):
2025-08-10T01:11:55.5156820Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 1082, in update_user_settings
2025-08-10T01:11:55.5157355Z     db = get_db()
2025-08-10T01:11:55.5157537Z          ^^^^^^^^
2025-08-10T01:11:55.5158225Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:55.5158721Z     return firestore.client()
2025-08-10T01:11:55.5158940Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5159815Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:55.5160779Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:55.5161316Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5162277Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:55.5163215Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:55.5163709Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5164667Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:55.5165665Z     self._services[name] = initializer(self)
2025-08-10T01:11:55.5166131Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5167519Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:55.5169105Z     credentials = app.credential.get_credential()
2025-08-10T01:11:55.5171537Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5173735Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:55.5174996Z     self._load_credential()
2025-08-10T01:11:55.5176251Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:55.5177912Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:55.5178759Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5179973Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:55.5181421Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:55.5182701Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5183868Z 2025-08-10 01:11:55,514 - root - INFO - Updated user settings for mcp-browser-mock-user: {'gemini_model': 'gemini-2.5-pro'}
2025-08-10T01:11:55.5185689Z 2025-08-10 01:11:55,516 - root - ERROR - üî•üî¥ Failed to get user settings for user_354819: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5207466Z 2025-08-10 01:11:55,520 - root - ERROR - üî•üî¥ Failed to update user settings for mcp-browser-mock-user: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5209597Z Traceback (most recent call last):
2025-08-10T01:11:55.5210569Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:55.5211678Z     asyncio.get_running_loop()
2025-08-10T01:11:55.5212155Z RuntimeError: no running event loop
2025-08-10T01:11:55.5212474Z
2025-08-10T01:11:55.5212846Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:55.5213113Z
2025-08-10T01:11:55.5213218Z Traceback (most recent call last):
2025-08-10T01:11:55.5213815Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 1082, in update_user_settings
2025-08-10T01:11:55.5214355Z     db = get_db()
2025-08-10T01:11:55.5214533Z          ^^^^^^^^
2025-08-10T01:11:55.5214986Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:55.5215481Z     return firestore.client()
2025-08-10T01:11:55.5215693Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5216286Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:55.5217257Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:55.5217955Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5218968Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:55.5219912Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:55.5220611Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5221575Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:55.5222337Z     self._services[name] = initializer(self)
2025-08-10T01:11:55.5222925Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5223935Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:55.5225274Z     credentials = app.credential.get_credential()
2025-08-10T01:11:55.5227101Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5229301Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:55.5231494Z     self._load_credential()
2025-08-10T01:11:55.5232878Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:55.5234295Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:55.5234961Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5236083Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:55.5237301Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:55.5239333Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5241241Z 2025-08-10 01:11:55,520 - root - INFO - Updated user settings for mcp-browser-mock-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:11:55.5243563Z 2025-08-10 01:11:55,522 - root - ERROR - üî•üî¥ Failed to get user settings for user_354819: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5253836Z .2025-08-10 01:11:55,525 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:55.5256625Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:55.5258348Z   setup_file_logging()
2025-08-10T01:11:55.5258956Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:55.5343013Z 2025-08-10 01:11:55,533 - root - ERROR - üî•üî¥ Failed to update user settings for mcp-browser-mock-user: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5344701Z Traceback (most recent call last):
2025-08-10T01:11:55.5345927Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:55.5346768Z     asyncio.get_running_loop()
2025-08-10T01:11:55.5347230Z RuntimeError: no running event loop
2025-08-10T01:11:55.5347536Z
2025-08-10T01:11:55.5348129Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:55.5348410Z
2025-08-10T01:11:55.5348506Z Traceback (most recent call last):
2025-08-10T01:11:55.5349104Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 1082, in update_user_settings
2025-08-10T01:11:55.5349631Z     db = get_db()
2025-08-10T01:11:55.5349812Z          ^^^^^^^^
2025-08-10T01:11:55.5350263Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:55.5350960Z     return firestore.client()
2025-08-10T01:11:55.5351351Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5352276Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:55.5353424Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:55.5353978Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5354932Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:55.5355886Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:55.5356377Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5357896Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:55.5359298Z     self._services[name] = initializer(self)
2025-08-10T01:11:55.5361324Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5363459Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:55.5364736Z     credentials = app.credential.get_credential()
2025-08-10T01:11:55.5365270Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5366556Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:55.5367991Z     self._load_credential()
2025-08-10T01:11:55.5369147Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:55.5370556Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:55.5371300Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5372444Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:55.5373823Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:55.5375589Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5377549Z 2025-08-10 01:11:55,534 - root - INFO - Updated user settings for mcp-browser-mock-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:11:55.5380212Z 2025-08-10 01:11:55,536 - root - ERROR - üî•üî¥ Failed to get user settings for user_354819: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5386139Z .2025-08-10 01:11:55,538 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:55.5389054Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:55.5390540Z   setup_file_logging()
2025-08-10T01:11:55.5391175Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:55.5500363Z .2025-08-10 01:11:55,549 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:55.5503369Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:55.5505086Z   setup_file_logging()
2025-08-10T01:11:55.5505726Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:55.5596838Z 2025-08-10 01:11:55,558 - root - ERROR - üî•üî¥ Failed to update user settings for mcp-browser-mock-user: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5599031Z Traceback (most recent call last):
2025-08-10T01:11:55.5600317Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:55.5601055Z     asyncio.get_running_loop()
2025-08-10T01:11:55.5601547Z RuntimeError: no running event loop
2025-08-10T01:11:55.5601884Z
2025-08-10T01:11:55.5602287Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:55.5602568Z
2025-08-10T01:11:55.5602668Z Traceback (most recent call last):
2025-08-10T01:11:55.5603507Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 1082, in update_user_settings
2025-08-10T01:11:55.5604170Z     db = get_db()
2025-08-10T01:11:55.5604524Z          ^^^^^^^^
2025-08-10T01:11:55.5605303Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:55.5605967Z     return firestore.client()
2025-08-10T01:11:55.5606407Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5607350Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:55.5608701Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:55.5609255Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5610271Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:55.5611234Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:55.5611751Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5613044Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:55.5614535Z     self._services[name] = initializer(self)
2025-08-10T01:11:55.5616716Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5618926Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:55.5621130Z     credentials = app.credential.get_credential()
2025-08-10T01:11:55.5621674Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5622979Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:55.5624219Z     self._load_credential()
2025-08-10T01:11:55.5625462Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:55.5626720Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:55.5627111Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5628107Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:55.5629117Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:55.5630381Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5631666Z 2025-08-10 01:11:55,559 - root - INFO - Updated user settings for mcp-browser-mock-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:11:55.5633004Z 2025-08-10 01:11:55,561 - root - ERROR - üî•üî¥ Failed to get user settings for user_354819: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5651019Z 2025-08-10 01:11:55,564 - root - ERROR - üî•üî¥ Failed to update user settings for mcp-browser-mock-user: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5652720Z Traceback (most recent call last):
2025-08-10T01:11:55.5653664Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:55.5654641Z     asyncio.get_running_loop()
2025-08-10T01:11:55.5655143Z RuntimeError: no running event loop
2025-08-10T01:11:55.5655465Z
2025-08-10T01:11:55.5655841Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:55.5656108Z
2025-08-10T01:11:55.5656200Z Traceback (most recent call last):
2025-08-10T01:11:55.5657020Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 1082, in update_user_settings
2025-08-10T01:11:55.5657678Z     db = get_db()
2025-08-10T01:11:55.5658235Z          ^^^^^^^^
2025-08-10T01:11:55.5659016Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:55.5659643Z     return firestore.client()
2025-08-10T01:11:55.5660062Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5660960Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:55.5661919Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:55.5662466Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5663440Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:55.5664407Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:55.5664899Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5665839Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:55.5666604Z     self._services[name] = initializer(self)
2025-08-10T01:11:55.5667052Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5668357Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:55.5680224Z     credentials = app.credential.get_credential()
2025-08-10T01:11:55.5681445Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5682294Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:55.5683320Z     self._load_credential()
2025-08-10T01:11:55.5684231Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:55.5685000Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:55.5685363Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5686000Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:55.5686989Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:55.5688237Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5689885Z 2025-08-10 01:11:55,564 - root - INFO - Updated user settings for mcp-browser-mock-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:11:55.5691393Z 2025-08-10 01:11:55,567 - root - ERROR - üî•üî¥ Failed to get user settings for user_354819: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5706059Z 2025-08-10 01:11:55,569 - root - ERROR - üî•üî¥ Failed to update user settings for mcp-browser-mock-user: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5708035Z Traceback (most recent call last):
2025-08-10T01:11:55.5709350Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:55.5710118Z     asyncio.get_running_loop()
2025-08-10T01:11:55.5710602Z RuntimeError: no running event loop
2025-08-10T01:11:55.5710920Z
2025-08-10T01:11:55.5711289Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:55.5711562Z
2025-08-10T01:11:55.5711658Z Traceback (most recent call last):
2025-08-10T01:11:55.5712243Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 1082, in update_user_settings
2025-08-10T01:11:55.5712772Z     db = get_db()
2025-08-10T01:11:55.5712944Z          ^^^^^^^^
2025-08-10T01:11:55.5713409Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:55.5713913Z     return firestore.client()
2025-08-10T01:11:55.5714135Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5714725Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:55.5715715Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:55.5716256Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5717246Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:55.5718424Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:55.5718922Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5719872Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:55.5720643Z     self._services[name] = initializer(self)
2025-08-10T01:11:55.5721095Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5722017Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:55.5722810Z     credentials = app.credential.get_credential()
2025-08-10T01:11:55.5723264Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5724221Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:55.5724985Z     self._load_credential()
2025-08-10T01:11:55.5725947Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:55.5727130Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:55.5727648Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.5728823Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:55.5729975Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:55.5731200Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5732407Z 2025-08-10 01:11:55,570 - root - INFO - Updated user settings for mcp-browser-mock-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:11:55.5738290Z 2025-08-10 01:11:55,573 - root - ERROR - üî•üî¥ Failed to get user settings for user_354819: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5757320Z .2025-08-10 01:11:55,575 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:55.5760336Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:55.5761837Z   setup_file_logging()
2025-08-10T01:11:55.5762467Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:55.5839934Z .2025-08-10 01:11:55,583 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:55.5842643Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:55.5844149Z   setup_file_logging()
2025-08-10T01:11:55.5844767Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:55.5929329Z 2025-08-10 01:11:55,592 - root - ERROR - üî•üî¥ Failed to get user settings for user_354819: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.5947642Z .2025-08-10 01:11:55,594 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:55.5950593Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:55.5952082Z   setup_file_logging()
2025-08-10T01:11:55.5952707Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:55.6038432Z 2025-08-10 01:11:55,603 - root - ERROR - üî•üî¥ Failed to get user settings for user_354819: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.6056737Z .2025-08-10 01:11:55,605 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:55.6059687Z /home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py:194: ResourceWarning: unclosed file <_io.TextIOWrapper name='/tmp/worldarchitect.ai/flask-server.log' mode='a' encoding='UTF-8'>
2025-08-10T01:11:55.6061174Z   setup_file_logging()
2025-08-10T01:11:55.6061811Z ResourceWarning: Enable tracemalloc to get the object allocation traceback
2025-08-10T01:11:55.6147068Z 2025-08-10 01:11:55,613 - root - ERROR - üî•üî¥ Failed to update user settings for mcp-browser-mock-user: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.6149203Z Traceback (most recent call last):
2025-08-10T01:11:55.6150117Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/main.py", line 314, in wrapper
2025-08-10T01:11:55.6151105Z     asyncio.get_running_loop()
2025-08-10T01:11:55.6151741Z RuntimeError: no running event loop
2025-08-10T01:11:55.6152052Z
2025-08-10T01:11:55.6152424Z During handling of the above exception, another exception occurred:
2025-08-10T01:11:55.6152694Z
2025-08-10T01:11:55.6152798Z Traceback (most recent call last):
2025-08-10T01:11:55.6153593Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 1082, in update_user_settings
2025-08-10T01:11:55.6154243Z     db = get_db()
2025-08-10T01:11:55.6154608Z          ^^^^^^^^
2025-08-10T01:11:55.6155346Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site/firestore_service.py", line 433, in get_db
2025-08-10T01:11:55.6155986Z     return firestore.client()
2025-08-10T01:11:55.6156391Z            ^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.6157268Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 53, in client
2025-08-10T01:11:55.6158472Z     fs_client = _utils.get_app_service(app, _FIRESTORE_ATTRIBUTE, _FirestoreClient.from_app)
2025-08-10T01:11:55.6159038Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.6159977Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/_utils.py", line 98, in get_app_service
2025-08-10T01:11:55.6160899Z     return app._get_service(name, initializer) # pylint: disable=protected-access
2025-08-10T01:11:55.6161391Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.6162542Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/__init__.py", line 297, in _get_service
2025-08-10T01:11:55.6163929Z     self._services[name] = initializer(self)
2025-08-10T01:11:55.6165651Z                            ^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.6168013Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/firestore.py", line 69, in from_app
2025-08-10T01:11:55.6169308Z     credentials = app.credential.get_credential()
2025-08-10T01:11:55.6169837Z                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.6171028Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 142, in get_credential
2025-08-10T01:11:55.6172184Z     self._load_credential()
2025-08-10T01:11:55.6173347Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/firebase_admin/credentials.py", line 159, in _load_credential
2025-08-10T01:11:55.6174598Z     self._g_credential, self._project_id = google.auth.default(scopes=_scopes)
2025-08-10T01:11:55.6175199Z                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-10T01:11:55.6176258Z   File "/home/runner/work/worldarchitect.ai/worldarchitect.ai/venv/lib/python3.11/site-packages/google/auth/_default.py", line 685, in default
2025-08-10T01:11:55.6177518Z     raise exceptions.DefaultCredentialsError(_CLOUD_SDK_MISSING_CREDENTIALS)
2025-08-10T01:11:55.6179389Z google.auth.exceptions.DefaultCredentialsError: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.6181140Z 2025-08-10 01:11:55,614 - root - INFO - Updated user settings for mcp-browser-mock-user: {'gemini_model': 'gemini-2.5-flash'}
2025-08-10T01:11:55.6183309Z 2025-08-10 01:11:55,616 - root - ERROR - üî•üî¥ Failed to get user settings for user_354819: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-08-10T01:11:55.6186959Z .
2025-08-10T01:11:55.6187308Z ----------------------------------------------------------------------
2025-08-10T01:11:55.6187940Z Ran 9 tests in 1.089s
2025-08-10T01:11:55.6188150Z
2025-08-10T01:11:55.6188441Z OK
2025-08-10T01:11:55.6188938Z üîµ Running browser tests for settings with MCP architecture
2025-08-10T01:11:55.6189555Z üìù NOTE: Tests HTTP endpoints through MCP API gateway
2025-08-10T01:11:55.8171307Z ‚úÖ PASS: tests/test_settings_browser_mock.py
2025-08-10T01:11:55.8172687Z ----------------------------------------
2025-08-10T01:11:55.8173173Z Running: tests/test_simple_json_bug_check.py
2025-08-10T01:11:55.8635501Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/case.py:678: DeprecationWarning: It is deprecated to return a value that is not None from a test case (<bound method TestSimpleJsonBugCheck.test_character_creation_json_parsing of <__main__.TestSimpleJsonBugCheck testMethod=test_character_creation_json_parsing>>)
2025-08-10T01:11:55.8639099Z   return self.run(*args, **kwds)
2025-08-10T01:11:55.8640201Z .WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:55.8644832Z .
2025-08-10T01:11:55.8647214Z ----------------------------------------------------------------------
2025-08-10T01:11:55.8647941Z Ran 2 tests in 0.001s
2025-08-10T01:11:55.8648164Z
2025-08-10T01:11:55.8648285Z OK
2025-08-10T01:11:55.8648613Z \n=== Testing Character Creation JSON Parsing ===
2025-08-10T01:11:55.8649089Z Input JSON length: 1062
2025-08-10T01:11:55.8649553Z ‚úÖ Parsing succeeded!
2025-08-10T01:11:55.8649910Z Result text length: 456
2025-08-10T01:11:55.8650335Z Result preview: [CHARACTER CREATION - Step 1 of 7]
2025-08-10T01:11:55.8650698Z
2025-08-10T01:11:55.8651009Z Welcome, adventurer! Before we begin your journey, we need to cr...
2025-08-10T01:11:55.8651621Z Contains JSON artifacts: False
2025-08-10T01:11:55.8652060Z \n=== Testing Malformed JSON Handling ===
2025-08-10T01:11:55.8652522Z Result: Some content here
2025-08-10T01:11:55.8652911Z Contains original JSON: False
2025-08-10T01:11:55.8716940Z ‚úÖ PASS: tests/test_simple_json_bug_check.py
2025-08-10T01:11:55.8718401Z ----------------------------------------
2025-08-10T01:11:55.8718932Z Running: tests/test_state_update_integration.py
2025-08-10T01:11:55.9190229Z test_consecutive_state_updates (__main__.TestStateUpdateIntegration.test_consecutive_state_updates)
2025-08-10T01:11:55.9193486Z Test that consecutive actions properly update state ... skipped 'Integration tests require refactoring for current API - see state_updates validation in narrative_response_schema.py'
2025-08-10T01:11:55.9195219Z test_empty_state_updates_handling (__main__.TestStateUpdateIntegration.test_empty_state_updates_handling)
2025-08-10T01:11:55.9196696Z Test handling of empty state updates ... skipped 'Integration tests require refactoring for current API - see state_updates validation in narrative_response_schema.py'
2025-08-10T01:11:55.9198656Z test_gemini_service_state_update_processing (__main__.TestStateUpdateIntegration.test_gemini_service_state_update_processing)
2025-08-10T01:11:55.9200455Z Test that Gemini service properly processes state updates ... skipped 'Integration tests require refactoring for current API - see state_updates validation in narrative_response_schema.py'
2025-08-10T01:11:55.9202175Z test_malformed_state_updates_handling (__main__.TestStateUpdateIntegration.test_malformed_state_updates_handling)
2025-08-10T01:11:55.9203847Z Test graceful handling of malformed state updates ... skipped 'Integration tests require refactoring for current API - see state_updates validation in narrative_response_schema.py'
2025-08-10T01:11:55.9205490Z test_response_without_state_updates (__main__.TestStateUpdateIntegration.test_response_without_state_updates)
2025-08-10T01:11:55.9207120Z Test handling of responses without state updates ... skipped 'Integration tests require refactoring for current API - see state_updates validation in narrative_response_schema.py'
2025-08-10T01:11:55.9209228Z test_state_update_application_simulation (__main__.TestStateUpdateIntegration.test_state_update_application_simulation)
2025-08-10T01:11:55.9210755Z Test simulation of state update application to game state ... skipped 'Integration tests require refactoring for current API - see state_updates validation in narrative_response_schema.py'
2025-08-10T01:11:55.9212452Z test_state_update_data_types (__main__.TestStateUpdateIntegration.test_state_update_data_types)
2025-08-10T01:11:55.9214553Z Test that state update fields have correct data types ... skipped 'Integration tests require refactoring for current API - see state_updates validation in narrative_response_schema.py'
2025-08-10T01:11:55.9216203Z test_state_update_field_completeness (__main__.TestStateUpdateIntegration.test_state_update_field_completeness)
2025-08-10T01:11:55.9218073Z Test that all expected state update fields are present ... skipped 'Integration tests require refactoring for current API - see state_updates validation in narrative_response_schema.py'
2025-08-10T01:11:55.9219801Z test_state_updates_extracted_from_json_response (__main__.TestStateUpdateIntegration.test_state_updates_extracted_from_json_response)
2025-08-10T01:11:55.9221673Z Test that state updates are properly extracted from JSON response ... skipped 'Integration tests require refactoring for current API - see state_updates validation in narrative_response_schema.py'
2025-08-10T01:11:55.9223373Z test_state_updates_separated_from_narrative (__main__.TestStateUpdateIntegration.test_state_updates_separated_from_narrative)
2025-08-10T01:11:55.9224853Z Test that state updates don't leak into narrative text ... skipped 'Integration tests require refactoring for current API - see state_updates validation in narrative_response_schema.py'
2025-08-10T01:11:55.9226378Z test_state_update_debug_logging (__main__.TestStateUpdatePersistence.test_state_update_debug_logging)
2025-08-10T01:11:55.9228154Z Test that state updates are logged for debugging ... skipped 'Integration tests require refactoring for current API - see state_updates validation in narrative_response_schema.py'
2025-08-10T01:11:55.9229053Z
2025-08-10T01:11:55.9229290Z ----------------------------------------------------------------------
2025-08-10T01:11:55.9229801Z Ran 11 tests in 0.001s
2025-08-10T01:11:55.9230031Z
2025-08-10T01:11:55.9230161Z OK (skipped=11)
2025-08-10T01:11:55.9271720Z ‚úÖ PASS: tests/test_state_update_integration.py
2025-08-10T01:11:55.9272986Z ----------------------------------------
2025-08-10T01:11:55.9273491Z Running: tests/test_state_updates_json_parsing.py
2025-08-10T01:11:55.9744564Z .....
2025-08-10T01:11:55.9745955Z ----------------------------------------------------------------------
2025-08-10T01:11:55.9746479Z Ran 5 tests in 0.000s
2025-08-10T01:11:55.9746702Z
2025-08-10T01:11:55.9746818Z OK
2025-08-10T01:11:55.9817617Z ‚úÖ PASS: tests/test_state_updates_json_parsing.py
2025-08-10T01:11:55.9819122Z ----------------------------------------
2025-08-10T01:11:55.9819624Z Running: tests/test_structured_fields_storage.py
2025-08-10T01:11:56.0259203Z Structured Fields Storage Test
2025-08-10T01:11:56.0260442Z ==================================================
2025-08-10T01:11:56.0260945Z Testing structured fields storage...
2025-08-10T01:11:56.0261816Z ‚úì Found AI story entry: The goblin attacks you with its rusty sword!...
2025-08-10T01:11:56.0262483Z ‚úì session_header preserved
2025-08-10T01:11:56.0262935Z ‚úì planning_block preserved
2025-08-10T01:11:56.0263361Z ‚úì dice_rolls preserved
2025-08-10T01:11:56.0263754Z ‚úì resources preserved
2025-08-10T01:11:56.0264137Z ‚úì debug_info preserved
2025-08-10T01:11:56.0264647Z ‚úÖ All structured fields stored and retrieved correctly
2025-08-10T01:11:56.0316013Z ‚úÖ PASS: tests/test_structured_fields_storage.py
2025-08-10T01:11:56.0317265Z ----------------------------------------
2025-08-10T01:11:56.0318240Z Running: tests/test_structured_fields_utils.py
2025-08-10T01:11:56.0939058Z test_extract_structured_fields_constants_mapping (__main__.TestStructuredFieldsUtils.test_extract_structured_fields_constants_mapping)
2025-08-10T01:11:56.0945615Z Test that function uses correct constants for field names. ... ok
2025-08-10T01:11:56.0948045Z test_extract_structured_fields_with_complex_debug_info (__main__.TestStructuredFieldsUtils.test_extract_structured_fields_with_complex_debug_info)
2025-08-10T01:11:56.0954096Z Test extraction with complex debug info structure. ... ok
2025-08-10T01:11:56.0956122Z test_extract_structured_fields_with_empty_fields (__main__.TestStructuredFieldsUtils.test_extract_structured_fields_with_empty_fields)
2025-08-10T01:11:56.0961489Z Test extraction with empty structured response fields. ... ok
2025-08-10T01:11:56.0963471Z test_extract_structured_fields_with_full_data (__main__.TestStructuredFieldsUtils.test_extract_structured_fields_with_full_data)
2025-08-10T01:11:56.0966763Z Test extraction with complete structured response data. ... ok
2025-08-10T01:11:56.0969062Z test_extract_structured_fields_with_long_text_fields (__main__.TestStructuredFieldsUtils.test_extract_structured_fields_with_long_text_fields)
2025-08-10T01:11:56.0973758Z Test extraction with longer text content. ... ok
2025-08-10T01:11:56.0975767Z test_extract_structured_fields_with_missing_attributes (__main__.TestStructuredFieldsUtils.test_extract_structured_fields_with_missing_attributes)
2025-08-10T01:11:56.0981001Z Test extraction when structured response lacks some attributes. ... ok
2025-08-10T01:11:56.0983218Z test_extract_structured_fields_with_no_structured_response (__main__.TestStructuredFieldsUtils.test_extract_structured_fields_with_no_structured_response)
2025-08-10T01:11:56.0986175Z Test extraction when GeminiResponse has no structured_response. ... ok
2025-08-10T01:11:56.0988419Z test_extract_structured_fields_with_none_values (__main__.TestStructuredFieldsUtils.test_extract_structured_fields_with_none_values)
2025-08-10T01:11:56.0993196Z Test extraction when structured response has None values. ... ok
2025-08-10T01:11:56.0994973Z
2025-08-10T01:11:56.0995179Z Running Structured Fields Utils Tests
2025-08-10T01:11:56.0995888Z ----------------------------------------------------------------------
2025-08-10T01:11:56.0996393Z ==================================================
2025-08-10T01:11:56.0996971Z Ran 8 tests in 0.006s
2025-08-10T01:11:56.0997175Z
2025-08-10T01:11:56.0997327Z
2025-08-10T01:11:56.0997908Z ‚úÖ All 8 tests passed!
2025-08-10T01:11:56.0998398Z OK
2025-08-10T01:11:56.1108209Z ‚úÖ PASS: tests/test_structured_fields_utils.py
2025-08-10T01:11:56.1109905Z ----------------------------------------
2025-08-10T01:11:56.1110412Z Running: tests/test_structured_generation.py
2025-08-10T01:11:56.2895681Z test_entity_tracking_instruction (__main__.TestStructuredGeneration.test_entity_tracking_instruction)
2025-08-10T01:11:56.2897138Z Test EntityTrackingInstruction creation ... ok
2025-08-10T01:11:56.2898669Z test_integration_with_entity_tracking (__main__.TestStructuredGeneration.test_integration_with_entity_tracking)
2025-08-10T01:11:56.2903260Z Test integration with existing entity tracking system ... ok
2025-08-10T01:11:56.2904380Z test_narrative_response_schema (__main__.TestStructuredGeneration.test_narrative_response_schema)
2025-08-10T01:11:56.2905352Z Test NarrativeResponse model ... ok
2025-08-10T01:11:56.2906436Z test_parse_structured_response_fallback (__main__.TestStructuredGeneration.test_parse_structured_response_fallback)
2025-08-10T01:11:56.2909277Z Test fallback for invalid JSON ... WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:56.2921731Z ERROR:root:üî•üî¥ All JSON parsing strategies failed
2025-08-10T01:11:56.2922791Z ok
2025-08-10T01:11:56.2925158Z test_parse_structured_response_valid_json (__main__.TestStructuredGeneration.test_parse_structured_response_valid_json)
2025-08-10T01:11:56.2926377Z Test parsing valid JSON response ... ok
2025-08-10T01:11:56.2929327Z test_parse_structured_response_with_extra_text (__main__.TestStructuredGeneration.test_parse_structured_response_with_extra_text)
2025-08-10T01:11:56.2930290Z Test parsing JSON with extra text around it ... ok
2025-08-10T01:11:56.2931069Z test_structured_prompt_injection (__main__.TestStructuredGeneration.test_structured_prompt_injection)
2025-08-10T01:11:56.2932100Z Test prompt injection creation ... ok
2025-08-10T01:11:56.2932863Z test_validate_entity_coverage_missing (__main__.TestStructuredGeneration.test_validate_entity_coverage_missing)
2025-08-10T01:11:56.2933773Z Test entity coverage validation with missing entities ... ok
2025-08-10T01:11:56.2934636Z test_validate_entity_coverage_perfect (__main__.TestStructuredGeneration.test_validate_entity_coverage_perfect)
2025-08-10T01:11:56.2935496Z Test entity coverage validation with perfect coverage ... ok
2025-08-10T01:11:56.2935863Z
2025-08-10T01:11:56.2936070Z ----------------------------------------------------------------------
2025-08-10T01:11:56.2936547Z Ran 9 tests in 0.003s
2025-08-10T01:11:56.2936732Z
2025-08-10T01:11:56.2936843Z OK
2025-08-10T01:11:56.2937299Z üß™ Testing Structured Generation Implementation
2025-08-10T01:11:56.2937915Z ============================================================
2025-08-10T01:11:56.2938577Z ‚úÖ Integration test: Structured generation works with entity tracking
2025-08-10T01:11:56.3173046Z ‚úÖ PASS: tests/test_structured_generation.py
2025-08-10T01:11:56.3174457Z ----------------------------------------
2025-08-10T01:11:56.3175004Z Running: tests/test_structured_response_extraction.py
2025-08-10T01:11:56.3801470Z ........
2025-08-10T01:11:56.3803004Z ----------------------------------------------------------------------
2025-08-10T01:11:56.3803548Z Ran 8 tests in 0.001s
2025-08-10T01:11:56.3803775Z
2025-08-10T01:11:56.3803897Z OK
2025-08-10T01:11:56.3910106Z ‚úÖ PASS: tests/test_structured_response_extraction.py
2025-08-10T01:11:56.3911519Z ----------------------------------------
2025-08-10T01:11:56.3911996Z Running: tests/test_syntax.py
2025-08-10T01:11:56.4347031Z ..
2025-08-10T01:11:56.4347317Z
2025-08-10T01:11:56.4347541Z --- Attempting to import gemini_service.py ---
2025-08-10T01:11:56.4354388Z Setting dummy GEMINI_API_KEY for import test...
2025-08-10T01:11:56.4354970Z SUCCESS: gemini_service.py was imported without a syntax error.
2025-08-10T01:11:56.4355580Z ----------------------------------------------------------------------
2025-08-10T01:11:56.4356125Z Ran 2 tests in 0.007s
2025-08-10T01:11:56.4356355Z
2025-08-10T01:11:56.4356465Z OK
2025-08-10T01:11:56.4413538Z ‚úÖ PASS: tests/test_syntax.py
2025-08-10T01:11:56.4414787Z ----------------------------------------
2025-08-10T01:11:56.4415262Z Running: tests/test_syntax_comprehensive.py
2025-08-10T01:11:56.5648701Z test_all_python_files_syntax (__main__.TestComprehensiveSyntax.test_all_python_files_syntax)
2025-08-10T01:11:56.6289972Z Test that all Python files in the project have valid syntax using AST parsing. ... ok
2025-08-10T01:11:56.6291880Z test_basic_game_state_instantiation (__main__.TestComprehensiveSyntax.test_basic_game_state_instantiation)
2025-08-10T01:11:56.6294068Z Test basic GameState instantiation without combat-specific features. ... ok
2025-08-10T01:11:56.6295101Z test_game_state_syntax_and_import (__main__.TestComprehensiveSyntax.test_game_state_syntax_and_import)
2025-08-10T01:11:56.6317643Z Specifically test game_state.py syntax and import. ... ok
2025-08-10T01:11:56.6318870Z test_main_module_syntax (__main__.TestComprehensiveSyntax.test_main_module_syntax)
2025-08-10T01:11:56.9230793Z Test that main.py has valid syntax and can load its dependencies. ... 2025-08-10 01:11:56,922 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:11:56.9296166Z ok
2025-08-10T01:11:56.9298220Z
2025-08-10T01:11:56.9298471Z ----------------------------------------------------------------------
2025-08-10T01:11:56.9299001Z Ran 4 tests in 0.365s
2025-08-10T01:11:56.9299206Z
2025-08-10T01:11:56.9299658Z OK
2025-08-10T01:11:56.9299935Z === Comprehensive Syntax Testing ===
2025-08-10T01:11:56.9300400Z This test would have caught the f-string syntax error.
2025-08-10T01:11:56.9300749Z
2025-08-10T01:11:56.9300918Z --- Quick syntax check for all Python files ---
2025-08-10T01:11:56.9301613Z ‚úì debug_mode_parser.py: Syntax OK
2025-08-10T01:11:56.9302078Z ‚úì structured_fields_utils.py: Syntax OK
2025-08-10T01:11:56.9302780Z ‚úì custom_types.py: Syntax OK
2025-08-10T01:11:56.9303200Z ‚úì debug_hybrid_system.py: Syntax OK
2025-08-10T01:11:56.9303633Z ‚úì entity_preloader.py: Syntax OK
2025-08-10T01:11:56.9304060Z ‚úì memory_mcp_real.py: Syntax OK
2025-08-10T01:11:56.9304492Z ‚úì firestore_service.py: Syntax OK
2025-08-10T01:11:56.9304923Z ‚úì entity_instructions.py: Syntax OK
2025-08-10T01:11:56.9305372Z ‚úì numeric_field_converter.py: Syntax OK
2025-08-10T01:11:56.9305824Z ‚úì entity_tracking.py: Syntax OK
2025-08-10T01:11:56.9306224Z ‚úì mcp_memory_real.py: Syntax OK
2025-08-10T01:11:56.9306627Z ‚úì unified_api_examples.py: Syntax OK
2025-08-10T01:11:56.9307073Z ‚úì json_utils.py: Syntax OK
2025-08-10T01:11:56.9307449Z ‚úì mcp_api.py: Syntax OK
2025-08-10T01:11:56.9308003Z ‚úì game_state.py: Syntax OK
2025-08-10T01:11:56.9308449Z ‚úì memory_integration.py: Syntax OK
2025-08-10T01:11:56.9308886Z ‚úì world_logic.py: Syntax OK
2025-08-10T01:11:56.9309267Z ‚úì decorators.py: Syntax OK
2025-08-10T01:11:56.9309689Z ‚úì narrative_sync_validator.py: Syntax OK
2025-08-10T01:11:56.9310195Z ‚úì gemini_response.py: Syntax OK
2025-08-10T01:11:56.9310606Z ‚úì world_loader.py: Syntax OK
2025-08-10T01:11:56.9310990Z ‚úì entity_utils.py: Syntax OK
2025-08-10T01:11:56.9311397Z ‚úì main_parallel_dual_pass.py: Syntax OK
2025-08-10T01:11:56.9311863Z ‚úì narrative_response_schema.py: Syntax OK
2025-08-10T01:11:56.9312330Z ‚úì entity_validator.py: Syntax OK
2025-08-10T01:11:56.9312758Z ‚úì dual_pass_generator.py: Syntax OK
2025-08-10T01:11:56.9313174Z ‚úì mcp_client.py: Syntax OK
2025-08-10T01:11:56.9313566Z ‚úì document_generator.py: Syntax OK
2025-08-10T01:11:56.9313996Z ‚úì robust_json_parser.py: Syntax OK
2025-08-10T01:11:56.9314437Z ‚úì gemini_service.py: Syntax OK
2025-08-10T01:11:56.9314830Z ‚úì start_flask.py: Syntax OK
2025-08-10T01:11:56.9315211Z ‚úì inspect_sdk.py: Syntax OK
2025-08-10T01:11:56.9315592Z ‚úì logging_util.py: Syntax OK
2025-08-10T01:11:56.9315980Z ‚úì file_cache.py: Syntax OK
2025-08-10T01:11:56.9316362Z ‚úì gemini_request.py: Syntax OK
2025-08-10T01:11:56.9316778Z ‚úì constants.py: Syntax OK
2025-08-10T01:11:56.9317223Z ‚úì test_documentation_performance.py: Syntax OK
2025-08-10T01:11:56.9321735Z ‚úì token_utils.py: Syntax OK
2025-08-10T01:11:56.9322160Z ‚úì main.py: Syntax OK
2025-08-10T01:11:56.9322537Z ‚úì debug_json_response.py: Syntax OK
2025-08-10T01:11:56.9322959Z ‚úì __init__.py: Syntax OK
2025-08-10T01:11:56.9323169Z
2025-08-10T01:11:56.9323327Z --- Running comprehensive test suite ---
2025-08-10T01:11:56.9853620Z ‚úÖ PASS: tests/test_syntax_comprehensive.py
2025-08-10T01:11:56.9855150Z ----------------------------------------
2025-08-10T01:11:56.9855643Z Running: tests/test_think_block_protocol.py
2025-08-10T01:11:57.9817947Z test_error_response_format_defined (__main__.TestThinkBlockProtocol.test_error_response_format_defined)
2025-08-10T01:11:57.9825522Z Test that error response format is specified ... ok
2025-08-10T01:11:57.9826968Z test_forbidden_actions_defined (__main__.TestThinkBlockProtocol.test_forbidden_actions_defined)
2025-08-10T01:11:57.9850493Z Test that forbidden actions are clearly defined ... ok
2025-08-10T01:11:57.9851795Z test_invalid_input_definitions (__main__.TestThinkBlockProtocol.test_invalid_input_definitions)
2025-08-10T01:11:57.9860258Z Test that invalid post-think-block inputs are defined ... ok
2025-08-10T01:11:57.9861701Z test_protocol_overrides_other_instructions (__main__.TestThinkBlockProtocol.test_protocol_overrides_other_instructions)
2025-08-10T01:11:57.9864460Z Test that protocol explicitly states it overrides other instructions ... ok
2025-08-10T01:11:57.9867248Z test_protocol_presence (__main__.TestThinkBlockProtocol.test_protocol_presence)
2025-08-10T01:11:57.9872300Z Test that think block protocol is present somewhere in the file ... ok
2025-08-10T01:11:57.9873862Z test_state_validation_checkpoints (__main__.TestThinkBlockProtocol.test_state_validation_checkpoints)
2025-08-10T01:11:57.9880013Z Test that state validation checkpoints are defined ... ok
2025-08-10T01:11:57.9881404Z test_think_block_protocol_exists_in_prompt (__main__.TestThinkBlockProtocol.test_think_block_protocol_exists_in_prompt)
2025-08-10T01:11:57.9893089Z Test that think block protocol is present in the prompt file ... ok
2025-08-10T01:11:57.9894374Z test_think_keywords_detection (__main__.TestThinkBlockProtocol.test_think_keywords_detection)
2025-08-10T01:11:57.9918483Z Test that all think block keywords are properly defined ... ok
2025-08-10T01:11:57.9920990Z test_valid_input_definitions (__main__.TestThinkBlockProtocol.test_valid_input_definitions)
2025-08-10T01:11:57.9931929Z Test that valid post-think-block inputs are defined ... ok
2025-08-10T01:11:57.9933290Z test_complex_planning_scenario (__main__.TestThinkBlockScenarios.test_complex_planning_scenario)
2025-08-10T01:11:57.9935306Z Test complex planning scenario ... ok
2025-08-10T01:11:57.9937431Z test_invalid_continuation_scenario (__main__.TestThinkBlockScenarios.test_invalid_continuation_scenario)
2025-08-10T01:11:57.9938698Z Test invalid continuation after think block ... ok
2025-08-10T01:11:57.9941617Z test_simple_think_scenario (__main__.TestThinkBlockScenarios.test_simple_think_scenario)
2025-08-10T01:11:57.9942730Z Test simple think command scenario ... ok
2025-08-10T01:11:57.9943863Z test_valid_selection_scenario (__main__.TestThinkBlockScenarios.test_valid_selection_scenario)
2025-08-10T01:11:57.9944936Z Test valid option selection after think block ... ok
2025-08-10T01:11:57.9946100Z test_backup_file_exists (__main__.TestPromptFileIntegrity.test_backup_file_exists)
2025-08-10T01:11:57.9947254Z Test that backup file was created ... skipped 'Backup file is optional'
2025-08-10T01:11:57.9948617Z test_essential_protocols_preserved (__main__.TestPromptFileIntegrity.test_essential_protocols_preserved)
2025-08-10T01:11:57.9961398Z Test that essential game protocols are preserved ... ok
2025-08-10T01:11:57.9963070Z test_prompt_file_exists (__main__.TestPromptFileIntegrity.test_prompt_file_exists)
2025-08-10T01:11:57.9964193Z Test that the prompt file exists ... ok
2025-08-10T01:11:57.9965204Z test_prompt_file_readable (__main__.TestPromptFileIntegrity.test_prompt_file_readable)
2025-08-10T01:11:57.9965980Z Test that the prompt file is readable ... ok
2025-08-10T01:11:57.9966758Z test_state_transition_rules (__main__.TestThinkBlockStateManagement.test_state_transition_rules)
2025-08-10T01:11:57.9988549Z Test that state transition rules are clearly defined ... ok
2025-08-10T01:11:57.9989789Z test_waiting_state_definition (__main__.TestThinkBlockStateManagement.test_waiting_state_definition)
2025-08-10T01:11:57.9994875Z Test that planning block state is defined ... ok
2025-08-10T01:11:57.9995272Z
2025-08-10T01:11:57.9995762Z ----------------------------------------------------------------------
2025-08-10T01:11:57.9996447Z Ran 19 tests in 0.018s
2025-08-10T01:11:57.9996693Z
2025-08-10T01:11:57.9997331Z Running Think Block Protocol Tests...
2025-08-10T01:11:57.9998150Z ==================================================
2025-08-10T01:11:57.9998590Z OK (skipped=1)
2025-08-10T01:11:57.9998882Z
2025-08-10T01:11:57.9999322Z ‚úÖ All think block tests passed!
2025-08-10T01:11:58.1575453Z ‚úÖ PASS: tests/test_think_block_protocol.py
2025-08-10T01:11:58.1576944Z ----------------------------------------
2025-08-10T01:11:58.1577420Z Running: tests/test_time_consolidation.py
2025-08-10T01:11:58.2044136Z .........
2025-08-10T01:11:58.2044937Z ----------------------------------------------------------------------
2025-08-10T01:11:58.2045759Z Ran 9 tests in 0.001s
2025-08-10T01:11:58.2048684Z
2025-08-10T01:11:58.2048824Z OK
2025-08-10T01:11:58.2118792Z ‚úÖ PASS: tests/test_time_consolidation.py
2025-08-10T01:11:58.2119577Z ----------------------------------------
2025-08-10T01:11:58.2121470Z Running: tests/test_time_pressure.py
2025-08-10T01:11:58.2605582Z .......
2025-08-10T01:11:58.2606539Z ----------------------------------------------------------------------
2025-08-10T01:11:58.2608365Z Ran 7 tests in 0.002s
2025-08-10T01:11:58.2608592Z
2025-08-10T01:11:58.2608706Z OK
2025-08-10T01:11:58.2684986Z ‚úÖ PASS: tests/test_time_pressure.py
2025-08-10T01:11:58.2686603Z ----------------------------------------
2025-08-10T01:11:58.2687062Z Running: tests/test_token_utils.py
2025-08-10T01:11:58.4051156Z .....ERROR:root:üî•üî¥ Failed to read file /tmp/tmp85bzx531/nonexistent.txt: [Errno 2] No such file or directory: '/tmp/tmp85bzx531/nonexistent.txt'
2025-08-10T01:11:58.4055325Z ERROR:root:üî•üî¥ Failed to read file /path/that/does/not/exist.txt: [Errno 2] No such file or directory: '/path/that/does/not/exist.txt'
2025-08-10T01:11:58.4057035Z ERROR:root:üî•üî¥ Failed to read file : [Errno 21] Is a directory: '/home/runner/work/worldarchitect.ai/worldarchitect.ai/mvp_site'
2025-08-10T01:11:58.4059152Z ERROR:root:üî•üî¥ Failed to read file /root/restricted_file.txt: [Errno 13] Permission denied: '/root/restricted_file.txt'
2025-08-10T01:11:58.4263206Z ................
2025-08-10T01:11:58.4263998Z ----------------------------------------------------------------------
2025-08-10T01:11:58.4264802Z Ran 21 tests in 0.024s
2025-08-10T01:11:58.4265301Z
2025-08-10T01:11:58.4266746Z OK
2025-08-10T01:11:58.4518894Z ‚úÖ PASS: tests/test_token_utils.py
2025-08-10T01:11:58.4519829Z ----------------------------------------
2025-08-10T01:11:58.4520696Z Running: tests/test_unknown_entity_filtering.py
2025-08-10T01:11:58.5000474Z ...
2025-08-10T01:11:58.5001468Z ----------------------------------------------------------------------
2025-08-10T01:11:58.5003176Z Ran 3 tests in 0.001s
2025-08-10T01:11:58.5004440Z
2025-08-10T01:11:58.5004575Z OK
2025-08-10T01:11:58.5071131Z ‚úÖ PASS: tests/test_unknown_entity_filtering.py
2025-08-10T01:11:58.5072703Z ----------------------------------------
2025-08-10T01:11:58.5073248Z Running: tests/test_unknown_entity_fix_summary.py
2025-08-10T01:11:58.5533452Z test_complete_fix_demonstration (__main__.TestUnknownEntityFixSummary.test_complete_fix_demonstration)
2025-08-10T01:11:58.5538566Z Complete demonstration of the fix ... ok
2025-08-10T01:11:58.5540394Z test_real_entities_still_validated (__main__.TestUnknownEntityFixSummary.test_real_entities_still_validated)
2025-08-10T01:11:58.5546303Z Ensure real entities are still properly validated ... ok
2025-08-10T01:11:58.5546787Z
2025-08-10T01:11:58.5548135Z
2025-08-10T01:11:58.5548614Z ----------------------------------------------------------------------
2025-08-10T01:11:58.5550199Z Ran 2 tests in 0.001s
2025-08-10T01:11:58.5550437Z
2025-08-10T01:11:58.5550552Z OK
2025-08-10T01:11:58.5551468Z === Unknown Entity Fix Demonstration ===
2025-08-10T01:11:58.5552569Z
2025-08-10T01:11:58.5553882Z 1. THE PROBLEM:
2025-08-10T01:11:58.5554746Z    Expected entities: ['Sir Galahad', 'Unknown']
2025-08-10T01:11:58.5556446Z    Narrative: 'The brave knight Sir Galahad enters the mysterious chamber.'
2025-08-10T01:11:58.5558442Z    Without fix: 'Unknown' would be flagged as missing
2025-08-10T01:11:58.5558811Z
2025-08-10T01:11:58.5558939Z 2. THE FIX:
2025-08-10T01:11:58.5559258Z    Entity validator filters out 'Unknown'
2025-08-10T01:11:58.5559681Z    Missing entities: []
2025-08-10T01:11:58.5560015Z    Retry needed: False
2025-08-10T01:11:58.5560230Z
2025-08-10T01:11:58.5560344Z 3. THE RESULT:
2025-08-10T01:11:58.5560699Z    Dual-pass generator also filters 'Unknown'
2025-08-10T01:11:58.5561159Z    Second pass needed: False
2025-08-10T01:11:58.5561532Z    Success on first pass: True
2025-08-10T01:11:58.5561788Z
2025-08-10T01:11:58.5562204Z ‚úÖ Fix verified: No unnecessary dual-pass for 'Unknown' entity!
2025-08-10T01:11:58.5562559Z
2025-08-10T01:11:58.5562789Z ‚úÖ Real entity validation still works correctly!
2025-08-10T01:11:58.5618664Z ‚úÖ PASS: tests/test_unknown_entity_fix_summary.py
2025-08-10T01:11:58.5620430Z ----------------------------------------
2025-08-10T01:11:58.5621250Z Running: tests/test_user_scenario_fix_validation.py
2025-08-10T01:11:58.6093208Z .WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:58.6103159Z ..WARNING:root:‚ö†Ô∏è üîç MALFORMED_JSON_DETECTED: Attempting field extraction from malformed JSON
2025-08-10T01:11:58.6105867Z .
2025-08-10T01:11:58.6106708Z ----------------------------------------------------------------------
2025-08-10T01:11:58.6107195Z Ran 4 tests in 0.002s
2025-08-10T01:11:58.6107404Z
2025-08-10T01:11:58.6107515Z OK
2025-08-10T01:11:58.6182781Z ‚úÖ PASS: tests/test_user_scenario_fix_validation.py
2025-08-10T01:11:58.6184356Z ----------------------------------------
2025-08-10T01:11:58.6184889Z Running: tests/test_v1_vs_v2_campaign_comparison.py
2025-08-10T01:11:58.7526654Z setUpClass (__main__.V1VsV2CampaignComparisonTest) ... skipped 'V1 server not available for testing'
2025-08-10T01:11:58.7529145Z üî¨ V1 vs V2 Campaign Creation Comparison Test Suite
2025-08-10T01:11:58.7530092Z
2025-08-10T01:11:58.7530340Z ----------------------------------------------------------------------
2025-08-10T01:11:58.7530826Z Ran 0 tests in 0.003s
2025-08-10T01:11:58.7531031Z
2025-08-10T01:11:58.7531148Z OK (skipped=1)
2025-08-10T01:11:58.7532123Z ============================================================
2025-08-10T01:11:58.7533936Z üìÅ Evidence directories created in: docs/v1_vs_v2_comparison
2025-08-10T01:11:58.7535258Z üìã Test Matrix Generated: 39 test combinations
2025-08-10T01:11:58.7538535Z ‚ùå V1 server not available at http://localhost:8081: HTTPConnectionPool(host='localhost', port=8081): Max retries exceeded with url: /health (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f3d93cfdc50>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-08-10T01:11:58.7703308Z ‚úÖ PASS: tests/test_v1_vs_v2_campaign_comparison.py
2025-08-10T01:11:58.7705068Z ----------------------------------------
2025-08-10T01:11:58.7705643Z Running: tests/test_v2_dashboard_authenticated_user.py
2025-08-10T01:11:58.7806210Z ‚úÖ All tests passed - Dashboard logic is correct
2025-08-10T01:11:58.7808303Z üö® But V2 UI still shows welcome page despite having campaigns
2025-08-10T01:11:58.7809107Z üîç Issue: campaigns array not reaching Dashboard component properly
2025-08-10T01:11:58.7828557Z ‚úÖ PASS: tests/test_v2_dashboard_authenticated_user.py
2025-08-10T01:11:58.7830222Z ----------------------------------------
2025-08-10T01:11:58.7830715Z Running: tests/test_v2_planning_blocks.py
2025-08-10T01:11:58.8003441Z Testing V2 Planning Blocks Implementation
2025-08-10T01:11:58.8004829Z
2025-08-10T01:11:58.8005183Z ==================================================
2025-08-10T01:11:58.8006362Z ‚úÖ Planning block data structure is correct
2025-08-10T01:11:58.8008569Z ‚úÖ API response with planning block is valid
2025-08-10T01:11:58.8009410Z ‚úÖ StoryEntry with planning type is valid
2025-08-10T01:11:58.8010841Z üìã TypeScript type definitions:
2025-08-10T01:11:58.8012132Z   - PlanningBlockChoice
2025-08-10T01:11:58.8013261Z   - PlanningBlockData
2025-08-10T01:11:58.8014275Z   - Updated InteractionResponse with planning_block field
2025-08-10T01:11:58.8016046Z   - Extended StoryEntry with 'planning' type
2025-08-10T01:11:58.8016351Z
2025-08-10T01:11:58.8016567Z üß© React components:
2025-08-10T01:11:58.8016959Z   - PlanningBlock.tsx component created
2025-08-10T01:11:58.8017495Z   - GameView.tsx updated to render planning blocks
2025-08-10T01:11:58.8018268Z   - api.service.ts updated to parse planning_block JSON
2025-08-10T01:11:58.8018659Z
2025-08-10T01:11:58.8018858Z üé® Rendering logic:
2025-08-10T01:11:58.8019251Z   - Planning blocks render with V2 theme colors
2025-08-10T01:11:58.8019770Z   - Choice selection triggers handleSubmit
2025-08-10T01:11:58.8020232Z   - Custom action option available
2025-08-10T01:11:58.8020686Z   - Risk level badges display correctly
2025-08-10T01:11:58.8020990Z
2025-08-10T01:11:58.8021248Z ‚úÖ All components integrated successfully
2025-08-10T01:11:58.8021870Z
2025-08-10T01:11:58.8022019Z ==================================================
2025-08-10T01:11:58.8022555Z ‚úÖ All V2 planning block tests passed!
2025-08-10T01:11:58.8022861Z
2025-08-10T01:11:58.8023007Z Implementation Summary:
2025-08-10T01:11:58.8023449Z 1. Created PlanningBlock.tsx component with V2 styling
2025-08-10T01:11:58.8024005Z 2. Extended api.types.ts with planning block types
2025-08-10T01:11:58.8024762Z 3. Updated GameView.tsx to render planning entries
2025-08-10T01:11:58.8025328Z 4. Modified api.service.ts to parse planning_block JSON
2025-08-10T01:11:58.8025945Z 5. Planning blocks now fully integrated in V2 interface
2025-08-10T01:11:58.8038557Z ‚úÖ PASS: tests/test_v2_planning_blocks.py
2025-08-10T01:11:58.8040100Z ----------------------------------------
2025-08-10T01:11:58.8040611Z Running: tests/test_validation_comparison.py
2025-08-10T01:11:58.9781016Z .WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp'. Using default: 1
2025-08-10T01:11:58.9783410Z WARNING:root:‚ö†Ô∏è Invalid value 'unknown' for field 'hp_max'. Using default: 1
2025-08-10T01:11:58.9832413Z ...
2025-08-10T01:11:58.9833804Z ----------------------------------------------------------------------
2025-08-10T01:11:58.9834308Z Ran 4 tests in 0.006s
2025-08-10T01:11:58.9834520Z
2025-08-10T01:11:58.9834627Z OK
2025-08-10T01:11:58.9834985Z Pydantic: Handled invalid data gracefully
2025-08-10T01:11:58.9836546Z Pydantic validation: 100 iterations in 0.005s (20130 ops/sec)
2025-08-10T01:11:59.0060752Z ‚úÖ PASS: tests/test_validation_comparison.py
2025-08-10T01:11:59.0062496Z ----------------------------------------
2025-08-10T01:11:59.0063669Z Running: tests/test_world_loader.py
2025-08-10T01:11:59.1237608Z test_development_scenario_parent_world (__main__.TestWorldLoader.test_development_scenario_parent_world)
2025-08-10T01:11:59.1246225Z Test legacy path logic (simplified since new cache tests cover functionality). ... ok
2025-08-10T01:11:59.1247444Z test_missing_world_files_error_handling (__main__.TestWorldLoader.test_missing_world_files_error_handling)
2025-08-10T01:11:59.1260800Z Test error handling when world files are missing. ... ok
2025-08-10T01:11:59.1263544Z test_path_construction_logic (__main__.TestWorldLoader.test_path_construction_logic)
2025-08-10T01:11:59.1267084Z Test the path construction logic for both scenarios. ... ok
2025-08-10T01:11:59.1269777Z test_production_scenario_local_world (__main__.TestWorldLoader.test_production_scenario_local_world)
2025-08-10T01:11:59.1279549Z Test current world_loader path resolution. ... ok
2025-08-10T01:11:59.1280679Z test_banned_names_loading_and_caching_behavior (__main__.TestWorldLoaderEnd2EndCache.test_banned_names_loading_and_caching_behavior)
2025-08-10T01:11:59.1299247Z Test banned names loading and caching behavior - PASSING TEST. ... ok
2025-08-10T01:11:59.1300720Z test_cache_hit_miss_scenarios_for_system_instructions (__main__.TestWorldLoaderEnd2EndCache.test_cache_hit_miss_scenarios_for_system_instructions)
2025-08-10T01:11:59.1302314Z Test cache hit/miss scenarios for world content system instructions - PASSING TEST. ... ok
2025-08-10T01:11:59.1303891Z test_cache_statistics_tracking_during_world_loading (__main__.TestWorldLoaderEnd2EndCache.test_cache_statistics_tracking_during_world_loading)
2025-08-10T01:11:59.1306879Z Test cache statistics tracking during world loading - PASSING TEST. ... ok
2025-08-10T01:11:59.1308423Z test_error_handling_with_missing_world_files (__main__.TestWorldLoaderEnd2EndCache.test_error_handling_with_missing_world_files)
2025-08-10T01:11:59.1314281Z Test error handling with missing world files - PASSING TEST. ... ERROR:root:üî•üî¥ Failed to read file /tmp/tmpaq8wdocf/world/world_assiah_compressed.md: [Errno 2] No such file or directory: '/tmp/tmpaq8wdocf/world/world_assiah_compressed.md'
2025-08-10T01:11:59.1316814Z ERROR:root:üî•üî¥ CRITICAL: World file not found: [Errno 2] No such file or directory: '/tmp/tmpaq8wdocf/world/world_assiah_compressed.md'
2025-08-10T01:11:59.1319134Z ERROR:root:üî•üî¥ Failed to read file /tmp/tmpaq8wdocf/world/world_assiah_compressed.md: [Errno 2] No such file or directory: '/tmp/tmpaq8wdocf/world/world_assiah_compressed.md'
2025-08-10T01:11:59.1321535Z ERROR:root:üî•üî¥ CRITICAL: World file not found: [Errno 2] No such file or directory: '/tmp/tmpaq8wdocf/world/world_assiah_compressed.md'
2025-08-10T01:11:59.1322669Z ok
2025-08-10T01:11:59.1323788Z test_integration_with_existing_world_loader_scenarios (__main__.TestWorldLoaderEnd2EndCache.test_integration_with_existing_world_loader_scenarios)
2025-08-10T01:11:59.1368556Z Test integration with existing world_loader scenarios - PASSING TEST. ... ok
2025-08-10T01:11:59.1369694Z test_memory_efficiency_validation (__main__.TestWorldLoaderEnd2EndCache.test_memory_efficiency_validation)
2025-08-10T01:11:59.1370688Z Test memory efficiency validation - PASSING TEST. ... ok
2025-08-10T01:11:59.1371729Z test_performance_improvement_verification (__main__.TestWorldLoaderEnd2EndCache.test_performance_improvement_verification)
2025-08-10T01:11:59.1372907Z Test cache functionality verification - focuses on behavior not timing. ... ok
2025-08-10T01:11:59.1374164Z test_world_content_loading_with_cache_integration (__main__.TestWorldLoaderEnd2EndCache.test_world_content_loading_with_cache_integration)
2025-08-10T01:11:59.1375355Z Test full world content loading with cache integration - PASSING TEST. ... ok
2025-08-10T01:11:59.1375913Z
2025-08-10T01:11:59.1376167Z ----------------------------------------------------------------------
2025-08-10T01:11:59.1376636Z Ran 12 tests in 0.012s
2025-08-10T01:11:59.1376829Z
2025-08-10T01:11:59.1376938Z OK
2025-08-10T01:11:59.1538979Z ‚úÖ PASS: tests/test_world_loader.py
2025-08-10T01:11:59.1542449Z ----------------------------------------
2025-08-10T01:11:59.1543036Z Running: tests/test_world_loader_e2e.py
2025-08-10T01:11:59.2030680Z .......
2025-08-10T01:11:59.2033105Z ----------------------------------------------------------------------
2025-08-10T01:11:59.2035595Z Ran 7 tests in 0.002s
2025-08-10T01:11:59.2037919Z
2025-08-10T01:11:59.2040003Z OK
2025-08-10T01:11:59.2103641Z ‚úÖ PASS: tests/test_world_loader_e2e.py
2025-08-10T01:11:59.2106239Z ----------------------------------------
2025-08-10T01:11:59.2108679Z Running: tests/test_world_logic_structure.py
2025-08-10T01:11:59.5444615Z 2025-08-10 01:11:59,544 - root - INFO - File logging configured: /tmp/worldarchitect.ai/flask-server.log
2025-08-10T01:12:04.9893213Z .2025-08-10 01:12:04,989 - root - INFO - --- update_state_with_changes: applying changes:\n{}
2025-08-10T01:12:04.9894516Z 2025-08-10 01:12:04,989 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:12:04.9900711Z 2025-08-10 01:12:04,989 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:12:04.9901751Z   "custom_campaign_state": {
2025-08-10T01:12:04.9902517Z     "last_story_mode_sequence_id": 6
2025-08-10T01:12:04.9903317Z   }
2025-08-10T01:12:04.9905155Z }
2025-08-10T01:12:04.9906991Z 2025-08-10 01:12:04,990 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:12:04.9907941Z   "last_story_mode_sequence_id": 6
2025-08-10T01:12:04.9908349Z }
2025-08-10T01:12:04.9908841Z 2025-08-10 01:12:04,990 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:12:04.9909643Z 2025-08-10 01:12:04,990 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:12:04.9910487Z 2025-08-10 01:12:04,990 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:12:04.9911535Z   "custom_campaign_state": {
2025-08-10T01:12:04.9911974Z     "last_story_mode_sequence_id": 6
2025-08-10T01:12:04.9912396Z   }
2025-08-10T01:12:04.9912662Z }
2025-08-10T01:12:04.9913182Z 2025-08-10 01:12:04,990 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:12:04.9913860Z   "last_story_mode_sequence_id": 6
2025-08-10T01:12:04.9914269Z }
2025-08-10T01:12:04.9914765Z 2025-08-10 01:12:04,990 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:12:04.9915567Z 2025-08-10 01:12:04,990 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:12:04.9931182Z .2025-08-10 01:12:04,992 - root - INFO - --- update_state_with_changes: applying changes:\n{}
2025-08-10T01:12:04.9933990Z 2025-08-10 01:12:04,992 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:12:04.9940018Z 2025-08-10 01:12:04,993 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:12:04.9951752Z   "custom_campaign_state": {
2025-08-10T01:12:04.9952274Z     "last_story_mode_sequence_id": 6
2025-08-10T01:12:04.9952692Z   }
2025-08-10T01:12:04.9952979Z }
2025-08-10T01:12:04.9953505Z 2025-08-10 01:12:04,993 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:12:04.9954184Z   "last_story_mode_sequence_id": 6
2025-08-10T01:12:04.9954587Z }
2025-08-10T01:12:04.9955061Z 2025-08-10 01:12:04,993 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:12:04.9955852Z 2025-08-10 01:12:04,993 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:12:04.9956688Z 2025-08-10 01:12:04,994 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:12:04.9957353Z   "custom_campaign_state": {
2025-08-10T01:12:04.9957949Z     "last_story_mode_sequence_id": 6
2025-08-10T01:12:04.9958379Z   }
2025-08-10T01:12:04.9958657Z }
2025-08-10T01:12:04.9959182Z 2025-08-10 01:12:04,994 - root - INFO - --- update_state_with_changes: applying changes:\n{
2025-08-10T01:12:04.9959857Z   "last_story_mode_sequence_id": 6
2025-08-10T01:12:04.9960263Z }
2025-08-10T01:12:04.9960728Z 2025-08-10 01:12:04,994 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:12:04.9961510Z 2025-08-10 01:12:04,994 - root - INFO - --- update_state_with_changes: finished ---
2025-08-10T01:12:04.9967150Z .2025-08-10 01:12:04,996 - root - INFO - Generated random campaign: character='A nature-loving druid who can shapeshift and command beasts', setting='The desert kingdom of Calimshan, where genies and merchants rule with equal power'
2025-08-10T01:12:05.0005988Z ..2025-08-10 01:12:05,000 - root - INFO - Generated random campaign: character='A wise wizard devoted to uncovering ancient magical secrets', setting='The desert kingdom of Calimshan, where genies and merchants rule with equal power'
2025-08-10T01:12:05.0012709Z 2025-08-10 01:12:05,000 - root - INFO - Using mock mode - returning mock initial story response
2025-08-10T01:12:05.0013602Z 2025-08-10 01:12:05,000 - root - INFO - Mock mode: No companions requested
2025-08-10T01:12:05.0018886Z 2025-08-10 01:12:05,001 - root - INFO - ‚úÖ Write-then-read (mock mode): user=test, campaign=generated-id-1, actor=user
2025-08-10T01:12:05.0021744Z 2025-08-10 01:12:05,001 - root - INFO - ‚úÖ Write-then-read (mock mode): user=test, campaign=generated-id-1, actor=gemini
2025-08-10T01:12:05.0103308Z .....
2025-08-10T01:12:05.0104971Z ----------------------------------------------------------------------
2025-08-10T01:12:05.0105735Z Ran 10 tests in 4.562s
2025-08-10T01:12:05.0107964Z
2025-08-10T01:12:05.0108114Z OK
2025-08-10T01:12:06.1467626Z ‚úÖ PASS: tests/test_world_logic_structure.py
2025-08-10T01:12:06.1470396Z ----------------------------------------
2025-08-10T01:12:06.1470986Z Running: tests/wizard/test_campaign_wizard_reset_reproduction.py
2025-08-10T01:12:14.1778933Z test_campaign_wizard_reset_issue_reproduction (__main__.CampaignWizardResetReproductionTest.test_campaign_wizard_reset_issue_reproduction)
2025-08-10T01:12:28.9968407Z Reproduce the complete user workflow that leads to persistent spinner ... /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/unittest/case.py:678: DeprecationWarning: It is deprecated to return a value that is not None from a test case (<bound method CampaignWizardResetReproductionTest.test_campaign_wizard_reset_issue_reproduction of <__main__.CampaignWizardResetReproductionTest testMethod=test_campaign_wizard_reset_issue_reproduction>>)
2025-08-10T01:12:28.9974516Z   return self.run(*args, **kwds)
2025-08-10T01:12:28.9974893Z ok
2025-08-10T01:12:29.5224525Z
2025-08-10T01:12:29.5225428Z ----------------------------------------------------------------------
2025-08-10T01:12:29.5225979Z
2025-08-10T01:12:29.5226753Z üß™ REPRODUCING CAMPAIGN WIZARD RESET ISSUE
2025-08-10T01:12:29.5227588Z üì± Step 1: Loading application...
2025-08-10T01:12:29.5229770Z Ran 1 test in 23.180s
2025-08-10T01:12:29.5230029Z
2025-08-10T01:12:29.5230160Z OK
2025-08-10T01:12:29.5232327Z üéÆ Step 2: Simulating first campaign creation...
2025-08-10T01:12:29.5233692Z üöÄ Step 3: Clicking 'Begin Adventure' to create first campaign...
2025-08-10T01:12:29.5234343Z ‚è≥ Step 4: Waiting for spinner to appear...
2025-08-10T01:12:29.5234756Z    Spinner visible: True
2025-08-10T01:12:29.5235231Z üìä Step 5: Waiting for campaign creation to complete...
2025-08-10T01:12:29.5235670Z    Dashboard visible: True
2025-08-10T01:12:29.5236200Z üéØ Step 6: Clicking 'Start Campaign' again (reproducing the bug)...
2025-08-10T01:12:29.5236935Z üîç Step 7: Checking what appears - fresh wizard or persistent spinner...
2025-08-10T01:12:29.5237565Z    ‚úÖ Fresh wizard content present: True
2025-08-10T01:12:29.5238202Z    ‚úÖ No persistent spinner found
2025-08-10T01:12:29.5238670Z üî¨ Step 8: Analyzing DOM state for debugging...
2025-08-10T01:12:29.5239109Z    Campaign wizard container contents:
2025-08-10T01:12:29.5239471Z
2025-08-10T01:12:29.5239754Z                             <div class="wizard-content">
2025-08-10T01:12:29.5240221Z                                 <h3>Campaign Creation Wizard</h3>
2025-08-10T01:12:29.5240719Z                                 <div class="wizard-step">Step 1: Basic Detai...
2025-08-10T01:12:29.5241239Z üìã Step 9: Test Results Summary
2025-08-10T01:12:29.5241595Z ==================================================
2025-08-10T01:12:29.5242202Z ‚úÖ EXPECTED BEHAVIOR: Fresh wizard appears, no persistent spinner
2025-08-10T01:12:29.5242873Z Test Result: PASS
2025-08-10T01:12:29.5243186Z ==================================================
2025-08-10T01:12:29.5325336Z sys:1: ResourceWarning: unclosed <socket.socket fd=3, family=2, type=1, proto=0, laddr=('0.0.0.0', 39513)>
2025-08-10T01:12:29.5471741Z ‚úÖ PASS: tests/wizard/test_campaign_wizard_reset_reproduction.py
2025-08-10T01:12:29.5473906Z ----------------------------------------
2025-08-10T01:12:29.5474491Z
2025-08-10T01:12:29.5474682Z ========================================
2025-08-10T01:12:29.5475202Z ‚ùå 1/178 TESTS FAILED
2025-08-10T01:12:29.5486563Z ##[error]Process completed with exit code 1.
